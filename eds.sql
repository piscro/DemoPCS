/****** Object:  Database [EDS]    Script Date: 3/27/2023 10:28:46 AM ******/

ALTER DATABASE [EDS] SET COMPATIBILITY_LEVEL = 150
GO
ALTER DATABASE [EDS] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [EDS] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [EDS] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [EDS] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [EDS] SET ARITHABORT OFF 
GO
ALTER DATABASE [EDS] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [EDS] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [EDS] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [EDS] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [EDS] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [EDS] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [EDS] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [EDS] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [EDS] SET ALLOW_SNAPSHOT_ISOLATION ON 
GO
ALTER DATABASE [EDS] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [EDS] SET READ_COMMITTED_SNAPSHOT ON 
GO
ALTER DATABASE [EDS] SET  MULTI_USER 
GO
ALTER DATABASE [EDS] SET ENCRYPTION ON
GO
ALTER DATABASE [EDS] SET QUERY_STORE = ON
GO
ALTER DATABASE [EDS] SET QUERY_STORE (OPERATION_MODE = READ_WRITE, CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 30), DATA_FLUSH_INTERVAL_SECONDS = 900, INTERVAL_LENGTH_MINUTES = 60, MAX_STORAGE_SIZE_MB = 100, QUERY_CAPTURE_MODE = AUTO, SIZE_BASED_CLEANUP_MODE = AUTO, MAX_PLANS_PER_QUERY = 200, WAIT_STATS_CAPTURE_MODE = ON)
GO
/*** The scripts of database scoped configurations in Azure should be executed inside the target database connection. ***/
GO
-- ALTER DATABASE SCOPED CONFIGURATION SET MAXDOP = 8;
GO
/****** Object:  User [cdc]    Script Date: 3/27/2023 10:28:46 AM ******/
CREATE USER [cdc] WITHOUT LOGIN WITH DEFAULT_SCHEMA=[cdc]
GO
sys.sp_addrolemember @rolename = N'db_owner', @membername = N'cdc'
GO
/****** Object:  Schema [cdc]    Script Date: 3/27/2023 10:28:46 AM ******/
CREATE SCHEMA [cdc]
GO
/****** Object:  UserDefinedFunction [dbo].[AlphaNumeric]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- AlphaNumeric
--
-- Returns an alpha-numeric version of the input string by replacing unwanted characters with spaces.
--
--		NOTES:	Parentheses, hyphens, underscores, and spaces are not stripped out.
--				Consecutive, leading, and trailing spaces are eliminated.
--				Only these characters are returned: a-z A-Z 0-9 () - _ and spaces.
--				
-- Author:			Heath Glandon
-- Last Updated:	Dec 2017
--
-- At least the following scripts are using:
--		Office365 Views
--



CREATE function [dbo].[AlphaNumeric](@string varchar(max))

returns varchar(max)

BEGIN

	-- loop through string replacing each invalid character with a space
	while patindex('%[^a-z 0-9()-]%', @string) > 0
		set @string = stuff(@string, patindex('%[^a-z 0-9()-]%', @string), 1, ' ')

	-- loop through string replacing double-spaces with a single space
	while charindex('  ',@string  ) > 0
		set @string = replace(@string, '  ', ' ')

	-- trim string
	set @string = ltrim(rtrim(@string))


return @string

END




GO
/****** Object:  UserDefinedFunction [dbo].[Bigger]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- returns larger of two reals
-- null values are ignored
CREATE FUNCTION [dbo].[Bigger]
(
	@a real,
    @b real
)
RETURNS real
AS
BEGIN
    select @a = case when @a is null then @b else @a end
    select @b = case when @b is null then @a else @b end
    return case when @a>@b then @a else @b end
END
GO
/****** Object:  UserDefinedFunction [dbo].[CleanEmail]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


-- Receives a string, looks for the first @ symbol, and if possible returns a valid email address
-- Last updated 2021-10-05

CREATE function [dbo].[CleanEmail] (@string varchar(8000))

returns varchar(8000) as

BEGIN
	declare 
            @left   varchar(8000)
           ,@right  varchar(8000)
           ,@email  varchar(8000)

    
    -- If there is no @ symbol, let's not waste our time looking for an email address.
    if @string not like '%@%' return null else set @string = ltrim(rtrim(@string))

    -- Get the left and right portions of the text based on the position of the @ symbol.
    set @left   = left( @string, charindex('@', @string, 0) - 1)
    set @right  = right(@string, len(@string)-charindex('@', @string, 0))

    -- Eliminate bad characters from the left and right parts by converting them to spaces.
    -- This will help determine where the email address starts and ends.
    -- Valid characters based on RFC3696 https://datatracker.ietf.org/doc/html/rfc3696#section-3
            
            -- LEFT (username part of email address)
            set @left = replace(@left,',',' ') -- eliminate commas
            -- loop through string replacing each invalid character with a space
	        while patindex('%[^a-z 0-9.!#$%&''*+-/=?^_`{|}~]%', @left) > 0
		        set @left = stuff(@left, patindex('%[^a-z 0-9.!#$%&''*+-/=?^_`{|}~]%', @left), 1, ' ')

            -- RIGHT (domain part of email address): Note that fewer special characters are permitted in the domain part.
            -- loop through string replacing each invalid character with a space
	        while patindex('%[^a-z 0-9-.]%', @right) > 0
		        set @right = stuff(@right, patindex('%[^a-z 0-9-.]%', @right), 1, ' ')

	        -- loop through left and right replacing double-spaces with a single space
	        while charindex('  ',@left  ) > 0
		        set @left = replace(@left, '  ', ' ')
	        while charindex('  ',@right  ) > 0
		        set @right = replace(@right, '  ', ' ')

	        -- trim
	        set @left   = ltrim(rtrim(@left ))
	        set @right  = ltrim(rtrim(@right))

            -- eliminate any trailing period
            if right(@right,1) = '.' set @right = left(@right,len(@right)-1)


    -- Assemble the email address using the component parts
    --      What we are doing here is starting from the @ symbol and then 'moving out' to the first space character, on both the left and right sides.
    set @left   = reverse(@left) -- Reverse the left side so it's easy to get to the position of first space character.
    set @left   = substring(@left,  1, case when charindex(' ', @left,  0) = 0 then len(@left)  + 1 else charindex(' ', @left,  0) end) -- Get text until first space
    set @right  = substring(@right, 1, case when charindex(' ', @right, 0) = 0 then len(@right) + 1 else charindex(' ', @right, 0) end) -- Get text until first space

    set @email  =   ltrim(rtrim(reverse(@left) +'@'+ @right))   -- Reverse @left back to normal then assemble the email address


    -- Validate the formatting of the email address before returning the value.
    set @email = case when @email like '%_@__%.__%' then @email else null end -- local-part@domain.part (minimum of 1char@2char.2char)
    set @email = case when @email not like '%@.%'   then @email else null end -- domain-part cannot begin with period
    set @email = case when @email not like '%.'     then @email else null end -- cannot end with period
    set @email = case when @email not like '.%'     then @email else null end -- cannot begin with period
    set @email = case when @email not like '%..%'   then @email else null end -- cannot have two consecutive periods
    set @email = case when len(@left)  <= 64                                  -- local-part  must be  64 characters or less
                       and len(@right) <= 255       then @email else null end -- domain-part must be 255 characters or less

    return @email

END




GO
/****** Object:  UserDefinedFunction [dbo].[CleanNumber]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- takes a string and removes all non-numeric characters including spaces
-- helpful for cleaning up phone numbers for example
-- uses num table (a table of sequential integers)


CREATE function [dbo].[CleanNumber] (@string varchar(8000))

returns varchar(8000) as

BEGIN
	declare @cleanstring varchar(8000)
	select @cleanstring = isnull(@cleanstring,'')+substring(@string,n,1)
	from num with (nolock)
	where n<=len(@string)
	  and substring(@string,n,1) like ('[0-9]')    

    return @cleanstring
END


GO
/****** Object:  UserDefinedFunction [dbo].[CleanPhone]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- takes a phone number and formats it in (727) 123-4567 x8910

CREATE function [dbo].[CleanPhone] (@string varchar(8000))

returns varchar(8000) as

BEGIN
	declare @cleanphone varchar(8000)

	set @cleanphone = dbo.CleanNumber(@string)
    set @cleanphone = case  when len(@cleanphone) > 10 then '('+left(@cleanphone,3)+') '+substring(@cleanphone,4,3)+'-'+substring(@cleanphone,7,4)+' x'+right(@cleanphone,len(@cleanphone)-10)
                            when len(@cleanphone) = 10 then '('+left(@cleanphone,3)+') '+substring(@cleanphone,4,3)+'-'+right(@cleanphone,4)
                            when len(@cleanphone) = 7  then left(@cleanphone,3)+'-'+right(@cleanphone,4)
                            when len(@cleanphone) > 7  then left(@cleanphone,3)+'-'+substring(@cleanphone,4,4)+' x'+right(@cleanphone,len(@cleanphone)-7)
                      else null end

    return @cleanphone
END

GO
/****** Object:  UserDefinedFunction [dbo].[GetCodeFromBrackets]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[GetCodeFromBrackets](
	@Field varchar(255) 
)

RETURNS varchar(8)
-- WITH SCHEMABINDING

-- Gets the code in [ ] from the field 
BEGIN

	DECLARE @Result varchar(8)
            
	SET @Result=(SELECT CASE WHEN @Field IS NOT NULL AND CHARINDEX('[',ISNULL(@Field,''))<>0 AND CHARINDEX('[',ISNULL(@Field,''))<>(CHARINDEX(']',ISNULL(@Field,''))-1)
                THEN SUBSTRING(@Field,CHARINDEX('[',@Field)+1,CHARINDEX(']',@Field)-CHARINDEX('[',@Field)-1) ELSE '' END) 
	
    RETURN @Result

END

--SELECT SUBSTRING('KSJDHFKJH []',12,0) --CHARINDEX(']',ISNULL('KSJDHFKJH []',''))
--
--SELECT CHARINDEX('[','')+1
--SELECT CHARINDEX(']','')-CHARINDEX('[','')-1
GO
/****** Object:  UserDefinedFunction [dbo].[MH_RemoveIllegalCharacters]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create Function [dbo].[MH_RemoveIllegalCharacters](@Temp VarChar(1000))
Returns VarChar(1000)
AS
Begin

    Declare @KeepValues as varchar(50)
    Set @KeepValues = '%[^a-z''''` ]%'
    While PatIndex(@KeepValues, @Temp) > 0
        Set @Temp = Stuff(@Temp, PatIndex(@KeepValues, @Temp), 1, '')

    Return @Temp
End
GO
/****** Object:  UserDefinedFunction [dbo].[N_Grad_FL]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



Create Function [dbo].[N_Grad_FL]
(
	 @subject	varchar(2)  -- FL (Foreign Language)
	,@req		  float		-- required credits
    ,@met		  float     -- earned credits subject 1
	,@enr	      float		-- enrolled credits (C or better)
	,@mrk		  varchar(1)-- lowest mark (gradebook grade) for enrolled credits
	,@rem		  float		-- remaining credits
	,@sem		  float		-- remaining semesters

)

RETURNS float
AS
BEGIN

	Declare @ontrack varchar(2)


	SET @ontrack =
    (
       select case
	                      ------------------------------------------
                   -- Foreign Language (FL)
                   ------------------------------------------
                   when @subject in ('FL') then
							   ------------------------------------------
							   -- Can this student's progress be tracked?
							   ------------------------------------------
						  case when @req is null then null									---------When grad_req-prgm has no match in Profile_Student_Grad_Requirements
							   ------------------------------------------
							   -- Has student completed all requirements?
							   ------------------------------------------
							   when @met >= @req then 'Y'									----------When earned credits >= required credits
							   -----------------------------------------------------------------------------------------
							   -- Will currently enrolled course(s) complete requirements AND is the grade C or better?
							   -----------------------------------------------------------------------------------------
							   when @met + @enr >= @req then 'Y'							---------When credits met + enrolled credits (C or better) >= credits required
							   ---------------------------------------------------------------
							   -- Is there time for the student to complete all requirements?
							   ---------------------------------------------------------------
							   when @rem - @enr <= (@sem - 1) then 'Y'					----------When remaining credits - enrolled credits (C or better) <= remaining semesters (not including current semester)
							   ----------------------------------------------------------------------------
							   -- Is the enrolled grade a D? OR Are there more than 2 remaining semesters?
							   ----------------------------------------------------------------------------
							   when @mrk = 'D' or @sem > 2 then 'N'							----------When enrolled credits lowest grade is D or there are more than 2 semesters remaining
							   ---------------------
							   -- Default CRITICAL!
							   ---------------------
							   else '!'
						  end
						end 
  )
	return @ontrack
end
GO
/****** Object:  UserDefinedFunction [dbo].[NameSuffix]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE Function [dbo].[NameSuffix](@Temp VarChar(1000))
Returns VarChar(1000)
AS
Begin

    set @temp = rtrim(@temp)

    set @temp = case when right(@temp,2) in (' I',' V')                     then right(@temp,1) else @temp end
    set @temp = case when right(@temp,2) in (',I',',V')                     then right(@temp,1) else @temp end
    set @temp = case when right(@temp,3) in (' Jr',' Sr',' II',' IV',' VI') then right(@temp,2) else @temp end
    set @temp = case when right(@temp,3) in (',Jr',',Sr',',II',',IV',',VI') then right(@temp,2) else @temp end
    set @temp = case when right(@temp,4) in (' Jr.',' Sr.')                 then right(@temp,3) else @temp end
    set @temp = case when right(@temp,4) in (',Jr.',',Sr.')                 then right(@temp,3) else @temp end
    set @temp = case when right(@temp,4) in (' III')                        then right(@temp,3) else @temp end
    set @temp = case when right(@temp,4) in (',III')                        then right(@temp,3) else @temp end

    set @temp = case when patindex('%[^a-z]%', right(@temp,1)) > 0 then left(@temp,len(@temp)-1) else @temp end -- remove last non-alpha character

    set @temp = case when @temp in ('I','II','III','IV','V','VI','Jr','Sr') then @temp end -- only return these valid suffix values

    return @temp

End
GO
/****** Object:  UserDefinedFunction [dbo].[NSC_RemoveIllegalCharacters]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE Function [dbo].[NSC_RemoveIllegalCharacters](@temp VarChar(1000))
Returns VarChar(1000)
AS
BEGIN

    declare @KeepValues as varchar(50)
    set @KeepValues = '%[^a-z''''-` ]%'

    while PatIndex(@KeepValues, @temp) > 0
        set @temp = Stuff(@temp, PatIndex(@KeepValues, @temp), 1, '')
    
    set @temp = ltrim(rtrim(@temp))

    set @temp = case when right(@temp,2) in (' I',' V')                     then left(@temp,len(@temp)-2) else @temp end
    set @temp = case when right(@temp,2) in (',I',',V')                     then left(@temp,len(@temp)-2) else @temp end
    set @temp = case when right(@temp,3) in (' Jr',' Sr',' II',' IV',' VI') then left(@temp,len(@temp)-3) else @temp end
    set @temp = case when right(@temp,3) in (',Jr',',Sr',',II',',IV',',VI') then left(@temp,len(@temp)-3) else @temp end
    set @temp = case when right(@temp,4) in (' Jr.',' Sr.')                 then left(@temp,len(@temp)-4) else @temp end
    set @temp = case when right(@temp,4) in (',Jr.',',Sr.')                 then left(@temp,len(@temp)-4) else @temp end
    set @temp = case when right(@temp,4) in (' III')                        then left(@temp,len(@temp)-4) else @temp end
    set @temp = case when right(@temp,4) in (',III')                        then left(@temp,len(@temp)-4) else @temp end

    set @temp = replace(@temp,'/','-')
    set @temp = replace(@temp,' -','-')
    set @temp = replace(@temp,'- ','-')

    set @temp = case when patindex('%[^a-z]%', right(@temp,1)) > 0 then left(@temp,len(@temp)-1) else @temp end

    return nullif(@temp,'')
END
GO
/****** Object:  UserDefinedFunction [dbo].[P_Grad_Sub_Enr]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*========================================================================

Author:			Lee Holmes
Create date:	04/06/2017
Last updated:   04/04/04
Project:		Profile_Student_Grad_Status, compute subject area credits enrolled
Description:	Required, Earned and Enrolled credits for up to 4 subjects per subject area

 =========================================================================*/

CREATE FUNCTION [dbo].[P_Grad_Sub_Enr] 
(
     @subject     varchar(2)  -- EN (English), MA (Math), SC (Science), SS (Social Studies), PF (Performing/Practical Arts), PE (HOPE), EL (Electives)
	,@r1		  float		-- required credits subject 1
	,@r2		  float		-- required credits subject 2
	,@r3		  float		-- required credits subject 3
	,@r4		  float		-- required credits subject 4
    ,@e1		  float     -- earned credits subject 1
    ,@e2		  float     -- earned credits subject 2 
    ,@e3		  float     -- earned credits subject 3 
    ,@e4		  float     -- earned credits subject 4 
	,@c1		  float		-- current entrolled credits
)

RETURNS float
AS
BEGIN

	DECLARE @enr float


	SET @enr =
    (
       select case
                   ------------------------------------------
                   -- 1-4 required subjects (EN, PF, PE, SS)
                   ------------------------------------------
                   when @subject in ('EN','PF','PE','SS','EL','CR') then
						case when @e1 >= @r1 and							-- subject 1 
								  @e2 >= @r2 and							-- subject 2		
								  @e3 >= @r3 and							-- subject 3		
								  @e4 >= @r4 								-- subject 4		 
							 then 0										    -- when earned >= required then use 0
							 else											-- else when remaining >= current enrolled
							 case when (case when @r1 - @e1 < 0 then 0								
										     else @r1 - @e1							
									    end +
									    case when @r2 - @e2 < 0 then 0							
										     else @r2 - @e2 
									    end +
									    case when @r3 - @e3 < 0 then 0								
										     else @r3 - @e3 
									    end +
									    case when @r4 - @e4 < 0 then 0								
										     else @r4 - @e4 
								        end) >= @c1 then @c1				-- then use current enrolled
								  else 										-- else use remaining
								  case when @r1 - @e1 < 0 then 0								
									   else @r1 - @e1						
								  end +
								  case when @r2 - @e2 < 0 then 0								
									   else @r2 - @e2 
								  end +
								  case when @r3 - @e3 < 0 then 0								
									   else @r3 - @e3 
								  end +
								  case when @r4 - @e4 < 0 then 0							
									   else @r4 - @e4 
							      end
							  end
						  end
                   ------------------------------------------
                   -- 2 required subjects and other (MA, SC)				-- same basic equation as above but allows excess from required courses to count as other
                   ------------------------------------------
                   when @subject in ('MA','SC') then
						case when @e1 >= @r1 and							-- subject 1 
								  @e2 >= @r2 and							-- subject 2
								  case when @e1 - @r1 < 0 then 0			-- subject 1 excess
								 	   else @e1 - @r1				
								  end + 													
								  case when @e2 - @r2 < 0 then 0			-- subject 2 excess
									   else @e2 - @r2				 
								  end +															
								  @e3 >= @r3								-- other non-required subjects
							 then 0											-- when earned >= required then use 0
							 else  											-- else when remaining >= current enrolled
							 case when (@r1 + @r2 + @r3) -					-- total required for subject area
								       (case when @e1 > @r1 then @r1				-- subject 1 - when earned > required then use required			
									         else @e1								--						              else use earned							
								        end +
								        case when @e2 > @r2 then @r2				-- subject 2			
									         else @e2							
								        end +
								        case when									-- other includes:								
									              case when @e1 - @r1 < 0 then 0		-- subject 1 excess		
								 		               else @e1 - @r1				
									              end + 													
									              case when @e2 - @r2 < 0 then 0		-- subject 2 excess		
								 		               else @e2 - @r2				 
									              end +															
									              @e3 > @r3 then @r3					-- other non-required subjects					
									         else 
									              case when @e1 - @r1 < 0 then 0		
										               else @e1 - @r1 
									              end + 													
									              case when @e2 - @r2 < 0 then 0		
										               else @e2 - @r2 
									              end +															
									              @e3
								        end) >= @c1 then @c1				-- then use current enrolled
								  else 										-- else use remaining
								        (case when @e1 > @r1 then @r1				-- subject 1 - when earned > required then use required			
									         else @e1								--						              else use earned							
								        end +
								        case when @e2 > @r2 then @r2				-- subject 2			
									         else @e2							
								        end +
								        case when									-- other includes:								
									              case when @e1 - @r1 < 0 then 0		-- subject 1 excess		
								 		               else @e1 - @r1				
									              end + 													
									              case when @e2 - @r2 < 0 then 0		-- subject 2 excess		
								 		               else @e2 - @r2				 
									              end +															
									              @e3 > @r3 then @r3					-- other non-required subjects					
									         else 
									              case when @e1 - @r1 < 0 then 0		
										               else @e1 - @r1 
									              end + 													
									              case when @e2 - @r2 < 0 then 0		
										               else @e2 - @r2 
									              end +															
									              @e3
								        end)
							end
					   end
                   ------------------------------------------
              end -- end main case statement
    ) 

	RETURN @enr

END
GO
/****** Object:  UserDefinedFunction [dbo].[P_Grad_Sub_Met]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*========================================================================

Author:			Lee Holmes
Create date:	04/06/2017
Last updated:   04/04/04
Project:		Profile_Student_Grad_Status, compute subject area credits earned
Description:	Required and Earned credits for up to 4 subjects per subject area

 =========================================================================*/

CREATE FUNCTION [dbo].[P_Grad_Sub_Met] 
(
     @subject     varchar(2)  -- EN (English), MA (Math), SC (Science), SS (Social Studies), PF (Performing/Practical Arts), PE (HOPE), EL (Electives)
	,@r1		  float		-- required credits subject 1
	,@r2		  float		-- required credits subject 2
	,@r3		  float		-- required credits subject 3
	,@r4		  float		-- required credits subject 4
    ,@e1		  float     -- earned credits subject 1
    ,@e2		  float     -- earned credits subject 2 
    ,@e3		  float     -- earned credits subject 3 
    ,@e4		  float     -- earned credits subject 4 
)

RETURNS float
AS
BEGIN

	DECLARE @met float


	SET @met =
    (
       select case
                   ------------------------------------------
                   -- 1-4 required subjects (EN, PF, PE, SS)
                   ------------------------------------------
                   when @subject in ('EN','PF','PE','SS','EL','CR') then
						case when @e1 > @r1 then @r1			-- subject 1 - when earned > required then use required
							 else @e1							--						              else use earned
						end +
						case when @e2 > @r2 then @r2			-- subject 2		
							 else @e2 
						end +
						case when @e3 > @r3 then @r3			-- subject 3		
							 else @e3 
						end +
						case when @e4 > @r4 then @r4			-- subject 4		 
							 else @e4 
						end
                   ------------------------------------------
                   -- 2 required subjects and other (MA, SC)
                   ------------------------------------------
                   when @subject in ('MA','SC') then
						case when @e1 > @r1 then @r1			-- subject 1 - when earned > required then use required
							 else @e1							--						              else use earned							
						end +
						case when @e2 > @r2 then @r2			-- subject 2
							 else @e2							
						end +
						case when								-- other includes:								
							 case when @e1 - @r1 < 0 then 0		-- subject 1 excess
								  else @e1 - @r1				
							 end + 													
							 case when @e2 - @r2 < 0 then 0		-- subject 2 excess
								  else @e2 - @r2				 
							 end +															
							 @e3 > @r3 then @r3					-- other non-required subjects
							 else 
							 case when @e1 - @r1 < 0 then 0		
								  else @e1 - @r1 
							 end + 													
							 case when @e2 - @r2 < 0 then 0		
								  else @e2 - @r2 
							 end +															
							 @e3
						end
                   ------------------------------------------
              end -- end main case statement
    ) 

	RETURN @met

END
GO
/****** Object:  UserDefinedFunction [dbo].[P_Grad_Sub_Mrk]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*========================================================================

Author:			Lee Holmes
Create date:	04/06/2017
Last updated:   04/04/04
Project:		Profile_Student_Grad_Status, compute subject area credits enrolled
Description:	Required, Earned and Enrolled credits for up to 4 subjects per subject area

 =========================================================================*/

CREATE FUNCTION [dbo].[P_Grad_Sub_Mrk] 
(
     @subject     varchar(2)  -- EN (English), MA (Math), SC (Science), SS (Social Studies), PF (Performing/Practical Arts), PE (HOPE)
	,@r1		  float		-- required credits subject 1
	,@r2		  float		-- required credits subject 2
	,@r3		  float		-- required credits subject 3
	,@r4		  float		-- required credits subject 4
    ,@e1		  float     -- earned credits subject 1
    ,@e2		  float     -- earned credits subject 2 
    ,@e3		  float     -- earned credits subject 3 
    ,@e4		  float     -- earned credits subject 4 
	,@m1		  varchar(1)-- lowest gradebook grade in enrolled class
)

RETURNS varchar
AS
BEGIN

	DECLARE @mrk varchar(1)


	SET @mrk =
    (
       select case
                   ------------------------------------------
                   -- 1-4 required subjects (EN, PF, PE, SS)
                   ------------------------------------------
                   when @subject in ('EN','PF','PE','SS','EL','CR') then
						case when @e1 >= @r1 and							-- subject 1 
								  @e2 >= @r2 and							-- subject 2		
								  @e3 >= @r3 and							-- subject 3		
								  @e4 >= @r4 								-- subject 4		 
							 then null										-- when earned >= required then use null
							 else											-- else when remaining >= current enrolled
							 @m1											-- lowest gradebook grade
						end
                   ------------------------------------------
                   -- 2 required subjects and other (MA, SC)				-- same basic equation as above but allows excess from required courses to count as other
                   ------------------------------------------
                   when @subject in ('MA','SC') then
						case when @e1 > @r1 and								-- subject 1 
								  @e2 > @r2 and								-- subject 2
								  case when @e1 - @r1 < 0 then 0			-- subject 1 excess
								 	   else @e1 - @r1				
								  end + 													
								  case when @e2 - @r2 < 0 then 0			-- subject 2 excess
									   else @e2 - @r2				 
								  end +															
								  @e3 > @r3									-- other non-required subjects
							 then null										-- when earned >= required then use null
							 else											-- else when remaining >= current enrolled
							 @m1											-- lowest gradebook grade
					    end
                   ------------------------------------------
              end -- end main case statement
    ) 

	RETURN @mrk

END
GO
/****** Object:  UserDefinedFunction [dbo].[P_Grad_Sub_Ontrack]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*========================================================================

Author:			Lee Holmes
Create date:	04/11/2017
Last updated:   04/11/2017
Project:		Profile_Student_Grad_Status, compute subject area ontrack
Description:	Logic to determine ontrack status for subject areas

 =========================================================================*/

CREATE FUNCTION [dbo].[P_Grad_Sub_Ontrack] 
(
     @subject     varchar(2)  -- EN (English), MA (Math), SC (Science), SS (Social Studies), PF (Performing/Practical Arts), PE (HOPE), EL (Electives), CR (Credits)
	,@req		  float		-- required credits
    ,@met		  float     -- earned credits subject 1
	,@enr	      float		-- enrolled credits (C or better)
	,@mrk		  varchar(1)-- lowest mark (gradebook grade) for enrolled credits
	,@rem		  float		-- remaining credits
	,@sem		  float		-- remaining semesters
)

RETURNS varchar
AS
BEGIN

	DECLARE @ontrack varchar(1)


	SET @ontrack =
    (
       select case
                   ------------------------------------------
                   -- Subject areas (EN, MA,SC, PF, PE, SS)
                   ------------------------------------------
                   when @subject in ('EN','MA','SC','PF','PE','SS') then
							   ------------------------------------------
							   -- Can this student's progress be tracked?
							   ------------------------------------------
						  case when @req is null then null									---------When grad_req-prgm has no match in Profile_Student_Grad_Requirements
							   ------------------------------------------
							   -- Has student completed all requirements?
							   ------------------------------------------
							   when @met >= @req then 'Y'									----------When earned credits >= required credits
							   -----------------------------------------------------------------------------------------
							   -- Will currently enrolled course(s) complete requirements AND is the grade C or better?
							   -----------------------------------------------------------------------------------------
							   when @met + @enr >= @req then 'Y'							---------When credits met + enrolled credits (C or better) >= credits required
							   ---------------------------------------------------------------
							   -- Is there time for the student to complete all requirements?
							   ---------------------------------------------------------------
							   when @rem - @enr <= (@sem - 1) / 2 then 'Y'					----------When remaining credits - enrolled credits (C or better) <= remaining semesters (not including current semester)
							   ----------------------------------------------------------------------------
							   -- Is the enrolled grade a D? OR Are there more than 2 remaining semesters?
							   ----------------------------------------------------------------------------
							   when @mrk = 'D' or @sem > 2 then 'N'							----------When enrolled credits lowest grade is D or there are more than 2 semesters remaining
							   ---------------------
							   -- Default CRITICAL!
							   ---------------------
							   else '!'
						  end
                   ------------------------------------------
                   -- Electives (EL)
                   ------------------------------------------
                   when @subject in ('EL') then
							   ------------------------------------------
							   -- Can this student's progress be tracked?
							   ------------------------------------------
						  case when @req is null then null									---------When grad_req-prgm has no match in Profile_Student_Grad_Requirements
							   ------------------------------------------
							   -- Has student completed all requirements?
							   ------------------------------------------
							   when @met >= @req then 'Y'									----------When earned credits >= required credits
							   -----------------------------------------------------------------------------------------
							   -- Will currently enrolled course(s) complete requirements AND is the grade C or better?
							   -----------------------------------------------------------------------------------------
							   when @met + @enr >= @req then 'Y'							---------When credits met + enrolled credits (C or better) >= credits required
							   ---------------------------------------------------------------
							   -- Is there time for the student to complete all requirements?
							   ---------------------------------------------------------------
							   when @rem - @enr <= (@sem - 1) then 'Y'					----------When remaining credits - enrolled credits (C or better) <= remaining semesters (not including current semester)
							   ----------------------------------------------------------------------------
							   -- Is the enrolled grade a D? OR Are there more than 2 remaining semesters?
							   ----------------------------------------------------------------------------
							   when @mrk = 'D' or @sem > 2 then 'N'							----------When enrolled credits lowest grade is D or there are more than 2 semesters remaining
							   ---------------------
							   -- Default CRITICAL!
							   ---------------------
							   else '!'
						  end
                   ------------------------------------------
                   -- Credits (CR)
                   ------------------------------------------
                   when @subject = 'CR' then
							   ------------------------------------------
							   -- Can this student's progress be tracked?
							   ------------------------------------------
						  case when @req is null then null									---------When grad_req-prgm has no match in Profile_Student_Grad_Requirements
							   ------------------------------------------
							   -- Has student completed all requirements?
							   ------------------------------------------
							   when @met >= @req then 'Y'									----------When earned credits >= required credits
							   -----------------------------------------------------------------------------------------
							   -- Will currently enrolled course(s) complete requirements AND is the grade C or better?
							   -----------------------------------------------------------------------------------------
							   when @met + @enr >= @req then 'Y'							---------When credits met + enrolled credits (C or better) >= credits required
							   ---------------------------------------------------------------
							   -- Is there time for the student to complete all requirements?
							   ---------------------------------------------------------------
							   when @rem - @enr <= (@sem - 1) * 3 then 'Y'			----------When remaining credits - enrolled credits (C or better) <= remaining semesters * 3 (not including current semester)
							   ----------------------------------------------------------------------------
							   -- Is the enrolled grade a D? OR Are there more than 2 remaining semesters?
							   ----------------------------------------------------------------------------
							   when @mrk = 'D' or @sem > 2 then 'N'							----------When enrolled credits lowest grade is D or there are more than 2 semesters remaining
							   ---------------------
							   -- Default CRITICAL!
							   ---------------------
							   else '!'
						  end
                   ------------------------------------------
              end -- end main case statement
    ) 

	RETURN @ontrack

END
GO
/****** Object:  UserDefinedFunction [dbo].[P_Grad_Sub_Per]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*========================================================================

Author:			Lee Holmes
Create date:	04/06/2017
Last updated:   04/04/04
Project:		Profile_Student_Grad_Status, compute subject area percentage complete
Description:	Required and Earned credits for up to 4 subjects per subject area

 =========================================================================*/

CREATE FUNCTION [dbo].[P_Grad_Sub_Per] 
(
     @subject     varchar(2)  -- EN (English), MA (Math), SC (Science), SS (Social Studies), PF (Performing/Practical Arts), PE (HOPE), EL (Electives)
	,@r1		  float		-- required credits subject 1
	,@r2		  float		-- required credits subject 2
	,@r3		  float		-- required credits subject 3
	,@r4		  float		-- required credits subject 4
    ,@e1		  float     -- earned credits subject 1
    ,@e2		  float     -- earned credits subject 2 
    ,@e3		  float     -- earned credits subject 3 
    ,@e4		  float     -- earned credits subject 4 
)

RETURNS float
AS
BEGIN

	DECLARE @per float


	SET @per =
    (
       select case
                   ------------------------------------------
                   -- 1-4 required subjects (EN, PF, PE, SS)
                   ------------------------------------------
                   when @subject in ('EN','PF','PE','SS','EL','CR') then
						round(
				        case when cast(							
								  case when @e1 > @r1 then @r1			
									   else @e1							
								  end +
								  case when @e2 > @r2 then @r2					
									   else @e2 
								  end +
								  case when @e3 > @r3 then @r3					
									   else @e3 
								  end +
								  case when @e4 > @r4 then @r4				 
									   else @e4 
								  end as float) / nullif((@r1 + @r2 + @r3 + @r4),0) > 1 then 1	-- when earned / required > 1 then 1
							 else cast(
								  case when @e1 > @r1 then @r1			
									   else @e1							
								  end +
								  case when @e2 > @r2 then @r2					
									   else @e2 
								  end +
								  case when @e3 > @r3 then @r3					
									   else @e3 
								  end +
								  case when @e4 > @r4 then @r4					 
									   else @e4 
								  end as float)  / nullif((@r1 + @r2 + @r3 + @r4),0)					-- else earned / required
						end,3)
                   ------------------------------------------
                   -- 2 required subjects and other (MA, SC)
                   ------------------------------------------
                   when @subject in ('MA','SC') then
						round(
				        case when cast(								
								  case when @e1 > @r1 then @r1			
									   else @e1														
								  end +
								  case when @e2 > @r2 then @r2			
									   else @e2							
								  end +
								  case when																
									        case when @e1 - @r1 < 0 then 0		
												 else @e1 - @r1				
									        end + 													
									        case when @e2 - @r2 < 0 then 0		
												 else @e2 - @r2				 
									        end +															
									        @e3 > @r3 then @r3					
								  else 
									        case when @e1 - @r1 < 0 then 0		
												 else @e1 - @r1 
									        end + 													
									        case when @e2 - @r2 < 0 then 0		
												 else @e2 - @r2 
									        end +															
									        @e3
								  end as float) / nullif((@r1 + @r2 + @r3 + @r4),0) > 1 then 1	-- when earned / required > 1 then 1
							 else cast(	 
								  case when @e1 > @r1 then @r1			
									   else @e1														
								  end +
								  case when @e2 > @r2 then @r2			
									   else @e2							
								  end +
								  case when																
									        case when @e1 - @r1 < 0 then 0		
												 else @e1 - @r1				
									        end + 													
									        case when @e2 - @r2 < 0 then 0		
												 else @e2 - @r2				 
									        end +															
									        @e3 > @r3 then @r3					
								  else 
									        case when @e1 - @r1 < 0 then 0		
												 else @e1 - @r1 
									        end + 													
									        case when @e2 - @r2 < 0 then 0		
												 else @e2 - @r2 
									        end +															
									        @e3
								  end as float) / nullif((@r1 + @r2 + @r3 + @r4),0)				-- else earned / required
						end,3)
                   ------------------------------------------
              end -- end main case statement
    ) 

	RETURN @per

END
GO
/****** Object:  UserDefinedFunction [dbo].[P_Grad_Sub_Rem]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*========================================================================

Author:			Lee Holmes
Create date:	04/06/2017
Last updated:   04/04/04
Project:		Profile_Student_Grad_Status, compute subject area credits remaining
Description:	Required and Earned credits for up to 4 subjects per subject area

 =========================================================================*/

CREATE FUNCTION [dbo].[P_Grad_Sub_Rem] 
(
     @subject     varchar(2)  -- EN (English), MA (Math), SC (Science), SS (Social Studies), PF (Performing/Practical Arts), PE (HOPE), EL (Electives)
	,@r1		  float		-- required credits subject 1
	,@r2		  float		-- required credits subject 2
	,@r3		  float		-- required credits subject 3
	,@r4		  float		-- required credits subject 4
    ,@e1		  float     -- earned credits subject 1
    ,@e2		  float     -- earned credits subject 2 
    ,@e3		  float     -- earned credits subject 3 
    ,@e4		  float     -- earned credits subject 4 
)

RETURNS float
AS
BEGIN

	DECLARE @rem float


	SET @rem =
    (
       select case
                   ------------------------------------------
                   -- 1-4 required subjects (EN, PF, PE, SS)
                   ------------------------------------------
                   when @subject in ('EN','PF','PE','SS','EL','CR') then
						case when @r1 - @e1 < 0 then 0					-- subject 1 - when required - earned < 0 then use 0 (earned more than required so 0 is remaining)				
						     else @r1 - @e1								--										  else use required - earned (earned less than required so some is remaining)
						end +
						case when @r2 - @e2 < 0 then 0					-- subject 2				
						     else @r2 - @e2 
						end +
						case when @r3 - @e3 < 0 then 0					-- subject 3				
						     else @r3 - @e3 
						end +
						case when @r4 - @e4 < 0 then 0					-- subject 4				
						     else @r4 - @e4 
						end
                   ------------------------------------------
                   -- 2 required subjects and other (MA, SC)			-- same basic equation as above but allows excess from required courses to count as other
                   ------------------------------------------
                   when @subject in ('MA','SC') then
				        case when (@r1 + @r2 + @r3) -					-- total required for subject area
							(case when @e1 > @r1 then @r1				-- subject 1 - when earned > required then use required			
								  else @e1								--						              else use earned							
							 end +
							 case when @e2 > @r2 then @r2				-- subject 2			
								  else @e2							
							 end +
							 case when									-- other includes:								
								  case when @e1 - @r1 < 0 then 0		-- subject 1 excess		
								 	   else @e1 - @r1				
								  end + 													
								  case when @e2 - @r2 < 0 then 0		-- subject 2 excess		
								 	   else @e2 - @r2				 
								  end +															
								  @e3 > @r3 then @r3					-- other non-required subjects					
								  else 
								  case when @e1 - @r1 < 0 then 0		
									   else @e1 - @r1 
								  end + 													
								  case when @e2 - @r2 < 0 then 0		
									   else @e2 - @r2 
								  end +															
								  @e3
							 end) < 0 then 0
							 else (@r1 + @r2 + @r3) -
							(case when @e1 > @r1 then @r1			
								  else @e1							
							 end +
							 case when @e2 > @r2 then @r2			
								  else @e2							
							 end +
							 case when								
								  case when @e1 - @r1 < 0 then 0		
								 	   else @e1 - @r1				
								  end + 													
								  case when @e2 - @r2 < 0 then 0		
								 	   else @e2 - @r2				 
								  end +															
								  @e3 > @r3 then @r3					
								  else 
								  case when @e1 - @r1 < 0 then 0		
									   else @e1 - @r1 
								  end + 													
								  case when @e2 - @r2 < 0 then 0		
									   else @e2 - @r2 
								  end +															
								  @e3
							 end)
						end
                   ------------------------------------------
              end -- end main case statement
    ) 

	RETURN @rem

END
GO
/****** Object:  UserDefinedFunction [dbo].[P_Grad_Sub_Xs]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*========================================================================

Author:			Lee Holmes
Create date:	04/06/2017
Last updated:   04/04/04
Project:		Profile_Student_Grad_Status, compute subject area credits earned
Description:	Required and Earned credits for up to 4 subjects per subject area

 =========================================================================*/

CREATE FUNCTION [dbo].[P_Grad_Sub_Xs] 
(
     @subject     varchar(2)  -- EN (English), MA (Math), SC (Science), SS (Social Studies), PF (Performing/Practical Arts), PE (HOPE)
	,@r1		  float		-- required credits subject 1
	,@r2		  float		-- required credits subject 2
	,@r3		  float		-- required credits subject 3
	,@r4		  float		-- required credits subject 4
    ,@e1		  float     -- earned credits subject 1
    ,@e2		  float     -- earned credits subject 2 
    ,@e3		  float     -- earned credits subject 3 
    ,@e4		  float     -- earned credits subject 4 
)

RETURNS float
AS
BEGIN

	DECLARE @xs float


	SET @xs =
    (
       select case when (@e1 + @e2 + @e3 + @e4) > (@r1 + @r2 + @r3 + @r4) then (@e1 + @e2 + @e3 + @e4) - (@r1 + @r2 + @r3 + @r4)	-- when earned > required then earned - required
				   else 0																											--						  else 0
                   ------------------------------------------
              end -- end main case statement
    ) 

	RETURN @xs

END
GO
/****** Object:  UserDefinedFunction [dbo].[ProperCase]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- Takes an uppercase name and converts it to proper case
--
-- Thankfully lifted from http://www.joellipman.com/articles/sql/t-sql/convert-to-proper-case-in-t-sql.html
--

CREATE FUNCTION [dbo].[ProperCase](@Text AS VARCHAR(8000))
RETURNS VARCHAR(8000)
AS
BEGIN
   -- declare some variables
   DECLARE @Reset BIT; DECLARE @Ret VARCHAR(8000); DECLARE @i INT;
   DECLARE @c0 CHAR(1); DECLARE @c1 CHAR(1); DECLARE @c2 CHAR(1);
   DECLARE @CaseLen INT;
   DECLARE @CaseExceptions VARCHAR(8000);
   DECLARE @CaseValue VARCHAR(8000);

   -- Set some default values
   SELECT @Reset = 1, @i=1, @Ret = '';

   -- only apply if all characters are already in uppercase
   IF (UPPER(@Text)=@Text COLLATE Latin1_General_CS_AI)
        BEGIN

                -- add a leading and trailing space to indicate word delimiters (bol & eol)
                SET @Text = ' ' + @Text + ' ';

                -- cycle through each character,
                -- if non-alpha, uppercase next alpha character.
                -- if alpha then lowercase subsequent alphas.
                WHILE (@i <= LEN(@Text))
                        SELECT
                                @c0=SUBSTRING(@Text,@i-2,1), @c1=SUBSTRING(@Text,@i-1,1), @c2=SUBSTRING(@Text,@i,1),
                                @Ret = @Ret + CASE WHEN @Reset=1 THEN UPPER(@c2) ELSE LOWER(@c2) END,
                                @Reset = CASE
                                                -- EXCEPTION: McDonalds and Mc Donalds but not Tomcat
                                                WHEN @c0 = ' ' AND @c1 = 'M' AND @c2 = 'c' THEN 1

                                                -- EXCEPTION: D'Artagnan, I'Anson, O'Neils and O' Sullivan but Mo'Money
                                                WHEN @c0 = ' ' AND @c1 IN ('D', 'I', 'O') AND @c2 = '''' THEN 1

                                                WHEN @c2 LIKE '[a-zA-Z''0-9]' THEN 0            -- Apply LOWER to any character after alphas or apostrophes or numbers
                                                WHEN @c2 = '/' THEN 1            -- Apply LOWER to any character after alphas or apostrophes or numbers
                                                ELSE 1                                          -- Apply UPPER to any character after symbols/punctuation
                                        END,
                                @i = @i +1

                -- add a trailing space in case the previous rule changed this.
                SET @Ret = @Ret + ' ';

                -- custom exceptions: this search is case-insensitive and will
                -- replace the full word to the case as it is written in the list.
                -- NOTE: this list has to end with a comma!
                SELECT @i=0, @CaseLen=0,
                        @CaseExceptions = 
                        'and,at,de,for,in,la,of,or,the,to,van,von,y,'+
                        'AskMe,HoD,PO Box,SportMe,PreK,PreK-12,'+
                        'DeWese,DiGregorio,DiLeonardo,DuGranrut,LaFlam,LeCain,MacClinchy,'+
                        'BI,CEP,CTAE,ESEA,ESE,ESOL,ESY,FDLRS,FEIC,FL,GP,HHH,HR,IRB,IT,JATC,NHS,OVC,OT,OT-PT,'+
                        'PA,PE,PR,PP,PT,PCVI,PCTA,PESPA,PTHP,PTEC,SP,STEM,SWFWMD,TBA,TBD,TIF,TV,UET,UK,USA,USDA,USF,UPARC,VC,WPSC,YMCA,'+
                        'II,III,IV,V,'

                -- Loop through exception cases
                WHILE CHARINDEX(',', @CaseExceptions, @i+1)>0
                        BEGIN
                                -- get the delimited word
                                SET @CaseLen = CHARINDEX(',', @CaseExceptions, @i+1) - @i
                                SET @CaseValue = SUBSTRING(@CaseExceptions, @i, @CaseLen)

                                -- replace it in the original text, using spaces as delimiters
                                SET @Ret = REPLACE(@Ret, ' '+@CaseValue+' ', ' '+@CaseValue+' ')

                                -- replace it in the original text, using slashes and parentheses and comma as delimiters
                                -- we only want to do all these if necessary
                                if @Ret like '%/%' or @Ret like '%(%' or @Ret like '%,%'
                                BEGIN
                                    SET @Ret = REPLACE(@Ret, '/'+@CaseValue+' ', '/'+@CaseValue+' ')    -- '/Word '
                                    SET @Ret = REPLACE(@Ret, ' '+@CaseValue+'/', ' '+@CaseValue+'/')    -- ' Word/'
                                    SET @Ret = REPLACE(@Ret, '/'+@CaseValue+'/', '/'+@CaseValue+'/')    -- '/Word/'
                                    SET @Ret = REPLACE(@Ret, '('+@CaseValue+'/', '('+@CaseValue+'/')    -- '(Word/'
                                    SET @Ret = REPLACE(@Ret, '/'+@CaseValue+')', '/'+@CaseValue+')')    -- '/Word)'
                                    SET @Ret = REPLACE(@Ret, '('+@CaseValue+' ', '('+@CaseValue+' ')    -- '(Word '
                                    SET @Ret = REPLACE(@Ret, ' '+@CaseValue+')', ' '+@CaseValue+')')    -- ' Word)'
                                    SET @Ret = REPLACE(@Ret, '('+@CaseValue+')', '('+@CaseValue+')')    -- '(Word)'
                                    SET @Ret = REPLACE(@Ret, ' '+@CaseValue+',', ' '+@CaseValue+',')    -- ' Word,'
                                END

                                -- get position of next word
                                SET @i = CHARINDEX(',', @CaseExceptions, @i+@CaseLen) +1
                        END

                -- remove any leading and trailing and duplicate spaces
                SET @Ret = LTRIM(RTRIM(@Ret));
                SET @Ret = REPLACE(@Ret,'  ',' ');

                -- capitalize first character if first word is...
                SET @Ret = case when left(@Ret,4) in ('The ')
                                  or left(@Ret,3) in ('Of ')
                                then upper(left(@Ret,1)) + right(@Ret,len(@Ret)-1)
                                else @Ret end

                -- if only contains one word, then capitalize first character of data irrespective of previous rules
                if ( len(@Ret) - len(replace(@Ret, ' ', '')) ) = 0  -- count number of spaces
                BEGIN
                    SET @Ret = UPPER(SUBSTRING(@Ret,1,1)) + SUBSTRING(@Ret,2,LEN(@Ret));
                END

        END
   ELSE
    BEGIN
                -- return the string unaffected if it is not in uppercase
                SET @Ret = @Text
        END

   RETURN nullif(@Ret,'')

END
GO
/****** Object:  UserDefinedFunction [dbo].[Quotes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- Quotes
--
-- Returns the input string surrounded by double quotes.
--				
-- Author:			Heath Glandon
-- Last Updated:	Jan 2020
--



CREATE function [dbo].[Quotes](@string varchar(max))

returns varchar(max)

BEGIN

    set @string = '"' + replace(@string,'"','""') + '"'

return @string

END




GO
/****** Object:  UserDefinedFunction [dbo].[RemoveNonASCII]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


-- Removes all non-ASCII characters
-- stolen from: https://sql-compass.blogspot.com/2017/06/sql-server-remove-non-printable.html

CREATE function [dbo].[RemoveNonASCII]
(
    @strIn as varchar(max)
)
returns varchar(max)
as
BEGIN

    declare @iPtr as int
    set @iPtr = patindex('%[^ -~0-9A-Z]%', @strIn COLLATE LATIN1_GENERAL_BIN)
    
    while @iPtr > 0
    BEGIN
        set @strIn = replace(@strIn COLLATE LATIN1_GENERAL_BIN, substring(@strIn, @iPtr, 1), '')
        set @iPtr = patindex('%[^ -~0-9A-Z]%', @strIn COLLATE LATIN1_GENERAL_BIN)
    END
  
    return @strIn

END

GO
/****** Object:  UserDefinedFunction [dbo].[SingleSpace]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- SingleSpace
--
-- Returns the input string without leading or trailing or duplicate spaces. NULL if empty string.
--				
-- Author:			Heath Glandon
-- Last Updated:	Jan 2020
--
-- Using a technique stolen from https://www.sqlservercentral.com/articles/replace-multiple-spaces-with-one
--
-- Consider the strings 'Fred fought five     fairies' (five spaces) and 'Steve sliced six      strawberries' (six spaces).
-- Using a character to represent the spaces will make these examples easier to follow.
--      Fred=fought=five=====fairies
--      Steve=sliced=six======strawberries
-- Step 1: Convert every double-space to a space followed by the unused CHAR(7) ASCII character (=7).
--      Fred=fought=five=7=7=fairies
--      Steve=sliced=six=7=7=7strawberries
-- Step 2: Convert each 7= to nothing. No matter how many spaces there were, this will always result in either = or =7.
--      Fred=fought=five=fairies
--      Steve=sliced=six=7strawberries
-- Step 3: Convert each remaining 7 to nothing.
--      Fred=fought=five=fairies
--      Steve=sliced=six=strawberries
--



CREATE function [dbo].[SingleSpace](@string varchar(max))

returns varchar(max)

BEGIN

    set @string = replace(
                        replace(
                              replace( ltrim(rtrim(@string)), '  ', ' '+char(7))    -- convert each double-space to =7
                        ,char(7)+' ', '')                                           -- convert each 7= to nothing
                  ,char(7),'')                                                      -- convert each remaining 7 to nothing

return nullif(@string,'')

END




GO
/****** Object:  UserDefinedFunction [dbo].[Split]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[Split]
(
      @ItemList VARCHAR(max), 
      @delimiter CHAR(1)
)
RETURNS @IDTable TABLE (Item VARCHAR(max))  
--DECLARE   @ItemList VARCHAR(max), @delimiter CHAR(1)
--DECLARE @IDTable TABLE (Item VARCHAR(50))  
--SELECT @ItemList='1,',@delimiter=','
AS      

BEGIN    
      DECLARE @tempItemList VARCHAR(max)
      SET @tempItemList = @ItemList

      DECLARE @i INT    
      DECLARE @Item VARCHAR(max)

--    SET @tempItemList = REPLACE (@tempItemList, ' ', '')
      SET @i = CHARINDEX(@delimiter, @tempItemList)

      IF LEN(@delimiter) <> 0
      BEGIN
            WHILE (LEN(@tempItemList) > 0)
            BEGIN
                  IF @i = 0
                        SET @Item = @tempItemList
                  ELSE
                        SET @Item = LEFT(@tempItemList, @i - 1)
                  INSERT INTO @IDTable(Item) VALUES(@Item)
                  IF @i = 0
                        SET @tempItemList = ''
                  ELSE
                        SET @tempItemList = RIGHT(@tempItemList, LEN(@tempItemList) - @i)
                  SET @i = CHARINDEX(@delimiter, @tempItemList)
            END 
            IF RIGHT(@ItemList,1)=@delimiter
                  INSERT INTO @IDTable(Item) VALUES('')
      END
      ELSE
      BEGIN
            WHILE LEN(@tempItemList) >= 2
            BEGIN

                  INSERT INTO @IDTable 
                  VALUES (RIGHT(@tempItemList, 2))

                  SET @tempItemList=LEFT(@tempItemList,LEN(@tempItemList)-2)

            END
      END
      RETURN
--    SELECT * FROM @IDTable
END  
GO
/****** Object:  UserDefinedFunction [dbo].[StrictAlpha]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


-- StrictAlpha
--
-- Returns an alpha only version of the input string by replacing unwanted characters with empty strings.
--
--		NOTES:	All special characters, numbers, and spaces are stripped out.
--				Only these characters are returned: a-z A-Z
--				
-- Author:			Heath Glandon
-- Last Updated:	Dec 2019
--
-- At least the following scripts are using:
--		JWB views
--



CREATE function [dbo].[StrictAlpha](@string varchar(max))

returns varchar(max)

BEGIN

	-- loop through string replacing each invalid character with an empty string
	while patindex('%[^a-z]%', @string) > 0
		set @string = stuff(@string, patindex('%[^a-z]%', @string), 1, '')


return @string

END




GO
/****** Object:  Table [dbo].[DS_Schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Schools](
	[active] [int] NULL,
	[syear] [int] NULL,
	[sch_id] [int] NOT NULL,
	[sch_state_id] [varchar](10) NULL,
	[sch_state_idx] [varchar](10) NULL,
	[school] [varchar](100) NULL,
	[initials] [varchar](20) NULL,
	[PCS_K12] [varchar](1) NULL,
	[region] [varchar](10) NULL,
	[region_long] [varchar](100) NULL,
	[choice_area] [varchar](10) NULL,
	[assign_type] [varchar](100) NULL,
	[category] [varchar](100) NULL,
	[SIS_type] [varchar](100) NULL,
	[title1] [varchar](10) NULL,
	[magnet] [varchar](10) NULL,
	[summer_school] [varchar](10) NULL,
	[school_level] [varchar](255) NULL,
	[level] [varchar](100) NULL,
	[valid_grades] [varchar](100) NULL,
	[grade_range] [varchar](50) NULL,
	[students] [int] NULL,
	[elem_area] [varchar](10) NULL,
	[mid_area] [varchar](10) NULL,
	[high_area] [varchar](10) NULL,
	[address] [varchar](100) NULL,
	[city] [varchar](100) NULL,
	[state] [varchar](2) NULL,
	[zipcode] [varchar](10) NULL,
	[area_code] [varchar](10) NULL,
	[phone] [varchar](10) NULL,
	[phone_full] [varchar](50) NULL,
	[principal] [varchar](100) NULL,
	[principal_email] [varchar](255) NULL,
	[dmt_username] [varchar](50) NULL,
	[dmt_phone_ext] [varchar](50) NULL,
	[dp_clerk_email] [varchar](100) NULL,
	[latitude] [numeric](18, 6) NULL,
	[longitude] [numeric](18, 6) NULL,
	[sch_nces_id] [varchar](20) NULL,
 CONSTRAINT [PK_DS_Schools] PRIMARY KEY CLUSTERED 
(
	[sch_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_Users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Users](
	[type] [nvarchar](50) NULL,
	[SSN] [nvarchar](50) NULL,
	[emp_id] [int] NOT NULL,
	[emp_local_id] [int] NULL,
	[emp_state_id] [nvarchar](50) NULL,
	[emp_username] [nvarchar](100) NOT NULL,
	[samAccountName] [nvarchar](100) NULL,
	[Account] [nvarchar](50) NULL,
	[last_name] [nvarchar](100) NULL,
	[first_name] [nvarchar](100) NULL,
	[middle_name] [nvarchar](100) NULL,
	[LAST] [nvarchar](100) NULL,
	[FIRST] [nvarchar](100) NULL,
	[email] [nvarchar](100) NULL,
	[email_AD] [nvarchar](100) NULL,
	[birthdate] [date] NULL,
	[age] [int] NULL,
	[gender] [nvarchar](10) NULL,
	[race] [nvarchar](10) NULL,
	[veteran_status] [nvarchar](10) NULL,
	[veteran] [nvarchar](10) NULL,
	[access_token] [nvarchar](4000) NULL,
	[job] [nvarchar](10) NULL,
	[fund] [nvarchar](10) NULL,
	[func] [nvarchar](10) NULL,
	[obj] [nvarchar](10) NULL,
	[proj] [nvarchar](10) NULL,
	[subproj] [nvarchar](10) NULL,
	[prog] [nvarchar](10) NULL,
	[pld] [nvarchar](10) NULL,
	[job_pos_num] [nvarchar](10) NULL,
	[location] [nvarchar](10) NULL,
	[location_name] [nvarchar](100) NULL,
	[costcenter] [nvarchar](10) NULL,
	[costcenter_name] [nvarchar](100) NULL,
	[statejobcode] [nvarchar](10) NULL,
	[pcsbjobcode] [nvarchar](10) NULL,
	[jobtitle] [nvarchar](100) NULL,
	[slot] [nvarchar](10) NULL,
	[fingerprinted] [date] NULL,
	[hiredate] [date] NULL,
	[contg_hiredate] [date] NULL,
	[contracttype] [nvarchar](10) NULL,
	[contracthours] [numeric](8, 2) NULL,
	[contractmonths] [numeric](8, 1) NULL,
	[pay_days] [int] NULL,
	[pay_type] [nvarchar](10) NULL,
	[pay_cycle] [nvarchar](10) NULL,
	[persstat] [nvarchar](10) NULL,
	[status] [nvarchar](10) NULL,
	[leave] [nvarchar](10) NULL,
	[EmpStatus] [nvarchar](50) NULL,
	[EmpStatusType] [nvarchar](50) NULL,
	[DROPend] [date] NULL,
	[bargaining_unit] [nvarchar](50) NULL,
	[sickbank_code] [nvarchar](1) NULL,
	[schools] [nvarchar](800) NULL,
	[instructional] [nvarchar](10) NULL,
	[students] [int] NULL,
	[probation] [nvarchar](10) NULL,
	[exp_pinellas] [tinyint] NULL,
	[exp_other] [tinyint] NULL,
	[exp_total] [tinyint] NULL,
	[reading_certification] [nvarchar](10) NULL,
	[grades] [nvarchar](50) NULL,
	[grades_list] [nvarchar](50) NULL,
	[address1] [nvarchar](100) NULL,
	[address2] [nvarchar](50) NULL,
	[city] [nvarchar](50) NULL,
	[state] [nvarchar](10) NULL,
	[zip] [nvarchar](20) NULL,
	[phone] [nvarchar](20) NULL,
	[User_SearchByName_calc] [nvarchar](255) NULL,
 CONSTRAINT [PK_DS_Users] PRIMARY KEY CLUSTERED 
(
	[emp_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[Profile_users_auto]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------------------
-- School Profile Users for Auto Import/Update
-----------------------------------------------------
CREATE view [dbo].[Profile_users_auto] as 

-- select * from Profile_users_auto
-----------------------------------------------------
-- School Administrators
-----------------------------------------------------

select 
	 u.emp_username
	,u.emp_local_id
	,s.sch_id
	,u.pcsbjobcode
	,u.jobtitle
	,1 as autoimport
	,'Admin' as importgroup
	,'School' as usergroup
-- select *	
-- select distinct pcsbjobcode	
from DS_Users as u
join DS_Schools as s on u.location = s.sch_state_id and left(s.school,2) not in ('z_','ss')
where u.jobtitle like '%prin%'
  and u.account = 'Active'
  and left(u.slot,1) = 'C'

-----------------------------------------------------
-- Social Workers and Attendance Specialists
-----------------------------------------------------

union all

-- Job Title = 2216 Social Worker and 6070 Attendance Specialist
-- The cost center is 5650, the PLD is 2566 for Social Workers and 5521 for Attendance Specialists.
select 
	 u.emp_username
	,u.emp_local_id
	,10000 as sch_id
	,u.pcsbjobcode
	,u.jobtitle
	,1 as autoimport
	,'SclWrkr' as importgroup
	,'District' as usergroup
from DS_Users as u
where u.pcsbjobcode in ('2216','6070')
  and u.costcenter = '5650'
  and u.account = 'Active'

-----------------------------------------------------
-- School Psychologists
-----------------------------------------------------

  union all

-- Job Title = 2215 Psychologist, 3200 Tchr Hrly Other and 8635 Mng Ofc Psychological Services
-- The cost center is 5390
select 
	 u.emp_username
	,u.emp_local_id
	,10000 as sch_id
	,u.pcsbjobcode
	,u.jobtitle
	,1 as autoimport
	,'Psyhc' as importgroup
	,'District' as usergroup
from DS_Users as u
where u.pcsbjobcode in ('2215','3200', '8635')
  and u.costcenter = '5390'
  and u.account = 'Active'

-----------------------------------------------------
-- Guidance Counselors
-----------------------------------------------------

  union all

-- Job Title = 2207 GUIDANCE COUNSELOR ELEM, 2208  GUIDANCE COUNSELOR MIDDLE, 2209 GUIDANCE COUNSELOR HIGH SCHOOL, 2210 GUIDANCE COUNSELOR OTHER, 2219  GUIDANCE COUNSELOR EXCEPT
select 
	 u.emp_username
	,u.emp_local_id
	,s.sch_id
	,u.pcsbjobcode
	,u.jobtitle
	,1 as autoimport
	,'Guidance' as importgroup
	,'School' as usergroup
from DS_Users as u
join DS_Schools as s on u.location = s.sch_state_id and left(s.school,2) not in ('z_','ss')
where u.pcsbjobcode in ('2207','2208','2209','2210','2219')
  and u.account = 'Active'

-----------------------------------------------------
-- Educational Diagnosticians
-----------------------------------------------------

union all

-- Job Title = 2206 Educational Diagnosticians
-- The cost center is 5450
select 
	 u.emp_username
	,u.emp_local_id
	,10000 as sch_id
	,u.pcsbjobcode
	,u.jobtitle
	,1 as autoimport
	,'EdDiag' as importgroup
	,'District' as usergroup
from DS_Users as u
where u.pcsbjobcode = '2206'
  and u.costcenter = '5450'
  and u.account = 'Active'
GO
/****** Object:  Table [dbo].[DS_Classes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Classes](
	[schedule_id] [numeric](18, 0) NOT NULL,
	[syear] [numeric](18, 0) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[sch_state_id] [varchar](4) NULL,
	[school] [varchar](100) NULL,
	[emp_id] [numeric](18, 0) NULL,
	[emp_local_id] [numeric](18, 0) NULL,
	[emp_username] [varchar](100) NULL,
	[emp_lastname] [varchar](100) NULL,
	[emp_firstname] [varchar](100) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[stu_local_id] [varchar](255) NULL,
	[stu_username] [varchar](100) NULL,
	[stu_lastname] [varchar](100) NULL,
	[stu_firstname] [varchar](100) NULL,
	[stu_grade] [varchar](2) NULL,
	[class_id] [numeric](18, 0) NULL,
	[course_id] [numeric](18, 0) NULL,
	[course_num_sch] [varchar](50) NULL,
	[course_num] [varchar](10) NULL,
	[course_weight] [varchar](50) NULL,
	[course_short] [varchar](100) NULL,
	[course] [varchar](100) NULL,
	[course_long] [varchar](265) NULL,
	[subject_area] [varchar](10) NULL,
	[subject_group] [varchar](100) NULL,
	[subject] [varchar](100) NULL,
	[marking_period_id] [numeric](18, 0) NULL,
	[active] [varchar](10) NULL,
	[term] [varchar](10) NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL,
	[stu_term] [varchar](10) NULL,
	[stu_start_date] [date] NULL,
	[stu_end_date] [date] NULL,
	[days] [varchar](7) NULL,
	[period] [varchar](10) NULL,
	[room] [varchar](10) NULL,
	[display_room] [varchar](20) NULL,
	[total_seats] [numeric](18, 0) NULL,
	[filled_seats] [numeric](18, 0) NULL,
	[avg_grade] [varchar](10) NULL,
	[ELL_model] [varchar](255) NULL,
	[read_interv] [varchar](255) NULL,
	[reading_certification] [varchar](10) NULL,
	[online_course] [varchar](10) NULL,
	[VAM_course] [varchar](1) NULL,
	[does_grades] [varchar](10) NULL,
	[emp2_id] [numeric](18, 0) NULL,
	[emp2_local_id] [numeric](18, 0) NULL,
	[emp2_username] [varchar](100) NULL,
	[emp3_id] [numeric](18, 0) NULL,
	[emp3_local_id] [numeric](18, 0) NULL,
	[emp3_username] [varchar](100) NULL,
	[emp4_id] [numeric](18, 0) NULL,
	[emp4_local_id] [numeric](18, 0) NULL,
	[emp4_username] [varchar](100) NULL,
	[emp5_id] [numeric](18, 0) NULL,
	[emp5_local_id] [numeric](18, 0) NULL,
	[emp5_username] [varchar](100) NULL,
	[emp6_id] [numeric](18, 0) NULL,
	[emp6_local_id] [numeric](18, 0) NULL,
	[emp6_username] [varchar](100) NULL,
	[emp7_id] [numeric](18, 0) NULL,
	[emp7_local_id] [numeric](18, 0) NULL,
	[emp7_username] [varchar](100) NULL,
	[emp8_id] [numeric](18, 0) NULL,
	[emp8_local_id] [numeric](18, 0) NULL,
	[emp8_username] [varchar](100) NULL,
	[gradebook_term] [varchar](10) NULL,
	[gradebook_grade] [numeric](18, 4) NULL,
	[alt_sch_id] [numeric](18, 0) NULL,
	[alt_sch_state_id] [varchar](4) NULL,
 CONSTRAINT [PK_DS_Classes] PRIMARY KEY CLUSTERED 
(
	[schedule_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Students](
	[active] [int] NULL,
	[last_syear] [int] NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[stu_local_id] [varchar](255) NULL,
	[stu_state_id] [varchar](50) NULL,
	[stu_username] [varchar](100) NULL,
	[samAccountName] [nvarchar](50) NULL,
	[Account] [nvarchar](50) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[sch_state_id] [varchar](4) NULL,
	[school] [varchar](100) NULL,
	[grade] [varchar](2) NULL,
	[grade_simple] [varchar](2) NULL,
	[last_first] [varchar](8000) NULL,
	[first_name] [varchar](255) NULL,
	[first_initial] [varchar](1) NULL,
	[last_name] [varchar](255) NULL,
	[middle_name] [varchar](8000) NULL,
	[suffix] [varchar](3) NULL,
	[rolling_ret] [int] NULL,
	[locker] [varchar](255) NULL,
	[gender] [varchar](max) NULL,
	[other_name] [varchar](255) NULL,
	[special_code] [varchar](max) NULL,
	[nickname] [varchar](8000) NULL,
	[pe_waiver] [varchar](255) NULL,
	[hmroom] [varchar](255) NULL,
	[hmroom_emp_id] [int] NULL,
	[hmroom_emp_name] [varchar](255) NULL,
	[advisor] [varchar](255) NULL,
	[counselor] [varchar](255) NULL,
	[internet_perm] [varchar](255) NULL,
	[media_release] [varchar](255) NULL,
	[groups] [varchar](max) NULL,
	[instructional_setting] [varchar](max) NULL,
	[alt_assessment] [varchar](max) NULL,
	[elig_504] [varchar](max) NULL,
	[qual_504] [varchar](max) NULL,
	[disabled] [varchar](max) NULL,
	[extra_curr_elig] [varchar](max) NULL,
	[grade_at_entry] [varchar](255) NULL,
	[lang_student] [varchar](max) NULL,
	[english_prof] [varchar](max) NULL,
	[lang_parent] [varchar](max) NULL,
	[birthdate] [date] NULL,
	[age] [int] NULL,
	[citizenship] [varchar](max) NULL,
	[migrant] [varchar](max) NULL,
	[homeless] [varchar](10) NULL,
	[foster] [varchar](10) NULL,
	[foster_type] [varchar](255) NULL,
	[military] [varchar](max) NULL,
	[directory_opt_out] [varchar](10) NULL,
	[college_military_info] [varchar](max) NULL,
	[enr_sch] [varchar](255) NULL,
	[enr_mulitple] [varchar](255) NULL,
	[email] [varchar](255) NULL,
	[sch_previous] [varchar](255) NULL,
	[sch_next] [varchar](255) NULL,
	[grd_next] [varchar](255) NULL,
	[retained] [varchar](10) NULL,
	[end_year_status] [varchar](max) NULL,
	[grd_prom_exmp] [varchar](max) NULL,
	[yr_grad] [varchar](max) NULL,
	[grad_date] [date] NULL,
	[planned_early_grad] [varchar](max) NULL,
	[pathway] [varchar](255) NULL,
	[gpa] [decimal](9, 4) NULL,
	[gpa_unwtd] [decimal](9, 4) NULL,
	[gpa_unwtd_prev_qtr] [decimal](9, 4) NULL,
	[class_rank] [int] NULL,
	[class_size] [int] NULL,
	[credits_earned] [decimal](9, 2) NULL,
	[rank_last_modified] [date] NULL,
	[l35_read] [varchar](255) NULL,
	[plcmt_read] [varchar](255) NULL,
	[plcmt_mth] [varchar](255) NULL,
	[read_fluency] [varchar](255) NULL,
	[year_entered] [varchar](max) NULL,
	[year_entered_us] [date] NULL,
	[l35_mth] [varchar](255) NULL,
	[math_rem] [varchar](max) NULL,
	[fdle_alert] [varchar](10) NULL,
	[team_flag1] [varchar](max) NULL,
	[team_flag2] [varchar](max) NULL,
	[application_program] [varchar](100) NULL,
	[summer_sch] [varchar](max) NULL,
	[shielded_student] [varchar](10) NULL,
	[eoc_credit_recovery] [varchar](max) NULL,
	[local_ethnic_code] [varchar](max) NULL,
	[ell_status] [varchar](max) NULL,
	[fte_elg2] [varchar](max) NULL,
	[test_acmdt] [varchar](max) NULL,
	[home_lang_survey_date] [date] NULL,
	[classification_date] [date] NULL,
	[entry_date] [date] NULL,
	[lep_basis_entry] [varchar](255) NULL,
	[stu_plan_date] [date] NULL,
	[ell_reeval_date] [date] NULL,
	[extension_instr] [varchar](255) NULL,
	[exit_date] [date] NULL,
	[lep_basis_exit] [varchar](255) NULL,
	[lep_basis_exit2] [varchar](255) NULL,
	[monitor_date1] [date] NULL,
	[monitor_date2] [date] NULL,
	[monitor_date3] [date] NULL,
	[monitor_date4] [date] NULL,
	[reclass_entry_date] [date] NULL,
	[reclass_exit_date] [date] NULL,
	[immigrant_stu] [varchar](255) NULL,
	[country_birth] [varchar](255) NULL,
	[ell_prog_participant] [varchar](255) NULL,
	[ell_tier] [varchar](255) NULL,
	[ft_sdc] [varchar](max) NULL,
	[pt_sdc1] [varchar](max) NULL,
	[pt_sdc2] [varchar](max) NULL,
	[pt_sdc3] [varchar](max) NULL,
	[case_manager] [varchar](255) NULL,
	[iep_date] [date] NULL,
	[iep_reevaldate] [date] NULL,
	[iep_resch] [varchar](255) NULL,
	[primary_exc] [varchar](255) NULL,
	[ese_totdis_minswkly] [numeric](18, 0) NULL,
	[ese_totnondis_minswkly] [numeric](18, 0) NULL,
	[ese_earlyint] [varchar](255) NULL,
	[ese_fefpcode] [varchar](max) NULL,
	[ese_extschyrsv] [varchar](max) NULL,
	[hearing_screening_date] [date] NULL,
	[hearing_screening_status] [varchar](max) NULL,
	[vision_screening_date] [date] NULL,
	[vision_screening_status] [varchar](max) NULL,
	[take_stock] [varchar](max) NULL,
	[race] [varchar](10) NULL,
	[race_long] [varchar](255) NULL,
	[group_hispanic] [varchar](max) NULL,
	[group_asian] [varchar](max) NULL,
	[group_native] [varchar](max) NULL,
	[group_pacific] [varchar](max) NULL,
	[group_black] [varchar](max) NULL,
	[group_white] [varchar](max) NULL,
	[ethnic_code] [varchar](max) NULL,
	[spec_rpt_ethnic_code] [varchar](10) NULL,
	[census_tract] [varchar](255) NULL,
	[res_status] [varchar](max) NULL,
	[alg_ese_eoc_waiver] [varchar](10) NULL,
	[alg_i_asmt_pass] [varchar](max) NULL,
	[biology_asmt_pass] [varchar](max) NULL,
	[geom_asmt_pass] [varchar](max) NULL,
	[us_hstry_asmt_pass] [varchar](max) NULL,
	[spc_student_id] [varchar](255) NULL,
	[assignment_code] [varchar](max) NULL,
	[zone_sch_elem] [varchar](255) NULL,
	[zone_sch_middle] [varchar](255) NULL,
	[zone_sch_high] [varchar](255) NULL,
	[zone_school] [varchar](255) NULL,
	[next_year_assign_code] [varchar](max) NULL,
	[equipment_code] [varchar](max) NULL,
	[iep_stop_location] [varchar](max) NULL,
	[elig_det_purp] [varchar](max) NULL,
	[impairment_code] [varchar](max) NULL,
	[intl_det_date] [date] NULL,
	[impaired_maj_lfe_act] [varchar](max) NULL,
	[rel_services] [varchar](max) NULL,
	[reeval_date] [date] NULL,
	[nxt_reeval_date] [date] NULL,
	[current_acmdt_plan_date] [date] NULL,
	[disc_acmdt_plan_date] [date] NULL,
	[temp_dis_exp] [date] NULL,
	[freereduced_meals] [varchar](max) NULL,
	[econ_dis] [varchar](10) NULL,
	[foodservicesPIN] [numeric](18, 0) NULL,
	[ssn] [varchar](255) NULL,
	[altid1] [varchar](300) NULL,
	[altid2] [varchar](300) NULL,
	[edal_choice] [varchar](max) NULL,
	[ceis] [varchar](max) NULL,
	[med_letter_physical] [date] NULL,
	[med_letter_speech] [date] NULL,
	[med_letter_psych] [date] NULL,
	[med_letter_nursing] [date] NULL,
	[med_letter_social] [date] NULL,
	[med_packet_signed] [date] NULL,
	[med_auth_ack] [varchar](50) NULL,
	[med_parent_auth] [varchar](10) NULL,
	[enr_date] [date] NULL,
	[enr_code] [varchar](100) NULL,
	[drop_date] [date] NULL,
	[drop_code] [varchar](100) NULL,
	[prior_district] [varchar](50) NULL,
	[prior_state] [varchar](50) NULL,
	[prior_country] [varchar](50) NULL,
	[disaster_affected_student] [varchar](50) NULL,
	[student_offender_transfer] [varchar](50) NULL,
	[calendar] [varchar](100) NULL,
	[am_route_id] [varchar](max) NULL,
	[am_run_id] [varchar](max) NULL,
	[am_stop_id] [varchar](max) NULL,
	[am_time] [varchar](max) NULL,
	[am_desc] [varchar](max) NULL,
	[am_dist_stop] [varchar](max) NULL,
	[am_dist_school] [varchar](max) NULL,
	[am_bus_num] [varchar](max) NULL,
	[am_bus_driver] [varchar](max) NULL,
	[pm_route_id] [varchar](max) NULL,
	[pm_run_id] [varchar](max) NULL,
	[pm_stop_id] [varchar](max) NULL,
	[pm_time] [varchar](max) NULL,
	[pm_desc] [varchar](max) NULL,
	[pm_dist_stop] [varchar](max) NULL,
	[pm_dist_school] [varchar](max) NULL,
	[pm_bus_num] [varchar](max) NULL,
	[pm_bus_driver] [varchar](max) NULL,
	[address] [varchar](255) NULL,
	[address_2] [varchar](255) NULL,
	[city] [varchar](60) NULL,
	[state] [varchar](50) NULL,
	[zip] [varchar](10) NULL,
	[home_phone] [varchar](30) NULL,
	[mail_address] [varchar](255) NULL,
	[mail_address_2] [varchar](255) NULL,
	[mail_city] [varchar](60) NULL,
	[mail_state] [varchar](50) NULL,
	[mail_zip] [varchar](10) NULL,
	[city_state] [varchar](72) NULL,
	[mail_city_state] [varchar](72) NULL,
	[cont1_type] [varchar](100) NULL,
	[cont1_cstdy] [varchar](1) NULL,
	[cont1_emer] [varchar](1) NULL,
	[cont1_last] [varchar](100) NULL,
	[cont1_first] [varchar](100) NULL,
	[cont1_email] [varchar](255) NULL,
	[cont1_address] [varchar](255) NULL,
	[cont1_address2] [varchar](255) NULL,
	[cont1_city] [varchar](60) NULL,
	[cont1_state] [varchar](10) NULL,
	[cont1_zip] [varchar](10) NULL,
	[cont1_home_phone] [varchar](30) NULL,
	[cont1_cell] [varchar](255) NULL,
	[cont1_work] [varchar](255) NULL,
	[cont2_type] [varchar](100) NULL,
	[cont2_cstdy] [varchar](1) NULL,
	[cont2_emer] [varchar](1) NULL,
	[cont2_last] [varchar](100) NULL,
	[cont2_first] [varchar](100) NULL,
	[cont2_email] [varchar](255) NULL,
	[cont2_address] [varchar](255) NULL,
	[cont2_address2] [varchar](255) NULL,
	[cont2_city] [varchar](60) NULL,
	[cont2_state] [varchar](10) NULL,
	[cont2_zip] [varchar](10) NULL,
	[cont2_home_phone] [varchar](30) NULL,
	[cont2_cell] [varchar](255) NULL,
	[cont2_work] [varchar](255) NULL,
	[cont3_type] [varchar](100) NULL,
	[cont3_cstdy] [varchar](1) NULL,
	[cont3_emer] [varchar](1) NULL,
	[cont3_last] [varchar](100) NULL,
	[cont3_first] [varchar](100) NULL,
	[cont3_email] [varchar](255) NULL,
	[cont3_address] [varchar](255) NULL,
	[cont3_address2] [varchar](255) NULL,
	[cont3_city] [varchar](60) NULL,
	[cont3_state] [varchar](10) NULL,
	[cont3_zip] [varchar](10) NULL,
	[cont3_home_phone] [varchar](30) NULL,
	[cont3_cell] [varchar](255) NULL,
	[cont3_work] [varchar](255) NULL,
	[resident_status] [varchar](255) NULL,
	[MyPCSOnline] [varchar](1) NULL,
 CONSTRAINT [PK_DS_Students] PRIMARY KEY CLUSTERED 
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  View [dbo].[Clever7381_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7381_schools
-- Only Pinellas Preparatory Academy students
-- 00:00:00
-----------------------
    create view [dbo].[Clever7381_schools]
    as
    select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
           'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
           'School_phone' as School_phone,
           'Low_grade' as Low_grade,
           'High_grade' as High_grade,
           'Principal' as Principal, 'Principal_email' as Principal_email
    UNION ALL

    select distinct sch_state_id as school_id, school, sch_state_id as state_id,
           address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
           replace(area_code+phone, '-', '') as phone,
           case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
           case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
           principal, principal_email
    from DS_Schools as h
    where sch_id = 273 


GO
/****** Object:  View [dbo].[Clever7381_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7381_students
-- 00:00:30
-----------------------
    create view [dbo].[Clever7381_students]
    as
    select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
           'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
           'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
           'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
           'Student_zip' as Student_zip, 'Student_email' as Student_email,
           'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
           'Username' as Username, 'Password' as Password

    UNION ALL

    select distinct
             ss.sch_state_id                        as School_id
            ,cast(stu.stu_id as varchar(30))        as Student_id
            ,stu.stu_local_id                       as Student_number
            ,stu.stu_state_id                       as State_id
            ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
            ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
            ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
            ,left(right(stu.GENDER,2),1)            as GENDER
            ,convert(varchar(10),stu.birthdate,101) as DOB
            ,stu.grade                              as Grade
            ,stu.race                               as Race
            ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
            ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
            ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
                  when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
            ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
            ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
            ,stu.stu_username + '@pcsb.org'         as Student_email
            ,'"'+Contact_relationship+'"'           as Contact_relationship
            ,'"'+Contact_type+'"'                   as Contact_type
            ,'"'+Contact_name+'"'                   as Contact_name
            ,'"'+Contact_phone+'"'                  as Contact_phone
            ,'"'+Contact_email+'"'                  as Contact_email
            ,stu.stu_username                       as Username
            ,'s.'+right(stu.stu_local_id,8)         as Password
    -- select count(*)
    from DS_Classes         as ss
    join Clever7381_schools as h   on ss.sch_state_id = h.School_id
    join DS_Students        as stu on ss.stu_id = stu.stu_id
    left join (
        select stu_id
              ,cont1_type                                                         as Contact_relationship
              ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                    when cont1_emer             = 'Y'  then 'Emergency'
                    when cont1_cstdy            = 'Y'  then 'Custody'
                                                       else 'Unknown' end               as Contact_type
              ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
              ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
              ,dbo.CleanEmail(cont1_email)       as Contact_email
        from DS_Students as s
        where s.cont1_type is not null
    ) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
    where stu.stu_username is not null


GO
/****** Object:  View [dbo].[radix_StudentSchedules]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
---------------------------------------------
-- StudentSchedules.csv
--
CREATE view [dbo].[radix_StudentSchedules]
as      
---------------------------------------------
select distinct
     c.sch_state_id                             as SchoolCode
    ,cast(c.stu_id as varchar(20))              as StudentId
    ,c.course_num                               as CourseCode
    ,cast(c.class_id as varchar(20))            as SectionCode
    ,c.term                                     as TermCode
    ,c.period                                   as BeginPeriod
    ,c.period                                   as EndPeriod
    ,cast(c.emp_local_id as varchar(20))        as StaffNumber
    ,c.days                                     as Days
    ,convert(varchar(20),c.stu_start_date,101)  as EnrollDate
    ,case when c.active = 'Y' then null else convert(varchar(20),c.stu_end_date,101) end    as DropDate
    ,convert(varchar(20),c.start_date,101)      as StartDate
    ,convert(varchar(20),c.end_date,101)        as EndDate
    ,cast(syear as varchar(20))                 as SchoolYear
-- select *
from DS_Classes as c
where c.sch_id = 415

UNION ALL select 'SchoolCode','StudentId','CourseCode','SectionCode','TermCode','BeginPeriod','EndPeriod','StaffNumber','Days','EnrollDate','DropDate','StartDate','EndDate','SchoolYear'


GO
/****** Object:  Table [dbo].[pmp_status]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[pmp_status](
	[syear] [int] NULL,
	[stu_id] [int] NULL,
	[syear_start] [date] NULL,
	[rdg_intervention] [nvarchar](50) NULL,
	[rdg_1] [nvarchar](50) NULL,
	[rdg_2] [nvarchar](50) NULL,
	[rdg_3] [nvarchar](50) NULL,
	[mth_1] [nvarchar](50) NULL,
	[mth_2] [nvarchar](50) NULL,
	[mth_3] [nvarchar](50) NULL,
	[sci_1] [nvarchar](50) NULL,
	[sci_2] [nvarchar](50) NULL,
	[sci_3] [nvarchar](50) NULL,
	[rdg_level_syear] [int] NULL,
	[rdg_level] [nvarchar](50) NULL,
	[mth_level_syear] [int] NULL,
	[mth_level] [nvarchar](50) NULL,
	[last_updated] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[reading_status]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[reading_status]
as

select
	 syear
	,stu_id				as student_id
	,rdg_1				as cycle1
	,rdg_2				as cycle2
	,rdg_3				as cycle3
	,rdg_level			as read_level
	,rdg_level_syear	as read_syear
	,last_updated		as last_updated

from pmp_status	as p
GO
/****** Object:  Table [dbo].[DS_Apps_Options]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Apps_Options](
	[option_id] [int] IDENTITY(1,1) NOT NULL,
	[last_modified] [datetime] NULL,
	[modified_by] [nvarchar](50) NULL,
	[app_id] [int] NULL,
	[type] [nvarchar](50) NULL,
	[i01] [int] NULL,
	[i02] [int] NULL,
	[v01] [nvarchar](500) NULL,
	[v02] [nvarchar](500) NULL,
	[v03] [nvarchar](500) NULL,
	[v04] [nvarchar](500) NULL,
	[v05] [nvarchar](500) NULL,
	[r01] [real] NULL,
	[r02] [real] NULL,
	[t01] [datetime] NULL,
 CONSTRAINT [PK_DS_Apps_Options] PRIMARY KEY CLUSTERED 
(
	[option_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[ReadWorks_Account]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- ReadWorks_Account
-- Account.csv
CREATE view [dbo].[ReadWorks_Account]
as
        -- teacher accounts
        select distinct
             '"'+case when c.emp_local_id is null then 'SIS'+cast(c.emp_id as varchar(100))
                      else cast(c.emp_local_id as varchar(100)) end +'"'                                                as id           -- use SIS+emp_id if account has no emp_local_id (mostly TBA)
            ,'"'+case when c.emp_firstname is null then cast(c.emp_id as varchar(100)) else c.emp_firstname end +'"'    as first_name   -- use emp_id if account has no emp_firstname (mostly TBA)
            ,'"'+c.emp_lastname+'"'      as last_name
            ,'"t"'                                      as type
            ,'"'+t.v01+'"'                              as school
            ,null                                       as subjects
            ,'"'+replace(grades_list, 'P', 'Pre-K')+'"' as grade_levels -- includes all sections not just ELA
            ,'"'+c.emp_username+'"'                     as username
        -- select c.*
        from DS_Classes         as c
        left join DS_Users      as u on c.emp_id = u.emp_id -- need to grab the teacher's grade levels from DS_Users
        join ( -- rank teachers' schools by most seats
                select emp_id, sch_id, s.v01, row_number() over (partition by emp_id order by count(*) desc) as seq
                from DS_Classes         as c
                join DS_Apps_Options    as s on s.app_id = 23 and s.type = 'Schools'and s.v01 is not null and c.sch_id = s.i01
                where c.stu_username is not null
                  and c.emp_id is not null
                  and c.course_long is not null
                group by emp_id, sch_id, v01
        ) as t on t.seq = 1 and c.emp_id = t.emp_id
        where c.stu_username is not null
          and c.emp_id is not null
          and c.course_long is not null
          and c.emp_username is not null


        --student accounts
        UNION ALL
        select distinct
             '"'+ stu_username  +'"'    as id
            ,'"'+ stu_firstname +'"'    as first_name
            ,'"'+ stu_lastname  +'"'    as last_name
            ,'"s"'                      as type
            ,null                       as school
            ,null                       as subjects
            ,null                       as grade_levels
            ,'"'+c.stu_username+'"'     as username
        from DS_Classes         as c
        join DS_Apps_Options    as s on s.app_id = 23 and s.type = 'Schools' and s.v01 is not null and c.sch_id = s.i01
        where c.stu_username is not null
          and c.emp_id is not null
          and c.course_long is not null
GO
/****** Object:  View [dbo].[ReadWorks_Classes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- ReadWorks_Classes
-- Classes.csv
CREATE view [dbo].[ReadWorks_Classes]
as
        select distinct
             '"'+cast(c.class_id as varchar(100)) +'"'                                              as id
            ,'"'+course_long +'"'                                                                   as name
            ,'"'+case when isnumeric(avg_grade)=1 then cast(cast(avg_grade as int) as varchar(10))
                      when avg_grade = 'PK' then 'Pre-K'
                      when avg_grade = 'KG' then 'K'
                      else avg_grade end +'"'                                                       as grade_level
            ,'"'+case when c.emp_local_id is null then 'SIS'+cast(c.emp_id as varchar(100))
                      else cast(c.emp_local_id as varchar(100)) end +'"'                            as owner_id
            ,'"'+nullif(string_agg(cast(c.stu_username as varchar(max)),','),'')+'"'				as roster

        from DS_Classes         as c
        join DS_Apps_Options    as s on s.app_id = 23 and s.type = 'Schools' and s.v01 is not null and c.sch_id = s.i01
        where c.stu_username is not null
          and c.emp_id is not null
          and c.course_long is not null
		group by c.class_id, c.course_long, c.avg_grade, c.emp_local_id, c.emp_id


GO
/****** Object:  View [dbo].[focus_student_schedule]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[focus_student_schedule]
as
select
         c.schedule_id
        ,c.syear
        ,c.sch_id           as school_id
        ,c.sch_state_id     as schoolnum
        ,c.stu_id           as student_id
        ,c.stu_local_id     as permnum
        ,c.stu_lastname     as lastname
        ,c.stu_firstname    as firstname
        ,s.grade          
        ,''                 as status
        ,c.term             as termcode
        ,c.class_id         as course_period_id
        ,c.marking_period_id
        ,c.ELL_model
        ,c.period
        ,c.course           as coursetitle
        ,c.course_num       as coursenum
        ,c.course_weight
        ,case when c.course_weight like '%C%' then 1 end as course_weight_C
        ,case when c.course_weight like '%X%' then 1 end as course_weight_X
		,c.subject_group
        ,c.room
        ,c.emp_id           as teacher_id
        ,c.emp_username     as username
        ,c.emp_lastname     as tch_lastname
        ,c.emp_firstname    as tch_firstname
		,c.reading_certification
        ,c.stu_start_date   as start_date
        ,c.stu_end_date     as end_date

from DS_Classes     as c
join DS_Students    as s on c.stu_id = s.stu_id




GO
/****** Object:  Table [dbo].[constants]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[constants](
	[relative_year] [int] NULL,
	[syear] [int] NOT NULL,
	[syear_long] [varchar](10) NULL,
	[grad_year] [int] NULL,
	[start_yr] [date] NULL,
	[end_yr] [date] NULL,
	[start_s1] [date] NULL,
	[lastday_s1] [date] NULL,
	[end_s1] [date] NULL,
	[start_s2] [date] NULL,
	[end_s2] [date] NULL,
	[start_mp1] [date] NULL,
	[lastday_mp1] [date] NULL,
	[end_mp1] [date] NULL,
	[start_mp2] [date] NULL,
	[lastday_mp2] [date] NULL,
	[end_mp2] [date] NULL,
	[start_mp3] [date] NULL,
	[lastday_mp3] [date] NULL,
	[end_mp3] [date] NULL,
	[start_mp4] [date] NULL,
	[end_mp4] [date] NULL,
	[start_ss] [date] NULL,
	[end_ss] [date] NULL,
	[days_yr] [int] NULL,
	[days_S1] [int] NULL,
	[days_S2] [int] NULL,
	[days_Q1] [int] NULL,
	[days_Q2] [int] NULL,
	[days_Q3] [int] NULL,
	[days_Q4] [int] NULL,
	[days_SS] [int] NULL,
	[days_m01] [int] NULL,
	[days_m02] [int] NULL,
	[days_m03] [int] NULL,
	[days_m04] [int] NULL,
	[days_m05] [int] NULL,
	[days_m06] [int] NULL,
	[days_m07] [int] NULL,
	[days_m08] [int] NULL,
	[days_m09] [int] NULL,
	[days_m10] [int] NULL,
	[days_m11] [int] NULL,
	[days_m12] [int] NULL,
	[school_days_elapsed] [int] NULL,
	[school_date] [date] NULL,
	[next_school_date] [date] NULL,
	[today] [date] NULL,
 CONSTRAINT [PK_constants] PRIMARY KEY CLUSTERED 
(
	[syear] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[focus_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE view [dbo].[focus_students]
as

select 
       s.stu_id                                         as student_id
      ,s.last_syear                                     as last_syear
      ,s.sch_id                                         as school_id
      ,s.sch_state_id                                   as statenum
      ,null                                             as schoolnum
      ,s.stu_local_id                                   as PERMNUM
      ,s.last_name                                      as LASTNAME
      ,s.first_name                                     as FIRSTNAME
      ,s.middle_name                                    as MIDDLENAME
      ,s.grade                                          as grade
      ,dbo.GetCodeFromBrackets(s.gender)                as GENDER
      ,s.local_ethnic_code                              as ETHNICCODE
      ,s.spec_rpt_ethnic_code                           as ETHNICCODE_black
      ,null                                             as ethnicity
      ,null                                             as race
      ,s.birthdate                                      as BIRTHDATE
      ,s.age                                            as age
      ,s.cont1_last+' '+s.cont1_first                   as PRNTGUARD
      ,null                                             as GRIDCODE
      ,s.zone_school                                    as zoned_school
      ,dbo.GetCodeFromBrackets(s.freereduced_meals)     as FREEMEALS
      ,s.counselor                                      as COUNSELOR
      ,s.hmroom_emp_id                                  as teacher_id
      ,s.hmroom_emp_name                                as abbrevname
      ,s.retained                                       as RETAIN
      ,s.gpa                                            as WTDCUMMGPA2
      ,dbo.GetCodeFromBrackets(s.instructional_setting) as INSTRSET
      ,s.sch_previous                                   as LASTSCHOOL
      ,s.summer_sch                                     as SUMMERSCHL
      ,s.sch_next                                       as NEXTSCHOOL
      ,h.sch_id                                         as NEXTsch_id
      ,s.grd_next                                       as NEXTGRADE
      ,dbo.GetCodeFromBrackets(s.alt_assessment)        as alt_assessment
      ,dbo.GetCodeFromBrackets(s.assignment_code)       as ASSIGNCODE
      ,dbo.GetCodeFromBrackets(s.end_year_status)       as endyrst
      ,s.ssn                                            as SOCSECNUM
      ,s.altid1                                         as ALTID1
      ,s.altid2                                         as ALTID2
      ,s.l35_read                                       as L35READ
      ,s.l35_mth                                        as L35MATH
      ,s.stu_username                                   as STULOGINID
      ,dbo.GetCodeFromBrackets(s.ell_status)            as LEP
      ,s.elig_504                                       as SEC504ELIG
      ,dbo.GetCodeFromBrackets(qual_504)                as SEC504QUAL
      ,dbo.GetCodeFromBrackets(s.ceis)                  as CEIS
      ,dbo.GetCodeFromBrackets(s.grd_prom_exmp)         as grprostgce
      ,left(s.primary_exc,1)                            as PRIEXC
      ,med_letter_physical
      ,med_letter_speech
      ,med_letter_psych
      ,med_letter_nursing
      ,med_letter_social
      ,s.mail_address                                   as address
      ,s.mail_city                                      as city
      ,s.mail_state                                     as state
      ,s.mail_zip                                       as zip
      ,s.home_phone                                     as phone
      ,s.address                                        as hm_address
      ,s.city                                           as hm_city
      ,s.state                                          as hm_state
      ,s.zip                                            as hm_zip
      ,s.case_manager                                   as CASEMGR
      ,s.year_entered_us
      ,s.enr_date                                       as start_date
      ,s.drop_date                                      as end_date
      ,case when s.active = 1       then ''
            else 'I'                end                 as status
      ,cont1_type
      ,cont1_first
      ,cont1_last
      ,cont1_cstdy
      ,cont1_emer
      ,cont1_email
      ,cont1_cell
      ,cont1_home_phone
      ,cont1_work
      ,cont1_address
      ,cont1_address2
      ,cont1_city
      ,cont1_state
      ,cont1_zip

from DS_Students        as s
join constants          as y on s.last_syear = y.syear and y.relative_year = 0
left join DS_Schools    as h on s.sch_next = h.sch_state_idx






GO
/****** Object:  View [dbo].[ppk]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[ppk]
AS
SELECT     s.permnum, s.school_id, s.schoolnum, s.lastname, s.firstname, d.grade, d.abbrevname, d.GENDER, d.ETHNICCODE, d.BIRTHDATE, d.FREEMEALS, 
                      d.PRNTGUARD, d.statenum, d.address, d.city, d.state, d.zip, d.phone, s.coursenum, s.course_weight, s.tch_lastname
FROM         dbo.focus_student_schedule AS s INNER JOIN
                      dbo.focus_students AS d ON s.permnum = d.PERMNUM
WHERE     (s.coursenum = '5100560') AND (s.course_weight = '0') AND (d.grade = 'pk') AND (s.schoolnum NOT IN ('707', '452', '977')) OR
                      (s.coursenum = '5100560') AND (s.course_weight = 'o')
GO
/****** Object:  Table [dbo].[SAM_Classes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SAM_Classes](
	[Course_number] [varchar](13) NULL,
	[Course_name] [varchar](102) NULL,
	[Class_name] [varchar](267) NULL,
	[Student_number] [varchar](30) NULL,
	[Stu_Username] [varchar](100) NULL,
	[Stu_Password] [varchar](10) NULL,
	[Stu_First_name] [varchar](257) NULL,
	[Stu_Middle_name] [varchar](8000) NULL,
	[Stu_Last_name] [varchar](257) NULL,
	[Stu_Grade] [varchar](50) NULL,
	[Teacher_number] [varchar](51) NULL,
	[Teacher_username] [nvarchar](100) NULL,
	[Teacher_email] [nvarchar](255) NULL,
	[Teacher_First_name] [nvarchar](100) NULL,
	[Teacher_Last_name] [nvarchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[SAM_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------------
CREATE view [dbo].[SAM_students]
as
-----------------------------------------------
select
         c.Stu_Username						as USER_NAME
        ,c.Stu_Password						as PASSWORD
        ,c.Student_number					as SIS_ID
        ,replace(c.Stu_First_name,'"','')	as FIRST_NAME
        ,null								as MIDDLE_NAME
        ,replace(c.Stu_Last_name,'"','')	as LAST_NAME
        ,c.Stu_Grade						as GRADE
        ,'MS Summer Bridge'					as SCHOOL_NAME
        ,replace(c.Class_name,'"','')		as CLASS_NAME
        ,null                   as LEXILE_SCORE
        ,null                   as LEXILE_MOD_DATE
        ,null                   as ETHNIC_CAUCASIAN
        ,null                   as ETHNIC_AFRICAN_AM
        ,null                   as ETHNIC_HISPANIC
        ,null                   as ETHNIC_PACIFIC_ISL
        ,null                   as ETHNIC_AM_IND_AK_NATIVE
        ,null                   as ETHNIC_ASIAN
        ,null                   as ETHNIC_TWO_OR_MORE_RACES
        ,null                   as GENDER_MALE
        ,null                   as GENDER_FEMALE
        ,null                   as AYP_ECON_DISADVANTAGED
        ,null                   as AYP_LTD_ENGLISH_PROFICIENCY
        ,null                   as AYP_GIFTED_TALENTED
        ,null                   as AYP_MIGRANT
        ,null                   as AYP_WITH_DISABILITIES
        ,null                   as EXTERNAL_ID
        ,null                   as LAST_COL
from SAM_Classes    as c

UNION ALL
select 'USER_NAME', 'PASSWORD', 'SIS_ID', 'FIRST_NAME', 'MIDDLE_NAME', 'LAST_NAME', 'GRADE', 'SCHOOL_NAME', 'CLASS_NAME', 'LEXILE_SCORE', 'LEXILE_MOD_DATE', 'ETHNIC_CAUCASIAN', 'ETHNIC_AFRICAN_AM', 'ETHNIC_HISPANIC', 'ETHNIC_PACIFIC_ISL', 'ETHNIC_AM_IND_AK_NATIVE', 'ETHNIC_ASIAN', 'ETHNIC_TWO_OR_MORE_RACES', 'GENDER_MALE', 'GENDER_FEMALE', 'AYP_ECON_DISADVANTAGED', 'AYP_LTD_ENGLISH_PROFICIENCY', 'AYP_GIFTED_TALENTED', 'AYP_MIGRANT', 'AYP_WITH_DISABILITIES', 'EXTERNAL_ID', 'LAST_COL'

GO
/****** Object:  View [dbo].[SAM_teachers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------------
CREATE view [dbo].[SAM_teachers]
as
-----------------------------------------------
select distinct
         c.teacher_number       as DISTRICT_USER_ID
        ,null                   as SPS_ID
        ,null                   as PREFIX
        ,c.Teacher_First_name   as FIRST_NAME
        ,c.Teacher_Last_name    as LAST_NAME
        ,null                   as TITLE
        ,null                   as SUFFIX
        ,c.Teacher_email        as EMAIL
        ,c.Teacher_username     as USER_NAME
        ,null                   as PASSWORD
        ,'MS Summer Bridge'		as SCHOOL_NAME
        ,replace(c.Class_name,'"','')           as CLASS_NAME
        ,null                   as EXTERNAL_ID
        ,null                   as LAST_COL
from SAM_Classes    as c

UNION ALL
select 'DISTRICT_USER_ID','SPS_ID','PREFIX', 'FIRST_NAME', 'LAST_NAME', 'TITLE', 'SUFFIX', 'EMAIL', 'USER_NAME', 'PASSWORD', 'SCHOOL_NAME', 'CLASS_NAME', 'EXTERNAL_ID', 'LAST_COL'
GO
/****** Object:  View [dbo].[school_admins]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- select * from school_admins
-- select distinct pk from school_admins

CREATE view [dbo].[school_admins]
as

select cast(o.option_id as varchar(20))+'.'+cast(u.emp_id as varchar(20))     as pk
      ,last_modified
      ,modified_by
      ,o.type
      ,'Manual'                     as type_display
      ,u.emp_id
      ,u.emp_local_id
      ,u.emp_username               as username
      ,u.first_name+' '+last_name   as name
      ,u.location
      ,u.location_name
      ,u.pcsbjobcode
      ,u.jobtitle
      ,v01                          as admin_schoolnum
      ,h.school                     as admin_school
      ,v02                          as admin_title
      ,v03                          as admin_role
-- select *
from DS_Apps_Options    as o
left join DS_Users           as u on o.i01 = u.emp_id
left join DS_Schools         as h on o.v01 = h.sch_state_id and h.summer_school = 'N'
where o.app_id = 11
  and o.type = 'School Admins Override'

UNION ALL

select cast(o.option_id as varchar(20))+'.'+cast(u.emp_id as varchar(20))     as pk
      ,last_modified
      ,modified_by
      ,o.type
      ,'Jobcode'                    as type_display
      ,u.emp_id
      ,u.emp_local_id
      ,u.emp_username               as username
      ,u.first_name+' '+last_name   as name
      ,u.location
      ,u.location_name
      ,u.pcsbjobcode
      ,u.jobtitle
      ,v01                          as admin_schoolnum
      ,h.school                     as admin_school
      ,v03                          as admin_title
      ,v04                          as admin_role
from DS_Apps_Options    as o
join DS_Users           as u on o.v01 = u.pcsbjobcode --and u.emp_id not in (select i01 from DS_Apps_Options where app_id = 11 and type = 'School Admins Override')
join DS_Schools         as h on u.location = h.sch_state_id and h.summer_school = 'N'
where o.app_id = 11
  and o.type = 'School Admins'


GO
/****** Object:  View [dbo].[Clever7281_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7281_schools
-- Only Pinellas Preparatory Academy students
-- 00:00:00
-----------------------
    create view [dbo].[Clever7281_schools]
    as
    select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
           'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
           'School_phone' as School_phone,
           'Low_grade' as Low_grade,
           'High_grade' as High_grade,
           'Principal' as Principal, 'Principal_email' as Principal_email
    UNION ALL

    select distinct sch_state_id as school_id, school, sch_state_id as state_id,
           address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
           replace(area_code+phone, '-', '') as phone,
           case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
           case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
           principal, principal_email
    from DS_Schools as h
    where sch_id = 272 


GO
/****** Object:  View [dbo].[Clever7281_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7281_students
-- 00:00:30
-----------------------
    create view [dbo].[Clever7281_students]
    as
    select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
           'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
           'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
           'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
           'Student_zip' as Student_zip, 'Student_email' as Student_email,
           'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
           'Username' as Username, 'Password' as Password

    UNION ALL

    select distinct
             ss.sch_state_id                        as School_id
            ,cast(stu.stu_id as varchar(30))        as Student_id
            ,stu.stu_local_id                       as Student_number
            ,stu.stu_state_id                       as State_id
            ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
            ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
            ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
            ,left(right(stu.GENDER,2),1)            as GENDER
            ,convert(varchar(10),stu.birthdate,101) as DOB
            ,stu.grade                              as Grade
            ,stu.race                               as Race
            ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
            ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
            ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
                  when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
            ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
            ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
            ,stu.stu_username + '@pcsb.org'         as Student_email
            ,'"'+Contact_relationship+'"'           as Contact_relationship
            ,'"'+Contact_type+'"'                   as Contact_type
            ,'"'+Contact_name+'"'                   as Contact_name
            ,'"'+Contact_phone+'"'                  as Contact_phone
            ,'"'+Contact_email+'"'                  as Contact_email
            ,stu.stu_username                       as Username
            ,'s.'+right(stu.stu_local_id,8)         as Password
    -- select count(*)
    from DS_Classes         as ss
    join Clever7281_schools as h   on ss.sch_state_id = h.School_id
    join DS_Students        as stu on ss.stu_id = stu.stu_id
    left join (
        select stu_id
              ,cont1_type                                                         as Contact_relationship
              ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                    when cont1_emer             = 'Y'  then 'Emergency'
                    when cont1_cstdy            = 'Y'  then 'Custody'
                                                       else 'Unknown' end               as Contact_type
              ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
              ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
              ,dbo.CleanEmail(cont1_email)       as Contact_email
        from DS_Students as s
        where s.cont1_type is not null
    ) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
    where stu.stu_username is not null

GO
/****** Object:  Table [dbo].[StudentTracker]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentTracker](
	[A_PD3] [varchar](3) NULL,
	[B_SSN] [varchar](50) NULL,
	[C_first_name] [varchar](1000) NULL,
	[D_middle_name] [varchar](1000) NULL,
	[E_last_name] [varchar](1000) NULL,
	[F_suffix] [varchar](1000) NULL,
	[G_previous_last] [varchar](50) NULL,
	[H_previous_first] [varchar](50) NULL,
	[I_date_of_birth] [varchar](8) NULL,
	[J_student_id] [varchar](50) NOT NULL,
	[K_diploma_type] [varchar](15) NULL,
	[L_grad_date] [varchar](8) NULL,
	[M_FERPA] [varchar](1) NULL,
	[N_school_name] [varchar](50) NULL,
	[O_ACT_code] [varchar](50) NULL,
	[P_gender] [varchar](8) NULL,
	[Q_ethnicity] [varchar](2) NULL,
	[R_econ_dis] [varchar](1) NULL,
	[S_gr8_math] [varchar](50) NULL,
	[T_gr8_ela] [varchar](50) NULL,
	[U_hs_math] [varchar](50) NULL,
	[V_hs_ela] [varchar](50) NULL,
	[W_ell] [varchar](1) NULL,
	[X_sem_math] [varchar](50) NULL,
	[Y_dual_enr] [varchar](1) NULL,
	[Z_disab] [varchar](1) NULL,
	[AA_program] [varchar](50) NULL,
	[AB_ED] [varchar](2) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[StudentTracker_Export]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- StudentTracker Export including the Leading and Trailing rows
CREATE view [dbo].[StudentTracker_Export]
as
-- Lead row, but does not match the number of columns in subsequent student info query
select
        'PH3'                               as A
       ,'10051150'                          as B
       ,'Pinellas County School District'   as C
       ,'P'                                 as D
       ,convert(varchar(8),getdate(),112)   as E
       ,(select cast(min(left(L_grad_date,4)) as varchar(8)) from StudentTracker) + '-' + (select cast(max(left(L_grad_date,4)) as varchar(8)) from StudentTracker) as F
       ,null G,null H,null I,null J,null K,null L,null M,null N,null O,null P,null Q,null R,null S,null T,null U,null V,null W,null X,null Y,null Z,null AA,null AB

-- Student Data
UNION ALL
select * from StudentTracker --where suffix like '%.%'


-- Trailing row
UNION ALL
select 'PT3', cast( (select count(*) from StudentTracker) + 2 as varchar(50))
      ,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null
GO
/****** Object:  View [dbo].[epk]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[epk]
AS
SELECT     s.permnum, s.school_id, s.schoolnum, s.lastname, s.firstname, d.grade, d.abbrevname, d.GENDER, d.ETHNICCODE, d.BIRTHDATE, d.FREEMEALS, 
                      d.PRNTGUARD, d.statenum, d.address, d.city, d.state, d.zip, d.phone, s.coursenum, s.course_weight, s.tch_lastname
FROM         dbo.focus_student_schedule AS s INNER JOIN
                      dbo.focus_students AS d ON s.permnum = d.PERMNUM
WHERE     (s.coursenum = '5100560') AND (s.course_weight IN ('PK', 'E'))
GO
/****** Object:  Table [dbo].[summer_bridge_letters]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[summer_bridge_letters](
	[file_id] [int] NULL,
	[file_name] [varchar](20) NULL,
	[stu_level] [varchar](20) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[stu_local_id] [varchar](50) NULL,
	[last_name] [varchar](100) NULL,
	[first_name] [varchar](100) NULL,
	[grade] [varchar](10) NULL,
	[ethnic_code] [varchar](10) NULL,
	[period_first_tch] [varchar](100) NULL,
	[period_first_section] [varchar](300) NULL,
	[period_last_tch] [varchar](100) NULL,
	[period_last_section] [varchar](300) NULL,
	[current_sch_id] [int] NULL,
	[current_school] [varchar](100) NULL,
	[zone_school] [varchar](100) NULL,
	[zone_elem] [varchar](100) NULL,
	[zone_mid] [varchar](100) NULL,
	[zone_high] [varchar](100) NULL,
	[summer_sch_id] [int] NULL,
	[summer_site] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[summer_bridge_file1]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- File/Letter 1
-- Elementary KG-04
--      select * from summer_bridge_file1
CREATE view [dbo].[summer_bridge_file1] as
select current_school       as [School Name]
      ,period_first_tch     as [Teacher Name]
      ,period_first_section as [Class Name]
      ,last_name            as [Last Name]
      ,first_name           as [First Name]
      ,stu_local_id         as [Student ID]
      ,grade                as [Current Grade]
      ,ethnic_code          as [Race]
      ,summer_site          as [Summer Bridge Site]
      ,zone_elem            as [Zoned Elem]
      ,zone_mid             as [Zoned Middle]
      ,zone_high            as [Zoned High]
from summer_bridge_letters as l
where l.file_id = 1
  and l.summer_site is not null
UNION ALL
select 'School Name', 'Teacher Name', 'Class Name', 'Last Name', 'First Name', 'Student ID', 'Current Grade', 'Race', 'Summer Bridge Site', 'Zoned Elem', 'Zoned Middle', 'Zoned High'
GO
/****** Object:  View [dbo].[summer_bridge_file2]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- File/Letter 2
-- Elementary 05
--      select * from summer_bridge_file2
CREATE view [dbo].[summer_bridge_file2] as
select current_school       as [School Name]
      ,period_first_tch     as [Teacher Name]
      ,period_first_section as [Class Name]
      ,last_name            as [Last Name]
      ,first_name           as [First Name]
      ,stu_local_id         as [Student ID]
      ,grade                as [Current Grade]
      ,ethnic_code          as [Race]
      ,summer_site          as [Summer Bridge Site]
      ,zone_elem            as [Zoned Elem]
      ,zone_mid             as [Zoned Middle]
      ,zone_high            as [Zoned High]
from summer_bridge_letters as l
where l.file_id = 2
  and l.summer_site is not null
UNION ALL
select 'School Name', 'Teacher Name', 'Class Name', 'Last Name', 'First Name', 'Student ID', 'Current Grade', 'Race', 'Summer Bridge Site', 'Zoned Elem', 'Zoned Middle', 'Zoned High'
GO
/****** Object:  View [dbo].[naviance_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[naviance_schools]
AS

select s.sch_state_id,school,school_level,grade_range
from DS_Schools as s
--join (select distinct sch_id from DS_Students where grade in ('06','07','08','09','10','11','12') and sch_state_id not in ('8034','8012','0521','7071','7021','7073','8028','8060','7051','7006','8006','8031') ) as g on s.sch_id = g.sch_id
join (select distinct sch_id from DS_Students where grade in ('06','07','08','09','10','11','12') and sch_state_id not in ('8034','8012','0521','7021','7073','7051','7006') ) as g on s.sch_id = g.sch_id
where left(category,1) not in ('W','Z','T') 
  and active = 1 
  and isnumeric(sch_state_idx) = 1
  --order by school

GO
/****** Object:  View [dbo].[summer_bridge_file3]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- File/Letter 3
-- Middle 06-07
--      select * from summer_bridge_file3
CREATE view [dbo].[summer_bridge_file3] as
select current_school       as [School Name]
      ,period_last_tch      as [Teacher Name]
      ,period_last_section  as [Class Name]
      ,last_name            as [Last Name]
      ,first_name           as [First Name]
      ,stu_local_id         as [Student ID]
      ,grade                as [Current Grade]
      ,ethnic_code          as [Race]
      ,summer_site          as [Summer Bridge Site]
      ,zone_mid             as [Zoned Middle]
      ,zone_high            as [Zoned High]
from summer_bridge_letters as l
where l.file_id = 3
  and l.summer_site is not null
UNION ALL
select 'School Name', 'Teacher Name', 'Class Name', 'Last Name', 'First Name', 'Student ID', 'Current Grade', 'Race', 'Summer Bridge Site', 'Zoned Middle', 'Zoned High'

GO
/****** Object:  Table [dbo].[Demographics_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Demographics_Students](
	[pk] [varchar](265) NULL,
	[active] [int] NULL,
	[syear] [numeric](18, 0) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[stu_local_id] [varchar](255) NULL,
	[stu_username] [varchar](100) NULL,
	[region] [varchar](10) NULL,
	[category] [varchar](50) NULL,
	[school_level] [varchar](50) NULL,
	[sch_id] [numeric](18, 0) NOT NULL,
	[sch_state_id] [varchar](10) NULL,
	[school] [varchar](100) NULL,
	[grade] [varchar](10) NULL,
	[enrollment_code] [varchar](100) NULL,
	[drop_code] [varchar](100) NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL,
	[Nth_date] [date] NULL,
	[enrToday] [int] NULL,
	[enrNth] [int] NULL,
	[enrQ1] [int] NULL,
	[enrQ2] [int] NULL,
	[enrQ3] [int] NULL,
	[enrQ4] [int] NULL,
	[enrS1] [int] NULL,
	[enrS2] [int] NULL,
	[enrYR] [int] NULL,
	[enr08] [int] NULL,
	[enr09] [int] NULL,
	[enr10] [int] NULL,
	[enr11] [int] NULL,
	[enr12] [int] NULL,
	[enr01] [int] NULL,
	[enr02] [int] NULL,
	[enr03] [int] NULL,
	[enr04] [int] NULL,
	[enr05] [int] NULL,
	[enr06] [int] NULL,
	[enr07] [int] NULL,
	[gPK] [int] NULL,
	[gKG] [int] NULL,
	[g01] [int] NULL,
	[g02] [int] NULL,
	[g03] [int] NULL,
	[g04] [int] NULL,
	[g05] [int] NULL,
	[g06] [int] NULL,
	[g07] [int] NULL,
	[g08] [int] NULL,
	[g09] [int] NULL,
	[g10] [int] NULL,
	[g11] [int] NULL,
	[g12] [int] NULL,
	[male] [int] NULL,
	[female] [int] NULL,
	[group_hispanic] [int] NULL,
	[group_native] [int] NULL,
	[group_asian] [int] NULL,
	[group_pacific] [int] NULL,
	[group_white] [int] NULL,
	[group_black] [int] NULL,
	[group_nonblack] [int] NULL,
	[local_multi] [int] NULL,
	[local_hispanic] [int] NULL,
	[local_native] [int] NULL,
	[local_asian] [int] NULL,
	[local_white] [int] NULL,
	[local_unknown] [int] NULL,
	[local_black] [int] NULL,
	[local_nonblack] [int] NULL,
	[econ_dis] [int] NULL,
	[ell] [int] NULL,
	[disabilities] [int] NULL,
	[migrant] [int] NULL,
	[homeless] [int] NULL,
	[foster] [int] NULL,
	[L1read] [int] NULL,
	[L2read] [int] NULL,
	[L12read] [int] NULL,
	[L1math] [int] NULL,
	[L2math] [int] NULL,
	[L12math] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[JWB_Schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------------------
-- JWB_Schools
-- 00:00:00
--      select * from DS_Schools order by school
--      select * from a0040sfocusm.focus_ss_1800.dbo.schools
--      select * from jwb_schools
CREATE view [dbo].[JWB_Schools]
as
----------------------------------------------------------------
select distinct
     cast(h.syear as varchar(4)) + '-' + cast(h.syear+1 as varchar(4)) as LastSchoolYear
    ,h.sch_state_id         as SchoolNum
    ,h.initials             as Abbrev
    ,h.school               as SchoolName
    ,h.school_level         as Level
    ,h.category             as Type
    ,h.region_long          as Area
    ,h.choice_area          as Choice_Area
    ,h.magnet               as Magnet
    ,h.area_code            as Area_Code
    ,h.phone                as Telephone
    ,h.address              as Address
    ,h.city                 as Address_City
    ,h.state                as Address_State
    ,h.zipcode              as Address_Zip
    ,h.valid_grades         as Valid_Grades
    ,cast(h.latitude  as varchar(20)) as Latitude
    ,cast(h.longitude as varchar(20)) as Longitude

    from Demographics_Students  as d
    join DS_Schools             as h on d.sch_id = h.sch_id and left(h.category,1) not in ('P','T','W','Z') -- Eliminate partnership, charter, adult, and other schools.
    where d.enrYR > 1
        and d.sch_state_id is not null


union all
select 'LastSchoolYear','SchoolNum','Abbrev','SchoolName','Level','Type','Area','Choice_Area','Magnet','Area_Code','Telephone','Address','Address_City','Address_State','Address_Zip','Valid_Grades','Latitude','Longitude'

GO
/****** Object:  View [dbo].[summer_bridge_file4]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- File/Letter 4
-- Middle 08
--      select * from summer_bridge_file4
CREATE view [dbo].[summer_bridge_file4] as
select current_school       as [School Name]
      ,period_last_tch      as [Teacher Name]
      ,period_last_section  as [Class Name]
      ,last_name            as [Last Name]
      ,first_name           as [First Name]
      ,stu_local_id         as [Student ID]
      ,grade                as [Current Grade]
      ,ethnic_code          as [Race]
      ,summer_site          as [Summer Bridge Site]
      ,zone_mid             as [Zoned Middle]
      ,zone_high            as [Zoned High]
from summer_bridge_letters as l
where l.file_id = 4
  and l.summer_site is not null
UNION ALL
select 'School Name', 'Teacher Name', 'Class Name', 'Last Name', 'First Name', 'Student ID', 'Current Grade', 'Race', 'Summer Bridge Site', 'Zoned Middle', 'Zoned High'

GO
/****** Object:  Table [dbo].[FAST_Assessments]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[FAST_Assessments](
	[assessment] [nvarchar](max) NULL,
	[assessment_code] [nvarchar](50) NULL,
	[assessment_grade] [nvarchar](255) NULL,
	[test_reason] [nvarchar](255) NULL,
	[assessment_window] [nvarchar](10) NULL,
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[sch_state_id] [nvarchar](4) NULL,
	[school] [nvarchar](100) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[stu_local_id] [nvarchar](255) NULL,
	[stu_state_id] [nvarchar](255) NULL,
	[last_name] [nvarchar](255) NULL,
	[first_name] [nvarchar](255) NULL,
	[birthdate] [date] NULL,
	[gender] [nvarchar](50) NULL,
	[ethnic_code] [nvarchar](50) NULL,
	[stu_grade] [nvarchar](10) NULL,
	[elig_504] [nvarchar](max) NULL,
	[primary_exc] [nvarchar](255) NULL,
	[ell_status] [nvarchar](max) NULL,
	[ell_prog_participant] [nvarchar](255) NULL,
	[test_oppnumber] [nvarchar](255) NULL,
	[lastest_test] [smallint] NULL,
	[date_started] [date] NULL,
	[date_completed] [date] NULL,
	[scale_score] [int] NULL,
	[achievement_level] [nvarchar](255) NULL,
	[level] [int] NULL,
	[percentile] [numeric](9, 2) NULL,
	[percentile_rank] [int] NULL,
	[source_date] [date] NULL,
	[last_updated] [datetime] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[JWB_Demographics]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[JWB_Demographics](
	[SchoolYear] [varchar](10) NULL,
	[syear] [varchar](5) NULL,
	[JWB_Program] [varchar](11) NULL,
	[ParticipantBusinessKeys] [nvarchar](max) NULL,
	[Matched_On] [nvarchar](100) NULL,
	[Stu_SIS_ID] [varchar](40) NULL,
	[Stu_Local_ID] [varchar](40) NULL,
	[Stu_State_ID] [varchar](40) NULL,
	[LastName] [varchar](255) NULL,
	[FirstName] [varchar](255) NULL,
	[MiddleName] [varchar](255) NULL,
	[BirthDate] [varchar](10) NULL,
	[GPA] [varchar](10) NULL,
	[Mail_Addr] [varchar](255) NULL,
	[Mail_City] [varchar](60) NULL,
	[Mail_State] [varchar](50) NULL,
	[Mail_ZipCode] [varchar](12) NULL,
	[Res_Addr] [varchar](255) NULL,
	[Res_City] [varchar](60) NULL,
	[Res_State] [varchar](50) NULL,
	[Res_ZipCode] [varchar](11) NULL,
	[Status] [varchar](8) NULL,
	[SchoolNum] [varchar](9) NULL,
	[SchoolName] [varchar](100) NULL,
	[GradeLevel] [varchar](10) NULL,
	[Gender] [varchar](max) NULL,
	[Local_Ethnic_Code] [varchar](max) NULL,
	[Hispanic] [varchar](max) NULL,
	[Native] [varchar](max) NULL,
	[Asian] [varchar](max) NULL,
	[Black] [varchar](max) NULL,
	[Pacific] [varchar](max) NULL,
	[White] [varchar](max) NULL,
	[EndYrSt] [varchar](max) NULL,
	[AssignCode] [varchar](max) NULL,
	[SpecCode] [varchar](max) NULL,
	[PRIEXC] [varchar](max) NULL,
	[LEP] [varchar](max) NULL,
	[HomelessUnaccomYouth] [varchar](max) NULL,
	[HomelessStudent] [varchar](max) NULL,
	[FreeReduced] [varchar](max) NULL,
	[U504_QUALCODE] [varchar](max) NULL,
	[EnterDate] [varchar](10) NULL,
	[LeaveDate] [varchar](10) NULL,
	[EnterCode] [varchar](100) NULL,
	[LeaveCode] [varchar](100) NULL,
	[L12math] [varchar](10) NULL,
	[L12read] [varchar](10) NULL,
	[AltAssessment] [varchar](max) NULL,
	[DiplomaType] [varchar](max) NULL,
	[GradPgrm] [varchar](max) NULL,
	[GradPathways] [varchar](max) NULL,
	[DualEnroll] [varchar](max) NULL,
	[MyPCSOnline] [varchar](12) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  View [dbo].[JWB_Measure_FAST]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------------------
-- JWB_Measure_FAST
-- 00:01:00
CREATE view [dbo].[JWB_Measure_FAST]
as
----------------------------------------------------------------
select
     cast(m.syear as varchar(4)) + '-' + cast(m.syear+1 as varchar(4)) as SchoolYear
    ,cast(m.syear as varchar(4)) as syear
    ,d.Stu_SIS_ID
    ,d.Stu_Local_ID
    ,d.Stu_State_ID
    ,d.LastName
    ,d.FirstName
    ,d.MiddleName
    ,d.BirthDate
    ,max(cast(m.assessment_grade as varchar(20)))    as GradeLevel
    ,m.sch_state_id             as SchoolNum
    ,h.SchoolName
    ,max(case when m.assessment_window = 'PM1' and m.assessment_code = 'FASTR' then cast(m.Scale_Score  as varchar(20)) end) as FAST_PM1_ELA_Scale_Score
    ,max(case when m.assessment_window = 'PM1' and m.assessment_code = 'FASTR' then cast(m.level        as varchar(20)) end) as FAST_PM1_ELA_Ach_Level
    ,max(case when m.assessment_window = 'PM1' and m.assessment_code = 'FASTM' then cast(m.Scale_Score  as varchar(20)) end) as FAST_PM1_Math_Scale_Score
    ,max(case when m.assessment_window = 'PM1' and m.assessment_code = 'FASTM' then cast(m.level        as varchar(20)) end) as FAST_PM1_Math_Ach_Level
    ,max(case when m.assessment_window = 'PM2' and m.assessment_code = 'FASTR' then cast(m.Scale_Score  as varchar(20)) end) as FAST_PM2_ELA_Scale_Score
    ,max(case when m.assessment_window = 'PM2' and m.assessment_code = 'FASTR' then cast(m.level        as varchar(20)) end) as FAST_PM2_ELA_Ach_Level
    ,max(case when m.assessment_window = 'PM2' and m.assessment_code = 'FASTM' then cast(m.Scale_Score  as varchar(20)) end) as FAST_PM2_Math_Scale_Score
    ,max(case when m.assessment_window = 'PM2' and m.assessment_code = 'FASTM' then cast(m.level        as varchar(20)) end) as FAST_PM2_Math_Ach_Level
    ,max(case when m.assessment_window = 'PM3' and m.assessment_code = 'FASTR' then cast(m.Scale_Score  as varchar(20)) end) as FAST_PM3_ELA_Scale_Score
    ,max(case when m.assessment_window = 'PM3' and m.assessment_code = 'FASTR' then cast(m.level        as varchar(20)) end) as FAST_PM3_ELA_Ach_Level
    ,max(case when m.assessment_window = 'PM3' and m.assessment_code = 'FASTM' then cast(m.Scale_Score  as varchar(20)) end) as FAST_PM3_Math_Scale_Score
    ,max(case when m.assessment_window = 'PM3' and m.assessment_code = 'FASTM' then cast(m.level        as varchar(20)) end) as FAST_PM3_Math_Ach_Level
    --select *
from JWB_Demographics   as d
join FAST_Assessments   as m on cast(d.stu_SIS_id as numeric(18,0)) = m.stu_id and d.Stu_Local_ID <> 'Stu_Local_ID'
join constants          as y on m.syear = y.syear and y.relative_year >= -3
join JWB_Schools        as h on m.sch_state_id = h.SchoolNum
where m.lastest_test = 1
group by m.syear, d.Stu_SIS_ID, d.Stu_Local_ID, d.Stu_State_ID, d.LastName, d.FirstName, d.MiddleName, d.BirthDate, m.sch_state_id, h.SchoolName

union all
select 'SchoolYear','syear','Stu_SIS_ID','Stu_Local_ID','Stu_State_ID','LastName','FirstName','MiddleName','BirthDate','GradeLevel','SchoolNum','SchoolName','FAST_PM1_ELA_Scale_Score','FAST_PM1_ELA_Ach_Level','FAST_PM1_Math_Scale_Score','FAST_PM1_Math_Ach_Level','FAST_PM2_ELA_Scale_Score','FAST_PM2_ELA_Ach_Level','FAST_PM2_Math_Scale_Score','FAST_PM2_Math_Ach_Level','FAST_PM3_ELA_Scale_Score','FAST_PM3_ELA_Ach_Level','FAST_PM3_Math_Scale_Score','FAST_PM3_Math_Ach_Level'
GO
/****** Object:  View [dbo].[Clever_charter_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever_charter_schools
-----------------------
CREATE view [dbo].[Clever_charter_schools]
as
select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
       'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
       'School_phone' as School_phone,
       'Low_grade' as Low_grade,
       'High_grade' as High_grade,
       'Principal' as Principal, 'Principal_email' as Principal_email
UNION ALL

select distinct sch_state_id as school_id, school, sch_state_id as state_id,
       address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
       replace(area_code+phone, '-', '') as phone,
       case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
       case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
       principal, principal_email
from DS_Schools as sch
join DS_Apps_Options as o on sch.sch_id = o.i01 and o.app_id = 2 and o.type = 'School' and o.v03 = 'Y'-- clever charter schools

UNION ALL

select '1' as School_id, 'Pinellas District Office' as School_name, '1' as State_id,
       '301 4th Street SW' as School_address, 'Largo' as School_city, 'FL' as School_state, '33770' as School_zip,
       null as School_phone,
       null as Low_grade,
       null as High_grade,
       null as Principal, null as Principal_email

GO
/****** Object:  View [dbo].[Clever_charter_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever_charter_students
-----------------------
CREATE view [dbo].[Clever_charter_students]
as
select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
       'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
       'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
       'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
       'Student_zip' as Student_zip, 'Student_email' as Student_email,
       'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
       'Username' as Username, 'Password' as Password

UNION ALL

select distinct
         cs.School_id                           as School_id
        ,stu.stu_local_id                       as Student_id
        ,cast(stu.stu_id as varchar(30))        as Student_number
        ,stu.stu_local_id                       as State_id
        ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
        ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
        ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
        ,left(right(stu.GENDER,2),1)            as GENDER
        ,convert(varchar(10),stu.birthdate,101) as DOB
        ,stu.grade                              as Grade
        ,stu.race                               as Race
        ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
        ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' end                            as Ell_status
        ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
              when right(stu.freereduced_meals,2) in ('3]')             then 'R' end                as Frl_status
        ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end      as Iep_status
        ,substring(stu.zip,1,5)+substring(stu.zip,7,4)                                              as Student_zip
        ,stu.stu_username + '@charter.pcsb.org' as Student_email
        ,'"'+Contact_relationship+'"'           as Contact_relationship
        ,'"'+Contact_type+'"'                   as Contact_type
        ,'"'+Contact_name+'"'                   as Contact_name
        ,'"'+Contact_phone+'"'                  as Contact_phone
        ,'"'+Contact_email+'"'                  as Contact_email
        ,stu.stu_username                       as Username
        ,'s.'+right(stu.stu_local_id,8)         as Password
-- select distinct stu.cont1_type
from DS_Classes      as c

--left join ( -- students and the school at which they were last marked 'present'
--        select
--             student_id
--            ,max(case when seq=1 then school_id end) as school_id
--        from (
--                select
--                        row_number() over (partition by ad.student_id order by ad.school_date desc) as seq
--                    ,ad.student_id
--                    ,mp.school_id
--                --select ad.syear, mp.school_id, ad.student_id, ad.school_date as date, state_value as present, daily_code as daycode, ad.comment
--                --select *
--                from A0040SFOCUSM.focus_ss_1800.dbo.attendance_day    as ad
--                join A0040SFOCUSM.focus_ss_1800.dbo.PCS_DstYear       as y  on ad.syear = y.dstyear
--                join A0040SFOCUSM.focus_ss_1800.dbo.vw_MarkingPeriods as mp on mp.marking_period_id=ad.marking_period_id
--                where ad.state_value = 1
--                    and y.todaysdate between mp.start_date and mp.end_date
--                    --and ad.student_id = 158149
--        ) as t
--        group by student_id
--) as pres on c.stu_id = pres.student_id

join DS_Students     as stu on c.stu_id = stu.stu_id --and stu.active = 1
------- regular school year -------
join DS_Apps_Options as o   on stu.sch_id = o.i01 and o.app_id = 2 and o.type = 'School' and o.v03 = 'Y'-- clever charter schools
join Clever_charter_schools  as cs  on o.v01 = cs.School_id
------- summer school term -------
--join DS_Apps_Options as o   on c.sch_id = o.i01 and o.type = 'Summer Bridge'
--join Clever_charter_schools  as cs  on o.v03 = cs.School_id
----------------------------------
left join (
    select stu_id
          ,cont1_type                                                         as Contact_relationship
          ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                when cont1_emer             = 'Y'  then 'Emergency'
                when cont1_cstdy            = 'Y'  then 'Custody'
                                                   else 'Unknown' end         as Contact_type
          ,cont1_first + ' ' + cont1_last                                     as Contact_name
          ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))               as Contact_phone
          ,case when ltrim(rtrim(cont1_email)) like '%_@%_.__%' 
                 and ltrim(rtrim(cont1_email)) not like '%[ ,]%' then ltrim(rtrim(cont1_email)) end       as Contact_email
    from DS_Students as s
    where s.sch_id = 22 -- Clearwater High
) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
where stu.stu_username is not null
GO
/****** Object:  Table [dbo].[KPI_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[KPI_Students](
	[sch_state_id] [varchar](4) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[school] [varchar](100) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[stu_local_id] [varchar](50) NULL,
	[last_first] [varchar](153) NULL,
	[birthdate] [date] NULL,
	[age] [int] NULL,
	[grade] [varchar](2) NULL,
	[local_ethnic_code] [varchar](1) NULL,
	[primary_exc] [varchar](255) NULL,
	[ell_status] [varchar](255) NULL,
	[gpa_unwtd] [decimal](9, 4) NULL,
	[rdg_status] [varchar](50) NULL,
	[mth_status] [varchar](50) NULL,
	[ela_level] [varchar](50) NULL,
	[mth_level] [varchar](50) NULL,
	[beh_iss] [int] NULL,
	[beh_oss] [int] NULL,
	[beh_ref] [int] NULL,
	[att_days] [int] NULL,
	[abs_exc] [int] NULL,
	[abs_unx] [int] NULL,
	[abs_all] [int] NULL,
	[abs_exc_per] [numeric](9, 3) NULL,
	[abs_unx_per] [numeric](9, 3) NULL,
	[abs_all_per] [numeric](9, 3) NULL,
	[tar_all] [int] NULL,
	[tar_all_per] [numeric](9, 3) NULL,
	[retained] [int] NULL,
	[expected_grade_by_age] [int] NULL,
	[grade_difference] [int] NULL,
	[F_rptcard] [int] NULL,
	[F_rptcard_lastyr] [int] NULL,
	[F_rptcard_all] [int] NULL,
	[F_gradebook] [int] NULL,
	[last_updated] [date] NULL,
 CONSTRAINT [PK_KPI_Students] PRIMARY KEY CLUSTERED 
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[ThinkCERCA_roster]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
------------------------------------------------
CREATE view [dbo].[ThinkCERCA_roster]
as
------------------------------------------------
        select distinct
               s.first_name                                                     as 'First Name'
              ,s.last_name                                                      as 'Last Name'
              ,s.stu_username+'@pcsb.org'                                       as 'Email'
              ,convert(varchar(10), HASHBYTES('SHA2_256',s.stu_username), 2)    as 'Password'
              ,case when s.grade in ('30','31') then 'Higher Ed'
                    else cast(cast(s.grade as int) as varchar(20)) end          as 'Enrolled Grade Level'
        from DS_Classes     as c
        join DS_Students    as s on c.stu_id = s.stu_id
        join KPI_Students   as k on c.stu_id = k.stu_id
        where s.local_ethnic_code = 'B'
          and s.grade in ('09','10')
          and s.year_entered in (2020,2021)
          and k.ela_level in (1,2)
          and c.sch_id in (15,22,45,59,56,73,97,107,61) -- Boca Ciega HS, Clearwater HS, Gibbs HS, Largo HS, Lakewood HS, Northeast HS, Pinellas Park HS, St. Pete HS

        UNION ALL select 'First Name', 'Last Name', 'Email', 'Password', 'Enrolled Grade Level'
GO
/****** Object:  View [dbo].[Clever7331_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7331_schools
-- Only Discovery Academy of Science students
-- 00:00:00
-----------------------
create view [dbo].[Clever7331_schools]
as
select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
       'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
       'School_phone' as School_phone,
       'Low_grade' as Low_grade,
       'High_grade' as High_grade,
       'Principal' as Principal, 'Principal_email' as Principal_email
UNION ALL

select distinct sch_state_id as school_id, school, sch_state_id as state_id,
       address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
       replace(area_code+phone, '-', '') as phone,
       case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
       case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
       principal, principal_email
from DS_Schools as h
where sch_id = 415 

GO
/****** Object:  View [dbo].[Townsend_Classes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Townsend_Classes
-- select * from Townsend_Classes
CREATE view [dbo].[Townsend_Classes]
as
select
     'school_id' as school_id
    ,'school' as school
    ,'tch_local_id' as tch_local_id
    ,'tch_username' as tch_username
    ,'tch_email' as tch_email
    ,'class_id' as class_id
    ,'course_num' as course_num
    ,'course_weight' as course_weight
    ,'course' as course
    ,'course_long' as course_long
    ,'term' as term
    ,'period' as period
    ,'start_date' as start_date
    ,'end_date' as end_date
UNION ALL
select distinct
       cast(sch_state_id as varchar(10))                        as school_id
      ,school                                                   as school
      ,isnull(cast(c.emp_local_id as varchar(20)),c.emp_username)   as tch_local_id
      ,c.emp_username                                             as tch_username
      ,isnull(u.email,c.emp_username+'@pcsb.org')                 as tch_email
      ,cast(class_id as varchar(50))                            as class_id
      ,course_num
      ,course_weight
      ,course
      ,course_long
      ,term
      ,period
      ,convert(varchar(20),start_date,101)                      as start_date
      ,convert(varchar(20),end_date,101)                        as end_date
-- select *
from DS_Classes         as c
join DS_Users           as u on c.emp_id = u.emp_id
where course_num = '1001405'
  and getdate() between c.stu_start_date and c.stu_end_date
GO
/****** Object:  View [dbo].[adobe_users_creative]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------
-- adobe_users_creative view
----------------------------------------------------
-- Groups are assigned based upon course_num from the DS_Apps_Options table
-- select * from adobe_users_creative

CREATE view [dbo].[adobe_users_creative]
as


-- Accounts based on courses specified in User Manager
--      select * from DS_Apps_Options as oc where oc.app_id = 21 and oc.type = 'Courses' and oc.i02 is null 

select
     firstname                              as [firstname]
    ,replace(lastname,',','.')              as [lastname]
    ,username+'@pcsb.org'                   as [email]
    ,'US'                                   as [country]
    ,'"'+left(groups,len(groups)-1)+'"'     as [groups]
    ,'FederatedID'                          as [type]
    ,username+'@pcsb.org'                   as [username]
    ,'pcsb.org'                             as [domain]
from (
        -- Teachers, 1:00
        select
             c.emp_username     as username
            ,c.emp_firstname    as firstname
            ,c.emp_lastname     as lastname
            ,  'Spark,' -- Everybody gets the Spark group
               +max(case when o.v03 = 'Art'         then 'Art,'         else '' end)
               +max(case when o.v03 = 'Business Ed' then 'Business Ed,' else '' end)
               +max(case when o.v03 = 'Tech Ed'     then 'Tech Ed,'     else '' end)
               +max(case when o.v03 = 'Other'       then 'Other,'       else '' end)
               as groups
        -- select *
        -- select distinct emp_username
        from DS_Classes         as c
        join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('T','W')
        join DS_Users           as u on c.emp_username = u.emp_username
        join constants          as y on y.relative_year = 0
                                    and (    y.school_date      between c.stu_start_date and c.stu_end_date
                                          or y.next_school_date between c.stu_start_date and c.stu_end_date   )
        join DS_Apps_Options    as o on o.app_id = 21 and o.type = 'Courses' and o.i02 is null and c.course_num = o.v01
                                    and case when o.i01 is null then 0 else h.sch_id end = case when o.i01 is null then 0 else o.i01 end -- if options table specifies a school, only include classes from that school
        where u.Account = 'Active'
        group by c.emp_username, c.emp_firstname, c.emp_lastname

        -- Students, 00:02
        UNION ALL
        select
             c.stu_username     as username
            ,c.stu_firstname    as firstname
            ,c.stu_lastname     as lastname
            ,  'Spark,' -- Everybody gets the Spark group
               +max(case when o.v03 = 'Art'         then 'Art,'         else '' end)
               +max(case when o.v03 = 'Business Ed' then 'Business Ed,' else '' end)
               +max(case when o.v03 = 'Tech Ed'     then 'Tech Ed,'     else '' end)
               +max(case when o.v03 = 'Other'       then 'Other,'       else '' end)
               as groups
        -- select *
        from DS_Classes         as c
        join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('T','W')
        join constants          as y on y.relative_year = 0
                                    and (    y.school_date      between c.stu_start_date and c.stu_end_date
                                          or y.next_school_date between c.stu_start_date and c.stu_end_date   )
        join DS_Apps_Options    as o on o.app_id = 21 and o.type = 'Courses' and o.i02 is null and c.course_num = o.v01
                                    and case when o.i01 is null then 0 else h.sch_id end = case when o.i01 is null then 0 else o.i01 end -- if options table specifies a school, only include classes from that school
        where c.stu_username is not null
        group by c.stu_username, c.stu_firstname, c.stu_lastname

) as t

-- Manually entered accounts
-- firstname,lastname,email,country,groups,type,username,domain
UNION ALL
select 'Heath','Glandon','glandonh@pcsb.org','US','"_org_admin"','FederatedID','glandonh@pcsb.org','pcsb.org'

GO
/****** Object:  View [dbo].[Townsend_Roster]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Townsend_Roster
-- select * from Townsend_Classes
CREATE view [dbo].[Townsend_Roster]
as
select
     'school_id' as school_id
    ,'school' as school
    ,'class_id' as class_id
    ,'course_long' as course_long
    ,'term' as term
    ,'stu_id' as stu_id
    ,'last_name' as last_name
    ,'first_name' as first_name
    ,'stu_username' as stu_username
    ,'stu_password' as stu_password
UNION ALL
select distinct
       cast(c.sch_state_id as varchar(10))                      as school_id
      ,c.school                                                 as school
      ,cast(class_id as varchar(50))                            as class_id
      ,course_long
      ,term
      ,cast(c.stu_id as varchar(20))                            as stu_id
      ,s.last_name
      ,s.first_name
      ,c.stu_username
      ,'s.'+right(s.stu_local_id,8)                             as stu_password
from DS_Classes         as c
join DS_Users           as u on c.emp_id = u.emp_id
join DS_Students        as s on c.stu_id = s.stu_id
where course_num = '1001405'
  and getdate() between c.stu_start_date and c.stu_end_date

GO
/****** Object:  View [dbo].[adobe_users_spark]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------
-- adobe_users_spark view
----------------------------------------------------
-- The Spark group is assigned to all users not already included in adobe_users_creative
CREATE view [dbo].[adobe_users_spark]
as

select 
     firstname                              as [firstname]
    ,replace(lastname,',','.')              as [lastname]
    ,username                               as [email]
    ,'US'                                   as [country]
    ,'"Spark"'                              as [groups]
    ,'FederatedID'                          as [type]
    ,username                               as [username]
    ,'pcsb.org'                             as [domain]
from (

        -- All Other Employees, 01:30
        select
             u.emp_username+'@pcsb.org'     as username
            ,u.first_name    as firstname
            ,u.last_name     as lastname
        from DS_Users           as u
        where u.type = 'Employee'
          and u.status = 'A'
          and u.Account = 'Active'
          and u.emp_username is not null
          and u.email not in (select email from adobe_users_creative)
        -- All Other Students, 00:00
        UNION ALL
        select distinct
             c.stu_username+'@pcsb.org' as username
            ,c.stu_firstname            as firstname
            ,c.stu_lastname             as lastname
        from (
                select distinct
                       stu_username, stu_firstname, stu_lastname, c.sch_id
                from DS_Classes         as c
                join constants          as y on y.relative_year = 0
                                            and (    y.school_date      between c.stu_start_date and c.stu_end_date
                                                  or y.next_school_date between c.stu_start_date and c.stu_end_date   )
                join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('P','T','W','Z')
        ) as c
        where c.stu_username is not null
          and c.stu_username+'@pcsb.org' not in (select email from adobe_users_creative)

) as t
GO
/****** Object:  View [dbo].[focus_users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[focus_users]
as
select
     null           as syear
    ,emp_id         as staff_id
    ,schools        as schools
    ,emp_username   as username
    ,first_name
    ,last_name
    ,FIRST
    ,LAST
    ,email
    ,costcenter
    ,costcenter_name
    ,location
    ,location_name
    ,job
    ,job_pos_num
    ,pcsbjobcode
    ,jobtitle       as title
    ,SSN
    ,status
    ,leave
    ,instructional
    ,students
    ,probation
    ,fingerprinted
	,reading_certification
    ,grades
    ,grades_list
    ,convert(datetime,birthdate)    as birthdate
    ,emp_local_id   as EmployeeID
    ,Account
    ,samAccountName
    ,gender
    ,race
from DS_Users   as u



GO
/****** Object:  View [dbo].[write_score_rdg]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[write_score_rdg]
as

select 'school' as school, 'grade' as grade, 'teacher' as teacher, 'email' as email,
       'period' as period, 'student' as student, 'studentid' as studentid, 'subject' as subject,
       'race' as race, 'gender' as gender, 'ell' as ell, 'migrant' as migrant, 'disabled' as disabled,
       'username' as username, 'password' as password

UNION ALL
select school, grade, teacher, email, period, student, studentid, subject, race, gender, ell, migrant, disabled, username, password
from (
        select row_number() over (partition by studentid order by ela desc, ese, course_num desc, email, period) as seq, *
        from (
            select c.school
                   ,case when left(s.grade,1) = '0' then right(s.grade,1)
                         else s.grade end                                       as grade
                   ,'"'+u.last_name+', '+u.first_name+'"'                       as teacher
                   ,u.email                                                     as email
                   ,left(c.period,2)                                            as period
                   ,'"'+s.last_first+'"'                                        as student
                   ,s.stu_local_id                                              as studentid
                   ,'"'+c.course+'"'                                            as subject
                   ,s.ethnic_code                                               as race
                   ,dbo.getcodefrombrackets(s.gender)                           as gender
                   ,case when right(s.ell_status,3) <> 'ZZ]' then dbo.GetCodeFromBrackets(s.ell_status) end     as ell
                   ,null                                                        as migrant
                   ,null                                                        as disabled
                   ,s.stu_local_id as Username, 's.'+right(s.stu_local_id,8)    as Password
                  ,u.title                                                      as title
                  ,case when left(c.course_num,2) = '10'   then 1
                        when left(c.course_num,4) = '5010' then 1
                        else 0 end                                              as ela
                  ,case when u.title like '%exce%' then 1
                        when u.title like '%emot%' then 1
                        when u.title like '%beha%' then 1 else 0 end            as ese
                  ,c.course_num                                                 as course_num

            -- select c.*
            -- select distinct permnum
            from DS_Classes     as c
            join DS_Students    as s   on c.stu_id = s.stu_id
            join focus_users    as u   on c.emp_id = u.staff_id
            where c.stu_username is not null -- only valid students
              and u.email is not null        -- only valid teachers
              and getdate() between c.start_date and c.end_date  -- only want active classes as of today
              and s.grade in ('05','06','07','08','09','10','11','12')
              and (
                        c.course_num in ('1004101','1004103','1002381')
                     or c.course_num+c.course_weight in ('1008350N','1008350T')
                  )
            --and c.stu_username = 'd8.gv'
        ) as t
) as w
where seq = 1
GO
/****** Object:  View [dbo].[Townsend_Teachers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Townsend_Teachers
-- select * from townsend_teachers
CREATE view [dbo].[Townsend_Teachers]
as
select
     'school_id' as school_id
    ,'school' as school
    ,'tch_local_id' as tch_local_id
    ,'tch_username' as tch_username
    ,'tch_email' as tch_email
    ,'last_name' as last_name
    ,'first_name' as first_name
UNION ALL
select distinct
       cast(sch_state_id as varchar(10))                        as school_id
      ,school                                                   as school
      ,isnull(cast(c.emp_local_id as varchar(20)),c.emp_username)   as tch_local_id
      ,c.emp_username                                             as tch_username
      ,isnull(u.email,c.emp_username+'@pcsb.org')                 as tch_email
      ,u.last_name
      ,u.first_name
from DS_Classes         as c
join DS_Users           as u on c.emp_id = u.emp_id
where course_num = '1001405'
  and getdate() between c.stu_start_date and c.stu_end_date
GO
/****** Object:  View [dbo].[adobe_users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------
-- adobe_users view
----------------------------------------------------
-- Combines header row with other two views
CREATE view [dbo].[adobe_users]
as

select 'firstname'as [firstname], 'lastname' as [lastname], 'email' as [email], 'country' as [country], 'groups' as [groups], 'type' as [type], 'username' as [username], 'domain' as [domain]

UNION ALL
select * from adobe_users_creative

UNION ALL
select * from adobe_users_spark
GO
/****** Object:  Table [dbo].[trans_sugar_case_numbers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[trans_sugar_case_numbers](
	[sugar_case_number] [numeric](9, 0) NOT NULL,
	[sharepoint_case_id] [numeric](9, 0) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[trans_sugar_cases]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[trans_sugar_cases](
	[deleted] [numeric](3, 0) NULL,
	[case_number] [numeric](9, 0) NULL,
	[priority] [varchar](25) NULL,
	[status] [varchar](25) NULL,
	[assigned_to] [varchar](60) NULL,
	[AssignedInvestigator] [varchar](255) NULL,
	[category_summary] [varchar](255) NULL,
	[description] [text] NULL,
	[resolution] [text] NULL,
	[modified_date] [smalldatetime] NULL,
	[modified_by] [varchar](60) NULL,
	[created_date] [smalldatetime] NULL,
	[created_by] [varchar](60) NULL,
	[id_c] [varchar](50) NULL,
	[case_category_c] [varchar](100) NULL,
	[case_subcategory1_c] [varchar](100) NULL,
	[case_subcategory2_c] [varchar](100) NULL,
	[case_subcategory3_c] [varchar](100) NULL,
	[student_grade_dd_c] [varchar](25) NULL,
	[am_home_to_stop_dist_c] [varchar](25) NULL,
	[home_to_school_dist_c] [varchar](25) NULL,
	[assigned_role_c] [varchar](50) NULL,
	[student_id_c] [varchar](25) NULL,
	[school_id_c] [varchar](25) NULL,
	[school_name_c] [varchar](100) NULL,
	[ftsvccd_c] [varchar](25) NULL,
	[equip_code_c] [varchar](25) NULL,
	[assign_code_c] [varchar](25) NULL,
	[pri_exc_c] [varchar](25) NULL,
	[dop_code_c] [varchar](25) NULL,
	[route_desc_c] [varchar](100) NULL,
	[am_stop_desc_c] [varchar](100) NULL,
	[am_driver_name_c] [varchar](50) NULL,
	[am_bus_num_c] [varchar](25) NULL,
	[am_run_num_c] [varchar](25) NULL,
	[am_stop_num_c] [varchar](25) NULL,
	[pm_stop_desc_c] [varchar](100) NULL,
	[pm_driver_name_c] [varchar](50) NULL,
	[pm_bus_num_c] [varchar](25) NULL,
	[pm_run_num_c] [varchar](25) NULL,
	[pm_stop_num_c] [varchar](25) NULL,
	[pm_home_to_stop_dist_c] [varchar](25) NULL,
	[reported_by_last_name_c] [varchar](25) NULL,
	[reported_by_first_name_c] [varchar](25) NULL,
	[reported_by_phone_c] [varchar](25) NULL,
	[reported_by_category_c] [varchar](100) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  View [dbo].[trans_sugar_cases_import]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

--USE [EDS]
--GO

--/****** Object:  View [dbo].[trans_sugar_cases_import]    Script Date: 7/14/2021 9:13:22 AM ******/
--SET ANSI_NULLS ON
--GO

--SET QUOTED_IDENTIFIER ON
--GO








----USE [EDS]
----GO

----/****** Object:  View [dbo].[trans_sugar_cases_import]    Script Date: 3/6/2020 11:54:12 AM ******/
----SET ANSI_NULLS ON
----GO

----SET QUOTED_IDENTIFIER ON
----GO



------USE [EDS]
------GO

------/****** Object:  View [dbo].[trans_sugar_cases_import]    Script Date: 10/1/2019 11:45:15 AM ******/
------SET ANSI_NULLS ON
------GO

------SET QUOTED_IDENTIFIER ON
------GO

----------------------------------------------------
CREATE view [dbo].[trans_sugar_cases_import]
as
------      select * from ds_students where stu_local_id in ('5208021282','5210010892','5211004752','5212012355','5216009323','5217010127','5218006525') select top 10 * from trans_sugar_cases where created_date > '2018-08-01'
 --select top 10 * from trans_sugar_cases_import
--------------------------------------------

select --top 2000
         c.case_number
		,x.sharepoint_case_id
        ,c.priority                 as Priority
        ,c.status                   as TaskStatus
        ,isnull(c.assigned_to, '')              as AssignedTo
        ,c.AssignedInvestigator
        ,c.category_summary
        ,c.description   --dbo.removeNonASCII(c.description) as description
        ,c.resolution
        ,c.modified_date
        ,c.modified_by
        ,YEAR(c.created_date) as Created_year
        ,c.created_date             as Created
        ,c.created_by               as [Created By]
        ,c.id_c                     as case_id
        ,c.case_category_c          as Category
        ,c.case_subcategory1_c      as Subcategory1
        ,c.case_subcategory2_c      as Subcategory2
        ,c.case_subcategory3_c      as Subcategory3
        ,c.student_grade_dd_c       as Grade
        ,c.am_home_to_stop_dist_c   as am_dist_stop
        ,c.home_to_school_dist_c    as am_dist_school
        ,isnull(c.assigned_role_c, 'Other')          as assigned_role
        ,case when assigned_role_c like '%FOS%' then 'FOS'
              when assigned_role_c like '%RSS%' then 'RSS'
              when assigned_role_c like '%RSA%' then 'RSA'
              when assigned_role_c like '%CSC%' then 'CSC'
              when assigned_role_c like '%Coordinator%' then 'Coord'
              else 'Other' end      as Investigator
        ,c.student_id_c             as stu_local_id
        ,left(ds.last_first, 255)   as Student
        ,c.school_id_c              as stu_costCenter
        ,c.school_name_c            as School
        ,c.ftsvccd_c                as ft_sdc
        ,c.equip_code_c             as equipment_code
        ,c.assign_code_c            as assignment_code
        ,c.pri_exc_c                as primary_exc
        ,c.dop_code_c               as dop_code
        ,isnull(case when route_desc_c <> '' then substring(route_desc_c,4,charindex(' -',route_desc_c,1)-4) end, '0000') as route_number
        ,c.route_desc_c             as route_desc
        ,c.am_stop_desc_c           as am_desc
        ,c.am_driver_name_c         as am_bus_driver
        ,c.am_bus_num_c             as am_bus_num
        ,c.am_run_num_c             as am_run_id
        ,c.am_stop_num_c            as am_stop_id
        ,c.pm_stop_desc_c           as pm_desc
        ,c.pm_driver_name_c         as pm_bus_driver
        ,c.pm_bus_num_c             as pm_bus_num
        ,c.pm_run_num_c             as pm_run_id
        ,c.pm_stop_num_c            as pm_stop_id
        ,c.pm_home_to_stop_dist_c   as pm_dist_home
        ,c.reported_by_last_name_c  as Citizen_Last
        ,c.reported_by_first_name_c as Citizen
        ,c.reported_by_phone_c      as ReportedByNumber
        ,c.reported_by_category_c   as ReportedBy

from trans_sugar_cases				as c
left join trans_sugar_case_numbers	as x on c.case_number = x.sugar_case_number
join DS_Students as ds on c.student_id_c = ds.stu_local_id
where deleted = 0
  and x.sharepoint_case_id is null -- Should only import cases into SharePoint if they do not already have a SharePoint id
  and created_date between '2020-06-14' and '2021-06-10'
  --and case_number = 16184
  --and c.student_id_c = '5213021059'
  --order by case_number asc
GO
/****** Object:  View [dbo].[career_cruising_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[career_cruising_schools] as

select 'SchoolCode' as SchoolCode, 'Name' as Name, 'SchoolType' as SchoolType
UNION ALL

select 
 sch_state_id  as SchoolCode
      ,school     as Name
      ,case when [level] = 'E' then '2'
            when [level] = 'M'     then '2'
            when [level] = 'H'       then '1'
            else '3' end as SchoolType
-- select *
from DS_Schools
where left(school_level,1) not in ('E','A')
and isnumeric(sch_state_idx) = 1
and left(category,1) not in ('T')
and active = 1
and sch_state_id not in (
						 '7006' -- Pinellas Virtual Part-time
						)

UNION ALL

select 
 sch_state_id  as SchoolCode
      ,school     as Name
      ,case when [level] = 'E' then '2'
            when [level] = 'M'     then '2'
            when [level] = 'H'       then '1'
            else '3' end as SchoolType
-- select *
from DS_Schools
where left(school_level,1) not in ('E','A')
and active = 1
and sch_state_id in (
					  '7191' -- St. Petersburg Collegiate High School
					)
GO
/****** Object:  Table [dbo].[trans_sugar_attachments]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[trans_sugar_attachments](
	[note_id] [uniqueidentifier] NULL,
	[import_date] [smalldatetime] NULL,
	[filedata] [varbinary](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[trans_sugar_notes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[trans_sugar_notes](
	[deleted] [numeric](3, 0) NULL,
	[case_number] [numeric](9, 0) NULL,
	[created_date] [smalldatetime] NULL,
	[created_by] [varchar](60) NULL,
	[student_name] [varchar](100) NULL,
	[subject] [varchar](255) NULL,
	[note] [text] NULL,
	[modified_date] [smalldatetime] NULL,
	[modified_by] [varchar](60) NULL,
	[note_id] [varchar](50) NULL,
	[filename] [varchar](255) NULL,
	[file_mime_type] [varchar](100) NULL,
	[file_url] [varchar](255) NULL,
	[parent_id] [varchar](50) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  View [dbo].[trans_sugar_notes_import]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO







--USE [EDS]
--GO

--/****** Object:  View [dbo].[trans_sugar_notes_import]    Script Date: 3/5/2020 1:08:25 PM ******/
--SET ANSI_NULLS ON
--GO

--SET QUOTED_IDENTIFIER ON
--GO

------------------------------------------------
CREATE view [dbo].[trans_sugar_notes_import]
as
----------------------------------------------------

select   n.case_number
		    ,x.sharepoint_case_id
        ,n.created_date
        ,n.created_by
        ,n.student_name
        ,n.subject
        ,cast(n.note as varchar(255)) as note
        ,n.modified_date
        ,n.modified_by
        ,n.note_id
        ,n.filename
        ,n.file_mime_type
        ,n.file_url
        --,a.filedata
        ,n.parent_id

from trans_sugar_notes				as n
left join trans_sugar_case_numbers	as x on n.case_number = x.sugar_case_number
left join trans_sugar_attachments   as a on n.note_id = a.note_id
where deleted = 0
  --and x.sharepoint_case_id is not null -- Only notes belonging to a case with a SharePoint id
  --and case_number in (select case_number from trans_sugar_cases_import)
and created_date between '2020-08-14' and '2021-06-10'
--and n.note_id like '9ddd88fb-ea8f-7ec1-ca30-5cf965a1226%'
--order by note_length desc
GO
/****** Object:  View [dbo].[applerouth_roster]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- applerouth_roster
-- 00:00:00
CREATE view [dbo].[applerouth_roster]
as
----------------------------------
    select distinct
         c.stu_firstname                        as 'First Name'
        ,c.stu_lastname                         as 'Last Name'
        ,c.stu_username+'@pcsb.org'             as 'Student Email'
        ,null                                   as 'Student ID'
        ,c.sch_state_id                         as 'School ID'
        ,cast(t1.emp_local_id as varchar(20))   as 'Teacher ID 1'
        ,cast(t2.emp_local_id as varchar(20))   as 'Teacher ID 2'
    from DS_Classes     as c
    join DS_Schools     as h on c.sch_state_id = h.sch_state_id and h.PCS_K12 = 'Y'
    left join DS_Users  as t1 on c.emp_id  = t1.emp_id
    left join DS_Users  as t2 on c.emp2_id = t2.emp_id

-- School year criteria
    --join DS_Schools     as h on c.sch_id = h.sch_id and h.PCS_K12 = 'Y'
    --join constants      as y on c.syear = y.syear and y.school_date between c.stu_start_date and c.stu_end_date
    --where 
    --      ( course_num = '1700370' and c.sch_id not in (59,107,134)                                         ) -- All schools except IB Schools
    --   or ( course_num = '1700370' and c.sch_id     in (59,107,134) and c.course_weight in ('0','SC','R')   ) -- Only specific sections at IB Schools
    --   or ( course_num = '8300310' and c.sch_id     in (97)         and c.course_weight in ('S')            ) -- Additional PPHS course

-- Summer criteria
    where term in ('RS','SS')
      and course_num in ('ELATREL','MTHTREL')
      --and course_short in ('97D','98D','99D')

    UNION ALL select 'First Name', 'Last Name', 'Student Email', 'Student ID', 'School ID', 'Teacher ID 1', 'Teacher ID 2'


GO
/****** Object:  View [dbo].[Transportation_Demographics]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[Transportation_Demographics]
as

select 
	 stu_local_id
	,stu_id
	,stu_username + '@pcsb.org'							as stu_email
	,s.sch_state_id
	,s.school
	,sch.principal
	,grade
	,last_first
	,race
	,age
	,gender
	,elig_504
	,primary_exc
	,am_route_id
	,am_bus_driver				
	,pm_route_id
	,pm_bus_driver
	,s.[address] + ' ' + s.city_state + ' ' + s.zip			as [address]
	,home_phone
	,case when cont1_cstdy = 'Y' then cont1_type end	as Contact_type
	,case when cont1_cstdy = 'Y' then cont1_last end	as Contact_last
	,case when cont1_cstdy = 'Y' then cont1_first end	as Contact_first
	,case when cont2_cstdy = 'Y' then cont2_type end	as Contact2_type
	,case when cont2_cstdy = 'Y' then cont2_last end	as Contact2_last
	,case when cont2_cstdy = 'Y' then cont2_first end	as Contact2_first
	-- select *
from DS_Students as s
join DS_Schools as sch on s.sch_state_id = sch_state_idx
where s.active = 1 or s.sch_state_id = 'PRE'
--and  cont3_cstdy is not null
--and grade in ('05', '06', '07', '09', '10')  
GO
/****** Object:  View [dbo].[applerouth_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- applerouth_schools
-- 00:00:00
CREATE view [dbo].[applerouth_schools]
as
----------------------------------
select distinct
     h.sch_state_id as 'School ID'
    ,h.school       as 'School Name'
from applerouth_roster  as r
join DS_Schools         as h on r.[School ID] = h.sch_state_idx

UNION ALL select 'School ID', 'School Name'

GO
/****** Object:  View [dbo].[Tutor_Logs_ELA_Alg]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create view [dbo].[Tutor_Logs_ELA_Alg]
as

select *
from (
select row_number() over (partition by concat(c.stu_id, course_num) order by c.stu_id) as dup
,concat(c.stu_id, course_num) as u_id
, c.syear, c.sch_id, c.sch_state_id, c.school, course_num, local_ethnic_code, gender, grade,c.stu_id
,last_first, subject_group, subject_area
--select *
from DS_Classes as c
left join DS_Students  as s on c.stu_id = s.stu_id
where local_ethnic_code = 'b'
and course_num in ('1200320', '1209810', '1200310', '1200386', '1000412', '1000414')
and stu_grade in ('09', '10')
) as t
where dup = 1
GO
/****** Object:  View [dbo].[applerouth_teachers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- applerouth_teachers
-- 00:00:00
CREATE view [dbo].[applerouth_teachers]
as
----------------------------------
select distinct
     u.first_name               as 'First Name'
    ,u.last_name                as 'Last Name'
    ,u.emp_username+'@pcsb.org' as 'Teacher Email'
    ,cast(u.emp_local_id as varchar(20))    as 'Teacher ID'
from DS_Users  as u
where u.emp_local_id in (
                      select cast([Teacher ID 1] as int) from applerouth_roster where ISNUMERIC([Teacher ID 1])=1
            union all select cast([Teacher ID 2] as int) from applerouth_roster where ISNUMERIC([Teacher ID 2])=1
      )
  and u.emp_local_id is not null

UNION ALL select 'First Name', 'Last Name', 'Teacher Email', 'Teacher ID'
GO
/****** Object:  View [dbo].[vpk]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*USE EDS
SELECT *
FROM ACLS8D21*/
CREATE VIEW [dbo].[vpk]
AS
SELECT        s.sch_id, s.school, s.stu_local_id, s.stu_lastname, s.stu_firstname, s.avg_grade, s.emp_firstname, s.emp_lastname, d.gender, d.ethnic_code, d.birthdate, d.freereduced_meals, d.cont1_first, d.cont1_last, 
                         d.address, d.city, d.state, d.zip
FROM            dbo.DS_Classes AS s INNER JOIN
                         dbo.DS_Students AS d ON s.stu_local_id = d.stu_local_id
WHERE        (s.avg_grade = 'PK') AND (s.course_num_sch = '5100560F')
GO
/****** Object:  View [dbo].[fm_servers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--------------------------------------------------------------
-- fm_servers
--      select distinct server_name from logins order by server_name
--------------------------------------------------------------
CREATE view [dbo].[fm_servers]
as
    -- EDS
              select 'Data Services (EDS)'              as server_name, 'EDS'       as title,  55   as cxn_limit
    union all select 'A0040SDS'                         as server_name, 'EDS'       as title,  55   as cxn_limit
    union all select 'PCSB FileMaker Server 17 (FM2)'   as server_name, 'EDS'       as title,  55   as cxn_limit
    union all select 'PCSB FileMaker Server 18 (FM2)'   as server_name, 'EDS'       as title,  55   as cxn_limit
    union all select 'PCSB FileMaker Server 19 (FM2)'   as server_name, 'EDS'       as title,  55   as cxn_limit
	union all select 'A0040SFM2'                        as server_name, 'EDS'       as title,  55	as cxn_limit
	union all select 'A0040SFM2X'                       as server_name, 'EDS'       as title,  55	as cxn_limit

    
    -- FM
    union all select 'PCSB FileMaker Server 16 (FM1)'   as server_name, 'FM'        as title, 250   as cxn_limit
    union all select 'PCSB FileMaker Server 16 (FM2)'   as server_name, 'FM'        as title, 250   as cxn_limit
    union all select 'PCSB FileMaker Server 17 (FM1)'   as server_name, 'FM'        as title, 250   as cxn_limit
    union all select 'PCSB FileMaker Server 18 (FM1)'   as server_name, 'FM'        as title, 250   as cxn_limit
    union all select 'PCSB FileMaker Server 19 (FM1)'   as server_name, 'FM'        as title, 250   as cxn_limit
    union all select 'A0040SFM1'                        as server_name, 'FM'        as title, 250   as cxn_limit
	union all select 'A0040SFM1X'                       as server_name, 'FM'        as title, 250   as cxn_limit
    
    -- ARTS
    union all select 'A0040SARTS'                       as server_name, 'ARTS'      as title,  25   as cxn_limit
    
    -- TITLE 1
    union all select 'A0060STITLE1PS'                   as server_name, 'TITLE 1'   as title,  25   as cxn_limit
    union all select 'A0060STITLE1PS (title1.pcsb.org)' as server_name, 'TITLE 1'   as title,  25   as cxn_limit


GO
/****** Object:  Table [dbo].[logins]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[logins](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[syear] [numeric](9, 0) NULL,
	[server_name] [nvarchar](50) NULL,
	[server_ip] [nvarchar](50) NULL,
	[filename] [nvarchar](50) NULL,
	[time] [datetime] NULL,
	[username] [nvarchar](50) NULL,
	[accountname] [nvarchar](50) NULL,
	[accountgroup] [nvarchar](150) NULL,
	[privilege_set] [nvarchar](50) NULL,
	[fmpver] [nvarchar](50) NULL,
	[fmparch] [nvarchar](50) NULL,
	[ip] [nvarchar](50) NULL,
	[os] [nvarchar](50) NULL,
	[osver] [nvarchar](50) NULL,
	[screensize] [nvarchar](50) NULL,
	[v01] [nvarchar](150) NULL,
	[v02] [nvarchar](150) NULL,
	[v03] [nvarchar](150) NULL,
	[v04] [nvarchar](150) NULL,
 CONSTRAINT [PK_logins] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[fm_log_files]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--------------------------------------------------------------
-- fm_log_files

-- select * from logins where time >= '2019-04-10 14:28:09.000' and v01 is null
-- select distinct fmparch from logins
-- select distinct filename from logins where filename not in (select filename from logins where v01 is not null)
--------------------------------------------------------------

CREATE view [dbo].[fm_log_files]
as

select
     l.syear
    ,s.title as server
    ,max(l.server_name) as server_name
    ,l.filename
    ,max(l.time)    as last_login
    ,count(distinct accountname) as users
    ,count(distinct case when time >= convert(date, getdate()) then accountname end) as users_today
    ,count(*) as logins
    ,count(distinct convert(date, l.time))                                                            as days
    ,cast( cast(count(*) as real) / nullif(count(distinct convert(date, l.time)), 0) as numeric(8,0)) as logins_perday
    ,count(case when time >= convert(date, getdate()) then 1 end) as logins_today
    ,count(case when datepart(month,l.time)=  8 then 1 end) as logins_m08
    ,count(case when datepart(month,l.time)=  9 then 1 end) as logins_m09
    ,count(case when datepart(month,l.time)= 10 then 1 end) as logins_m10
    ,count(case when datepart(month,l.time)= 11 then 1 end) as logins_m11
    ,count(case when datepart(month,l.time)= 12 then 1 end) as logins_m12
    ,count(case when datepart(month,l.time)=  1 then 1 end) as logins_m01
    ,count(case when datepart(month,l.time)=  2 then 1 end) as logins_m02
    ,count(case when datepart(month,l.time)=  3 then 1 end) as logins_m03
    ,count(case when datepart(month,l.time)=  4 then 1 end) as logins_m04
    ,count(case when datepart(month,l.time)=  5 then 1 end) as logins_m05
    ,count(case when datepart(month,l.time)=  6 then 1 end) as logins_m06
    ,count(case when datepart(month,l.time)=  7 then 1 end) as logins_m07
    ,cast( cast(count(case when os in ('Win','-2') then 1 end) as real) / count(*) as numeric(8,3))  as win
    ,cast( cast(count(case when os in ('Mac', '1') then 1 end) as real) / count(*) as numeric(8,3))  as mac
    ,cast( cast(count(case when os in ('iOS', '3') then 1 end) as real) / count(*) as numeric(8,3))  as ios
    ,cast( cast(count(case when os in ('Web', '4') then 1 end) as real) / count(*) as numeric(8,3))  as web
    ,cast( cast(count(case when fmpver  like '%15.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp15
    ,cast( cast(count(case when fmpver  like '%16.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp16
    ,cast( cast(count(case when fmpver  like '%17.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp17
    ,cast( cast(count(case when fmpver  like '%18.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp18
    ,cast( cast(count(case when fmpver  like '%19.%'  then 1 end) as real) / count(*) as numeric(8,3))  as fmp19
    ,cast( cast(count(case when fmparch = 'i386'   then 1 end) as real) / count(*) as numeric(8,3))  as fmp_32b
    ,cast( cast(count(case when fmparch = 'x86_64' then 1 end) as real) / count(*) as numeric(8,3))  as fmp_64b
from logins             as l
left join fm_servers    as s on l.server_name = s.server_name
where syear is not null
group by l.syear, s.title, l.filename
;
GO
/****** Object:  View [dbo].[vw_destiny_sections]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[vw_destiny_sections]
as

select distinct top 100 percent
     '"'+cast(c.sch_state_id as varchar(100))+'"'				as [Site ID]
    ,'"'+course+'"'                                             as [Class name]
    ,'"'+cast(course_num as varchar(100))+'"'                   as [Catalog designation]
    ,'"'+cast(class_id as varchar(100))+'"'                     as [Section ID]
    ,'"'+emp_username+'"'                                       as [Teacher number]
    ,'"'+cast(cast(left(period,2) as int) as varchar(100))+'"'  as [Period]
    ,'"'+stu_local_id+'"'										as [Student number]
    ,'"'+isnull(subject_group,subject)+'"'						as [Department]
    ,replace('"'+case when charindex('M',days)>0 then ',M'  else '' end
                +case when charindex('T',days)>0 then ',TU' else '' end
                +case when charindex('W',days)>0 then ',W'  else '' end
                +case when charindex('H',days)>0 then ',TH' else '' end
                +case when charindex('F',days)>0 then ',F'  else '' end
                +case when charindex('S',days)>0 then ',Sa' else '' end
         +'"','",','"')                                         as [Meets]
    ,'"'+convert(varchar(20),start_date,101)+'"'                as [Starts]
    ,'"'+convert(varchar(20),end_date,  101)+'"'                as [Ends]

-- select top 100 *
from DS_Classes     as c
join DS_Schools     as h on c.sch_id = h.sch_id and h.active = 1 and isnumeric(h.sch_state_idx) = 1
                        and left(h.category,1) in ('A','C','D','E','F','J')
where isnumeric(left(period,2))=1
order by [Site ID], [Class name], [Catalog designation]

GO
/****** Object:  Table [dbo].[DS_Enrollment]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Enrollment](
	[id] [numeric](18, 0) NOT NULL,
	[active] [int] NULL,
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[school] [varchar](100) NULL,
	[stu_id] [int] NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](10) NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL,
	[enrollment_code] [varchar](100) NULL,
	[drop_code] [varchar](100) NULL,
	[enrolled] [int] NULL,
	[days_present] [int] NULL,
	[prior_district] [varchar](10) NULL,
	[prior_state] [varchar](10) NULL,
	[prior_country] [varchar](10) NULL,
	[disaster_affected_student] [varchar](10) NULL,
	[student_offender_transfer] [varchar](10) NULL,
	[calendar] [varchar](50) NULL,
	[econ_dis] [numeric](1, 0) NULL,
	[ell_status] [numeric](1, 0) NULL,
	[disabilities] [numeric](1, 0) NULL,
	[homeless] [numeric](1, 0) NULL,
	[foster] [numeric](1, 0) NULL,
 CONSTRAINT [PK_DS_Enrollment] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[vw_P_Enrollment]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[vw_P_Enrollment]
as

-- Schools
select distinct
     e.syear
    ,h.region
    ,e.sch_id
    ,e.stu_id
    ,g.grade
    ,e.start_date
    ,e.end_date
from DS_Enrollment   as e
left join DS_Schools as h on e.sch_id = h.sch_id
join ( -- use student's final grade level for the school year
        select row_number() over (partition by syear, sch_id, stu_id order by start_date desc) as seq
              ,syear,sch_id,stu_id,grade
        from DS_Enrollment
) as g on g.seq = 1 and e.syear = g.syear and e.sch_id = g.sch_id and e.stu_id = g.stu_id
where g.grade <> 'PK'
  and e.syear <= (select syear from constants where relative_year = 0)
  
UNION ALL

-- Regions
select distinct
     e.syear
    ,null
    ,10000 + h.region                       as sch_id
    ,e.stu_id
    ,g.grade
    ,e.start_date
    ,e.end_date
from DS_Enrollment   as e
left join DS_Schools as h on e.sch_id = h.sch_id
join ( -- use student's final grade level for the school year
        select row_number() over (partition by syear, sch_id, stu_id order by start_date desc) as seq
              ,syear,sch_id,stu_id,grade
        from DS_Enrollment
) as g on g.seq = 1 and e.syear = g.syear and e.sch_id = g.sch_id and e.stu_id = g.stu_id
where g.grade <> 'PK'
  and e.syear <= (select syear from constants where relative_year = 0)
  and h.region is not null

UNION ALL

-- District
select distinct
     e.syear
    ,null
	,10000									as sch_id
    ,e.stu_id
    ,g.grade
    ,e.start_date
    ,e.end_date
from DS_Enrollment   as e
left join DS_Schools as h on e.sch_id = h.sch_id
join ( -- use student's final grade level for the school year
        select row_number() over (partition by syear, sch_id, stu_id order by start_date desc) as seq
              ,syear,sch_id,stu_id,grade
        from DS_Enrollment
) as g on g.seq = 1 and e.syear = g.syear and e.sch_id = g.sch_id and e.stu_id = g.stu_id
where g.grade <> 'PK'
  and e.syear <= (select syear from constants where relative_year = 0)
GO
/****** Object:  View [dbo].[EVO_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- EVO_schools
----------------------------------
CREATE view [dbo].[EVO_schools]
as
                    select   3 as sch_id,   '07' as period    -- Azalea Middle        (2017/2018 Period 08)
        UNION ALL   select   1 as sch_id,   '06' as period    -- Bay Point Middle     (2017/2018 Period 02)
        UNION ALL   select  34 as sch_id,   '07' as period    -- Dunedin Middle       (2017/2018 Period 01)
        UNION ALL   select  38 as sch_id,   '07' as period    -- Fitzgerald Middle    (2017/2018 Period 06)
        UNION ALL   select 117 as sch_id,   '04' as period    -- John Hopkins Middle  (2017/2018 Period 03)
        UNION ALL   select   5 as sch_id,   '01' as period    -- Largo Middle         (2017/2018 Period 03)
        UNION ALL   select  66 as sch_id,   '03' as period    -- Meadowlawn Middle    (2017/2018 Period 03)
        UNION ALL   select  79 as sch_id,   '01' as period    -- Oak Grove Middle     (2017/2018 Period 07)
        UNION ALL   select  96 as sch_id,   '07' as period    -- Pinellas Park Middle (2017/2018 Period 07)
        UNION ALL   select 131 as sch_id,   '07' as period    -- Tyrone Middle        (2017/2018 Period 03)
GO
/****** Object:  View [dbo].[EVO_roster]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- EVO_roster
----------------------------------
CREATE view [dbo].[EVO_roster]
as

select distinct
     c.school                               as [Site Name]
    ,c.sch_state_id                         as [Site ID]
    ,c.emp_username                         as [Group Name]
    ,cast(c.emp_id as varchar(20))          as [Group ID]
    ,cast(c.emp_local_id as varchar(20))    as [Emp_Local_ID]
    ,p.period                               as [Preferred Period]
    ,c.period                               as [Period]
    ,c.filled_seats                         as [Filled Seats]
    ,s.first_name                           as [Stu First Name]
    ,s.last_name                            as [Stu Last Name]
    ,cast(s.stu_id as varchar(20))          as [Stu Student ID]
    ,convert(varchar(50),s.birthdate,101)   as [Stu DOB]
    ,left(s.gender,1)                       as [Stu Gender]
    ,case when isnumeric(s.grade) = 1 then cast(cast(s.grade as int) as varchar(10))
          when s.grade = 'KG' then 'K'
          when s.grade = 'PK' then 'P' end  as [Stu Grade]
    ,u.first_name       as [User First Name]
    ,u.last_name        as [User Last Name]
    ,u.email            as [User Email]
-- select c.*
from DS_Classes     as c
join DS_Students    as s on c.stu_id = s.stu_id and c.sch_id = s.sch_id
join DS_Users       as u on c.emp_id = u.emp_id
join DS_Schools     as h on c.sch_id = h.sch_id
join EVO_schools    as p on c.sch_id = p.sch_id
where getdate() between c.start_date and c.end_date
  and u.email not in (select email from (select distinct c.emp_username+'@pcsb.org' as email, c.sch_id from DS_Classes as c join EVO_schools as p on c.sch_id = p.sch_id) as t group by email having count(*) > 1) -- eliminate teachers at multiple schools
  and (
            s.grade in ('06','07')              -- All 6th and 7th graders
        or (s.grade = '08' and s.sch_id = 66)   -- Also include the 8th graders at Meadowlawn
      ) 
GO
/****** Object:  View [dbo].[focus_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--------------------------------------------
CREATE view [dbo].[focus_schools]
--------------------------------------------
as

select active
      ,syear
      ,sch_id           as school_id
      ,sch_state_id     as schoolnum
      ,sch_state_id     as statenum
      ,school           as title
      ,initials
      ,address
      ,city
      ,state
      ,zipcode
      ,area_code
      ,phone
      ,principal
      ,principal_email
      ,latitude
      ,longitude
      ,grade_range
      ,region
from DS_Schools as h
where active = 1
  and ( sch_state_idx = sch_state_id        -- regular schools
        or sch_state_idx = sch_state_id+'S' -- summer schools
      )



GO
/****** Object:  View [dbo].[compasslearning_student_upload]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------------------------------------------------------------------
CREATE VIEW [dbo].[compasslearning_student_upload]
AS

-- Student data (One row per student/class)
select 'User Name' as 'User Name', 'Password' as 'Password', 'First Name' as 'First Name', 'Middle Initial' as 'Middle Initial', 'Last Name' as 'Last Name', 'Grade' as 'Grade', 'Student Id Number' as 'Student Id Number',
       'SIF Provided Student ID' as 'SIF Provided Student ID', 'Parent User Name' as 'Parent User Name', 'Parent Password' as 'Parent Password', 'Gender' as 'Gender', 'Hispanic/Latino' as 'Hispanic/Latino', 'Not Hispanic/Latino' as 'Not Hispanic/Latino', 'American Indian/Alaskan Native' as 'American Indian/Alaskan Native', 'Asian' as 'Asian', 'Black' as 'Black', 'Native Hawaiian/Pacific Islander' as 'Native Hawaiian/Pacific Islander', 'White' as 'White', 'ESL/ESOL/ELL/LEP' as 'ESL/ESOL/ELL/LEP', 'Title I Math' as 'Title I Math', 'Title I Reading' as 'Title I Reading', 'Speech' as 'Speech', 'LD' as 'LD', 'Physically Challenged' as 'Physically Challenged',  'ESE/Special Needs' as 'ESE/Special Needs', 'Attendance Concern' as 'Attendance Concern',
       'Free or Reduced Lunch' as 'Free or Reduced Lunch', 'Hearing Impaired' as 'Hearing Impaired', 'Economically Disadvantaged' 'Economically Disadvantaged', 'Migrant' as 'Migrant', 'Continuous Enrollment' as 'Continuous Enrollment', 'Gifted' as 'Gifted', 'After School Programs' as 'After School Programs', 'Intervention' as 'Intervention',
       'Class Name' as 'Class Name',
       'Account ID' as 'Account ID',
       'Operation Type' as 'Operation Type'

UNION ALL

select stu.STULOGINID, 'Pinellas13' as password, ss.firstname, null as middle, ss.lastname, cast(cast(ss.grade as int) as varchar(2)) as grade, ss.permnum,
       null as H, null as I, null as J, null as K, null as L, null as M, null as N, null as O, null as P, null as Q, null as R, null as S, null as T, null as U, null as V, null as W, null as X, null as Y, null as Z,
       null as AA, null as AB, null as AC, null as AD, null as AE, null as AF, null as AG, null as AH,
       replace(replace(isnull(ss.termcode+' (','')+ss.period+') '+rtrim(ss.coursetitle)+' ('+upper(ss.username)+')',',','_'),';','_') as class,
       cast(cast(sch.statenum as int) as varchar(8)) as schoolnum,
       null as AK

from focus_student_schedule as ss
join focus_students         as stu   on ss.student_id = stu.student_id
join focus_schools          as sch on ss.school_id = sch.school_id
where ss.school_id in (3,66,97)        -- Specific schools
  and ss.grade in ('06','07','08','09','10','11','12') -- middle and high school
  and left(ss.coursenum,2) in ('12','20') -- only math and science classes
  and stu.STULOGINID is not null
GO
/****** Object:  View [dbo].[vw_P_Timeframes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE view [dbo].[vw_P_Timeframes]
as

          select syear, 'Year'      as timeframe, cast(syear as varchar(20))                as timeframe_id, start_yr    as start_date, end_yr       as end_date from constants as y
UNION ALL select syear, 'Nth Day'   as timeframe, cast(school_days_elapsed as varchar(20))  as timeframe_id, start_yr    as start_date, school_date  as end_date from constants as y where school_days_elapsed is not null
UNION ALL select syear, 'Today'     as timeframe, cast(school_date as varchar(20))          as timeframe_id, school_date as start_date, school_date  as end_date from constants as y where school_date is not null
UNION ALL select syear, 'Quarter'   as timeframe, 'Q1'                                      as timeframe_id, start_mp1   as start_date, end_mp1      as end_date from constants as y where syear >= 2014
UNION ALL select syear, 'Quarter'   as timeframe, 'Q2'                                      as timeframe_id, start_mp2   as start_date, end_mp2      as end_date from constants as y where syear >= 2014
UNION ALL select syear, 'Quarter'   as timeframe, 'Q3'                                      as timeframe_id, start_mp3   as start_date, end_mp3      as end_date from constants as y where syear >= 2014
UNION ALL select syear, 'Quarter'   as timeframe, 'Q4'                                      as timeframe_id, start_mp4   as start_date, end_mp4      as end_date from constants as y where syear >= 2014
UNION ALL select syear, 'Semester'  as timeframe, 'S1'                                      as timeframe_id, start_s1    as start_date, end_s1       as end_date from constants as y where end_s1 is not null
UNION ALL select syear, 'Semester'  as timeframe, 'S2'                                      as timeframe_id, start_s2    as start_date, end_s2       as end_date from constants as y where end_s2 is not null
UNION ALL select syear, 'Month'     as timeframe,  '1' as timeframe_id, DATEFROMPARTS(syear+1, 1,1) as start_date,           DATEFROMPARTS(syear+1, 1,31) as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe,  '2' as timeframe_id, DATEFROMPARTS(syear+1, 2,1) as start_date,   EOMONTH(DATEFROMPARTS(syear+1, 2,1)) as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe,  '3' as timeframe_id, DATEFROMPARTS(syear+1, 3,1) as start_date,           DATEFROMPARTS(syear+1, 3,31) as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe,  '4' as timeframe_id, DATEFROMPARTS(syear+1, 4,1) as start_date,           DATEFROMPARTS(syear+1, 4,30) as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe,  '5' as timeframe_id, DATEFROMPARTS(syear+1, 5,1) as start_date, case when month(end_yr) = 5 then end_yr else DATEFROMPARTS(syear+1, 5,31) end as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe,  '6' as timeframe_id, DATEFROMPARTS(syear+1, 6,1) as start_date, case when month(end_yr) = 6 then end_yr else DATEFROMPARTS(syear+1, 6,30) end as end_date from constants as y where month(end_yr) > 5 
UNION ALL select syear, 'Month'     as timeframe,  '8' as timeframe_id, start_yr                    as start_date,           DATEFROMPARTS(syear, 8,31) as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe,  '9' as timeframe_id, DATEFROMPARTS(syear,   9,1) as start_date,           DATEFROMPARTS(syear, 9,29) as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe, '10' as timeframe_id, DATEFROMPARTS(syear,  10,1) as start_date,           DATEFROMPARTS(syear,10,31) as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe, '11' as timeframe_id, DATEFROMPARTS(syear,  11,1) as start_date,           DATEFROMPARTS(syear,11,30) as end_date from constants as y
UNION ALL select syear, 'Month'     as timeframe, '12' as timeframe_id, DATEFROMPARTS(syear,  12,1) as start_date,           DATEFROMPARTS(syear,12,31) as end_date from constants as y





GO
/****** Object:  View [dbo].[EVO_group_import]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- EVO_group_import
--      select * from evo_roster where [Group ID] < 10000
----------------------------------
CREATE view [dbo].[EVO_group_import]
as

select distinct
     [Site Name]
    ,[Group Name]
    ,[Group ID]
-- select c.*
from EVO_roster
where [Emp_Local_ID] is not null

UNION ALL

select distinct
     [Site Name]
    ,'UNASSIGNED'   as [Group Name]
    ,[Site ID]      as [Group ID]
from EVO_roster
GO
/****** Object:  Table [dbo].[Profile_Behavior_Trend]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Behavior_Trend](
	[syear] [int] NULL,
	[timeframe] [varchar](8) NULL,
	[timeframe_id] [varchar](20) NULL,
	[as_of_date] [date] NULL,
	[school_days] [int] NULL,
	[category] [varchar](8) NULL,
	[category_id] [int] NULL,
	[sch_id] [int] NULL,
	[subgroup] [varchar](50) NULL,
	[group] [varchar](50) NULL,
	[value_list] [varchar](50) NULL,
	[toggle] [varchar](12) NULL,
	[color] [int] NULL,
	[series] [int] NULL,
	[green] [int] NULL,
	[gold] [int] NULL,
	[red] [int] NULL,
	[enrolled] [int] NULL,
	[enrolled_per] [decimal](10, 3) NULL,
	[ref_stu] [int] NULL,
	[ref_num] [int] NULL,
	[ref_risk] [decimal](10, 3) NULL,
	[ref_risk_ratio] [decimal](10, 3) NULL,
	[ref_stu_composition] [decimal](10, 3) NULL,
	[ref_stu_comp_flag] [int] NULL,
	[ref_stu_comp_exp] [numeric](10, 3) NULL,
	[ref_composition] [decimal](10, 3) NULL,
	[ref_rate] [decimal](10, 3) NULL,
	[ref_rate_ratio] [decimal](10, 3) NULL,
	[oss_stu] [int] NULL,
	[oss_num] [int] NULL,
	[oss_risk] [decimal](10, 3) NULL,
	[oss_risk_ratio] [decimal](10, 3) NULL,
	[oss_stu_composition] [decimal](10, 3) NULL,
	[oss_stu_comp_flag] [int] NULL,
	[oss_stu_comp_exp] [numeric](10, 3) NULL,
	[oss_composition] [decimal](10, 3) NULL,
	[oss_rate] [decimal](10, 3) NULL,
	[oss_rate_ratio] [decimal](10, 3) NULL,
	[iss_stu] [int] NULL,
	[iss_num] [int] NULL,
	[iss_risk] [decimal](10, 3) NULL,
	[iss_risk_ratio] [decimal](10, 3) NULL,
	[iss_stu_composition] [decimal](10, 3) NULL,
	[iss_stu_comp_flag] [int] NULL,
	[iss_stu_comp_exp] [numeric](10, 3) NULL,
	[iss_composition] [decimal](10, 3) NULL,
	[iss_rate] [decimal](10, 3) NULL,
	[iss_rate_ratio] [decimal](10, 3) NULL,
	[arr_num] [int] NULL,
	[arr_composition] [decimal](10, 3) NULL,
	[arr_rate] [decimal](10, 4) NULL,
	[arr_rate_ratio] [decimal](10, 3) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[vw_Profile_Behavior_Trend]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[vw_Profile_Behavior_Trend]
AS
--select * from vw_Profile_Behavior_Trend
--------------------------
-- Referrals
--------------------------

select
       [syear]
      ,[timeframe]
      ,[timeframe_id]
      ,[as_of_date]
      ,[school_days]
      ,[category]
      ,[category_id]
	  ,[group]
      ,[subgroup]
      ,[value_list]
	  ,[toggle]
      ,'Referrals'			as 'Type'
      ,[color]
      ,[series]
      ,[enrolled]
      ,[enrolled_per]
      ,ref_stu              as stu
      ,ref_num              as num
      ,ref_risk             as risk
      ,ref_risk_ratio       as risk_ratio
      ,ref_stu_composition  as stu_composition
      ,ref_composition      as composition
      ,ref_rate             as rate
      ,ref_rate_ratio       as rate_ratio
      ,ref_stu_comp_exp     as stu_comp_exp
      ,ref_stu_comp_flag    as stu_comp_flag
      
  FROM Profile_Behavior_Trend
-- where category =  'School'
--and category_id = 3
--and subgroup = 'All Students'
--and syear = 2015
--------------------------
-- ISS
--------------------------
UNION ALL
 
 select
       [syear]
      ,[timeframe]
      ,[timeframe_id]
      ,[as_of_date]
      ,[school_days]
      ,[category]
      ,[category_id]
	  ,[group]
      ,[subgroup]
      ,[value_list]
	  ,[toggle]
      ,'ISS'				as 'Type'
      ,[color]
      ,[series]
      ,[enrolled]
      ,[enrolled_per]
      ,iss_stu              as stu
      ,iss_num              as num
      ,iss_risk             as risk
      ,iss_risk_ratio       as risk_ratio
      ,iss_stu_composition  as stu_composition
      ,iss_composition      as composition
      ,iss_rate             as rate
      ,iss_rate_ratio       as rate_ratio
      ,iss_stu_comp_exp     as stu_comp_exp
      ,iss_stu_comp_flag    as stu_comp_flag
          
  FROM Profile_Behavior_Trend
 
--------------------------
-- OSS
--------------------------
UNION ALL
 
 select
       [syear]
      ,[timeframe]
      ,[timeframe_id]
      ,[as_of_date]
      ,[school_days]
      ,[category]
      ,[category_id]
	  ,[group]
      ,[subgroup]
      ,[value_list]
	  ,[toggle]
      ,'OSS'			    as 'Type'
      ,[color]
      ,[series]
      ,[enrolled]
      ,[enrolled_per]
      ,oss_stu              as stu
      ,oss_num              as num
      ,oss_risk             as risk
      ,oss_risk_ratio       as risk_ratio
      ,oss_stu_composition  as stu_composition
      ,oss_composition      as composition
      ,oss_rate             as rate
      ,oss_rate_ratio       as rate_ratio
      ,oss_stu_comp_exp     as stu_comp_exp
      ,oss_stu_comp_flag    as stu_comp_flag
      
  FROM Profile_Behavior_Trend
 
--------------------------
-- Arrests
--------------------------
 UNION ALL
 
 select
       [syear]
      ,[timeframe]
      ,[timeframe_id]
      ,[as_of_date]
      ,[school_days]
      ,[category]
      ,[category_id]
	  ,[group]
      ,[subgroup]
      ,[value_list]
	  ,[toggle]
      ,'Arrests'			    as 'Type'
      ,[color]
      ,[series]
      ,[enrolled]
      ,[enrolled_per]
      ,NULL						as stu
      ,[arr_num]				as num
      ,NULL						as risk
      ,NULL						as risk_ratio
      ,NULL						as stu_composition
      ,[arr_composition]		as composition
      ,[arr_rate]				as rate
      ,[arr_rate_ratio]			as rate_ratio
      ,NULL						as stu_comp_exp
      ,NULL						as stu_comp_flag
      
  FROM Profile_Behavior_Trend
 
GO
/****** Object:  View [dbo].[fm_log_users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[fm_log_users]
as
    
select l.syear, l.last_name, l.first_name, l.emp_username, l.accountname, l.location, l.location_name, l.pcsbjobcode, l.jobtitle
      ,l.servers
      ,cast(avg(s.servers) as numeric(9,2))     as servers_perday
      ,l.files
      ,l.logins
      ,l.days
      ,L1.days_elapsed
      ,cast(l.logins*1.0/L1.days_elapsed as numeric(9,2))    as logins_perday
      ,max(L1.time)                             as first_login
      ,max(L2.time)                             as last_login
      ,max(L2.ip)                               as ip
      ,max(L2.os)                               as os
      ,max(L2.osver)                            as osver
      ,max(L2.screensize)                       as screensize 
      ,max(L2.fmpver)                           as filemaker
      ,max(L2.bits)                             as bits
      ,max(L2.filename)                         as most_recent_file
      ,max(A.filename)                          as favorite_file
      ,max(A.server)                            as favorite_server
	  ,concat(l.last_name,char(13),char(10),l.last_name,' ',l.first_name) as User_SearchByName_calc
from (  -- basic info per accountname
        select distinct l.syear, u.last_name, u.first_name, u.emp_username, l.accountname, u.location, u.location_name, u.pcsbjobcode, u.jobtitle
              ,count(*)                                 as logins
              ,count(distinct l.server_name)            as servers
              ,count(distinct l.filename)               as files
              ,count(distinct convert(date, l.time))    as days
        from logins		as l 
		join constants	as y on l.syear = y.syear and y.relative_year = 0
        join DS_Users	as u on l.accountname = u.emp_username
        group by l.syear, u.last_name, u.first_name, u.emp_username, l.accountname, u.location, u.location_name, u.pcsbjobcode, u.jobtitle
     ) as l
left join ( -- earliest login date per accountname
        select row_number() over (partition by syear, accountname order by time)    as seq
              ,isnull(nullif(datediff(d,time,getdate()),0),1)                       as days_elapsed
              , *
        from logins         as l
     ) as L1 on l.accountname = L1.accountname and L1.syear = l.syear and L1.seq = 1
left join ( -- most recent file and info per accountname
        select row_number() over (partition by syear, accountname order by time desc) as seq, syear, accountname, filename, time, ip, screensize, fmpver
              ,case os      when '-2'  then 'Win' when '1'   then 'Mac' when '3'    then 'iOS' when '4' then 'Web'  else os     end as os
              ,case osver   when '6.1' then '7'   when '6.3' then '8.1' when '10.0' then '10'                       else osver  end as osver
              ,case fmparch when 'x86_64' then '64' when 'i386' then '32'                                           else ''     end as bits
        from logins         as l
     ) as L2 on l.accountname = L2.accountname and L2.syear = l.syear and L2.seq = 1
left join ( -- most frequent file per accountname
        select row_number() over (partition by syear, accountname order by logins desc) as seq, *
        from (
                select syear, accountname, title as server, filename, count(*) as logins
                from logins             as l
                left join fm_servers    as s on l.server_name = s.server_name
                group by syear, accountname, title, filename
        ) as t
     ) as A on l.accountname = A.accountname and l.syear = A.syear and A.seq = 1
left join ( 
        select l.syear, l.accountname, convert(date, l.time) login_date, count(distinct s.title)*1.0 as servers
        from logins             as l
        left join fm_servers    as s on l.server_name = s.server_name
        where accountname is not null
        group by l.syear, l.accountname, convert(date, l.time)
    ) as s on l.syear = s.syear and l.accountname = s.accountname
group by l.syear, l.last_name, l.first_name, l.emp_username, l.accountname, l.location, l.location_name, l.pcsbjobcode, l.jobtitle,l.logins,l.servers,l.files,l.days,L1.days_elapsed
;
GO
/****** Object:  View [dbo].[Student_Lookup]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Student_Lookup]
AS
SELECT     stu.PERMNUM, stu.FIRSTNAME, stu.LASTNAME, stu.grade, stu.GENDER, stu.ETHNICCODE, sch.statenum, sch.title, stu.PRNTGUARD, stu.address, 
                      stu.city, stu.state, stu.zip
FROM         dbo.focus_students AS stu INNER JOIN
                      dbo.focus_schools AS sch ON stu.school_id = sch.school_id
GO
/****** Object:  Table [dbo].[swbp_snapshot]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[swbp_snapshot](
	[pk] [int] IDENTITY(1,1) NOT NULL,
	[selection] [varchar](500) NULL,
	[data] [varchar](500) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](500) NULL,
	[type] [varchar](500) NULL,
	[syear2] [int] NULL,
	[syear1] [int] NULL,
	[syear0] [int] NULL,
	[syear2_value] [decimal](9, 3) NULL,
	[syear1_value] [decimal](9, 3) NULL,
	[syear0_value] [decimal](9, 3) NULL,
	[school_day] [int] NULL,
	[school_date] [date] NULL,
 CONSTRAINT [PK_swbp_snapshot] PRIMARY KEY CLUSTERED 
(
	[pk] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[vw_Profile_swbp]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[vw_Profile_swbp]
AS

SELECT cast([pk] as numeric(18,1)) as pk
      ,[selection]
      ,[data]
      ,[school_id]
      ,[schoolnum]
      ,[type]
      ,[syear2]
      ,[syear1]
      ,[syear0]
      ,convert(decimal(11,0),syear2_value) as syear2_value
      ,convert(decimal(11,0),syear1_value) as syear1_value
      ,convert(decimal(11,0),syear0_value) as syear0_value
	  ,case when syear1_value-syear2_value > 0 then '+' else '' end + cast(convert(decimal(11,0),syear1_value-syear2_value) as varchar(10)) as syear1_change
	  ,case when syear0_value-syear1_value > 0 then '+' else '' end + cast(convert(decimal(11,0),syear0_value-syear1_value) as varchar(10)) as syear0_change
	  ,case when syear2_value = 0 and syear1_value <> 0 then convert(decimal(11,3),(syear1_value-syear2_value) * 1.0 / 100)
	        when syear2_value <> 0 and syear1_value = 0 then convert(decimal(11,3),(syear1_value-syear2_value) * 1.0 / 100)
			when syear2_value = 0 and syear1_value = 0 then 0
			else convert(decimal(11,3),(syear1_value-syear2_value) * 1.0 / nullif(syear2_value,0))
	   end  as syear1_change_per
	  ,case when syear1_value = 0 and syear0_value <> 0 then convert(decimal(11,3),(syear0_value-syear1_value) * 1.0 / 100)
	        when syear1_value <> 0 and syear0_value = 0 then convert(decimal(11,3),(syear0_value-syear1_value) * 1.0 / 100)
			when syear1_value = 0 and syear0_value = 0 then 0
			else convert(decimal(11,3),(syear0_value-syear1_value) * 1.0 / nullif(syear1_value,0))
	   end  as syear0_change_per
      ,[school_day]
      ,[school_date]
  FROM [dbo].[swbp_snapshot]

union all

SELECT 
	   cast(max(pk)+0.9 as numeric(18,1)) as pk
      ,[selection]
      ,[data]
      ,10000 as [school_id]
      ,'10000' as [schoolnum]
      ,[type]
      ,[syear2]
      ,[syear1]
      ,[syear0]
      ,convert(decimal(11,0),sum(syear2_value)) as syear2_value
      ,convert(decimal(11,0),sum(syear1_value)) as syear1_value
      ,convert(decimal(11,0),sum(syear0_value)) as syear0_value
	  ,case when sum(syear1_value)-sum(syear2_value) > 0 then '+' else '' end + cast(convert(decimal(11,0),sum(syear1_value)-sum(syear2_value)) as varchar(10)) as syear1_change
	  ,case when sum(syear0_value)-sum(syear1_value) > 0 then '+' else '' end + cast(convert(decimal(11,0),sum(syear0_value)-sum(syear1_value)) as varchar(10)) as syear0_change
	  ,case when sum(syear2_value) = 0 and sum(syear1_value) <> 0 then convert(decimal(11,3),(sum(syear1_value)-sum(syear2_value)) * 1.0 / 100)
	        when sum(syear2_value) <> 0 and sum(syear1_value) = 0 then convert(decimal(11,3),(sum(syear1_value)-sum(syear2_value)) * 1.0 / 100)
			when sum(syear2_value) = 0 and sum(syear1_value) = 0 then 0
			else convert(decimal(11,3),(sum(syear1_value)-sum(syear2_value)) * 1.0 / nullif(sum(syear2_value),0))
	   end  as syear1_change_per
	  ,case when sum(syear1_value) = 0 and sum(syear0_value) <> 0 then convert(decimal(11,3),(sum(syear0_value)-sum(syear1_value)) * 1.0 / 100)
	        when sum(syear1_value) <> 0 and sum(syear0_value) = 0 then convert(decimal(11,3),(sum(syear0_value)-sum(syear1_value)) * 1.0 / 100)
			when sum(syear1_value) = 0 and sum(syear0_value) = 0 then 0
			else convert(decimal(11,3),(sum(syear0_value)-sum(syear1_value)) * 1.0 / nullif(sum(syear1_value),0))
	   end  as syear0_change_per
      ,max(school_day) as school_day
      ,[school_date]
  FROM [dbo].[swbp_snapshot]
group by selection,data,type,syear2,syear1,syear0,school_date


union all

SELECT 
	   cast(max(pk) + region/10.0 as numeric(18,1)) as pk
      ,[selection]
      ,[data]
      ,10000+region as [school_id]
      ,'1000'+cast(region as varchar(10)) as [schoolnum]
      ,[type]
      ,[syear2]
      ,[syear1]
      ,[syear0]
      ,convert(decimal(11,0),sum(syear2_value)) as syear2_value
      ,convert(decimal(11,0),sum(syear1_value)) as syear1_value
      ,convert(decimal(11,0),sum(syear0_value)) as syear0_value
	  ,case when sum(syear1_value)-sum(syear2_value) > 0 then '+' else '' end + cast(convert(decimal(11,0),sum(syear1_value)-sum(syear2_value)) as varchar(10)) as syear1_change
	  ,case when sum(syear0_value)-sum(syear1_value) > 0 then '+' else '' end + cast(convert(decimal(11,0),sum(syear0_value)-sum(syear1_value)) as varchar(10)) as syear0_change
	  ,case when sum(syear2_value) = 0 and sum(syear1_value) <> 0 then convert(decimal(11,3),(sum(syear1_value)-sum(syear2_value)) * 1.0 / 100)
	        when sum(syear2_value) <> 0 and sum(syear1_value) = 0 then convert(decimal(11,3),(sum(syear1_value)-sum(syear2_value)) * 1.0 / 100)
			when sum(syear2_value) = 0 and sum(syear1_value) = 0 then 0
			else convert(decimal(11,3),(sum(syear1_value)-sum(syear2_value)) * 1.0 / nullif(sum(syear2_value),0))
	   end  as syear1_change_per
	  ,case when sum(syear1_value) = 0 and sum(syear0_value) <> 0 then convert(decimal(11,3),(sum(syear0_value)-sum(syear1_value)) * 1.0 / 100)
	        when sum(syear1_value) <> 0 and sum(syear0_value) = 0 then convert(decimal(11,3),(sum(syear0_value)-sum(syear1_value)) * 1.0 / 100)
			when sum(syear1_value) = 0 and sum(syear0_value) = 0 then 0
			else convert(decimal(11,3),(sum(syear0_value)-sum(syear1_value)) * 1.0 / nullif(sum(syear1_value),0))
	   end  as syear0_change_per
      ,max(school_day) as school_day
      ,[school_date]
  FROM [dbo].[swbp_snapshot] as s
  join DS_Schools            as h on s.school_id = h.sch_id and h.region is not null
group by selection,data,region,type,syear2,syear1,syear0,school_date
GO
/****** Object:  View [dbo].[Clever_custom_sections]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------
-- Clever_custom_sections
-- ../customsections/sections.csv
-------------------------------------------------
        CREATE view [dbo].[Clever_custom_sections]
        as

        select 'School_id' as School_id, 'Section_id' as Section_id, 'Teacher_id' as Teacher_id, 'Teacher_2_id' as Teacher_2_id, 
               'Name' as Name, 'Section_number' as Section_number,
               'Grade' as Grade, 'Course_name' as Course_name, 'Course_number' as Course_number, 'Period' as Period, 'Subject' as Subject,
               'Term_name' as Term_name, 'Term_start' as Term_start, 'Term_end' as Term_end

        UNION ALL select '6440' as School_id, 'ELA06' as Section_id, '33141' as Teacher_id, '134345' as Teacher_2_id, '"YR 90 ELA 06"' as Name, '"6"' as Section_number, '06' as Grade, '"DISTRICTWIDE GRADE 06"' as Course_name, 'DISTW06' as Course_number, '90' as Period, '"Other"' as Subject, 'YR' as Term_name, convert(varchar(50),min(start_yr),101) as Term_start, convert(varchar(50),min(end_yr),101) as Term_end from constants where relative_year = 0
        UNION ALL select '6440' as School_id, 'ELA07' as Section_id, '33141' as Teacher_id, '134345' as Teacher_2_id, '"YR 90 ELA 07"' as Name, '"7"' as Section_number, '07' as Grade, '"DISTRICTWIDE GRADE 07"' as Course_name, 'DISTW07' as Course_number, '90' as Period, '"Other"' as Subject, 'YR' as Term_name, convert(varchar(50),min(start_yr),101) as Term_start, convert(varchar(50),min(end_yr),101) as Term_end from constants where relative_year = 0
        UNION ALL select '6440' as School_id, 'ELA08' as Section_id, '33141' as Teacher_id, '134345' as Teacher_2_id, '"YR 90 ELA 08"' as Name, '"8"' as Section_number, '08' as Grade, '"DISTRICTWIDE GRADE 08"' as Course_name, 'DISTW08' as Course_number, '90' as Period, '"Other"' as Subject, 'YR' as Term_name, convert(varchar(50),min(start_yr),101) as Term_start, convert(varchar(50),min(end_yr),101) as Term_end from constants where relative_year = 0

GO
/****** Object:  Table [dbo].[DS_Attendance]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Attendance](
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[sch_state_id] [varchar](8) NULL,
	[school] [varchar](100) NULL,
	[stu_id] [int] NULL,
	[stu_local_id] [varchar](50) NULL,
	[stu_username] [varchar](50) NULL,
	[grade] [varchar](4) NULL,
	[ttl_enrolled] [int] NULL,
	[ttl_present] [int] NULL,
	[ttl_absences] [int] NULL,
	[ttl_tardies] [int] NULL,
	[ttl_abs_rate] [decimal](9, 3) NULL,
	[ttl_tar_rate] [decimal](9, 3) NULL,
	[ytd_days] [int] NULL,
	[ytd_enrolled] [int] NULL,
	[ytd_present] [int] NULL,
	[ytd_absences] [int] NULL,
	[ytd_tardies] [int] NULL,
	[ytd_abs_rate] [decimal](9, 3) NULL,
	[ytd_tar_rate] [decimal](9, 3) NULL,
	[prj_abs_rate] [decimal](9, 3) NULL,
	[prj_tar_rate] [decimal](9, 3) NULL,
	[m08_enrolled] [int] NULL,
	[m08_present] [int] NULL,
	[m08_absences] [int] NULL,
	[m08_tardies] [int] NULL,
	[m08_abs_rate] [decimal](9, 3) NULL,
	[m08_tar_rate] [decimal](9, 3) NULL,
	[m09_enrolled] [int] NULL,
	[m09_present] [int] NULL,
	[m09_absences] [int] NULL,
	[m09_tardies] [int] NULL,
	[m09_abs_rate] [decimal](9, 3) NULL,
	[m09_tar_rate] [decimal](9, 3) NULL,
	[m10_enrolled] [int] NULL,
	[m10_present] [int] NULL,
	[m10_absences] [int] NULL,
	[m10_tardies] [int] NULL,
	[m10_abs_rate] [decimal](9, 3) NULL,
	[m10_tar_rate] [decimal](9, 3) NULL,
	[m11_enrolled] [int] NULL,
	[m11_present] [int] NULL,
	[m11_absences] [int] NULL,
	[m11_tardies] [int] NULL,
	[m11_abs_rate] [decimal](9, 3) NULL,
	[m11_tar_rate] [decimal](9, 3) NULL,
	[m12_enrolled] [int] NULL,
	[m12_present] [int] NULL,
	[m12_absences] [int] NULL,
	[m12_tardies] [int] NULL,
	[m12_abs_rate] [decimal](9, 3) NULL,
	[m12_tar_rate] [decimal](9, 3) NULL,
	[m01_enrolled] [int] NULL,
	[m01_present] [int] NULL,
	[m01_absences] [int] NULL,
	[m01_tardies] [int] NULL,
	[m01_abs_rate] [decimal](9, 3) NULL,
	[m01_tar_rate] [decimal](9, 3) NULL,
	[m02_enrolled] [int] NULL,
	[m02_present] [int] NULL,
	[m02_absences] [int] NULL,
	[m02_tardies] [int] NULL,
	[m02_abs_rate] [decimal](9, 3) NULL,
	[m02_tar_rate] [decimal](9, 3) NULL,
	[m03_enrolled] [int] NULL,
	[m03_present] [int] NULL,
	[m03_absences] [int] NULL,
	[m03_tardies] [int] NULL,
	[m03_abs_rate] [decimal](9, 3) NULL,
	[m03_tar_rate] [decimal](9, 3) NULL,
	[m04_enrolled] [int] NULL,
	[m04_present] [int] NULL,
	[m04_absences] [int] NULL,
	[m04_tardies] [int] NULL,
	[m04_abs_rate] [decimal](9, 3) NULL,
	[m04_tar_rate] [decimal](9, 3) NULL,
	[m05_enrolled] [int] NULL,
	[m05_present] [int] NULL,
	[m05_absences] [int] NULL,
	[m05_tardies] [int] NULL,
	[m05_abs_rate] [decimal](9, 3) NULL,
	[m05_tar_rate] [decimal](9, 3) NULL,
	[m06_enrolled] [int] NULL,
	[m06_present] [int] NULL,
	[m06_absences] [int] NULL,
	[m06_tardies] [int] NULL,
	[m06_abs_rate] [decimal](9, 3) NULL,
	[m06_tar_rate] [decimal](9, 3) NULL,
	[m07_enrolled] [int] NULL,
	[m07_present] [int] NULL,
	[m07_absences] [int] NULL,
	[m07_tardies] [int] NULL,
	[m07_abs_rate] [decimal](9, 3) NULL,
	[m07_tar_rate] [decimal](9, 3) NULL,
	[S1_enrolled] [int] NULL,
	[S1_present] [int] NULL,
	[S1_absences] [int] NULL,
	[S1_tardies] [int] NULL,
	[S1_abs_rate] [decimal](9, 3) NULL,
	[S1_tar_rate] [decimal](9, 3) NULL,
	[S2_enrolled] [int] NULL,
	[S2_present] [int] NULL,
	[S2_absences] [int] NULL,
	[S2_tardies] [int] NULL,
	[S2_abs_rate] [decimal](9, 3) NULL,
	[S2_tar_rate] [decimal](9, 3) NULL,
	[Q1_enrolled] [int] NULL,
	[Q1_present] [int] NULL,
	[Q1_absences] [int] NULL,
	[Q1_tardies] [int] NULL,
	[Q1_abs_rate] [decimal](9, 3) NULL,
	[Q1_tar_rate] [decimal](9, 3) NULL,
	[Q2_enrolled] [int] NULL,
	[Q2_present] [int] NULL,
	[Q2_absences] [int] NULL,
	[Q2_tardies] [int] NULL,
	[Q2_abs_rate] [decimal](9, 3) NULL,
	[Q2_tar_rate] [decimal](9, 3) NULL,
	[Q3_enrolled] [int] NULL,
	[Q3_present] [int] NULL,
	[Q3_absences] [int] NULL,
	[Q3_tardies] [int] NULL,
	[Q3_abs_rate] [decimal](9, 3) NULL,
	[Q3_tar_rate] [decimal](9, 3) NULL,
	[Q4_enrolled] [int] NULL,
	[Q4_present] [int] NULL,
	[Q4_absences] [int] NULL,
	[Q4_tardies] [int] NULL,
	[Q4_abs_rate] [decimal](9, 3) NULL,
	[Q4_tar_rate] [decimal](9, 3) NULL,
	[last_updated] [datetime] NULL,
 CONSTRAINT [IX_DS_Attendance] UNIQUE NONCLUSTERED 
(
	[syear] ASC,
	[sch_id] ASC,
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[vw_Profile_swbp_attendance]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

--select * from vw_Profile_swbp_attendance
--drop view vw_Profile_swbp_attendance

CREATE view [dbo].[vw_Profile_swbp_attendance]
AS

---------------------------------------
-- School Attendance Data
---------------------------------------

-- Total Avg Daily Attendance %

select 'Total'                  as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Avg Daily Attendance %' as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 then ttl_present end)*1.0/sum(case when a.syear = y.syear-2 then ttl_enrolled end) as syear2_value
      ,sum(case when a.syear = y.syear-1 then ttl_present end)*1.0/sum(case when a.syear = y.syear-1 then ttl_enrolled end) as syear1_value
      ,sum(case when a.syear = y.syear   then ttl_present end)*1.0/sum(case when a.syear = y.syear   then ttl_enrolled end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Year to Date Avg Daily Attendance %
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Avg Daily Attendance %' as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 then ytd_present end)*1.0/nullif(sum(case when a.syear = y.syear-2 then ytd_enrolled end),0) as syear2_value
      ,sum(case when a.syear = y.syear-1 then ytd_present end)*1.0/nullif(sum(case when a.syear = y.syear-1 then ytd_enrolled end),0) as syear1_value
      ,sum(case when a.syear = y.syear   then ytd_present end)*1.0/nullif(sum(case when a.syear = y.syear   then ytd_enrolled end),0) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Total Students Absent 10%+
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Students Absent 10%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ttl_absences > 1 and ttl_abs_rate >= .1 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ttl_absences > 1 and ttl_abs_rate >= .1 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ttl_absences > 1 and ttl_abs_rate >= .1 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Year to Date Students Absent 10%+
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Students Absent 10%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ytd_absences > 1 and ytd_abs_rate >= .1 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ytd_absences > 1 and ytd_abs_rate >= .1 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ytd_absences > 1 and ytd_abs_rate >= .1 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Total Students Absent 15%+
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Students Absent 15%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ttl_absences > 1 and ttl_abs_rate >= .15 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ttl_absences > 1 and ttl_abs_rate >= .15 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ttl_absences > 1 and ttl_abs_rate >= .15 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Year to Date Students Absent 15%+
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Students Absent 15%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ytd_absences > 1 and ytd_abs_rate >= .15 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ytd_absences > 1 and ytd_abs_rate >= .15 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ytd_absences > 1 and ytd_abs_rate >= .15 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Total Students Absent 20%+
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Students Absent 20%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ttl_absences > 1 and ttl_abs_rate >= .2 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ttl_absences > 1 and ttl_abs_rate >= .2 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ttl_absences > 1 and ttl_abs_rate >= .2 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Year to Date Students Absent 20%+
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Students Absent 20%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ytd_absences > 1 and ytd_abs_rate >= .2 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ytd_absences > 1 and ytd_abs_rate >= .2 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ytd_absences > 1 and ytd_abs_rate >= .2 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Total Perfect Attendance
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Perfect Attendance'     as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ttl_absences = 0 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ttl_absences = 0 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ttl_absences = 0 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

-- Year to Date Perfect Attendance
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,a.sch_id                 as school_id
      ,a.sch_state_id           as schoolnum
      ,'Perfect Attendance'     as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ytd_absences = 0 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ytd_absences = 0 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ytd_absences = 0 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by a.sch_id, a.sch_state_id, y.syear, y.school_days_elapsed

---------------------------------------
-- District Attendance Data
---------------------------------------

-- Total Avg Daily Attendance %
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'			        as schoolnum
      ,'Avg Daily Attendance %' as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 then ttl_present end)*1.0/sum(case when a.syear = y.syear-2 then ttl_enrolled end) as syear2_value
      ,sum(case when a.syear = y.syear-1 then ttl_present end)*1.0/sum(case when a.syear = y.syear-1 then ttl_enrolled end) as syear1_value
      ,sum(case when a.syear = y.syear   then ttl_present end)*1.0/sum(case when a.syear = y.syear   then ttl_enrolled end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Year to Date Avg Daily Attendance %
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Avg Daily Attendance %' as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 then ytd_present end)*1.0/nullif(sum(case when a.syear = y.syear-2 then ytd_enrolled end),0) as syear2_value
      ,sum(case when a.syear = y.syear-1 then ytd_present end)*1.0/nullif(sum(case when a.syear = y.syear-1 then ytd_enrolled end),0) as syear1_value
      ,sum(case when a.syear = y.syear   then ytd_present end)*1.0/nullif(sum(case when a.syear = y.syear   then ytd_enrolled end),0) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Total Students Absent 10%+
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Students Absent 10%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ttl_absences > 1 and ttl_abs_rate >= .1 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ttl_absences > 1 and ttl_abs_rate >= .1 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ttl_absences > 1 and ttl_abs_rate >= .1 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Year to Date Students Absent 10%+
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Students Absent 10%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ytd_absences > 1 and ytd_abs_rate >= .1 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ytd_absences > 1 and ytd_abs_rate >= .1 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ytd_absences > 1 and ytd_abs_rate >= .1 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Total Students Absent 15%+
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Students Absent 15%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ttl_absences > 1 and ttl_abs_rate >= .15 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ttl_absences > 1 and ttl_abs_rate >= .15 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ttl_absences > 1 and ttl_abs_rate >= .15 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Year to Date Students Absent 15%+
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Students Absent 15%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ytd_absences > 1 and ytd_abs_rate >= .15 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ytd_absences > 1 and ytd_abs_rate >= .15 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ytd_absences > 1 and ytd_abs_rate >= .15 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Total Students Absent 20%+
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Students Absent 20%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ttl_absences > 1 and ttl_abs_rate >= .2 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ttl_absences > 1 and ttl_abs_rate >= .2 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ttl_absences > 1 and ttl_abs_rate >= .2 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Year to Date Students Absent 20%+
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Students Absent 20%+'   as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ytd_absences > 1 and ytd_abs_rate >= .2 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ytd_absences > 1 and ytd_abs_rate >= .2 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ytd_absences > 1 and ytd_abs_rate >= .2 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Total Perfect Attendance
UNION ALL
select 'Total'                  as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Perfect Attendance'     as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ttl_absences = 0 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ttl_absences = 0 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ttl_absences = 0 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed

-- Year to Date Perfect Attendance
UNION ALL
select 'Year to Date'           as selection
      ,'Attendance'             as data
      ,10000					as school_id
      ,'10000'					as schoolnum
      ,'Perfect Attendance'     as type
      ,y.syear-2                as syear2
      ,y.syear-1                as syear1
      ,y.syear                  as syear0
      ,sum(case when a.syear = y.syear-2 and ytd_absences = 0 then 1 end) as syear2_value
      ,sum(case when a.syear = y.syear-1 and ytd_absences = 0 then 1 end) as syear1_value
      ,sum(case when a.syear = y.syear   and ytd_absences = 0 then 1 end) as syear0_value
      ,y.school_days_elapsed    as school_day
from DS_Attendance  as a
join constants      as y on relative_year = 0
group by y.syear, y.school_days_elapsed
GO
/****** Object:  View [dbo].[Clever7171_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7171_schools
-- Only Pinellas Preparatory Academy students
-- 00:00:00
-----------------------
create view [dbo].[Clever7171_schools]
as
select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
       'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
       'School_phone' as School_phone,
       'Low_grade' as Low_grade,
       'High_grade' as High_grade,
       'Principal' as Principal, 'Principal_email' as Principal_email
UNION ALL

select distinct sch_state_id as school_id, school, sch_state_id as state_id,
       address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
       replace(area_code+phone, '-', '') as phone,
       case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
       case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
       principal, principal_email
from DS_Schools as h
where sch_id = 150 


GO
/****** Object:  Table [dbo].[summer_bridge_stu_list]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[summer_bridge_stu_list](
	[permnum] [varchar](255) NULL,
	[lastname] [varchar](255) NULL,
	[firstname] [varchar](255) NULL,
	[grade] [varchar](5) NOT NULL,
	[schoolnum_distr] [varchar](255) NULL,
	[sch_name] [varchar](100) NULL,
	[gender] [varchar](1) NULL,
	[Local_EthnicCode] [varchar](1) NULL,
	[AYP_EthnicCode] [varchar](1) NULL,
	[PRIEXE] [varchar](1) NULL,
	[LEP] [varchar](2) NULL,
	[freemeals] [varchar](1) NULL,
	[endyrst] [varchar](1) NULL,
	[Phone1] [varchar](30) NULL,
	[Phone2] [varchar](30) NULL,
	[Phone3] [varchar](30) NULL,
	[Status504] [varchar](1) NOT NULL,
	[SB_Name] [varchar](513) NULL,
	[ChildCare] [varchar](1) NOT NULL,
	[MedicalCare] [varchar](1) NULL,
	[scgrade] [varchar](5) NOT NULL,
	[course] [varchar](1) NOT NULL,
	[crsname] [varchar](1) NOT NULL,
	[processdate] [varchar](1) NOT NULL,
	[schl_grade_elg_cnt] [int] NULL,
	[ZonedSchool] [varchar](255) NULL,
	[ASSIGNCODE] [varchar](500) NULL,
	[Transportation] [varchar](1) NOT NULL,
	[sch_level] [varchar](1) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[vw_summer_bridge_stu_list]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create view [dbo].[vw_summer_bridge_stu_list]
as

select * 
from (
select row_number() over (partition by permnum order by permnum) as dup, s.sch_id
,sb.* 
from summer_bridge_stu_list as sb
left join DS_Schools as s on left(sb.SB_Name, 4) = s.sch_state_idx
) as t
where t.dup = 1


GO
/****** Object:  View [dbo].[EVO_student_import]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- EVO_student_import
----------------------------------
CREATE view [dbo].[EVO_student_import]
as

select distinct
     [Stu First Name]   as [First Name]
    ,[Stu Last Name]    as [Last Name]
    ,[Stu Student ID]   as [Student ID]
    ,[Stu DOB]          as [DOB]
    ,[Stu Gender]       as [Gender]
    ,[Stu Grade]        as [Grade]
    ,isnull(
         max(case when [Filled Seats] <= 30
                   and [Period] = [Preferred Period]
                   and [Emp_Local_ID] is not null
                  then [Group ID]
                  --else [Site ID]
             end)
        ,max([Site ID])
     )                  as [Group ID]
-- select distinct [Stu Student ID]
-- select *
from EVO_roster     as r
where r.[Preferred Period] <> '??'
group by [Stu First Name], [Stu Last Name], [Stu Student ID], [Stu DOB], [Stu Gender], [Stu Grade]
GO
/****** Object:  View [dbo].[NWEA_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------------
-- NWEA Identified students
--      These are students being shared with NWEA MAP via Clever
-----------------------------------------------
CREATE view [dbo].[NWEA_Students]
as

select distinct cast(s.stu_id as varchar(20))   as [Student ID]
from DS_Classes     as c
join DS_Students    as s on c.stu_id = s.stu_id
join constants		as y on y.school_date between c.stu_start_date and c.stu_end_date
where

        -- Lealman Innovation, Clearwater Intermediate, Grades: 05
        ( c.sch_id in (61,92) and s.grade = '05' )

        -- Middle Schools
     or ( c.sch_id in (3,117,5,66,131) and s.grade in ('06','07','08'))

        -- Elementary Schools
     or ( s.grade in ('KG','01','02','03','04','05')
          and c.sch_id in (
               8    -- Anona Elementary School
            ,  2    -- Azalea Elementary School
            ,  4    -- Bardmoor Elementary School
            ,  6    -- Bauder Elementary School
            ,  7    -- Bay Point Elementary School
            ,  9    -- Bay Vista Fundamental Elementary School
            , 11    -- Bear Creek Elementary School
            ,170    -- Belcher Elementary School
            ,171    -- Belleair Elementary School
            , 14    -- Blanton Elementary School
            , 16    -- Brooker Creek Elementary School
            , 17    -- Campbell Park Elementary School
            , 49    -- Calvin A. Hunsinger School
            , 69    -- Chi Chi Rodriguez Academy
            , 26    -- Cross Bayou Elementary School
            , 27    -- Curlew Creek Elementary School
            , 87    -- Curtis Fundamental Elementary
            ,141    -- Cypress Woods Elementary School
            , 51    -- Douglas L. Jamerson Elementary
            , 32    -- Dunedin Elementary School
            ,144    -- Educational Alternative Services
            , 35    -- Eisenhower Elementary School
            , 88    -- Elisa Nelson Elementary School
            , 36    -- Fairmount Park Elementary School
            , 39    -- Forest Lakes Elementary School
            , 40    -- Frontier Elementary School
            , 41    -- Fuguitt Elementary School
            , 44    -- Garrison-Jones Elementary School
            ,418    -- Gulf Beaches Elem Magnet
            , 47    -- Gulfport Elementary School
            , 50    -- High Point Elementary School
            , 48    -- Highland Lakes Elementary School
            ,106    -- James B. Sanderlin PK-8
            ,419    -- Kings Highway Elementary Magnet
            ,143    -- Lake St. George Elementary School
            , 54    -- Lakeview Fundamental Elementary
            , 55    -- Lakewood Elementary School
            , 60    -- Lealman Avenue Elementary School
            , 29    -- Leila Davis Elementary School
            , 42    -- Lynch Elementary School
            , 63    -- Madeira Beach Fundamental
            , 64    -- Maximo Elementary School
            , 65    -- McMullen-Booth Elementary School
            , 67    -- Melrose Elementary School
            ,482    -- Midtown Academy
            , 68    -- Mildred Helms Elementary School
            , 71    -- Mount Vernon Elementary School
            ,130    -- New Heights Elementary School
            , 75    -- North Shore Elementary School
            , 77    -- Northwest Elementary School
            , 81    -- Oakhurst Elementary School
            , 82    -- Oldsmar Elementary School
            , 83    -- Orange Grove Elementary School
            , 86    -- Ozona Elementary School
            , 91    -- Pasadena Fundamental Elementary School
            , 43    -- Perkins Elementary School
            , 93    -- Pinellas Central Elementary School
            , 95    -- Pinellas Park Elementary School
            ,474    -- Pinellas Virtual FLVS Franchise
            , 98    -- Plumb Elementary School
            , 99    -- Ponce de Leon Elementary School
            ,123    -- Rawlings Elementary
            , 90    -- Richard L. Sanders School
            ,100    -- Ridgecrest Elementary School
            ,103    -- Safety Harbor Elementary School
            ,110    -- San Jose Elementary School
            ,111    -- Sandy Lane Elementary School
            ,105    -- Sawgrass Lake Elementary School
            ,112    -- Seminole Elementary School
            ,115    -- Seventy-Fourth St. Elementary
            , 37    -- Sexton Elementary School
            ,116    -- Shore Acres Elementary School
            ,118    -- Skycrest Elementary School
            ,119    -- Skyview Elementary School
            ,140    -- Southern Oak Elementary School
            ,122    -- Starkey Elementary School
            ,124    -- Sunset Hills Elementary School
            ,142    -- Sutherland Elementary School
            ,125    -- Tarpon Springs Elementary School
            ,133    -- Tarpon Springs Fundamental Elementary School
            ,136    -- Walsingham Elementary School
            ,137    -- Westgate Elementary School
            , 13    -- Woodlawn Elementary School
     
        ) )
 
 
GO
/****** Object:  Table [dbo].[P_Subgroups]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[P_Subgroups](
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[stu_id] [int] NULL,
	[group] [varchar](50) NULL,
	[subgroup] [varchar](50) NULL,
	[color] [int] NULL,
	[series] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Student_Enrollment]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Enrollment](
	[syear] [int] NULL,
	[region] [int] NULL,
	[sch_id] [int] NULL,
	[stu_id] [int] NULL,
	[grade] [varchar](2) NULL,
	[timeframe] [varchar](20) NULL,
	[timeframe_id] [varchar](20) NULL,
	[timeframe_days] [int] NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL,
	[stu_days] [int] NULL,
	[stu_start_date] [date] NULL,
	[stu_end_date] [date] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[vw_P_Enrollment_Demographics]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE view [dbo].[vw_P_Enrollment_Demographics]
as

select 
 e.syear
,e.region
,e.sch_id
,e.stu_id
,e.grade
,e.timeframe
,e.timeframe_id
,e.timeframe_days
,e.start_date
,e.end_date
,e.stu_start_date
,e.stu_end_date
,e.stu_days
,d.[group]
,d.subgroup
,d.color
,d.series

from Profile_Student_Enrollment as e
join P_Subgroups as d on e.syear = d.syear and e.sch_id = d.sch_id and e.stu_id = d.stu_id

GO
/****** Object:  View [dbo].[vw_Profile_Enrollment]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[vw_Profile_Enrollment]

as

select 
	 e.syear
	,e.sch_id
	,[group]
	,subgroup
	,color
	,series
	,count(distinct stu_id) as enr
	,round((cast(count(distinct stu_id) as float) *1 / a.enr),3) as enr_per
from vw_P_Enrollment_Demographics as e
join (
		select 
			 e.syear
			,sch_id
			,count(distinct stu_id) as enr
		from vw_P_Enrollment_Demographics as e
        join constants as y on e.syear = y.syear and y.relative_year = 0
		where timeframe = 'Today'
		and [group] = 'All Students'
		group by e.syear,sch_id
	) as a on e.sch_id = a.sch_id and e.syear = a.syear
where timeframe = 'Today'
and [group] = 'Ethnicity'
--and e.sch_id = 22
group by e.syear,e.sch_id,[group],subgroup,color,series,a.enr



GO
/****** Object:  Table [dbo].[DS_Behavior]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Behavior](
	[referral_id] [numeric](18, 0) NULL,
	[referral_date] [date] NULL,
	[response_id] [numeric](18, 0) NULL,
	[syear] [numeric](18, 0) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[sch_state_id] [varchar](50) NULL,
	[school] [varchar](100) NULL,
	[emp_id] [numeric](18, 0) NULL,
	[emp_local_id] [numeric](18, 0) NULL,
	[emp_username] [varchar](50) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[stu_local_id] [varchar](50) NULL,
	[stu_username] [varchar](50) NULL,
	[stu_sch_id] [numeric](18, 0) NULL,
	[stu_sch_state_id] [varchar](50) NULL,
	[incident_id] [numeric](18, 0) NULL,
	[incident_date] [date] NULL,
	[incident_code] [varchar](2) NULL,
	[incident_code_ext] [varchar](3) NULL,
	[incident] [varchar](1000) NULL,
	[incident_comment] [varchar](5000) NULL,
	[incident_context] [varchar](1000) NULL,
	[incident_location] [varchar](1000) NULL,
	[incident_bus] [numeric](18, 0) NULL,
	[prior_actions] [varchar](1000) NULL,
	[teacher_reasons] [varchar](1000) NULL,
	[response_date] [date] NULL,
	[response_code] [varchar](100) NULL,
	[response] [varchar](100) NULL,
	[response_comment] [varchar](5000) NULL,
	[response_start] [date] NULL,
	[response_end] [date] NULL,
	[response_days] [varchar](100) NULL,
	[response_admin] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[JWB_Discipline]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------------------
-- JWB_Discipline
-- 00:02:00
CREATE view [dbo].[JWB_Discipline]
as
----------------------------------------------------------------
select
     cast(b.syear as varchar(4)) + '-' + cast(b.syear+1 as varchar(4)) as SchoolYear
    ,cast(b.syear as varchar(4)) as syear
    ,d.Stu_SIS_ID
    ,d.Stu_Local_ID
    ,d.Stu_State_ID
    ,d.LastName
    ,d.FirstName
    ,d.MiddleName
    ,d.BirthDate
    ,d.GradeLevel
    ,convert(varchar(10),b.incident_date,101) as school_date
    ,h.SchoolNum    as SchoolNum
    ,h.SchoolName   as SchoolName
    ,cast(b.incident_id as varchar(40))         as incident_id
    ,convert(varchar(10),b.incident_date,101)   as incident_date
    ,b.incident                                 as incident
    ,b.prior_actions                            as prior_actions
    ,b.teacher_reasons                          as teacher_reasons
    ,cast(b.response_id as varchar(40))         as response_id
    ,convert(varchar(10),b.response_date,101)   as response_date
    ,b.response_code                            as response_code
    ,b.response                                 as response
    ,convert(varchar(10),b.response_start,101)  as response_start
    ,convert(varchar(10),b.response_end,101)    as response_end
    ,cast(b.response_days as varchar(40))       as response_days

-- select count(*) -- 90,382 : 9,923
-- select top 100 b.*
from JWB_Demographics       as d
join DS_Behavior            as b on cast(d.syear as numeric(4,0))       = b.syear  and d.syear        <> 'syear'
                                and cast(d.stu_SIS_id as numeric(18,0)) = b.stu_id and d.Stu_Local_ID <> 'Stu_Local_ID'
join constants              as y on b.syear = y.syear and y.relative_year >= -3
join JWB_Schools            as h on b.sch_state_id = h.SchoolNum

union all
select 'SchoolYear','syear','Stu_SIS_ID','Stu_Local_ID','Stu_State_ID','LastName','FirstName','MiddleName','BirthDate','GradeLevel','School_Date','SchoolNum','SchoolName','incident_id','incident_date','incident','prior_actions','teacher_reasons','response_id','response_date','response_code','response','response_start','response_end','response_days'
GO
/****** Object:  View [dbo].[career_cruising_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[career_cruising_students] as

select 'StudentID' as StudentID, 'FirstName' as FirstName, 'LastName' as LastName, 'Gender' as Gender, 'DateOfBirth' as DateOfBirth
      ,'CurrentGrade' as CurrentGrade, 'CurrentSchoolCode' as CurrentSchoolCode, 'PreRegSchoolCode' as PreRegSchoolCode
      ,'Email' as Email, 'Username' as Username, 'Password' as Password, 'CurrentTeacher' as CurrentTeacher, 'DegreeType' as DegreeType, 'GroupVariable' as GroupVariable, 'StudentGUID' as StudentGUID
UNION ALL

select distinct
       cast(stu.stu_id as varchar(15)) as StudentID
      ,stu.first_name
      ,stu.last_name
      ,substring(stu.gender,LEN(stu.gender)-1,1)
      ,cast(stu.birthdate as varchar(10)) as DateOfBirth
      ,stu.grade as CurrentGrade
      ,ss.sch_state_id as CurrentSchoolCode
      ,stu.sch_next as PreRegSchoolCode
      ,case when stu.samAccountName is null then stu.stu_username else stu.samAccountName end +'@pcsb.org' as Email
      ,replace( case when stu.samAccountName is null then stu.stu_username else stu.samAccountName end, '.', '') as Username
      ,'s.'+right(stu.stu_local_id,8) as Password
      ,null as CurrentTeacher
      ,null as DegreeType
      ,null as GroupVariable
      ,null as StudentGUID
-- select *
from (
                select distinct sch_state_id, stu_id  from DS_Classes
) as ss
join ( -- each students's schools ranked by most sections at each, switches to summer school location after school year
        select stu_id, sch_state_id, sum(syear_classes) as syear_classes, sum(summer_classes) as summer_classes, row_number() over (partition by stu_id order by case when getdate() > (select end_yr from constants where relative_year = 0) then sum(summer_classes) else 0 end desc, sum(syear_classes) desc) as seq
        from (
                            select stu_id,  sch_state_id, count(case when term<>'SS' then 1 end) as syear_classes, count(case when term='SS' then 1 end) as summer_classes
                            from DS_Classes     as c
                            join career_cruising_schools as sch on c.sch_state_id = sch.SchoolCode
                            group by stu_id,  sch_state_id
        ) as t
        group by stu_id, sch_state_id
) as ps on ss.stu_id = ps.stu_id and ss.sch_state_id = ps.sch_state_id and ps.seq = 1 -- primary school
join DS_Students     as stu on ss.stu_id = stu.stu_id
where stu.grade in ('06','07','08','09','10','11','12')
and stu.stu_id in (select distinct stu_id from DS_Classes where does_grades is not null)
--and samAccountName is not null
and stu.active = 1
and (stu.stu_username is not null or stu.samAccountName is not null)
--and stu.stu_id = '324628'
GO
/****** Object:  View [dbo].[Clever7581_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7581_schools
-- Only Pinellas Preparatory Academy students
-- 00:00:00
-----------------------
    create view [dbo].[Clever7581_schools]
    as
    select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
           'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
           'School_phone' as School_phone,
           'Low_grade' as Low_grade,
           'High_grade' as High_grade,
           'Principal' as Principal, 'Principal_email' as Principal_email
    UNION ALL

    select distinct sch_state_id as school_id, school, sch_state_id as state_id,
           address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
           replace(area_code+phone, '-', '') as phone,
           case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
           case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
           principal, principal_email
    from DS_Schools as h
    where sch_id = 308 



GO
/****** Object:  View [dbo].[PLP_LArts_ES]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create View [dbo].[PLP_LArts_ES]

as

select
ds.stu_username + '@pcsb.org' as stu_email,student_id, lastname, firstname, fs.grade, coursetitle, username + '@pcsb.org' as email, tch_lastname, tch_firstname
from [focus_student_schedule] as fs
join DS_Students as ds on fs.student_id = ds.stu_id
where coursenum in ('5010044F','5010045F', '5010046F')
--and student_id = 331504


--select
--student_id, lastname, firstname, grade, coursetitle, username, tch_lastname, tch_firstname
--from [focus_student_schedule]
--where grade in ('05')
--and lastname = 'mitrovic'
--and coursenum = '5010046F'
--select*
--from [focus_student_schedule]
--where  coursetitle = 'LANG ARTS GRADE 5'
GO
/****** Object:  Table [dbo].[Profile_Attendance_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Attendance_Students](
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[stu_id] [int] NULL,
	[timeframe] [varchar](8) NULL,
	[timeframe_id] [varchar](20) NULL,
	[timeframe_days] [int] NULL,
	[group] [varchar](50) NULL,
	[subgroup] [varchar](50) NULL,
	[color] [int] NULL,
	[series] [int] NULL,
	[enr_days] [int] NULL,
	[present] [int] NULL,
	[QP] [int] NULL,
	[abs_all] [int] NULL,
	[abs_unx] [int] NULL,
	[PND_unx] [int] NULL,
	[SKP_unx] [int] NULL,
	[FAM_unx] [int] NULL,
	[EMP_unx] [int] NULL,
	[TRA_unx] [int] NULL,
	[DIS_unx] [int] NULL,
	[MDU_unx] [int] NULL,
	[QA_unx] [int] NULL,
	[UNX_unx] [int] NULL,
	[abs_exc] [int] NULL,
	[MDE_exc] [int] NULL,
	[EME_exc] [int] NULL,
	[LEG_exc] [int] NULL,
	[ACE_exc] [int] NULL,
	[REL_exc] [int] NULL,
	[EXC_exc] [int] NULL,
	[abs_rate] [numeric](10, 3) NULL,
	[abs_unx_rate] [numeric](10, 3) NULL,
	[abs_exc_rate] [numeric](10, 3) NULL,
	[school_date] [date] NULL,
	[school_days_elapsed] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[BTC_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[BTC_Students]
as

  select 
	 cast(s.stu_username as varchar(10))		as stu_username
	,cast(s.stu_id as varchar(10))				as stu_id
	,cast(s.stu_local_id as varchar(10))		as stu_local_id
	,''''+ s.last_name  +''''					as last_name
    ,''''+ s.first_name +''''					as first_name
    ,''''+ s.school     +''''					as school
	--,cast(M.syear as varchar(10))				as syear
	,cast(s.grade as varchar(10))				as grade
	,s.gender
	--,case when M.[group] = 'Ethnicity' then subgroup end	as ethnicity
	--,M.abs_rate												as abs_percent
	--,s.yr_grad

from DS_Students		as s

left join (  --Ethnicity
		select
			 ROW_NUMBER() over (partition by c.stu_id order by c.syear desc) as seq
			,c.stu_id
			,c.syear
			,c.subgroup
			,c.[group]
			,c.abs_rate
			,c.timeframe

		from Profile_Attendance_Students	as c
		where c.[group] = 'Ethnicity'

) as M on M.seq=1 and s.stu_id = M.stu_id

where s.active = 1
and s.grade in ('09','10','11','12')

GO
/****** Object:  View [dbo].[Clever7131_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7131_schools
-- Only Academie Da Vinci students
-- 00:00:00
-----------------------
CREATE view [dbo].[Clever7131_schools]
as
select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
       'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
       'School_phone' as School_phone,
       'Low_grade' as Low_grade,
       'High_grade' as High_grade,
       'Principal' as Principal, 'Principal_email' as Principal_email
UNION ALL

select distinct sch_state_id as school_id, school, sch_state_id as state_id,
       address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
       replace(area_code+phone, '-', '') as phone,
       case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
       case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
       principal, principal_email
from DS_Schools as h
where sch_id = 148 

GO
/****** Object:  View [dbo].[DiscoveryEd_options_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------------------------------------
-- DiscoveryEd_options_schools
-------------------------------------------------------------------------------
CREATE view [dbo].[DiscoveryEd_options_schools]
AS

select
     i01        as sch_id
    ,v02        as [Site Passcode]
    ,h.school   as school
from DS_Apps_Options    as o
join DS_Schools         as h on o.i01 = h.sch_id
where o.app_id = 19 and type = 'Schools'
GO
/****** Object:  View [dbo].[DiscoveryEd_teacher]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------------------------------------
-- DiscoveryEd_teacher
-------------------------------------------------------------------------------
CREATE view [dbo].[DiscoveryEd_teacher]
AS

select 
     'Site Passcode'            as [Site Passcode]
    ,'Account Name'             as [Account Name]
    ,'Site Name'                as [Site Name]
    ,'First Name'               as [First Name]
    ,'Last Name'                as [Last Name]
    ,'UserName'                 as [UserName]
    ,'Password'                 as [Password]
    ,'Grade'                    as [Grade]
    ,'Teacher ID'               as [Teacher ID]
    ,'Email'                    as [Email]
    ,'Assessment Access Flag'   as [Assessment Access Flag]
    ,'Archive Flag'             as [Archive Flag]


-- Scheduled Teachers
UNION ALL

select distinct 
     os.[Site Passcode]                                 as [Site Passcode]  -- Provided by Discovery Ed
    ,'Pinellas County Schools'                          as [Account Name]
    ,c.school                                           as [Site Name]
    ,c.emp_firstname                                    as [First Name]
    ,c.emp_lastname                                     as [Last Name]
    ,c.emp_username+'@pcsb.org'                         as [UserName]
    ,null                                               as [Password]
    ,null                                               as [Grade]
    ,cast(c.emp_id as varchar(20))                      as [Teacher ID]
    ,u.email                                            as [Email]
    ,'N'                                                as [Assessment Access Flag]
    ,'N'                                                as [Archive Flag]

from DS_Classes                     as c
join DS_Users                       as u  on c.emp_id = u.emp_id
join constants                      as y  on c.syear = y.syear
join DiscoveryEd_options_schools    as os on c.sch_id = os.sch_id
--join DiscoveryEd_options_courses    as oc on c.course_num = oc.course_num
where y.school_date <= c.stu_end_date

-- TBA Teachers
UNION ALL

select distinct 
     os.[Site Passcode]                                 as [Site Passcode]  -- Provided by Discovery Ed
    ,'Pinellas County Schools'                          as [Account Name]
    ,c.school                                           as [Site Name]
    ,c.emp_firstname                                    as [First Name]
    ,c.emp_lastname                                     as [Last Name]
    ,c.emp_username+'@pcsb.org'                         as [UserName]
    ,null                                               as [Password]
    ,null                                               as [Grade]
    ,cast(c.emp_id as varchar(20))                      as [Teacher ID]
    ,c.emp_username+'@pcsb.org'                         as [Email]
    ,'N'                                                as [Assessment Access Flag]
    ,'N'                                                as [Archive Flag]

from DS_Classes                     as c
join constants                      as y  on c.syear = y.syear
join DiscoveryEd_options_schools    as os on c.sch_id = os.sch_id
--join DiscoveryEd_options_courses    as oc on c.course_num = oc.course_num
where c.emp_lastname = 'TBA'
  and y.school_date <= c.stu_end_date

GO
/****** Object:  View [dbo].[Clever7181_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7181_schools
-- Only Pinellas Preparatory Academy students
-- 00:00:00
-----------------------
    create view [dbo].[Clever7181_schools]
    as
    select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
           'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
           'School_phone' as School_phone,
           'Low_grade' as Low_grade,
           'High_grade' as High_grade,
           'Principal' as Principal, 'Principal_email' as Principal_email
    UNION ALL

    select distinct sch_state_id as school_id, school, sch_state_id as state_id,
           address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
           replace(area_code+phone, '-', '') as phone,
           case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
           case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
           principal, principal_email
    from DS_Schools as h
    where sch_id = 151 


GO
/****** Object:  View [dbo].[DiscoveryEd_options_courses]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------------------------------------
-- DiscoveryEd_options_courses
-------------------------------------------------------------------------------
CREATE view [dbo].[DiscoveryEd_options_courses]
AS

select
     v01 as course_num
    ,v03 as course
from DS_Apps_Options    as o
where o.app_id = 19 and type = 'Courses'
GO
/****** Object:  View [dbo].[DiscoveryEd_student]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------------------------------------
-- DiscoveryEd_student
--      select count(*) from discoveryed_student (22,960 -> 23,040)
--      select username, count(*) as dup from DiscoveryEd_student group by username having count(*) > 1
-------------------------------------------------------------------------------
CREATE view [dbo].[DiscoveryEd_student]
AS

select 
     'Site Passcode'            as [Site Passcode]
    ,'Account Name'             as [Account Name]
    ,'Site Name'                as [Site Name]
    ,'First Name'               as [First Name]
    ,'Middle Initial'           as [Middle Initial]
    ,'Last Name'                as [Last Name]
    ,'UserName'                 as [UserName]
    ,'Password'                 as [Password]
    ,'Student ID'               as [Student ID]
    ,'Student Grade'            as [Student Grade]
    ,'Parent Email'             as [Parent Email]
    ,'Archive Flag'             as [Archive Flag]

UNION ALL

select [Site Passcode], [Account Name], [Site Name], [First Name], [Middle Initial], [Last Name], UserName, Password, [Student ID], [Student Grade], [Parent Email], [Archive Flag]
from (
        select 
             row_number() over (partition by c.stu_id order by count(oc.course_num) desc) as seq
            ,os.[Site Passcode]                                 as [Site Passcode]  -- Provided by Discovery Ed
            ,'Pinellas County Schools'                          as [Account Name]
            ,c.school                                           as [Site Name]
            ,c.stu_firstname                                    as [First Name]
            ,left(s.middle_name,1)                              as [Middle Initial]
            ,c.stu_lastname                                     as [Last Name]
            ,c.stu_username                                     as [UserName]
            ,null                                               as [Password]
            ,cast(c.stu_id as varchar(20))                      as [Student ID]
            ,s.grade_simple                                     as [Student Grade]
            ,null                                               as [Parent Email]
            ,'N'                                                as [Archive Flag]
            --,count(oc.course_num)                               as class_count
        -- select *
        from DS_Classes                         as c
        join DS_Students                        as s  on c.stu_id = s.stu_id
        join constants                          as y  on c.syear = y.syear
        left join DiscoveryEd_options_courses   as oc on c.course_num = oc.course_num
        join DiscoveryEd_options_schools        as os on c.sch_id = os.sch_id
        where s.grade <> 'PK'
          and s.stu_username is not null
          and y.school_date <= c.stu_end_date
        --and s.stu_username = 'D9.B3'
        --and s.stu_username = 'CQ.JS'
        group by os.[Site Passcode], c.school, c.stu_firstname, s.middle_name, c.stu_lastname, c.stu_username, c.stu_id, s.grade_simple
) as t where t.seq = 1

GO
/****** Object:  View [dbo].[DiscoveryEd_roster]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------------------------------------
-- DiscoveryEd_roster
-------------------------------------------------------------------------------
CREATE view [dbo].[DiscoveryEd_roster]
AS

select 
     'Site Passcode'            as [Site Passcode]
    ,'Account Name'             as [Account Name]
    ,'Site Name'                as [Site Name]
    ,'Class ID'                 as [Class ID]
    ,'UserName'                 as [UserName]
    ,'Teacher ID'               as [Teacher ID]
    ,'Student ID'               as [Student ID]
    ,'Remove Flag'              as [Remove Flag]


-- Teacher assignment
UNION ALL

select distinct 
     os.[Site Passcode]                         as [Site Passcode]  -- Provided by Discovery Ed
    ,'Pinellas County Schools'                  as [Account Name]
    ,c.school                                   as [Site Name]
    ,cast(c.class_id as varchar(20))            as [Class ID]
    ,c.emp_username+'@pcsb.org'                 as [UserName]
    ,cast(c.emp_id as varchar(20))              as [Teacher ID]
    ,null                                       as [Student ID]
    ,'N'                                        as [Remove Flag]

from DS_Classes                     as c
join DS_Students                    as s  on c.stu_id = s.stu_id
join constants                      as y  on c.syear = y.syear
join DiscoveryEd_options_schools    as os on c.sch_id = os.sch_id
--join DiscoveryEd_options_courses    as oc on c.course_num = oc.course_num
where s.grade <> 'PK'
  and c.emp_username is not null
  and y.school_date <= c.stu_end_date

-- Student assignment
UNION ALL

select distinct 
     os.[Site Passcode]                         as [Site Passcode]  -- Provided by Discovery Ed
    ,'Pinellas County Schools'                  as [Account Name]
    ,c.school                                   as [Site Name]
    ,cast(c.class_id as varchar(20))            as [Class ID]
    ,c.stu_username                             as [UserName]
    ,null                                       as [Teacher ID]
    ,cast(c.stu_id as varchar(20))              as [Student ID]
    ,'N'                                        as [Remove Flag]

from DS_Classes                     as c
join DS_Students                    as s  on c.stu_id = s.stu_id
join constants                      as y  on c.syear = y.syear
join DiscoveryEd_options_schools    as os on c.sch_id = os.sch_id
--join DiscoveryEd_options_courses    as oc on c.course_num = oc.course_num
where s.grade <> 'PK'
  and c.stu_username is not null
  and y.school_date <= c.stu_end_date



GO
/****** Object:  View [dbo].[DiscoveryEd_class]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------------------------------------
-- DiscoveryEd_class
-- select * from discoveryed_class
-------------------------------------------------------------------------------
CREATE view [dbo].[DiscoveryEd_class]
AS

select 
     'Site Passcode'            as [Site Passcode]
    ,'Account Name'             as [Account Name]
    ,'Site Name'                as [Site Name]
    ,'Class Name'               as [Class Name]
    ,'Class ID'                 as [Class ID]
    ,'Class Description'        as [Class Description]
    ,'School Year'              as [School Year]
    ,'Benchmark Class Flag'     as [Benchmark Class Flag]
    ,'Grade'                    as [Grade]
    ,'Subject'                  as [Subject]
    ,'Semester/Block'           as [Semester/Block]
    ,'Archive Flag'             as [Archive Flag]

UNION ALL

select distinct 
     os.[Site Passcode]                     as [Site Passcode]  -- Provided by Discovery Ed
    ,'Pinellas County Schools'              as [Account Name]
    ,c.school                               as [Site Name]
    ,'"'+c.term+' '+c.course_long+'"'       as [Class Name]
    ,cast(c.class_id as varchar(20))        as [Class ID]
    ,null                                   as [Class Description]
    ,right(c.syear,2)+right(c.syear+1,2)    as [School Year]
    ,null                                   as [Benchmark Class Flag]
    ,null                                   as [Grade]
    ,null                                   as [Subject]
    ,null                                   as [Semester/Block]
    ,'N'                                    as [Archive Flag]

from DS_Classes                     as c
join DS_Students                    as s  on c.stu_id = s.stu_id
join constants                      as y  on c.syear = y.syear
join DiscoveryEd_options_schools    as os on c.sch_id = os.sch_id
--join DiscoveryEd_options_courses    as oc on c.course_num = oc.course_num
where s.grade <> 'PK'
  and c.term+' '+c.course_long is not null
  and y.school_date <= c.stu_end_date


GO
/****** Object:  View [dbo].[PLP_MS_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[PLP_MS_Students]
as

select 
	 cast(s.stu_username as varchar(10))	as stu_username
	,cast(s.stu_id as varchar(10))			as stu_id
	,cast(s.stu_local_id as varchar(10))	as stu_local_id
	,''''+ s.last_name  +''''				as last_name
    ,''''+ s.first_name +''''				as first_name
    ,''''+ s.school     +''''				as school
	,cast(M.syear as varchar(10))			as syear	
	,cast(s.grade as varchar(10))			as grade
	,s.gender
	,case when M.[group] = 'Ethnicity' then subgroup end	as ethnicity
	,cast(M.abs_rate as varchar(10))		as abs_percent
	,cast(s.yr_grad as varchar(10))			as yr_grad

from DS_Students		as s

left join (  --Ethnicity
		select
			 ROW_NUMBER() over (partition by c.stu_id order by c.syear desc) as seq
			,c.stu_id
			,c.syear
			,c.subgroup
			,c.[group]
			,c.abs_rate
			,c.timeframe

		from Profile_Attendance_Students	as c
		where c.[group] = 'Ethnicity'

) as M on M.seq=1 and s.stu_id = M.stu_id

where s.active = 1
and s.grade in ('06','07','08')
GO
/****** Object:  View [dbo].[Clever7781_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7781_schools
-- Only Pinellas Preparatory Academy students
-- 00:00:00
-----------------------
    create view [dbo].[Clever7781_schools]
    as
    select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
           'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
           'School_phone' as School_phone,
           'Low_grade' as Low_grade,
           'High_grade' as High_grade,
           'Principal' as Principal, 'Principal_email' as Principal_email
    UNION ALL

    select distinct sch_state_id as school_id, school, sch_state_id as state_id,
           address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
           replace(area_code+phone, '-', '') as phone,
           case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
           case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
           principal, principal_email
    from DS_Schools as h
    where sch_id = 451 



GO
/****** Object:  View [dbo].[fm_calendar]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--------------------------------------------------------------
-- fm_calendar

-- select * from fm_calendar
--------------------------------------------------------------

CREATE view [dbo].[fm_calendar]
as
    select distinct
         grad_year-1                     as syear
        ,datefromparts(grad_year-1,8, 1) as start_date
        ,datefromparts(grad_year,  7,31) as end_date
    from constants
    where grad_year >= 2019

GO
/****** Object:  View [dbo].[fitnessgram]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- fitnessgram
-- 00:01:00
-- select top 10 * from fitnessgram where studentgrade = '5'

CREATE view [dbo].[fitnessgram]
as

select
-- select top 1000 
     dbo.Quotes(c.sch_state_id)                                                     as SchoolID
    ,dbo.Quotes(s.stu_id)                                                           as StudentID
    ,dbo.Quotes(s.first_name)                                                       as StudentFirstName
    ,dbo.Quotes(s.last_name)                                                        as StudentLastName
    ,dbo.Quotes(left(s.middle_name,1))                                              as StudentMiddleInitial
    ,null                                                                           as StudentNickname
    ,dbo.Quotes(convert(varchar(50),s.birthdate,101))                               as StudentBirthdate
    ,case when isnumeric(s.grade)=0 then '"K"'
          else dbo.Quotes(cast(s.grade as int)) end                                 as StudentGrade
    ,dbo.Quotes(isnull(left(right(s.gender,2),1),'M'))                              as StudentGender
    ,case when s.group_hispanic = 'Y' then '"500"'
          when s.race = 'I'           then '"100"'
          when s.race = 'A'           then '"200"'
          when s.race = 'P'           then '"300"'
          when s.race = 'B'           then '"600"'
          when s.race = 'W'           then '"700"'
          when s.race = 'M'           then '"800"'
          else '"999"' end                                                          as StudentEthnicityCode
    ,dbo.Quotes(s.stu_username)                                                     as StudentUsername
    ,dbo.Quotes('s.'+right(s.stu_local_id,8))                                       as StudentPassword
    ,null                                                                           as StudentReportEmail
    ,dbo.Quotes(left(upper(s.stu_username)+'@pcsb.org',35))                         as [Student SSO ID]
    ,dbo.Quotes(left(dbo.CleanEmail(s.cont1_email),128))                            as ParentReportEmail1
    ,null                                                                           as ParentReportEmail2
    ,case when s.active = 1 then '"Y"' else '"N"' end                               as StudentisActive
    ,dbo.Quotes(replace(c.term+' '+isnull(t.course_elem,c.course_long), ',', ''))   as ClassName
    ,dbo.Quotes('52-'+cast(c.class_id as varchar(30)))                              as ClassID
    ,dbo.Quotes(c.course_num)                                                       as ClassDescription
    ,dbo.Quotes(convert(varchar(50), c.start_date, 101))                            as ClassStartDate
    ,dbo.Quotes(convert(varchar(50), c.end_date, 101))                              as ClassEndDate
    ,dbo.Quotes('T'+cast(c.emp_id as varchar(30)))                                  as TeacherID
    ,dbo.Quotes(u.first_name)                                                       as TeacherFirstName
    ,dbo.Quotes(u.last_name)                                                        as TeacherLastName
    ,dbo.Quotes(u.samAccountname)                                                   as TeacherUsername
    ,dbo.Quotes(isnull( left(replace(convert(varchar(20),u.birthdate,101),'/',''),4)+lower(u.emp_username), reverse(lower(u.emp_username)) ))   as TeacherPassword
    ,dbo.Quotes(u.samAccountname+'@pcsb.org')                                       as TeacherEmail
    ,dbo.Quotes(u.samAccountname+'@pcsb.org')                                       as [Teacher SSO ID]
    ,case when u.account = 'Active' then '"Y"' else '"N"' end                       as TeacherisActive

-- select top 100 *
-- select distinct c.subject_group
from DS_Classes     as c
join DS_Students    as s on c.stu_id = s.stu_id
join DS_Users       as u on c.emp_id = u.emp_id
join constants      as y on s.last_syear = y.syear and y.relative_year = 0
left join ( -- include homeroom teacher's name in elementary PE sections
        select class_id, course_num, course_long
              ,max(case course_num
                        when '5015020' then period+' PE K ('+upper(emp_username)+') '+cast(class_id as varchar(20))+' ('+s.hmroom_emp_name+')'
                        when '5015030' then period+' PE 1 ('+upper(emp_username)+') '+cast(class_id as varchar(20))+' ('+s.hmroom_emp_name+')'
                        when '5015040' then period+' PE 2 ('+upper(emp_username)+') '+cast(class_id as varchar(20))+' ('+s.hmroom_emp_name+')'
                        when '5015050' then period+' PE 3 ('+upper(emp_username)+') '+cast(class_id as varchar(20))+' ('+s.hmroom_emp_name+')'
                        when '5015060' then period+' PE 4 ('+upper(emp_username)+') '+cast(class_id as varchar(20))+' ('+s.hmroom_emp_name+')'
                        when '5015070' then period+' PE 5 ('+upper(emp_username)+') '+cast(class_id as varchar(20))+' ('+s.hmroom_emp_name+')'
                   end
                  ) as course_elem
              ,s.hmroom_emp_name
              ,count(distinct c.stu_id) as students
              ,row_number() over (partition by class_id order by count(distinct c.stu_id) desc) as seq
        from DS_Classes     as c
        join DS_Students    as s on c.stu_id = s.stu_id
        where c.course_num in (         
                  '5015020'   -- PHYSICAL EDUCATION K
                 ,'5015030'   -- PHYSICAL EDUCATION 1
                 ,'5015040'   -- PHYSICAL EDUCATION 2
                 ,'5015050'   -- PHYSICAL EDUCATION 3
                 ,'5015060'   -- PHYSICAL EDUCATION 4
                 ,'5015070'   -- PHYSICAL EDUCATION 5
                 )
        group by class_id, course_num, course_long, s.hmroom_emp_name
) as t on c.class_id = t.class_id and t.seq = 1
where s.stu_username is not null
  and u.samAccountName is not null
  and c.sch_state_id in ('0051','0111','0121','0131','0141','0151','0161','0171','0231','0251','0271','0321','0371','0391','0431','0441','0481','0531','0711','0731','0751','0811','0851','0991','1031','1071','1081','1091','1131','1211','1261','1281','1331','1341','1361','1421','1471','1481','1531','1691','1781','1801','1811','1821','1961','2021','2031','2081','2141','2151','2261','2281','2301','2321','2371','2381','2431','2441','2531','2641','2691','2791','2821','2861','2921','2961','3021','3031','3041','3071','3131','3181','3191','3231','3281','3341','3361','3391','3411','3421','3431','3461','3511','3731','3741','3751','3761','3781','3851','3871','3911','3921','3931','3961','4021','4061','4121','4171','4331','4351','4381','4491','4521','4581','4591','4611','4631','4661','4681','4701','4771','4931','6181','6251','6261','6271','6281','6311','6361','6391')
  and (    left(c.course_num,3) in ('150')
        or left(c.course_num,4) in ('3026','5015')
        )
UNION ALL select 'SchoolID', 'StudentID', 'StudentFirstName', 'StudentLastName', 'StudentMiddleInitial', 'StudentNickname', 'StudentBirthdate', 'StudentGrade', 'StudentGender', 'StudentEthnicityCode', 'StudentUsername', 'StudentPassword', 'StudentReportEmail', 'Student SSO ID', 'ParentReportEmail1', 'ParentReportEmail2', 'StudentisActive', 'ClassName', 'ClassID', 'ClassDescription', 'ClassStartDate', 'ClassEndDate', 'TeacherID', 'TeacherFirstName', 'TeacherLastName', 'TeacherUsername', 'TeacherPassword', 'TeacherEmail', 'Teacher SSO ID', 'TeacherisActive'
GO
/****** Object:  View [dbo].[fm_log_stats]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--------------------------------------------------------------
-- fm_log_stats

-- select * from fm_log_stats
-- select * from fm_log_files
--------------------------------------------------------------

CREATE view [dbo].[fm_log_stats]
as

select
     y.syear
    ,count(distinct s.title)        as servers
    ,count(distinct l.filename)     as files
    ,count(distinct accountname)    as users
    ,count(distinct case when time >= convert(date, getdate()) then accountname end)                    as users_today
    ,count(*)                                                                                           as logins
    ,count(distinct convert(date, l.time))                                                              as days
    ,cast( cast(count(*) as real) / nullif(count(distinct convert(date, l.time)), 0) as numeric(8,0))   as logins_perday
    ,count(case when time >= convert(date, getdate()) then 1 end)                                       as logins_today
    ,count(case when datepart(month,l.time)=  8 then 1 end) as logins_m08
    ,count(case when datepart(month,l.time)=  9 then 1 end) as logins_m09
    ,count(case when datepart(month,l.time)= 10 then 1 end) as logins_m10
    ,count(case when datepart(month,l.time)= 11 then 1 end) as logins_m11
    ,count(case when datepart(month,l.time)= 12 then 1 end) as logins_m12
    ,count(case when datepart(month,l.time)=  1 then 1 end) as logins_m01
    ,count(case when datepart(month,l.time)=  2 then 1 end) as logins_m02
    ,count(case when datepart(month,l.time)=  3 then 1 end) as logins_m03
    ,count(case when datepart(month,l.time)=  4 then 1 end) as logins_m04
    ,count(case when datepart(month,l.time)=  5 then 1 end) as logins_m05
    ,count(case when datepart(month,l.time)=  6 then 1 end) as logins_m06
    ,count(case when datepart(month,l.time)=  7 then 1 end) as logins_m07
    ,cast( cast(count(case when os in ('Win','-2') then 1 end) as real) / count(*) as numeric(8,3))  as win
    ,cast( cast(count(case when os in ('Mac', '1') then 1 end) as real) / count(*) as numeric(8,3))  as mac
    ,cast( cast(count(case when os in ('iOS', '3') then 1 end) as real) / count(*) as numeric(8,3))  as ios
    ,cast( cast(count(case when os in ('Web', '4') then 1 end) as real) / count(*) as numeric(8,3))  as web
    ,cast( cast(count(case when fmpver  like '%15.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp15
    ,cast( cast(count(case when fmpver  like '%16.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp16
    ,cast( cast(count(case when fmpver  like '%17.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp17
    ,cast( cast(count(case when fmpver  like '%18.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp18
    ,cast( cast(count(case when fmpver  like '%19.%'  then 1 end) as real) / count(*) as numeric(8,3))  as fmp19
    ,cast( cast(count(case when fmparch = 'i386'   then 1 end) as real) / count(*) as numeric(8,3))  as fmp_32b
    ,cast( cast(count(case when fmparch = 'x86_64' then 1 end) as real) / count(*) as numeric(8,3))  as fmp_64b
from logins             as l
join fm_calendar        as y on l.time between y.start_date and y.end_date
left join fm_servers    as s on l.server_name = s.server_name
group by y.syear
;
GO
/****** Object:  View [dbo].[Clever7681_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7681_schools
-- Only Pinellas Preparatory Academy students
-- 00:00:00
-----------------------
    create view [dbo].[Clever7681_schools]
    as
    select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
           'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
           'School_phone' as School_phone,
           'Low_grade' as Low_grade,
           'High_grade' as High_grade,
           'Principal' as Principal, 'Principal_email' as Principal_email
    UNION ALL

    select distinct sch_state_id as school_id, school, sch_state_id as state_id,
           address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
           replace(area_code+phone, '-', '') as phone,
           case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
           case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
           principal, principal_email
    from DS_Schools as h
    where sch_id = 416 



GO
/****** Object:  View [dbo].[myON_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------
-- myON_schools
-- select * from myON_schools
-- select * from ds_schools order by school
-- 
-----------------
CREATE view [dbo].[myON_schools]
as
select *
from DS_Schools
where sch_id in (
     8	    -- 0051	Anona Elementary School
    ,2	    -- 0111	Azalea Elementary School
    ,4	    -- 0131	Bardmoor Elementary School
    ,6	    -- 0151	Bauder Elementary School
    ,7	    -- 0161	Bay Point Elementary School
    ,9	    -- 0231	Bay Vista Fundamental Elementary School
    ,11	    -- 0271	Bear Creek Elementary School
    ,170	-- 0321	Belcher Elementary School
    ,171	-- 0371	Belleair Elementary School
    ,14	    -- 0391	Blanton Elementary School
    ,16	    -- 0441	Brooker Creek Elementary School
    ,17	    -- 0481	Campbell Park Elementary School
    ,69     -- 2441 Chi Chi Rodriguez Academy
    ,26	    -- 0811	Cross Bayou Elementary School
    ,27	    -- 0851	Curlew Creek Elementary School
    ,87	    -- 3131	Curtis Fundamental Elementary
    ,141	-- 6261	Cypress Woods Elementary School
    ,415    -- 7331 Discovery Academy of Science
    ,51	    -- 1821	Douglas L. Jamerson Elementary
    ,32	    -- 1071	Dunedin Elementary School
    ,144    -- 7071 Educational Alternative Services (Associate to 0391 Blanton ES)
    ,35	    -- 1131	Eisenhower Elementary School
    ,36	    -- 1211	Fairmount Park Elementary School
    ,39	    -- 1331	Forest Lakes Elementary School
    ,40	    -- 1341	Frontier Elementary School
    ,41	    -- 1361	Fuguitt Elementary School
    ,44	    -- 1481	Garrison-Jones Elementary School
    ,418	-- 6311	Gulf Beaches Elem Magnet
    ,47	    -- 1691	Gulfport Elementary School
    ,50	    -- 1811	High Point Elementary School
    ,48	    -- 1781	Highland Lakes Elementary School
    ,145    -- 7081 Hospital Homebound
    ,106	-- 3761	James B. Sanderlin PK-8
    ,419	-- 6361	Kings Highway Elementary Magnet
    ,143	-- 6281	Lake St. George Elementary School
    ,54	    -- 1961	Lakeview Fundamental Elementary
    ,55	    -- 2021	Lakewood Elementary School
    ,60	    -- 2141	Lealman Avenue Elementary School
    ,61	    -- 2151	Lealman Innovation Academy
    ,29	    -- 0991	Leila Davis Elementary School
    ,42	    -- 1421	Lynch Elementary School
    ,63	    -- 2261	Madeira Beach Fundamental
    ,64	    -- 2281	Maximo Elementary School
    ,65	    -- 2301	McMullen-Booth Elementary School
    ,67	    -- 2371	Melrose Elementary School
    ,482	-- 2381	Midtown Academy
    ,68	    -- 2431	Mildred Helms Elementary School
    ,71	    -- 2531	Mount Vernon Elementary School
    ,130	-- 4591	New Heights Elementary School
    ,75	    -- 2691	North Shore Elementary School
    ,77	    -- 2791	Northwest Elementary School
    ,81	    -- 2921	Oakhurst Elementary School
    ,82	    -- 2961	Oldsmar Elementary School
    ,83	    -- 3021	Orange Grove Elementary School
    ,86	    -- 3071	Ozona Elementary School
    ,91	    -- 3281	Pasadena Fundamental Elementary School
    ,43	    -- 1471	Perkins Elementary School
    ,93	    -- 3361	Pinellas Central Elementary School
    ,95	    -- 3391	Pinellas Park Elementary School
    ,300	-- 7023	Pinellas Virtual Full Time
    ,98	    -- 3431	Plumb Elementary School
    ,99	    -- 3461	Ponce de Leon Elementary School
    ,123	-- 4351	Rawlings Elementary
    ,100	-- 3511	Ridgecrest Elementary School
    ,103	-- 3731	Safety Harbor Elementary School
    ,110	-- 3851	San Jose Elementary School
    ,111	-- 3871	Sandy Lane Elementary School
    ,105	-- 3751	Sawgrass Lake Elementary School
    ,112	-- 3911	Seminole Elementary School
    ,115	-- 3961	Seventy-Fourth St. Elementary
    ,37	    -- 1261	Sexton Elementary School
    ,116	-- 4021	Shore Acres Elementary School
    ,118	-- 4121	Skycrest Elementary School
    ,119	-- 4171	Skyview Elementary School
    ,140	-- 6251	Southern Oak Elementary School
    ,122	-- 4331	Starkey Elementary School
    ,124	-- 4381	Sunset Hills Elementary School
    ,142	-- 6271	Sutherland Elementary School
    ,125	-- 4491	Tarpon Springs Elementary School
    ,133	-- 4661	Tarpon Springs Fundamental Elementary School 
    ,136	-- 4701	Walsingham Elementary School
    ,137	-- 4771	Westgate Elementary School
    ,13	    -- 4931	Woodlawn Elementary School
)
GO
/****** Object:  View [dbo].[myON_data]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[myON_data]
as
select *
from (
    select distinct
         row_number() over (partition by c.stu_id order by c.subject_group desc, case when course like '%read%' then '0'
                                                                                      when course like '%lang%' then '1'
                                                                                      else course end, c.emp_id desc) as seq

        ,s.grade
        ,c.stu_local_id                         as student_sis_id
        ,'T'+cast(c.emp_id as varchar(30))      as faculty_sis_id
        ,c.*
    -- select distinct subject_group
    from DS_Classes     as c
    join DS_Students    as s on c.stu_id = s.stu_id
    join focus_users    as u on c.emp_id = u.staff_id
    join myON_schools   as h on c.sch_id = h.sch_id -- include only these schools
    where c.subject_group in ('Homeroom','English Language Arts')
      and c.stu_username is not null
    --order by c.stu_id
) as t
where ( grade in     ('PK','KG','01','02','03','04','05') and seq = 1 )
   or ( grade not in ('PK','KG','01','02','03','04','05') )
GO
/****** Object:  Table [dbo].[log_fmservers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[log_fmservers](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[server_name] [nvarchar](50) NULL,
	[server_ip] [nvarchar](50) NULL,
	[syear] [smallint] NULL,
	[time] [datetime] NULL,
	[daytime] [tinyint] NULL,
	[connected_app] [int] NULL,
	[connected_web] [int] NULL,
 CONSTRAINT [PK_log_fmservers] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[fm_log_servers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--------------------------------------------------------------
-- fm_log_servers

-- select * from fm_log_stats
-- select * from fm_log_files
-- select * from fm_log_servers
--------------------------------------------------------------

CREATE view [dbo].[fm_log_servers]
as

select distinct
     s.syear
    ,s.title as server
    ,l.files, l.users, l.users_today
    ,c.cxn_max, c.cxn_avg
    ,r.cxn_recent, c.cxn_max_today
    ,c.cxn_max_08, c.cxn_max_09, c.cxn_max_10, c.cxn_max_11, c.cxn_max_12, c.cxn_max_01, c.cxn_max_02, c.cxn_max_03, c.cxn_max_04, c.cxn_max_05, c.cxn_max_06, c.cxn_max_07
    ,l.logins, l.days, l.logins_perday, l.logins_today
    ,l.logins_m08, l.logins_m09, l.logins_m10, l.logins_m11, l.logins_m12, l.logins_m01, l.logins_m02, l.logins_m03, l.logins_m04, l.logins_m05, l.logins_m06, l.logins_m07
    ,l.win, l.mac, l.ios, l.web
    ,l.fmp15, l.fmp16, l.fmp17, l.fmp18, l.fmp19
    ,l.fmp_32b, l.fmp_64b

from (  -- list of servers for each schoolyear
        select distinct s.title, y.*
        from fm_servers         as s
        cross join fm_calendar  as y
) as s

left join ( -- user logins by server and schoolyear
        select
             l.syear
            ,s.title
            --,l.server_name
            --,l.server_ip
            ,count(distinct l.filename)  as files
            ,count(distinct accountname) as users
            ,count(distinct case when l.time >= convert(date, getdate()) then accountname end) as users_today
            ,count(*) as logins
            ,count(distinct convert(date, l.time))                                                            as days
            ,cast( cast(count(*) as real) / nullif(count(distinct convert(date, l.time)), 0) as numeric(8,0)) as logins_perday
            ,count(case when l.time >= convert(date, getdate()) then 1 end) as logins_today
            ,count(case when datepart(month,l.time)=  8 then 1 end) as logins_m08
            ,count(case when datepart(month,l.time)=  9 then 1 end) as logins_m09
            ,count(case when datepart(month,l.time)= 10 then 1 end) as logins_m10
            ,count(case when datepart(month,l.time)= 11 then 1 end) as logins_m11
            ,count(case when datepart(month,l.time)= 12 then 1 end) as logins_m12
            ,count(case when datepart(month,l.time)=  1 then 1 end) as logins_m01
            ,count(case when datepart(month,l.time)=  2 then 1 end) as logins_m02
            ,count(case when datepart(month,l.time)=  3 then 1 end) as logins_m03
            ,count(case when datepart(month,l.time)=  4 then 1 end) as logins_m04
            ,count(case when datepart(month,l.time)=  5 then 1 end) as logins_m05
            ,count(case when datepart(month,l.time)=  6 then 1 end) as logins_m06
            ,count(case when datepart(month,l.time)=  7 then 1 end) as logins_m07
            ,cast( cast(count(case when os in ('Win','-2') then 1 end) as real) / count(*) as numeric(8,3))  as win
            ,cast( cast(count(case when os in ('Mac', '1') then 1 end) as real) / count(*) as numeric(8,3))  as mac
            ,cast( cast(count(case when os in ('iOS', '3') then 1 end) as real) / count(*) as numeric(8,3))  as ios
            ,cast( cast(count(case when os in ('Web', '4') then 1 end) as real) / count(*) as numeric(8,3))  as web
            ,cast( cast(count(case when fmpver  like '%15.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp15
            ,cast( cast(count(case when fmpver  like '%16.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp16
            ,cast( cast(count(case when fmpver  like '%17.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp17
            ,cast( cast(count(case when fmpver  like '%18.0%' then 1 end) as real) / count(*) as numeric(8,3))  as fmp18
            ,cast( cast(count(case when fmpver  like '%19.%'  then 1 end) as real) / count(*) as numeric(8,3))  as fmp19
            ,cast( cast(count(case when fmparch = 'i386'   then 1 end) as real) / count(*) as numeric(8,3))  as fmp_32b
            ,cast( cast(count(case when fmparch = 'x86_64' then 1 end) as real) / count(*) as numeric(8,3))  as fmp_64b
        -- select *
        from logins         as l
        join fm_servers     as s on l.server_name = s.server_name
        group by l.syear, s.title
) as l on s.title = l.title and s.syear = l.syear

left join ( -- server connections by server and schoolyear
        select syear, s.title
              ,max(connected_app + connected_web)   as cxn_max
              ,max(connected_app)                   as cxn_max_app
              ,max(connected_web)                   as cxn_max_web
              ,avg(case when convert(time, f.time) between '06:00:00.0000000' and '18:00:00.0000000' then connected_app+connected_web end)  as cxn_avg
              ,max(case when f.time >= convert(date, getdate()) then connected_app+connected_web else 0 end)  as cxn_max_today
              ,max(case when datepart(month,f.time)=  8 then connected_app+connected_web else 0 end) as cxn_max_08
              ,max(case when datepart(month,f.time)=  9 then connected_app+connected_web else 0 end) as cxn_max_09
              ,max(case when datepart(month,f.time)= 10 then connected_app+connected_web else 0 end) as cxn_max_10
              ,max(case when datepart(month,f.time)= 11 then connected_app+connected_web else 0 end) as cxn_max_11
              ,max(case when datepart(month,f.time)= 12 then connected_app+connected_web else 0 end) as cxn_max_12
              ,max(case when datepart(month,f.time)=  1 then connected_app+connected_web else 0 end) as cxn_max_01
              ,max(case when datepart(month,f.time)=  2 then connected_app+connected_web else 0 end) as cxn_max_02
              ,max(case when datepart(month,f.time)=  3 then connected_app+connected_web else 0 end) as cxn_max_03
              ,max(case when datepart(month,f.time)=  4 then connected_app+connected_web else 0 end) as cxn_max_04
              ,max(case when datepart(month,f.time)=  5 then connected_app+connected_web else 0 end) as cxn_max_05
              ,max(case when datepart(month,f.time)=  6 then connected_app+connected_web else 0 end) as cxn_max_06
              ,max(case when datepart(month,f.time)=  7 then connected_app+connected_web else 0 end) as cxn_max_07
        from log_fmservers  as f
        join fm_servers     as s on f.server_name = s.server_name
        group by syear, s.title
) as c on s.title = c.title and s.syear = c.syear

left join ( -- most recent number of server connections by server and schoolyear
        select row_number() over (partition by syear, title order by time desc) as seq
              ,syear, title, connected_app+connected_web as cxn_recent
        from log_fmservers  as f
        join fm_servers     as s on f.server_name = s.server_name
) as r on s.title = r.title and s.syear = r.syear and r.seq = 1
;
GO
/****** Object:  View [dbo].[myON_roster]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- roster.csv
CREATE view [dbo].[myON_roster]
AS
select 'student_sis_id' as student_sis_id
      ,'faculty_sis_id' as faculty_sis_id
UNION ALL
select distinct
     r.student_sis_id
    ,r.faculty_sis_id
from myON_data    as r
GO
/****** Object:  View [dbo].[food_users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
------------------------------------------
-- Users
create view [dbo].[food_users]
as
--      select * from foodservice_users
------------------------------------------

        -- Site Admins
        select 'Managers' as default_user_group, 'Edit' as default_permissions, emp_local_id, email, emp_username, last_name, first_name, location, location_name, pcsbjobcode, dbo.ProperCase(jobtitle) as jobtitle, EmpStatus as status
        from DS_Users
        where pcsbjobcode in ('6566','6571','6576','6581','6586')

        -- Area Coordinators
        UNION ALL
        select 'Coordinators' as default_user_group, 'Edit' as default_permissions, emp_local_id, email, emp_username, last_name, first_name, location, location_name, pcsbjobcode, dbo.ProperCase(jobtitle) as jobtitle, EmpStatus as status
        from DS_Users
        where pcsbjobcode in ('6569')

        -- District Admins
        UNION ALL
        select 'Admins' as default_user_group, 'View' as default_permissions, emp_local_id, email, emp_username, last_name, first_name, location, location_name, pcsbjobcode, dbo.ProperCase(jobtitle) as jobtitle, EmpStatus as status
        from DS_Users
        where pcsbjobcode in ('0062','0264','6399','6429','6567','8603')

        -- Accounting
        UNION ALL
        select 'Accounting' as default_user_group, 'Edit' as default_permissions, emp_local_id, email, emp_username, last_name, first_name, location, location_name, pcsbjobcode, dbo.ProperCase(jobtitle) as jobtitle, EmpStatus as status
        from DS_Users
        where pcsbjobcode in ('0200','8041')


GO
/****** Object:  View [dbo].[EVO_user_import]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- EVO_user_import
----------------------------------
CREATE view [dbo].[EVO_user_import]
as

select distinct
     [User First Name]
    ,[User Last Name]
    ,[User Email]
    ,[Site Name]
    ,[Group ID]
    ,'N' as [Is Site Admin]
from EVO_roster     as r
where [Emp_Local_ID] is not null

GO
/****** Object:  View [dbo].[myON_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- students.csv
CREATE view [dbo].[myON_students]
AS
select 'school_id'      as school_id
      ,'school_name'    as school_name
      ,'sis_id'         as sis_id
      ,'last_name'      as last_name
      ,'first_name'     as first_name
      ,'middle_name'    as middle_name
      ,'grade'          as grade
      ,'username'       as username
      ,'password'       as password
UNION ALL
select distinct
     case when r.sch_state_id = '7071' then '0391'
          else r.sch_state_id
          end                               as school_id
    ,case when r.sch_state_id = '7071' then 'Blanton Elementary School'
          else r.school
          end                               as school_name
    ,r.stu_local_id                         as sis_id
    ,replace(s.last_name,',','''')          as last_name
    ,replace(s.first_name,',','''')         as first_name
    ,replace(s.middle_name,',','''')        as middle_name
    ,case when isnumeric(s.grade)=1 then cast(cast(s.grade as int) as varchar(10))
          when s.grade = 'KG'       then 'K'
          else s.grade              end     as grade
    ,r.stu_username                         as username
    ,'s.'+right(r.stu_local_id,8)           as password
from myON_data      as r
join DS_Students    as s on r.stu_id = s.stu_id

GO
/****** Object:  UserDefinedFunction [dbo].[GetSchoolYear]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE function [dbo].[GetSchoolYear]()

    returns char(2)
    with schemabinding

as

BEGIN
	declare @result char(2)

	--SELECT @Result = select DstYear - 2000 FROM [A0040SFOCUSM].[FOCUS_SS_0600].dbo.PCS_DstYear --original statement from Focus version of function
	select @result = syear-2000 from dbo.constants where relative_year = 0

	return @result

END


GO
/****** Object:  View [dbo].[Clever7481_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7481_schools
-- Only Pinellas Preparatory Academy students
-- 00:00:00
-----------------------
    create view [dbo].[Clever7481_schools]
    as
    select 'School_id' as School_id, 'School_name' as School_name, 'State_id' as State_id,
           'School_address' as School_address, 'School_city' as School_city, 'School_state' as School_state, 'School_zip' as School_zip,
           'School_phone' as School_phone,
           'Low_grade' as Low_grade,
           'High_grade' as High_grade,
           'Principal' as Principal, 'Principal_email' as Principal_email
    UNION ALL

    select distinct sch_state_id as school_id, school, sch_state_id as state_id,
           address, city, state, substring(zipcode,1,5)+substring(zipcode,7,4) as zipcode,
           replace(area_code+phone, '-', '') as phone,
           case when isnumeric(left(grade_range,2))=1 then cast(round(left(grade_range,2),0) as varchar(2)) when left(grade_range,2) = 'KG' then 'Kindergarten' end as Low_grade,
           case when isnumeric(right(grade_range,2))=1 then cast(round(right(grade_range,2),0) as varchar(2)) when right(grade_range,2) = 'KG' then 'Kindergarten' end as High_grade,
           principal, principal_email
    from DS_Schools as h
    where sch_id = 299 



GO
/****** Object:  Table [dbo].[Profile_Student_Courses]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Courses](
	[syear] [numeric](18, 0) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[course_num] [varchar](26) NULL,
	[term] [varchar](10) NULL,
	[start_date] [datetime] NULL,
	[end_date] [datetime] NULL,
	[title] [varchar](100) NOT NULL,
	[long_title] [varchar](150) NULL,
	[teacher] [varchar](50) NULL,
	[credatmpt] [float] NULL,
	[credearned] [float] NOT NULL,
	[mark] [varchar](10) NULL,
	[score] [float] NULL,
	[grade] [varchar](255) NULL,
	[ib] [char](1) NULL,
	[ap] [char](1) NULL,
	[ell] [char](1) NULL,
	[dual_course] [char](1) NULL,
	[honors_course] [char](1) NULL,
	[qpoint_course] [char](1) NULL,
	[grading_scale] [varchar](50) NULL,
	[grad_subject_area] [varchar](5) NULL,
	[gft_enr] [int] NULL,
	[hon_enr] [int] NULL,
	[adv_enr] [int] NULL,
	[acc_enr] [int] NULL,
	[ap_enr] [int] NULL,
	[ib_enr] [int] NULL,
	[aice_enr] [int] NULL,
	[dual_enr] [int] NULL,
	[cte_enr] [int] NULL,
	[hon_perf] [int] NULL,
	[adv_perf] [int] NULL,
	[acc_perf] [int] NULL,
	[ap_perf] [int] NULL,
	[ib_perf] [int] NULL,
	[aice_perf] [int] NULL,
	[dual_perf] [int] NULL,
	[cte_perf] [int] NULL,
	[ncaa] [int] NULL,
	[bfq_points] [float] NULL,
	[curr_course] [int] NULL,
	[avid_enr] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Student_Grad_Credits]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Grad_Credits](
	[stu_id] [numeric](18, 0) NOT NULL,
	[syear] [int] NULL,
	[yr_grad] [varchar](255) NULL,
	[short_name] [varchar](50) NULL,
	[grad_req_prgm] [varchar](50) NULL,
	[grad_option] [varchar](255) NULL,
	[grad_pathway] [varchar](255) NULL,
	[total_ela_credits] [float] NULL,
	[alg1_credits] [float] NULL,
	[geo_credits] [float] NULL,
	[other_math_credits] [float] NULL,
	[total_math_credits] [float] NULL,
	[bio_credits] [float] NULL,
	[sci_eq_credits] [float] NULL,
	[other_sci_credits] [float] NULL,
	[total_sci_credits] [float] NULL,
	[world_hist_credits] [float] NULL,
	[us_hist_credits] [float] NULL,
	[govt_credits] [float] NULL,
	[econ_credits] [float] NULL,
	[total_ss_credits] [float] NULL,
	[total_arts_credits] [float] NULL,
	[hope_credits] [float] NULL,
	[total_pe_credits] [float] NULL,
	[total_elective_credits] [float] NULL,
	[online_class] [int] NULL,
	[total_credits] [float] NULL,
	[industry_cert] [varchar](255) NULL,
	[grd10_fcat_read] [float] NULL,
	[grd10_fcat_math] [float] NULL,
	[grd10_fcat2_read] [float] NULL,
	[grd10_fsa_read] [float] NULL,
	[act_read] [float] NULL,
	[act_read_date] [date] NULL,
	[act_eng] [float] NULL,
	[act_eng_date] [date] NULL,
	[act_math] [float] NULL,
	[sat3_read] [float] NULL,
	[sat4_read] [float] NULL,
	[sat4_read_date] [date] NULL,
	[sat4_ebrw] [float] NULL,
	[sat4_ebrw_date] [date] NULL,
	[sat4_math] [float] NULL,
	[sat4_math_date] [date] NULL,
	[pert_math] [float] NULL,
	[alg1_eoc_ngsss] [float] NULL,
	[alg1_eoc_fsa] [float] NULL,
	[alg1_eoc_fsa_date] [date] NULL,
	[alg2_eoc] [float] NULL,
	[geo_eoc_ngsss] [float] NULL,
	[geo_eoc_fsa] [float] NULL,
	[psa_math] [float] NULL,
	[psa_math_date] [date] NULL,
	[bio_eoc] [float] NULL,
	[us_hist_eoc] [float] NULL,
	[unwtd_cum_gpa] [varchar](255) NULL,
	[alg2_credits] [float] NULL,
	[stats_credits] [float] NULL,
	[chem_phys_credits] [float] NULL,
	[f_lang_credits] [float] NULL,
	[college_credits] [float] NULL,
	[a1_met] [varchar](255) NULL,
	[a1_eoc_met] [varchar](255) NULL,
	[a1_eoc_wvr] [varchar](255) NULL,
	[rd_wvr] [varchar](255) NULL,
	[ol_xmt] [varchar](255) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[JWB_Grades]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------------------
-- JWB_Grades
-- 00:02:00
CREATE view [dbo].[JWB_Grades]
as
----------------------------------------------------------------
select
     cast(c.syear as varchar(4)) + '-' + cast(c.syear+1 as varchar(4)) as SchoolYear
    ,cast(c.syear as varchar(4)) as syear
    ,d.Stu_SIS_ID
    ,d.Stu_Local_ID
    ,d.Stu_State_ID
    ,d.LastName
    ,d.FirstName
    ,d.MiddleName
    ,d.BirthDate
    ,c.grade        as GradeLevel
    ,h.SchoolNum
    ,h.SchoolName
    ,c.term
    ,convert(varchar(10),c.start_date,101)      as start_date
    ,convert(varchar(10),c.end_date  ,101)      as end_date
    ,case when c.curr_course = 1 then 'Y' end   as current_course
    ,c.grad_subject_area
    ,j.subject
    ,left(c.course_num,7)                       as course_num
    ,c.long_title                               as title
    ,c.mark
    ,case c.mark when 'A' then '4'
                 when 'B' then '3'
                 when 'C' then '2'
                 when 'D' then '1'
                 when 'F' then '0' end          as mark_value
    ,cast(c.credearned as varchar(10))          as credearned
    ,case when c.dual_enr = 1 then 'Y' end      as dual_enr

from JWB_Demographics                   as d
join Profile_Student_Courses            as c on cast(d.syear as numeric(4,0))       = c.syear  and d.syear        <> 'syear'
                                            and cast(d.stu_SIS_id as numeric(18,0)) = c.stu_id and d.Stu_Local_ID <> 'Stu_Local_ID'
join constants                          as y on c.syear = y.syear and y.relative_year >= -3
join DS_Schools                         as s on c.sch_id = s.sch_id
join JWB_Schools                        as h on s.sch_state_id = h.SchoolNum
left join Profile_Student_Grad_Credits  as g on c.stu_id = g.stu_id and c.syear = g.syear
left join (
			select v01, v02 as subject
			from DS_Apps_Options
			where app_id = 11 and type = 'Subjects'
) as j on left(c.course_num,len(j.v01)) = j.v01

union all
select 'SchoolYear','syear','Stu_SIS_ID','Stu_Local_ID','Stu_State_ID','LastName','FirstName','MiddleName','BirthDate','GradeLevel','SchoolNum','SchoolName','term','start_date','end_date','current_course','grad_subject_area','subject','course_num','title','mark','mark_value','credearned','dual_enr'
GO
/****** Object:  View [dbo].[nearpod]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------
-- Nearpod view
CREATE view [dbo].[nearpod]
as
----------------------------------------------------
select 'first name' as [first name], 'last name' as [last name], 'email' as email, 'role' as role, 'amazon ID' as [amazon ID]--, 'employee ID' as [employee ID]

UNION ALL
select
     dbo.Quotes(u.first_name)           as [first name]
    ,dbo.Quotes(u.last_name)            as [last name]
    ,dbo.Quotes(lower(u.email))         as [email]
    ,dbo.Quotes(case when s.v02 is not null then isnull(r.v01,'User') else 'User' end)   as [role]  -- check if the user is at a school, then set role
    ,dbo.Quotes(isnull(s.v02,m.v02))    as [amazon ID]
    --,dbo.Quotes(cast(u.emp_local_id as varchar(50))) as [employee ID]

from DS_Users               as u
left join DS_Apps_Options   as r on r.app_id = 29 and r.type = 'Roles' and u.pcsbjobcode = r.v02
left join DS_Apps_Options   as s on s.app_id = 29 and s.type = 'Schools' and u.location = s.v01
left join DS_Apps_Options   as m on m.app_id = 29 and m.type = 'Schools' and m.v01 = '0000'

where u.email is not null
  and u.emp_local_id is not null
  and u.Account = 'Active'
  and u.type = 'Employee'
  and (    u.EmpStatusType in ('F - Full Time') 
        or u.EmpStatus = '5 - Substitute'   -- Substitute Teachers
        or u.pcsbjobcode in (select v01 from DS_Apps_Options where app_id=29 and type='JobCodes') -- jobcodes specified in User Manager app
      )


GO
/****** Object:  View [dbo].[Apple_Schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Apple_Schools
-- These schools will have their rosters uploaded.
-- These will be automatically included in the Apple_Locations view.
----------------------------------
CREATE view [dbo].[Apple_Schools]
as

select	 h.sch_state_id		as location_id
		,'"'+h.school+'"'	as location_name
from DS_Schools as h
where h.sch_id in (418)
GO
/****** Object:  Table [dbo].[DS_Contacts]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Contacts](
	[seq] [numeric](18, 0) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[person_id] [numeric](18, 0) NOT NULL,
	[custody] [varchar](1) NULL,
	[emergency] [varchar](1) NULL,
	[pick_up] [varchar](1) NULL,
	[SMemail] [varchar](1) NULL,
	[sort_order] [int] NULL,
	[student_relation] [varchar](100) NULL,
	[title] [varchar](10) NULL,
	[last_name] [varchar](255) NULL,
	[first_name] [varchar](255) NULL,
	[middle_name] [varchar](255) NULL,
	[email] [varchar](255) NULL,
	[email_full] [varchar](255) NULL,
	[cell_phone] [varchar](max) NULL,
	[cell_callout] [varchar](1) NULL,
	[work_phone] [varchar](max) NULL,
	[work_callout] [varchar](1) NULL,
	[home_phone] [varchar](max) NULL,
	[home_callout] [varchar](1) NULL,
	[mail_address] [varchar](255) NULL,
	[mail_address2] [varchar](255) NULL,
	[mail_city] [varchar](100) NULL,
	[mail_state] [varchar](10) NULL,
	[mail_zipcode] [varchar](10) NULL,
	[notes] [varchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  View [dbo].[naviance_parents]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[naviance_parents]
AS
-----------------------------
select
     'First Name'					as [First Name] 
    ,'Last Name'					as [Last Name]
    ,'Full Name'					as [Full Name]
    ,'Naviance Student ID'			as [Naviance Student ID]
	,'Student_ID'					as [Student_ID]
	,'Parent ID'					as [Parent ID]
	,'Student Address'              as [Student Address]
    ,'Street_Address_1'             as [Street_Address_1]
    ,'Street_Address_2'             as [Street_Address_2]
    ,'City'							as [City]
    ,'State'						as [State]
    ,'ZIP_Code'                     as [ZIP_Code]
    ,'Country'                      as [Country]
    ,'Occupation'                   as [Occupation]
    ,'E-mail'						as [E-mail]					
    ,'Home Telephone'				as [Home Telephone]			
    ,'Work Telephone'				as [Work Telephone]			
    ,'Mobile Telephone'				as [Mobile Telephone]		
    ,'Custodial'                    as [Custodial]				
	,'Communications'				as [Communications]			
	,'Alma Mater'					as [Alma Mater]
	,'Naviance_Parent_Username'		as [Naviance_Parent_Username]
	,'Federated_ID'					as [Federated_ID]
	,'Has_Financial_Responsibility'	as [Has_Financial_Responsibility]

union all

select

     max(c.first_name)									as [First Name]						--First Name					First name of parent/guardian.
    ,max(c.last_name)									as [Last Name]						--Last Name						Last name of parent/guardian. If parent last name is not included, staff will not be able to locate parent records in the parent roster in Naviance.
    ,concat(max(c.first_name),' ',max(c.last_name))		as [Full Name]						--Full Name						Full name of parent/guardian.
    ,null												as [Naviance Student ID]			--Naviance Student ID			Unique ID number, assigned by Naviance to the student associated with the parent/guardian. This number is included in the backup files exported from Naviance.
    --,'"'+string_agg(cast(s.stu_id as varchar),',')+'"'	as [Student ID]						--Student ID					Unique, district-assigned ID of a student associated with the parent/guardian. This ID can contain alphanumeric characters, a dash (-) symbol, and a period (.) symbol.
    ,cast(s.stu_id as varchar)							as [Student ID]						--Student ID					Unique, district-assigned ID of a student associated with the parent/guardian. This ID can contain alphanumeric characters, a dash (-) symbol, and a period (.) symbol.
    ,left(dbo.CleanEmail(c.email),charindex('@',dbo.CleanEmail(c.email))-1)	as [Parent ID]	--Parent ID						Unique, district-assigned parent ID, which can contain alphanumeric characters, a dash (-) symbol, and a period (.) symbol.
    ,null												as [Student Address]				--Student Address				School-assigned student ID of the student whose address should be used when printing envelopes or mailing labels. This address is used in lieu of specifying a separate address for the parent/guardian.
    ,max(c.mail_address)								as [Street Address 1]				--Street Address 1				First line of street address of parent/guardian’s residence.
    ,max(c.mail_address2)								as [Street Address 2]				--Street Address 2				Second line of street address of parent/guardian’s residence.
    ,max(c.mail_city)									as [City]							--City							City of parent/guardian’s residence.
    ,max(c.mail_state)									as [State/Province]					--State/Province				State or province of parent/guardian’s residence.
    ,max(c.mail_zipcode	)								as [ZIP/Postal Code]				--ZIP/Postal Code				ZIP code or postal code of parent/guardian’s residence.
    ,'US'												as [Country]						--Country						Country of parent/guardian’s residence.
    ,null												as [Occupation]						--Occupation					Occupation of parent/guardian.
    ,dbo.CleanEmail(c.email)							as [E-mail]							--E-mail						Parent/guardian e-mail address.
    ,max(cast(nullif(c.home_phone,'') as varchar))		as [Home Telephone]					--Home Telephone				Home telephone number for parent/guardian.
    ,max(cast(nullif(c.work_phone,'') as varchar))		as [Work Telephone]					--Work Telephone				Work telephone number for parent/guardian.
    ,max(cast(nullif(c.cell_phone,'') as varchar))		as [Mobile Telephone]				--Mobile Telephone				Mobile telephone number for parent/guardian.
    ,'Yes'												as [Custodial]						--Custodial						Yes/No indicator of whether the parent/guardian has custodial responsibilities for the student. Financial Responsibility Yes/No indicator of whether the parent/guardian has financial responsibilities for the student.
	,case when dbo.CleanEmail(c.email) is not null then 'Yes' end		as [Communications]					--Communications				Yes/No indicator of whether the parent/guardian should be included in e-mail and written communications when using Naviance group email or mailing label/envelope printing features.
	,null												as [Alma Mater]						--Alma Mater					Four-digit college ID for alma mater of parent/guardian, assigned by College Board.
    ,dbo.CleanEmail(c.email)							as [Naviance_Parent_Username]		--Naviance_Parent_Username		This is a unique identification name for a parent to access Naviance. Note: Parent_Username is required if using a SAML connection. If not setting up a SAML connection, you should not include parent username in your import file.
	,null												as [Federated_ID]					--Federated_ID					The Federation ID is an additional field  that allows admins to pick whatever username or username format they want to pass to Naviance from their user directory for single sign-on. Note: This ID is required if "Federated ID" is the federation type used for SAML SSO Setup
	,null												as [Has_Financial_Responsibility]	--Has_Financial_Responsibility	Indicates whether parent has financial responsibility for the student.
-- select c.*
from DS_Contacts as c
join DS_Students as s on c.stu_id = s.stu_id
where c.custody = 'Y' --custodial parent
and c.email like '%@%' --eliminates non-email addresses
and len(dbo.CleanEmail(c.email)) <= 50 --character limit for Parent ID
and s.active = 1
and s.sch_state_id in (select sch_state_id from naviance_schools)
group by s.stu_id,dbo.CleanEmail(c.email)
GO
/****** Object:  Table [dbo].[Work_PLP_logs_21_22]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_PLP_logs_21_22](
	[pk] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[CreationDate] [nvarchar](max) NULL,
	[username] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  View [dbo].[PLP_Logins]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE view [dbo].[PLP_Logins]
as

select	 
		 count(seq)					as total_logins
		,t.stu_id
		,stu_username
		,max(last_first)			as last_first
		,max(t.local_ethnic_code)	as ethnic_code
		,max(gender)				as gender
		,max(t.sch_state_id)		as sch_state_id
		,max(t.school)				as school
		,max(instructional_setting)	as instructional_setting
		,max(ELL)					as ELL
		,max(t.pemail)				as principal_email
		,(select	max(CreationDate)   

		from [Work_PLP_logs_21_22]	as p
		join DS_Students	as s on LEFT(username, 5) = stu_username
		 )						as displayDate

		--select *
from (
select	 row_number() over (partition by username order by username)	as seq
				,stu_username
				,stu_id
				,last_first
				,username				as stu_email
				,local_ethnic_code
				,gender
				,grade_simple
				,instructional_setting
				,right(ell_status, 4) as ELL
				,s.sch_state_id
				,s.school
				,sc.principal_email		as pemail

		from [Work_PLP_logs_21_22]	as p
		join DS_Students	as s on LEFT(username, 5) = stu_username
		join (
            select sch_state_id, school, principal_email
            from DS_Schools 
            where active = 1
		        --and stu_id = 7122
    ) as sc on cast(s.sch_state_id as varchar(10)) = cast(sc.sch_state_id as varchar(10))
    --where stu_id = 7122
) as t

group by t.stu_id, t.stu_username
GO
/****** Object:  View [dbo].[PLP_PM_Logins]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--USE [EDS]
--GO

--/****** Object:  View [dbo].[PLP_PM_Logins]    Script Date: 7/8/2019 1:30:50 PM ******/
--SET ANSI_NULLS ON
--GO

--SET QUOTED_IDENTIFIER ON
--GO


----------------------------------------------------------------
---- PM_scholastic view
----      select * from PM_scholastic
----      select * from work_Read180_import
----      select sis_id, EXPORT_END_DATE, total_minutes_spent, average_session_minutes, average_sessions_per_segment from work_Read180_Import
---- [Student ID] [Test Date] [Folder 1 Desc] [Folder 1 Score] [Folder 2 Desc] [Folder 2 Score] [Folder 3 Desc] [Folder 3 Score] [Folder 4 Desc] [Folder 4 Score] [Folder 5 Desc] [Folder 5 Score]
------------------------------------------------------------------
CREATE view [dbo].[PLP_PM_Logins] as

-- Header row
	select 'Student ID'	   as [Student ID]
		  ,'Test Date'     as [Test Date]
		  ,'Folder 1 Desc' as [Folder 1 Desc], 'Folder 1 Score' as [Folder 1 Score]
		  ,'Folder 2 Desc' as [Folder 2 Desc], 'Folder 2 Score' as [Folder 2 Score]
		  ,'Folder 3 Desc' as [Folder 3 Desc], 'Folder 3 Score' as [Folder 3 Score]
		  ,'Folder 4 Desc' as [Folder 4 Desc], 'Folder 4 Score' as [Folder 4 Score]
		  ,'Folder 5 Desc' as [Folder 5 Desc], 'Folder 5 Score' as [Folder 5 Score]


-- Logins total
UNION ALL
select
     s.stu_local_id                                                                             as [Student ID]
    ,convert(varchar(20),dateadd(d,-1,cast(displayDate as date)),101)			as [Test Date]
    ,'PLP Logins'                                                                               as [Folder 1 Desc]
    ,null                                                                                       as [Folder 1 Score]
    ,cast(y.syear as varchar(10))+'-'+right(cast(y.syear+1 as varchar(10)),2)                   as [Folder 2 Desc]
    ,null                                                                                       as [Folder 2 Score]
    ,datename(mm,dateadd(d,-7,cast(displayDate as date)))						            as [Folder 3 Desc]
    ,null                                                                                       as [Folder 3 Score]
    ,'Number of Logins'                                                                         as [Folder 4 Desc]
    ,convert(varchar(20), total_logins)															                            as [Folder 4 Score]
    ,null                                                                                       as [Folder 5 Desc]
    ,null                                                                                       as [Folder 5 Score]
 --select *
from PLP_Logins    as r
join DS_Students            as s on r.stu_id = s.stu_id
join constants              as y on cast(displayDate as date) between dateadd(dd, -4,y.start_yr) and dateadd(dd, 68,y.end_yr)
--group by s.stu_local_id, r.CreationDate, y.syear
GO
/****** Object:  View [dbo].[peachjar]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
---------------------------
-- Peachjar
-- 00:00:30
-- all student contact email addresses for each school in which student is enrolled
--
--  select * from ds_schools order by active, category, school

CREATE view [dbo].[peachjar]
as

select distinct
     '"'+ c.school +'"'         as school
    ,'"'+ lower(a.email)  +'"'  as email

from DS_Classes  as c
join DS_Schools  as h on c.sch_id = h.sch_id
					 and left(h.category,1) not in ('D','J','P','T','W','Z')
					 and h.sch_id not in (18,144,474)
					 and h.active = 1
join constants   as y on c.syear = y.syear and y.relative_year = 0
join DS_Students as s on c.stu_id = s.stu_id
join (  -- all parent email addresses
        select stu_id, email as email_orig, dbo.CleanEmail(email) as email from DS_Contacts
) as a on c.stu_id = a.stu_id

where a.email is not null
  and s.grade not in (select case when getdate() > y.end_yr then '12' else '' end) -- eliminate graduated seniors
GO
/****** Object:  View [dbo].[naviance_groups]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[naviance_groups]
AS
-----------------------------
select
	 s.stu_id
	,'"ESE"'					as [Group]
--select *
from DS_Students as s
where s.stu_username is not null
  and s.active = 1
  and s.alt_assessment in (
							 'Alt Assessment will be Administered [Y]'
							,'Student will be assessed using FSAA-Datafolio [D]'
							,'Alt Assessment was/will be Administered [Y]'
							,'Student will be assessed using FSAA-Performance Tasks [P]'
						  )

union all

select
	 s.stu_id
	,'"EE"'	as [Group]
from DS_Students as s
where s.stu_username is not null
  and s.active = 1
  and (special_code like '%||98%' or special_code like '%||99%')

union all

select
	 s.stu_id
	,'"AVID"'					as [Group]
from DS_Students as s
join (
		select 
		 s.stu_id
		,sum(s.avid_enr) as avid
		,sum(s.ib_enr) as ib
		from Profile_Student_Courses as s
		where s.curr_course = 1
		group by s.stu_id
) as c on s.stu_id = c.stu_id
where s.stu_username is not null
  and s.active = 1
  and c.avid > 0

union all

select
	 s.stu_id
	,'"IB"'					as [Group]
from DS_Students as s
join (
		select 
		 s.stu_id
		,sum(s.avid_enr) as avid
		,sum(s.ib_enr) as ib
		from Profile_Student_Courses as s
		where s.curr_course = 1
		group by s.stu_id
) as c on s.stu_id = c.stu_id
where s.stu_username is not null
  and s.active = 1
  and c.ib > 0

union all

select
	 s.stu_id
	,'"FRL"'					as [Group]
from DS_Students as s
where s.econ_dis = 'Y'
  and s.active = 1

union all

select
	 s.stu_id
	,concat('"',application_program,'"')	as [Group]
from DS_Students as s
where application_program is not null
  and s.active = 1
GO
/****** Object:  View [dbo].[Clever7331_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7331_students
-- 00:00:30
-----------------------
create view [dbo].[Clever7331_students]
as
select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
       'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
       'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
       'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
       'Student_zip' as Student_zip, 'Student_email' as Student_email,
       'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
       'Username' as Username, 'Password' as Password

UNION ALL

select distinct
         ss.sch_state_id                        as School_id
        ,cast(stu.stu_id as varchar(30))        as Student_id
        ,stu.stu_local_id                       as Student_number
        ,stu.stu_state_id                       as State_id
        ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
        ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
        ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
        ,left(right(stu.GENDER,2),1)            as GENDER
        ,convert(varchar(10),stu.birthdate,101) as DOB
        ,stu.grade                              as Grade
        ,stu.race                               as Race
        ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
        ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
        ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
              when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
        ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
        ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
        ,stu.stu_username + '@pcsb.org'         as Student_email
        ,'"'+Contact_relationship+'"'           as Contact_relationship
        ,'"'+Contact_type+'"'                   as Contact_type
        ,'"'+Contact_name+'"'                   as Contact_name
        ,'"'+Contact_phone+'"'                  as Contact_phone
        ,'"'+Contact_email+'"'                  as Contact_email
        ,stu.stu_username                       as Username
        ,'s.'+right(stu.stu_local_id,8)         as Password
-- select count(*)
from DS_Classes         as ss
join Clever7331_schools as h   on ss.sch_state_id = h.School_id
join DS_Students        as stu on ss.stu_id = stu.stu_id
left join (
    select stu_id
          ,cont1_type                                                         as Contact_relationship
          ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                when cont1_emer             = 'Y'  then 'Emergency'
                when cont1_cstdy            = 'Y'  then 'Custody'
                                                   else 'Unknown' end               as Contact_type
          ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
          ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
          ,dbo.CleanEmail(cont1_email)       as Contact_email
    from DS_Students as s
    where s.cont1_type is not null
) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
where stu.stu_username is not null
GO
/****** Object:  View [dbo].[SSWIMS_Users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[SSWIMS_Users]
AS
SELECT     TOP (100) PERCENT staff_id, username, first_name, last_name, email, costcenter, title, birthdate, ssn, status, LEFT(last_name, 1) AS last_initial
FROM         dbo.focus_users
WHERE     (costcenter IN ('6290', '5650', '5390', '5260', '5530', '5200', '5450', '5090', '5710')) AND (status = 'A') OR
                      (status = 'A') AND (title IN ('GUIDANCE COUNSELOR E', 'GUIDANCE COUNSELOR M', 'GUIDANCE COUNSELOR H', 'GUIDANCE COUNSELOR O'))
ORDER BY costcenter, title
GO
/****** Object:  View [dbo].[edgenuity_sections]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[edgenuity_sections]
as

select 'Course_Code' as Course_Code, 'Course_Section' as Course_Section, 'Course_Name' as Course_Name, 'Course_Name_Long' as Course_Name_Long, 'Subject' as Subject, 'Term' as Term, 'Days' as Days, 'Period' as Period, 'Room' as Room, 'Course_Start_Date' as Course_Start_Date, 'Course_End_Date' as Course_End_Date, 'School_Code' as School_Code, 'Teacher_ID' as Teacher_ID, 'Teacher_Username' as Teacher_Username
UNION ALL
select distinct
     cast(c.course_num as varchar(50))      as Course_Code
    ,cast(c.class_id as varchar(50))        as Course_Section
    ,c.course                               as Course_Name
    ,c.course_long                          as Course_Name_Long
    ,c.subject                              as Subject
    ,c.term                                 as Term
    ,c.days                                 as Days
    ,c.period                               as Period
    ,c.display_room                         as Room
    ,convert(varchar(50),c.start_date,101)  as Course_Start_Date
    ,convert(varchar(50),c.end_date,101)    as Course_End_Date
    ,c.sch_state_id                         as School_Code
    ,case when u.email is null then null else cast(c.emp_id as varchar(50)) end          as Teacher_ID
    ,u.email                                as Teacher_Username

from ds_classes     as c
left join focus_users as u on c.emp_id = u.staff_id
where c.sch_id in (79,85,12)



GO
/****** Object:  Table [dbo].[Profile_Student_Grad_Status]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Grad_Status](
	[stu_id] [numeric](18, 0) NOT NULL,
	[syear] [int] NULL,
	[grade] [varchar](2) NULL,
	[yr_ent] [varchar](255) NULL,
	[yr_grad] [varchar](255) NULL,
	[sem_rem] [int] NULL,
	[sem_per] [float] NULL,
	[grad_req_prgm] [varchar](50) NULL,
	[grad_pathway] [varchar](255) NULL,
	[en_req] [int] NULL,
	[en_met] [float] NULL,
	[en_rem] [float] NULL,
	[en_enr] [float] NULL,
	[en_mrk] [varchar](10) NULL,
	[en_per] [decimal](5, 3) NULL,
	[en_ontrack] [varchar](1) NULL,
	[ma_req] [int] NULL,
	[ma_met] [float] NULL,
	[ma_rem] [float] NULL,
	[ma_enr] [float] NULL,
	[ma_mrk] [varchar](10) NULL,
	[ma_per] [float] NULL,
	[ma_ontrack] [varchar](1) NULL,
	[sc_req] [int] NULL,
	[sc_met] [float] NULL,
	[sc_rem] [float] NULL,
	[sc_enr] [float] NULL,
	[sc_mrk] [varchar](10) NULL,
	[sc_per] [decimal](5, 3) NULL,
	[sc_ontrack] [varchar](1) NULL,
	[ss_req] [int] NULL,
	[ss_met] [float] NULL,
	[ss_rem] [float] NULL,
	[ss_enr] [float] NULL,
	[ss_mrk] [varchar](10) NULL,
	[ss_per] [decimal](5, 3) NULL,
	[ss_ontrack] [varchar](1) NULL,
	[pf_req] [int] NULL,
	[pf_met] [float] NULL,
	[pf_rem] [float] NULL,
	[pf_enr] [float] NULL,
	[pf_mrk] [varchar](10) NULL,
	[pf_per] [decimal](5, 3) NULL,
	[pf_ontrack] [varchar](1) NULL,
	[pe_req] [int] NULL,
	[pe_met] [float] NULL,
	[pe_rem] [float] NULL,
	[pe_enr] [float] NULL,
	[pe_mrk] [varchar](10) NULL,
	[pe_per] [decimal](5, 3) NULL,
	[pe_ontrack] [varchar](1) NULL,
	[el_req] [int] NULL,
	[el_met] [float] NULL,
	[el_rem] [float] NULL,
	[el_enr] [float] NULL,
	[el_mrk] [varchar](10) NULL,
	[el_per] [decimal](5, 3) NULL,
	[el_ontrack] [varchar](1) NULL,
	[ol_req] [varchar](1) NOT NULL,
	[ol_met] [varchar](1) NULL,
	[ol_enr] [varchar](1) NULL,
	[ol_mrk] [varchar](10) NULL,
	[ol_per] [int] NULL,
	[ol_ontrack] [varchar](1) NULL,
	[gpa_req] [numeric](2, 1) NULL,
	[gpa_met] [float] NULL,
	[gpa_ontrack] [varchar](1) NULL,
	[cr_req] [int] NULL,
	[cr_met] [float] NULL,
	[cr_rem] [float] NULL,
	[cr_enr] [float] NULL,
	[cr_mrk] [varchar](10) NULL,
	[cr_per] [decimal](5, 3) NULL,
	[cr_ontrack] [varchar](1) NULL,
	[rd_req] [varchar](1) NULL,
	[rd_met] [varchar](1) NULL,
	[rd_ontrack] [varchar](1) NULL,
	[a1_eoc_req] [varchar](1) NULL,
	[a1_eoc_met] [varchar](1) NULL,
	[a1_eoc_ontrack] [varchar](1) NULL,
	[grad_ontrack] [varchar](255) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[BTC_GradProgress]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-----------------------------------------------
-- BTC_GradProgress.csv
--
-----------------------------------------------
CREATE view [dbo].[BTC_GradProgress]
as

select
     cast(s.stu_id as varchar(10))    as stu_id
	,cast(ds.stu_username as varchar(10)) as stu_username
    ,cast(syear as varchar(10))    as syear
    ,cast(s.grade as varchar(10))    as grade
    ,cast(yr_ent as varchar(10))    as yr_ent
    ,cast(s.yr_grad as varchar(10))    as yr_grad
    ,cast(sem_rem as varchar(10))    as sem_rem
    ,cast(sem_per as varchar(10))    as sem_per
    ,''''+cast(grad_req_prgm as varchar(100))+''''  as grad_req_prgm
    ,''''+cast(grad_pathway as varchar(100))+''''   as grad_pathway
    ,cast(en_req as varchar(10))    as en_req
    ,cast(en_met as varchar(10))    as en_met
    ,cast(en_rem as varchar(10))    as en_rem
    ,cast(en_enr as varchar(10))    as en_enr
    ,cast(en_mrk as varchar(10))    as en_mrk
    ,cast(en_per as varchar(10))    as en_per
    ,cast(en_ontrack as varchar(10))    as en_ontrack
    ,cast(ma_req as varchar(10))    as ma_req
    ,cast(ma_met as varchar(10))    as ma_met
    ,cast(ma_rem as varchar(10))    as ma_rem
    ,cast(ma_enr as varchar(10))    as ma_enr
    ,cast(ma_mrk as varchar(10))    as ma_mrk
    ,cast(ma_per as varchar(10))    as ma_per
    ,cast(ma_ontrack as varchar(10))    as ma_ontrack
    ,cast(sc_req as varchar(10))    as sc_req
    ,cast(sc_met as varchar(10))    as sc_met
    ,cast(sc_rem as varchar(10))    as sc_rem
    ,cast(sc_enr as varchar(10))    as sc_enr
    ,cast(sc_mrk as varchar(10))    as sc_mrk
    ,cast(sc_per as varchar(10))    as sc_per
    ,cast(sc_ontrack as varchar(10))    as sc_ontrack
    ,cast(ss_req as varchar(10))    as ss_req
    ,cast(ss_met as varchar(10))    as ss_met
    ,cast(ss_rem as varchar(10))    as ss_rem
    ,cast(ss_enr as varchar(10))    as ss_enr
    ,cast(ss_mrk as varchar(10))    as ss_mrk
    ,cast(ss_per as varchar(10))    as ss_per
    ,cast(ss_ontrack as varchar(10))    as ss_ontrack
    ,cast(pf_req as varchar(10))    as pf_req
    ,cast(pf_met as varchar(10))    as pf_met
    ,cast(pf_rem as varchar(10))    as pf_rem
    ,cast(pf_enr as varchar(10))    as pf_enr
    ,cast(pf_mrk as varchar(10))    as pf_mrk
    ,cast(pf_per as varchar(10))    as pf_per
    ,cast(pf_ontrack as varchar(10))    as pf_ontrack
    ,cast(pe_req as varchar(10))    as pe_req
    ,cast(pe_met as varchar(10))    as pe_met
    ,cast(pe_rem as varchar(10))    as pe_rem
    ,cast(pe_enr as varchar(10))    as pe_enr
    ,cast(pe_mrk as varchar(10))    as pe_mrk
    ,cast(pe_per as varchar(10))    as pe_per
    ,cast(pe_ontrack as varchar(10))    as pe_ontrack
    ,cast(el_req as varchar(10))    as el_req
    ,cast(el_met as varchar(10))    as el_met
    ,cast(el_rem as varchar(10))    as el_rem
    ,cast(el_enr as varchar(10))    as el_enr
    ,cast(el_mrk as varchar(10))    as el_mrk
    ,cast(el_per as varchar(10))    as el_per
    ,cast(el_ontrack as varchar(10))    as el_ontrack
    ,cast(ol_req as varchar(10))    as ol_req
    ,cast(ol_met as varchar(10))    as ol_met
    ,cast(ol_enr as varchar(10))    as ol_enr
    ,cast(ol_mrk as varchar(10))    as ol_mrk
    ,cast(ol_per as varchar(10))    as ol_per
    ,cast(ol_ontrack as varchar(10))    as ol_ontrack
    ,cast(gpa_req as varchar(10))    as gpa_req
    ,cast(gpa_met as varchar(10))    as gpa_met
    ,cast(gpa_ontrack as varchar(10))    as gpa_ontrack
    ,cast(cr_req as varchar(10))    as cr_req
    ,cast(cr_met as varchar(10))    as cr_met
    ,cast(cr_rem as varchar(10))    as cr_rem
    ,cast(cr_enr as varchar(10))    as cr_enr
    ,cast(cr_mrk as varchar(10))    as cr_mrk
    ,cast(cr_per as varchar(10))    as cr_per
    ,cast(cr_ontrack as varchar(10))    as cr_ontrack
    ,cast(rd_req as varchar(10))    as rd_req
    ,cast(rd_met as varchar(10))    as rd_met
    ,cast(rd_ontrack as varchar(10))    as rd_ontrack
    ,cast(a1_eoc_req as varchar(10))    as a1_eoc_req
    ,cast(a1_eoc_met as varchar(10))    as a1_eoc_met
    ,cast(a1_eoc_ontrack as varchar(10))    as a1_eoc_ontrack
    ,cast(grad_ontrack as varchar(10))      as grad_ontrack
	,cast(s.stu_id as varchar(10))    as SPO_id
	
--select top 100 *
from Profile_Student_Grad_Status    as s
join DS_Students as ds on s.stu_id = ds.stu_id
where cast(s.stu_id as varchar(20)) in (select stu_id from BTC_Students) 

UNION ALL select 'stu_id', 'stu_username','syear','grade','yr_ent','yr_grad','sem_rem','sem_per','grad_req_prgm','grad_pathway','en_req','en_met','en_rem','en_enr','en_mrk','en_per','en_ontrack','ma_req','ma_met','ma_rem','ma_enr','ma_mrk','ma_per','ma_ontrack','sc_req','sc_met','sc_rem','sc_enr','sc_mrk','sc_per','sc_ontrack','ss_req','ss_met','ss_rem','ss_enr','ss_mrk','ss_per','ss_ontrack','pf_req','pf_met','pf_rem','pf_enr','pf_mrk','pf_per','pf_ontrack','pe_req','pe_met','pe_rem','pe_enr','pe_mrk','pe_per','pe_ontrack','el_req','el_met','el_rem','el_enr','el_mrk','el_per','el_ontrack','ol_req','ol_met','ol_enr','ol_mrk','ol_per','ol_ontrack','gpa_req','gpa_met','gpa_ontrack','cr_req','cr_met','cr_rem','cr_enr','cr_mrk','cr_per','cr_ontrack','rd_req','rd_met','rd_ontrack','a1_eoc_req','a1_eoc_met','a1_eoc_ontrack','grad_ontrack', 'SPO_id'

GO
/****** Object:  View [dbo].[fm_log_cxn_percentiles]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
------------------------------------------------------------
-- fm_log_cxn_percentiles
-- percentile concurrent connections
--
-- looking only at hours between 6:00 AM and 6:00 PM
-- number of concurrent connections, by 'percent of the time'
-- for example, cxn_p25 value of 8 means: 25 percent of the time, there are 8 or fewer concurrent connections
------------------------------------------------------------
CREATE view [dbo].[fm_log_cxn_percentiles]
as
select   f.syear
        ,f.server
        ,count(distinct convert(date, f.time))       as days   
        ,count(*)                                    as log_entries   
        ,cast( cast(count(*) as real) / nullif(count(distinct convert(date, f.time)), 0) as numeric(9,2)) as log_entries_perday
        ,max(f.time) as last_cxn_log
        ,max(case when f.seq = q.p25 then f.cxn end) as cxn_p25
        ,max(case when f.seq = q.p50 then f.cxn end) as cxn_p50
        ,max(case when f.seq = q.p75 then f.cxn end) as cxn_p75
        ,max(case when f.seq = q.p85 then f.cxn end) as cxn_p85
        ,max(case when f.seq = q.p90 then f.cxn end) as cxn_p90
        ,max(case when f.seq = q.p95 then f.cxn end) as cxn_p95
        ,max(case when f.seq = q.p96 then f.cxn end) as cxn_p96
        ,max(case when f.seq = q.p97 then f.cxn end) as cxn_p97
        ,max(case when f.seq = q.p98 then f.cxn end) as cxn_p98
        ,max(case when f.seq = q.p99 then f.cxn end) as cxn_p99
        ,max(f.cxn)                                  as cxn_p100
        ,f.cxn_limit
from (
        select 
                f.syear, f.time
                ,s.title as server
                ,s.cxn_limit
                ,row_number() over (partition by f.syear, s.title order by connected_app+connected_web) as seq
                ,connected_app+connected_web as cxn
        from log_fmservers  as f
        join fm_servers     as s on f.server_name = s.server_name
        where f.daytime = 1
) as f
join ( -- identify quartile row numbers
        select   f.syear, s.title as server
                ,cast(count(*) * .25 as int) as p25
                ,cast(count(*) * .50 as int) as p50
                ,cast(count(*) * .75 as int) as p75
                ,cast(count(*) * .85 as int) as p85
                ,cast(count(*) * .90 as int) as p90
                ,cast(count(*) * .95 as int) as p95
                ,cast(count(*) * .96 as int) as p96
                ,cast(count(*) * .97 as int) as p97
                ,cast(count(*) * .98 as int) as p98
                ,cast(count(*) * .99 as int) as p99
                ,count(*)                    as p100
        from log_fmservers  as f
		join fm_servers     as s on f.server_name = s.server_name
        where daytime = 1
        group by f.syear, s.title
) as q on f.syear = q.syear and f.server = q.server
group by f.syear, f.server, f.cxn_limit
; 
GO
/****** Object:  View [dbo].[career_cruising_student_courses]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[career_cruising_student_courses] as

select 'StudentID' as StudentID, 'CourseCode' as CourseCode, 'CourseName' as CourseName, 'DateCourseComplete' as DateCourseComplete, 'GradeMark' as GradeMark,'CreditValue' as CreditValue, 'HSCourse' as HSCourse, 'CoursePart' as CoursePart

UNION ALL

select 
	 convert(varchar,c.stu_id)		as StudentID
	,left(c.course_num,7)			as CourseCode
	,c.title						as CourseName
	,convert(varchar,c.end_date,23) as DateCourseComplete
	,case when c.curr_course = 1 and c.credearned = 0 then '0'
	      else c.mark 
	  end							as GradeMark
	,case when c.curr_course = 1 and c.credearned = 0 then convert(varchar,c.credatmpt)
	      else convert(varchar,c.credearned) 
	  end							as CreditValue
	,'1'							as HSCourse
	,c.term							as CoursePart
--select *
from Profile_Student_Courses as c
join career_cruising_students as s on convert(varchar,c.stu_id) = s.StudentID
where c.grad_subject_area <> 'NC' 
  and c.grad_subject_area is not null
GO
/****** Object:  Table [dbo].[MAP_tests]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MAP_tests](
	[syear] [varchar](4) NULL,
	[term_name] [varchar](100) NULL,
	[stu_id] [int] NULL,
	[stu_local_id] [varchar](50) NULL,
	[stu_lastname] [varchar](100) NULL,
	[stu_firstname] [varchar](100) NULL,
	[grade] [varchar](2) NULL,
	[sch_id] [int] NULL,
	[sch_state_id] [varchar](4) NULL,
	[school] [varchar](100) NULL,
	[test_date] [date] NULL,
	[discipline] [varchar](50) NULL,
	[test] [varchar](100) NULL,
	[score] [varchar](50) NULL,
	[percentile] [varchar](50) NULL,
	[FallToFallProjectedGrowth] [varchar](50) NULL,
	[FallToFallObservedGrowth] [varchar](50) NULL,
	[FallToFallMetProjectedGrowth] [varchar](50) NULL,
	[FallToFallConditionalGrowthPercentile] [varchar](50) NULL,
	[FallToWinterProjectedGrowth] [varchar](50) NULL,
	[FallToWinterObservedGrowth] [varchar](50) NULL,
	[FallToWinterMetProjectedGrowth] [varchar](50) NULL,
	[FallToWinterConditionalGrowthPercentile] [varchar](50) NULL,
	[FallToSpringProjectedGrowth] [varchar](50) NULL,
	[FallToSpringObservedGrowth] [varchar](50) NULL,
	[FallToSpringMetProjectedGrowth] [varchar](50) NULL,
	[FallToSpringConditionalGrowthPercentile] [varchar](50) NULL,
	[WinterToWinterProjectedGrowth] [varchar](50) NULL,
	[WinterToWinterObservedGrowth] [varchar](50) NULL,
	[WinterToWinterMetProjectedGrowth] [varchar](50) NULL,
	[WinterToWinterConditionalGrowthPercentile] [varchar](50) NULL,
	[WinterToSpringProjectedGrowth] [varchar](50) NULL,
	[WinterToSpringObservedGrowth] [varchar](50) NULL,
	[WinterToSpringMetProjectedGrowth] [varchar](50) NULL,
	[WinterToSpringConditionalGrowthPercentile] [varchar](50) NULL,
	[SpringToSpringProjectedGrowth] [varchar](50) NULL,
	[SpringToSpringObservedGrowth] [varchar](50) NULL,
	[SpringToSpringMetProjectedGrowth] [varchar](50) NULL,
	[SpringToSpringConditionalGrowthPercentile] [varchar](50) NULL,
	[goal1] [varchar](100) NULL,
	[goal1_score] [varchar](50) NULL,
	[goal1_range] [varchar](50) NULL,
	[goal2] [varchar](100) NULL,
	[goal2_score] [varchar](50) NULL,
	[goal2_range] [varchar](50) NULL,
	[goal3] [varchar](100) NULL,
	[goal3_score] [varchar](50) NULL,
	[goal3_range] [varchar](50) NULL,
	[goal4] [varchar](100) NULL,
	[goal4_score] [varchar](50) NULL,
	[goal4_range] [varchar](50) NULL,
	[goal5] [varchar](100) NULL,
	[goal5_score] [varchar](50) NULL,
	[goal5_range] [varchar](50) NULL,
	[goal6] [varchar](100) NULL,
	[goal6_score] [varchar](50) NULL,
	[goal6_range] [varchar](50) NULL,
	[goal7] [varchar](100) NULL,
	[goal7_score] [varchar](50) NULL,
	[goal7_range] [varchar](50) NULL,
	[goal8] [varchar](100) NULL,
	[goal8_score] [varchar](50) NULL,
	[goal8_range] [varchar](50) NULL,
	[study1] [varchar](50) NULL,
	[study1_projected] [varchar](50) NULL,
	[study2] [varchar](50) NULL,
	[study2_projected] [varchar](50) NULL,
	[study3] [varchar](50) NULL,
	[study3_projected] [varchar](50) NULL,
	[import_date] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[JWB_Measure_MAP]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------------------
-- JWB_Measure_MAP
-- 00:01:00
--          select count(*) from JWB_Measure_MAP
CREATE view [dbo].[JWB_Measure_MAP]
as
----------------------------------------------------------------
select
     cast(m.syear as varchar(4)) + '-' + cast(m.syear+1 as varchar(4)) as SchoolYear
    ,cast(m.syear as varchar(4)) as syear
    ,d.Stu_SIS_ID
    ,d.Stu_Local_ID
    ,d.Stu_State_ID
    ,d.LastName
    ,d.FirstName
    ,d.MiddleName
    ,d.BirthDate
    ,m.grade        as GradeLevel
    ,m.sch_state_id as SchoolNum
    ,h.SchoolName
    ,convert(varchar(20),m.test_date,101) as test_date
    ,m.discipline
    ,m.test
    ,m.score
    ,m.percentile

    ,m.FallToFallProjectedGrowth,     m.FallToFallObservedGrowth,     m.FallToFallMetProjectedGrowth,     m.FallToFallConditionalGrowthPercentile
    ,m.FallToWinterProjectedGrowth,   m.FallToWinterObservedGrowth,   m.FallToWinterMetProjectedGrowth,   m.FallToWinterConditionalGrowthPercentile
    ,m.FallToSpringProjectedGrowth,   m.FallToSpringObservedGrowth,   m.FallToSpringMetProjectedGrowth,   m.FallToSpringConditionalGrowthPercentile
    ,m.WinterToWinterProjectedGrowth, m.WinterToWinterObservedGrowth, m.WinterToWinterMetProjectedGrowth, m.WinterToWinterConditionalGrowthPercentile
    ,m.WinterToSpringProjectedGrowth, m.WinterToSpringObservedGrowth, m.WinterToSpringMetProjectedGrowth, m.WinterToSpringConditionalGrowthPercentile
    ,m.SpringToSpringProjectedGrowth, m.SpringToSpringObservedGrowth, m.SpringToSpringMetProjectedGrowth, m.SpringToSpringConditionalGrowthPercentile

    ,m.goal1, m.goal1_score, m.goal1_range
    ,m.goal2, m.goal2_score, m.goal2_range
    ,m.goal3, m.goal3_score, m.goal3_range
    ,m.goal4, m.goal4_score, m.goal4_range
    ,m.goal5, m.goal5_score, m.goal5_range
    ,m.goal6, m.goal6_score, m.goal6_range
    ,m.goal7, m.goal7_score, m.goal7_range
    ,m.goal8, m.goal8_score, m.goal8_range

    ,m.study1, m.study1_projected
    ,m.study2, m.study2_projected
    ,m.study3, m.study3_projected

    ,convert(varchar(20),m.import_date,101) as import_date

-- select top 10 * from map_scores
-- select top 10 * from map_tests
-- select top 10 * from map_data_summary
from JWB_Demographics   as d
join MAP_tests          as m on m.syear >= 2015 and cast(d.stu_SIS_id as numeric(18,0)) = m.stu_id and d.Stu_Local_ID <> 'Stu_Local_ID'
join JWB_Schools        as h on m.sch_state_id = h.SchoolNum


union all
select 'SchoolYear','syear','Stu_SIS_ID','Stu_Local_ID','Stu_State_ID','LastName','FirstName','MiddleName','BirthDate','GradeLevel','SchoolNum','SchoolName','test_date','discipline','test','score','percentile','FallToFallProjectedGrowth','FallToFallObservedGrowth','FallToFallMetProjectedGrowth','FallToFallConditionalGrowthPercentile','FallToWinterProjectedGrowth','FallToWinterObservedGrowth','FallToWinterMetProjectedGrowth','FallToWinterConditionalGrowthPercentile','FallToSpringProjectedGrowth','FallToSpringObservedGrowth','FallToSpringMetProjectedGrowth','FallToSpringConditionalGrowthPercentile','WinterToWinterProjectedGrowth','WinterToWinterObservedGrowth','WinterToWinterMetProjectedGrowth','WinterToWinterConditionalGrowthPercentile','WinterToSpringProjectedGrowth','WinterToSpringObservedGrowth','WinterToSpringMetProjectedGrowth','WinterToSpringConditionalGrowthPercentile','SpringToSpringProjectedGrowth','SpringToSpringObservedGrowth','SpringToSpringMetProjectedGrowth','SpringToSpringConditionalGrowthPercentile','goal1','goal1_score','goal1_range','goal2','goal2_score','goal2_range','goal3','goal3_score','goal3_range','goal4','goal4_score','goal4_range','goal5','goal5_score','goal5_range','goal6','goal6_score','goal6_range','goal7','goal7_score','goal7_range','goal8','goal8_score','goal8_range','study1','study1_projected','study2','study2_projected','study3','study3_projected','import_date'

GO
/****** Object:  Table [dbo].[FSA_history]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[FSA_history](
	[RecordNum] [numeric](18, 0) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[stu_local_id] [varchar](10) NULL,
	[most_recent_ela] [smallint] NULL,
	[most_recent_mth] [smallint] NULL,
	[AdmSchool] [varchar](10) NULL,
	[AdmGrade] [varchar](10) NULL,
	[Seq] [int] NULL,
	[syear] [int] NULL,
	[date] [date] NULL,
	[TestID] [varchar](50) NULL,
	[TestName] [varchar](100) NULL,
	[Subject] [varchar](50) NULL,
	[PartCode] [varchar](50) NULL,
	[PartSubjCode] [varchar](50) NULL,
	[PartName] [varchar](100) NULL,
	[Test_Form] [varchar](50) NULL,
	[Achievement_Level] [varchar](50) NULL,
	[Raw_Score] [varchar](50) NULL,
	[Scale_Score] [varchar](50) NULL,
	[EOC_Grade_Level] [varchar](50) NULL,
	[Pass_Fail] [varchar](50) NULL,
	[EOC_T_Score] [varchar](50) NULL,
	[Florida_Percentile] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[JWB_Measure_FSA]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------------------
-- JWB_Measure_FSA
-- 00:01:00
CREATE view [dbo].[JWB_Measure_FSA]
as
----------------------------------------------------------------
select
     cast(m.syear as varchar(4)) + '-' + cast(m.syear+1 as varchar(4)) as SchoolYear
    ,cast(m.syear as varchar(4)) as syear
    ,d.Stu_SIS_ID
    ,d.Stu_Local_ID
    ,d.Stu_State_ID
    ,d.LastName
    ,d.FirstName
    ,d.MiddleName
    ,d.BirthDate
    ,max(m.AdmGrade)    as GradeLevel
    ,m.AdmSchool        as SchoolNum
    ,h.SchoolName

    ,max(case when m.PartCode = 'RO' then m.Scale_Score         end) as FSA_ELA_Scale_Score
    ,max(case when m.PartCode = 'RO' then m.Achievement_Level   end) as FSA_ELA_Ach_Level
    ,max(case when m.PartCode = 'MO' then m.Scale_Score         end) as FSA_Math_Scale_Score
    ,max(case when m.PartCode = 'MO' then m.Achievement_Level   end) as FSA_Math_Ach_Level
    ,max(case when m.PartCode = '50' then m.Achievement_Level   end) as NGSSS_Sci_Ach_Level

    ,max(case when m.PartCode = 'E1' then m.Achievement_Level   end) as EOC_ALG1_Ach_Level
    ,max(case when m.PartCode = 'E2' then m.Achievement_Level   end) as EOC_ALG2_Ach_Level
    ,max(case when m.PartCode = 'E3' then m.Achievement_Level   end) as EOC_GEOM_Ach_Level
    ,max(case when m.PartCode = 'IV' then m.Achievement_Level   end) as EOC_CIV_Ach_Level
    ,max(case when m.PartCode = '27' then m.Achievement_Level   end) as EOC_USHIST_Ach_Level
    ,max(case when m.PartCode = 'YB' then m.Achievement_Level   end) as EOC_BIO_Ach_Level

from JWB_Demographics   as d
join fsa_history        as m on cast(d.stu_SIS_id as numeric(18,0)) = m.stu_id and d.Stu_Local_ID <> 'Stu_Local_ID'
join constants          as y on m.syear = y.syear and y.relative_year >= -3
join JWB_Schools        as h on m.AdmSchool = h.SchoolNum
group by m.syear, d.Stu_SIS_ID, d.Stu_Local_ID, d.Stu_State_ID, d.LastName, d.FirstName, d.MiddleName, d.BirthDate, m.AdmSchool, h.SchoolName

union all
select 'SchoolYear','syear','Stu_SIS_ID','Stu_Local_ID','Stu_State_ID','LastName','FirstName','MiddleName','BirthDate','GradeLevel','SchoolNum','SchoolName','FSA_ELA_Scale_Score','FSA_ELA_Ach_Level','FSA_Math_Scale_Score','FSA_Math_Ach_Level','NGSSS_Sci_Ach_Level','EOC_ALG1_Ach_Level','EOC_ALG2_Ach_Level','EOC_GEOM_Ach_Level','EOC_CIV_Ach_Level','EOC_USHIST_Ach_Level','EOC_BIO_Ach_Level'
GO
/****** Object:  View [dbo].[terms_employees]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- terms_employees view
CREATE view [dbo].[terms_employees]
AS
----------------------------------

    select
         emp_local_id       as employeeid
        ,emp_id             as staff_id
        ,SSN
        ,emp_username       as username
        ,last_name
        ,first_name
        ,LAST
        ,FIRST
        ,email
        ,birthdate
        ,gender
        ,job
        ,func
        ,proj
        ,pld
        ,job_pos_num
        ,location
        ,costcenter
        ,statejobcode
        ,pcsbjobcode
        ,jobtitle           as pcsbjobtitle
        ,slot
        ,contracttype
        ,persstat
        ,leave
        ,Account
    from DS_Users   as u
    where u.type = 'Employee'
GO
/****** Object:  Table [dbo].[Profile_Student_Grad_Courses]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Grad_Courses](
	[stu_id] [numeric](18, 0) NOT NULL,
	[course_code] [varchar](255) NOT NULL,
	[key_id] [varchar](255) NULL,
	[course_title] [varchar](255) NOT NULL,
	[teacher] [varchar](255) NULL,
	[mark] [varchar](10) NULL,
	[credatmpt] [float] NULL,
	[credearned] [float] NULL,
	[credreq] [float] NULL,
	[repeattag] [varchar](255) NULL,
	[grade] [varchar](255) NOT NULL,
	[syear] [numeric](18, 0) NOT NULL,
	[term] [varchar](255) NOT NULL,
	[distnum] [varchar](255) NULL,
	[statenum] [varchar](255) NULL,
	[school] [varchar](255) NULL,
	[subject_area] [varchar](255) NOT NULL,
	[online_course] [varchar](255) NULL,
	[curr_course] [int] NOT NULL,
	[ctae] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[BTC_GradCourses_Advanced]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[BTC_GradCourses_Advanced]
as 

select --cast(ROW_NUMBER()	over (order by p.stu_id) as varchar(50)) as Row_Id
	cast(p.key_id as varchar(20)) as U_id	
    ,cast(p.stu_id as varchar(50))			as stu_id
	,cast(ds.stu_username as varchar(10))	as stu_username
    ,cast(p.course_code as varchar(50))		as course_code
    ,case when rtrim(p.course_title) is not null then '"'+cast(p.course_title as varchar(50))+'"' end as course_title
    ,cast(p.mark as varchar(50))			as mark
    ,cast(p.credearned as varchar(50))		as credearned

from Profile_Student_Grad_Courses			as p
join DS_Students as ds on p.stu_id = ds.stu_id
where cast(p.stu_id as varchar(20)) in (select stu_id from BTC_Students)
and p.mark is not null
and (left(course_title,3) =  'AP '
or left(course_title,4) =  'AICE'
or left(course_title,3) =  'IB ')

UNION ALL select 'U_id', 'stu_id', 'stu_username', 'course_code', 'course_title', 'mark', 'credearned'
GO
/****** Object:  View [dbo].[HMH_class]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------
-- CLASS.csv
-- http://downloads.hmlt.hmco.com/Help/ImportMngmt/Administrator/SFF_Template_Files/CLASS_File.htm#Class_Name_Tips
-----------------------------
CREATE view [dbo].[HMH_class]
as
select
     'SCHOOLYEAR' as SCHOOLYEAR
    ,'CLASSLOCALID' as CLASSLOCALID
    ,'COURSEID' as COURSEID
    ,'COURSENAME' as COURSENAME
    ,'COURSESUBJECT' as COURSESUBJECT
    ,'CLASSNAME' as CLASSNAME
    ,'CLASSDESCRIPTION' as CLASSDESCRIPTION
    ,'CLASSPERIOD' as CLASSPERIOD
    ,'ORGANIZATIONTYPEID' as ORGANIZATIONTYPEID
    ,'ORGANIZATIONID' as ORGANIZATIONID
    ,'GRADE' as GRADE
    ,'TERMID' as TERMID
    ,'HMHAPPLICATIONS' as HMHAPPLICATIONS
UNION ALL
select distinct
     cast(c.syear+1 as varchar(10))         as SCHOOLYEAR
    ,cast(c.class_id as varchar(20))        as CLASSLOCALID
    ,c.course_num                           as COURSEID     
    ,replace(c.course,',','')               as COURSENAME        
    ,replace(c.subject_group,',','')        as COURSESUBJECT
    ,replace(upper(isnull(c.period,'')+isnull(' '+c.term,'')+isnull(' '+ltrim(rtrim(c.course)),'')+' '+cast(c.class_id as varchar(50)))+isnull(' '+a.v04,''),',','')    as CLASSNAME
    ,null                                   as CLASSDESCRIPTION
    ,c.period                               as CLASSPERIOD
    ,'MDR'                                  as ORGANIZATIONTYPEID
    ,o.v01                                  as ORGANIZATIONID
    ,case when isnumeric(c.avg_grade) = 1   then cast(cast(c.avg_grade as int) as varchar(10))
          when c.avg_grade = 'KG'           then 'K'
          else c.avg_grade
          end                               as GRADE
    ,c.term                                 as TERMID
    ,a.v02                                  as HMHAPPLICATIONS

-- select distinct c.school, c.course_long
-- select count(distinct s.stu_id)
from DS_Classes         as c
join DS_Students        as s on c.stu_id = s.stu_id
join DS_Users           as u on c.emp_id = u.emp_id
join DS_Apps_Options    as o on o.app_id = 10 and o.type = 'School' and c.sch_id = o.i01
join DS_Apps_Options    as a on a.app_id = 10 and a.type = 'Course' and c.course_num = a.v01 and case when a.i01 is not null then a.i01 else c.sch_id end = c.sch_id
where c.stu_username is not null
  and c.emp_local_id is not null
  and s.grade is not null
  and u.grades <> ''

GO
/****** Object:  View [dbo].[HMH_classassignment]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------
-- CLASSASSIGNMENTS.csv
-- http://downloads.hmlt.hmco.com/Help/ImportMngmt/Administrator/index.htm#t=SFF_Template_Files%2FCLASSASSIGNMENT_File.htm
-----------------------------
CREATE view [dbo].[HMH_classassignment]
as
select
     'SCHOOLYEAR' as SCHOOLYEAR
    ,'CLASSLOCALID' as CLASSLOCALID
    ,'LASID' as LASID
    ,'ROLE' as ROLE
    ,'POSITION' as POSITION

-- Students
UNION ALL

select distinct
     h.SCHOOLYEAR
    ,h.CLASSLOCALID
    ,cast(c.stu_id as varchar(20))              as LASID
    ,'S'                                        as ROLE
    ,null                                       as POSITION
from HMH_class      as h
join DS_Classes     as c on h.CLASSLOCALID = cast(c.class_id as varchar(20))
join DS_Students    as s on c.stu_id = s.stu_id
join DS_Users       as u on c.emp_id = u.emp_id
where s.grade is not null
  and c.stu_username is not null


-- Lead Teachers
UNION ALL 

select distinct
     h.SCHOOLYEAR
    ,h.CLASSLOCALID
    ,'e'+cast(c.emp_id as varchar(50))          as LASID        -- Local ID, cannot match any student_ids so prepend 'e'
    ,'T'                                        as ROLE
    ,'L'                                        as POSITION
from HMH_class      as h
join DS_Classes     as c on h.CLASSLOCALID = cast(c.class_id as varchar(20))
join DS_Students    as s on c.stu_id = s.stu_id
join DS_Users       as u on c.emp_id = u.emp_id
where s.grade is not null
  and c.stu_username is not null
GO
/****** Object:  View [dbo].[compasslearning_teacher_upload]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


-------------------------------------------------------------------------------------------------------------
CREATE VIEW [dbo].[compasslearning_teacher_upload]
AS

-- Teacher data
select 'User Name' as 'User Name', 'Password' as 'Password', 'First Name' as 'First Name', 'Middle Initial' as 'Middle Initial', 'Last Name' as 'Last Name', 'Grade' as 'Grade',
       'SIF Provided Teacher ID' as 'SIF Provided Teacher ID', 'My School' as 'My School', 'My District' as 'My District', 'Email' as 'Email',
       'School Custom Assessment Features' as 'School Custom Assessment Features', 'District Custom Assessment Features' as 'District Custom Assessment Features', 'Print Tests' as 'Print Tests', 'Scan Results' as 'Scan Results', 'School Odyssey Writer Project Permissions' as 'School Odyssey Writer Project Permissions', 'District Odyssey Writer Project Permissions' as 'District Odyssey Writer Project Permissions', 'Add Personal Information' as 'Add Personal Information', 'Edit Personal Information' as 'Edit Personal Information', 'View Student Attributes' as 'View Student Attributes', 'Edit Student Attributes' as 'Edit Student Attributes', 'Edit Student Subject Level Access' as 'Edit Student Subject Level Access', 'Delete Students' as 'Delete Students', 'Add Edit Class Information' as 'Add Edit Class Information', 'Add Edit Class Rosters' as 'Add Edit Class Rosters', 'Targeted Teacher' as 'Targeted Teacher', 'Associated Subjects' as 'Associated Subjects', 'Associated Grades' as 'Associated Grades',
       'Classes' as 'Classes', 'Account ID' as 'Account ID', 'Operation Type' as 'Operation Type'

UNION ALL

select username, password, firstname, mi, lastname, grade, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z, AA, classes, schoolnum, AD
from (
    select row_number () over (partition by s.username order by s.schoolnum) as seq,
           s.username, 'Pinellas13' as password, s.firstname, null as mi, s.lastname, cast(max(s.grade) as varchar(2)) as grade,
           null as G, null as H, null as I,
           s.email as J,
           null as K, null as L, null as M, null as N, null as O, null as P,
           'N' as Q, 'N' as R, 'Y' as S, 'N' as T, 'Y' as U, 'N' as V, 'N' as W, 'N' as X,
           null as Y, null as Z, null as AA,
           max(case when seq =  1 then     class else '' end) +
           max(case when seq =  2 then ';'+class else '' end) +
           max(case when seq =  3 then ';'+class else '' end) +
           max(case when seq =  4 then ';'+class else '' end) +
           max(case when seq =  5 then ';'+class else '' end) +
           max(case when seq =  6 then ';'+class else '' end) +
           max(case when seq =  7 then ';'+class else '' end) +
           max(case when seq =  8 then ';'+class else '' end) +
           max(case when seq =  9 then ';'+class else '' end) +
           max(case when seq = 10 then ';'+class else '' end) +
           max(case when seq = 11 then ';'+class else '' end) +
           max(case when seq = 12 then ';'+class else '' end) +
           max(case when seq = 13 then ';'+class else '' end) +
           max(case when seq = 14 then ';'+class else '' end) +
           max(case when seq = 15 then ';'+class else '' end) +
           max(case when seq = 16 then ';'+class else '' end) as classes,
           cast(s.schoolnum as varchar(8)) as schoolnum,
           null as AD

    from (
    SELECT cast(sch.statenum as int) as schoolnum, tch.staff_id, tch.username, tch.first_name as firstname, tch.last_name as lastname,
           max(cast(ss.grade as int)) as grade, tch.email,
           row_number () over (partition by sch.statenum, tch.staff_id order by ss.termcode, ss.period, ss.coursetitle) as seq, 
           replace(replace(isnull(ss.termcode+' (','')+ss.period+') '+rtrim(ss.coursetitle)+' ('+upper(tch.username)+')',',','_'),';','_') as class
    from focus_student_schedule as ss
    join focus_users            as tch on ss.teacher_id = tch.staff_id
    join focus_schools          as sch on ss.school_id = sch.school_id
    where ss.school_id in (3,66,97)        -- Specific schools
      and ss.grade in ('06','07','08','09','10','11','12') -- middle and high school
      and left(ss.coursenum,2) in ('12','20') -- only math and science classes
      and tch.username is not null
    group by sch.statenum, tch.staff_id, tch.username, tch.first_name, tch.last_name, tch.email, ss.termcode, ss.period, ss.coursetitle
    ) as s
    where s.email is not null
    group by schoolnum, username, firstname, lastname, email
) as t where seq=1

GO
/****** Object:  View [dbo].[BTC_GradCourses]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[BTC_GradCourses]
as 

select
     cast(p.stu_id as varchar(50))    as stu_id
	,cast(ds.stu_username as varchar(10)) as stu_username
    ,cast(p.course_code as varchar(50))    as course_code
    ,cast(p.key_id as varchar(50))    as U_id
    ,case when rtrim(p.course_title) is not null then '"'+cast(p.course_title as varchar(50))+'"' end as course_title
    ,case when p.teacher <> '' then '"'+cast(p.teacher as varchar(50))+'"' end as teacher
    ,cast(p.mark as varchar(50))    as mark
    ,cast(p.credatmpt as varchar(50))    as credatmpt
    ,cast(p.credearned as varchar(50))    as credearned
    ,case when p.repeattag = '' then null else cast(p.repeattag as varchar(50)) end as repeattag
    ,cast(p.grade as varchar(50))    as grade
    ,cast(p.syear as varchar(50))    as syear
    ,cast(p.term as varchar(50))    as term
    ,cast(p.distnum as varchar(50))    as distnum
    ,cast(p.statenum as varchar(50))    as statenum
    ,cast(p.school as varchar(50))    as school
    ,cast(p.subject_area as varchar(50))    as subject_area
    ,cast(p.online_course as varchar(50))    as online_course
    ,cast(p.curr_course as varchar(50))    as curr_course

from Profile_Student_Grad_Courses   as p
join DS_Students as ds on p.stu_id = ds.stu_id
where cast(p.stu_id as varchar(20)) in (select stu_id from BTC_Students)

UNION ALL select 'stu_id', 'stu_username', 'course_code', 'U_id', 'course_title', 'teacher', 'mark', 'credatmpt', 'credearned', 'repeattag', 'grade', 'syear', 'term', 'distnum', 'statenum', 'school', 'subject_area', 'online_course', 'curr_course'

GO
/****** Object:  Table [dbo].[Profile_Student_Grad_Assessments]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Grad_Assessments](
	[stu_id] [numeric](18, 0) NOT NULL,
	[test_id] [numeric](18, 0) NOT NULL,
	[test_title] [varchar](100) NOT NULL,
	[part_id] [numeric](18, 0) NOT NULL,
	[part_title] [varchar](100) NOT NULL,
	[score] [float] NULL,
	[test_code] [varchar](50) NULL,
	[administration_date] [date] NULL,
	[gradelevel] [varchar](10) NULL,
	[syear] [numeric](4, 0) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[BTC_GradAssessments]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[BTC_GradAssessments]
as

select 
	 cast(p.stu_id as varchar(20)) + '.' +cast(test_id as varchar(20)) + '.' + cast(part_id as varchar(20)) + '.'+cast(administration_date as varchar(20)) as U_id
    ,cast(p.stu_id as varchar(20))    as stu_id
	,cast(ds.stu_username as varchar(10)) as stu_username
    ,cast(test_id as varchar(20))    as test_id
    ,''''+cast(test_title as varchar(250))+''''    as test_title
    ,cast(part_id as varchar(20))    as part_id
    ,''''+cast(part_title as varchar(50))+''''    as part_title
    ,cast(score as varchar(10))    as score
    --,cast(test_code as varchar(20))    as test_code
    ,convert(varchar(20), administration_date, 101)    as administration_date
    ,cast(gradelevel as varchar(10))    as gradelevel
    ,cast(syear as varchar(10))    as syear

from Profile_Student_Grad_Assessments   as p
join DS_Students as ds on p.stu_id = ds.stu_id
where cast(p.stu_id as varchar(20)) in (select stu_id from BTC_Students)
and administration_date is not null

UNION ALL select 'U_id','stu_id', 'stu_username', 'test_id', 'test_title', 'part_id', 'part_title', 'score', 'administration_date', 'gradelevel', 'syear'
GO
/****** Object:  View [dbo].[HMH_users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------
-- Users
-- http://downloads.hmlt.hmco.com/Help/ImportMngmt/Administrator/index.htm#t=SFF_Template_Files%2FUSERS_File.htm
-----------------------------

CREATE view [dbo].[HMH_users]
as
select
     'SCHOOLYEAR' as SCHOOLYEAR
    ,'ROLE' as ROLE
    ,'LASID' as LASID
    ,'SASID' as SASID
    ,'FIRSTNAME' as FIRSTNAME
    ,'MIDDLENAME' as MIDDLENAME
    ,'LASTNAME' as LASTNAME
    ,'GRADE' as GRADE
    ,'USERNAME' as USERNAME
    ,'PASSWORD' as PASSWORD
    ,'ORGANIZATIONTYPEID' as ORGANIZATIONTYPEID
    ,'ORGANIZATIONID' as ORGANIZATIONID
    ,'PRIMARYEMAIL' as PRIMARYEMAIL
    ,'HMHAPPLICATIONS' as HMHAPPLICATIONS

-- Students
UNION ALL

select distinct
     cast(c.syear+1 as varchar(10))             as SCHOOLYEAR
    ,'S'                                        as ROLE         -- S for students, T for teachers
    ,cast(s.stu_id as varchar(30))              as LASID        -- Local ID, cannot match any staff_ids
    ,s.stu_local_id                             as SASID        -- State ID, not needed for teachers
    ,replace(s.first_name,',','')               as FIRSTNAME
    ,nullif(replace(s.middle_name,',',''),'')   as MIDDLENAME
    ,replace(s.last_name,',','')                as LASTNAME
    ,case when isnumeric(s.grade) = 1   then cast(cast(s.grade as int) as varchar(10))
          when s.grade = 'KG'           then 'K'
          else nullif(s.grade,'')
          end                                   as GRADE
    ,case when t.seq = 1 then c.stu_username+'@pcsb.org'
          else c.stu_username+'.'+c.sch_state_id+'@pcsb.org'
          end                                   as USERNAME
    ,null                                       as PASSWORD             -- Leave blank for SSO
    ,'MDR'                                      as ORGANIZATIONTYPEID
    ,t.ORGANIZATIONID                           as ORGANIZATIONID       -- Only the primary school
    ,null                                       as PRIMARYEMAIL         -- Leave blank for students
    ,g.v02                                      as HMHAPPLICATIONS

--select top 100 *
-- select count(distinct s.stu_id)
-- select distinct o.i01
from HMH_class      as h
join DS_Classes     as c on h.CLASSLOCALID = cast(c.class_id as varchar(20))
join DS_Students    as s on c.stu_id = s.stu_id
join DS_Users       as u on c.emp_id = u.emp_id
join ( -- Rank each students' schools by most HMH classes.
        select row_number() over (partition by c.stu_id order by count(distinct c.class_id) desc, c.sch_state_id) as seq
               ,c.stu_id
               ,c.sch_id
               ,c.sch_state_id
               ,h.ORGANIZATIONID
               ,count(distinct c.class_id) as cls
        -- select *
        from HMH_class      as h
        join DS_Classes     as c on h.CLASSLOCALID = cast(c.class_id as varchar(20))
        where c.stu_username is not null
        group by c.syear, c.stu_id, c.sch_id, c.sch_state_id, h.ORGANIZATIONID
) as t on c.stu_id = t.stu_id and c.sch_id = t.sch_id
join DS_Apps_Options    as g on g.app_id = 10 and g.type = 'Grade'  and s.grade = g.v01
where s.grade is not null
  and c.stu_username is not null



-- Teachers
UNION ALL

select distinct
     cast(c.syear+1 as varchar(10))     as SCHOOLYEAR
    ,'T'                                as ROLE         -- S for students, T for teachers
    ,'e'+cast(c.emp_id as varchar(50))  as LASID        -- Local ID, cannot match any student_ids so prepend 'e'
    ,null                               as SASID        -- State ID, not needed for teachers
    ,replace(u.first_name,',','')       as FIRSTNAME
    ,null                               as MIDDLENAME
    ,replace(u.last_name,',','')        as LASTNAME
    ,nullif(case when u.grades in ('6','7','8','6-7','7-8') then '6-8'
                 when u.grades in ('K','1','2','3','4','5') then 'K-5'
                 when right(u.grades,2) in ('-K','-1','-2','-3','-4','-5')  then 'K-5'
                 when left(u.grades,2) in ('7-','8-')       then stuff(u.grades,1,2,'6-')
                 else replace(u.grades, 'P','PK')     end,'')       as GRADE
    ,case when t.seq = 1 then c.emp_username+'@pcsb.org'
          else c.emp_username+'.'+c.sch_state_id+'@pcsb.org'
          end                           as USERNAME
    ,null                               as PASSWORD
    ,'MDR'                              as ORGANIZATIONTYPEID
    ,t.ORGANIZATIONID                   as ORGANIZATIONID
    ,u.email                            as PRIMARYEMAIL
    ,replace(rtrim( case when t.Elementary > 0 or t.middle > 0  then 'TC '   else '' end    -- Elem and Middle teachers get TC
                   +                                                 'HMO '                 -- All teachers get HMO
                   +case when t.High       > 0                  then 'ED'    else '' end)   -- High teachers get ED
         ,' ', '.')                     as HMHAPPLICATIONS
--select top 100 *
from HMH_class      as h
join DS_Classes     as c on h.CLASSLOCALID = cast(c.class_id as varchar(20))
join DS_Students    as s on c.stu_id = s.stu_id
join DS_Users       as u on c.emp_id = u.emp_id
join ( -- Rank each teachers' schools by most HMH students.
            select row_number() over (partition by c.emp_id order by count(distinct c.stu_id) desc, c.sch_state_id) as seq
                   ,c.emp_id
                   ,c.sch_id
                   ,c.sch_state_id
                   ,h.ORGANIZATIONID
                   ,count(distinct c.stu_id) as students
                   ,sum(case when s.grade in ('PK','KG','01','02','03','04','05') then 1 else 0 end) as Elementary
                   ,sum(case when s.grade in ('06','07','08')                     then 1 else 0 end) as Middle
                   ,sum(case when s.grade in ('09','10','11','12')                then 1 else 0 end) as High
            -- select *
            from HMH_class      as h
            join DS_Classes     as c on h.CLASSLOCALID = cast(c.class_id as varchar(20))
            join DS_Students    as s on c.stu_id = s.stu_id
            where c.stu_username is not null
            group by c.emp_id, c.sch_id, c.sch_state_id, h.ORGANIZATIONID
) as t on c.emp_id = t.emp_id and c.sch_id = t.sch_id
where s.grade is not null
  and c.stu_username is not null


GO
/****** Object:  Table [dbo].[work_adobe_import]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[work_adobe_import](
	[type] [varchar](8000) NULL,
	[username] [varchar](8000) NULL,
	[domain] [varchar](8000) NULL,
	[email] [varchar](8000) NULL,
	[firstname] [varchar](8000) NULL,
	[lastname] [varchar](800) NULL,
	[country] [varchar](800) NULL,
	[product] [varchar](800) NULL,
	[roles] [varchar](800) NULL,
	[config] [varchar](800) NULL,
	[f11] [varchar](800) NULL,
	[f12] [varchar](800) NULL,
	[f13] [varchar](800) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[adobe_users_add]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------
-- adobe_users_add view
----------------------------------------------------
-- Groups are assigned based upon course_num from the DS_Apps_Options table
-- select * from adobe_users

create view [dbo].[adobe_users_add]
as

select 'Identity Type' as [Identity Type], 'Username' as [Username], 'Domain' as [Domain], 'Email' as [Email], 'First Name'as [First Name], 'Last Name' as [Last Name], 'Country Code' as [Country Code], 'User Groups' as [User Groups]

UNION ALL

select
     'Federated ID'                         as [Identity Type]
    ,username+'@pcsb.org'                   as [Username]
    ,'pcsb.org'                             as [Domain]
    ,username+'@pcsb.org'                   as [Email]
    ,firstname                              as [First Name]
    ,lastname                               as [Last Name]
    ,'US'                                   as [Country Code]
    ,'"'+left(groups,len(groups)-1)+'"'                         as [User Groups]
from (
        -- Students
        select
             c.stu_username     as username
            ,c.stu_firstname    as firstname
            ,c.stu_lastname     as lastname
            ,   max(case when oc.v03 = 'Art'         then 'Art,'         else '' end)
               +max(case when oc.v03 = 'Business Ed' then 'Business Ed,' else '' end)
               +max(case when oc.v03 = 'Tech Ed'     then 'Tech Ed,'     else '' end)
               as groups
        -- select *
        from DS_Classes         as c
        join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('T','W')
        join DS_Apps_Options    as oc on oc.app_id = 21 and oc.type = 'Courses' and c.course_num = oc.v01
        where c.stu_username is not null
          and getdate() between c.stu_start_date and c.stu_end_date
          and c.stu_username+'@pcsb.org' not in (select username from work_adobe_import)
        group by c.stu_username, c.stu_firstname, c.stu_lastname

        -- Teachers
        UNION ALL
        select
             c.emp_username     as username
            ,c.emp_firstname    as firstname
            ,c.emp_lastname     as lastname
            ,   max(case when oc.v03 = 'Art'         then 'Art,'         else '' end)
               +max(case when oc.v03 = 'Business Ed' then 'Business Ed,' else '' end)
               +max(case when oc.v03 = 'Tech Ed'     then 'Tech Ed,'     else '' end)
               as groups
        -- select *
        -- select distinct emp_username
        from DS_Classes         as c
        join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('T','W')
        join DS_Apps_Options    as oc on oc.app_id = 21 and oc.type = 'Courses' and c.course_num = oc.v01
        where c.emp_username is not null and c.emp_lastname <> 'TBA'
          and getdate() between c.start_date and c.end_date
          and c.emp_username+'@pcsb.org' not in (select username from work_adobe_import)
        group by c.emp_username, c.emp_firstname, c.emp_lastname

) as t

GO
/****** Object:  Table [dbo].[DS_Admins]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Admins](
	[type] [varchar](20) NULL,
	[location] [nvarchar](10) NULL,
	[location_name] [nvarchar](100) NULL,
	[sch_id] [int] NULL,
	[emp_id] [int] NOT NULL,
	[emp_local_id] [int] NULL,
	[emp_state_id] [nvarchar](50) NULL,
	[emp_username] [nvarchar](100) NOT NULL,
	[email] [nvarchar](100) NULL,
	[first_name] [nvarchar](100) NULL,
	[middle_name] [nvarchar](100) NULL,
	[last_name] [nvarchar](100) NULL,
	[pld] [nvarchar](10) NULL,
	[statejobcode] [nvarchar](10) NULL,
	[pcsbjobcode] [nvarchar](10) NULL,
	[jobtitle] [nvarchar](100) NULL,
	[admin_title] [nvarchar](500) NULL,
	[clever_role] [nvarchar](500) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[radix_Staff]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
---------------------------------------------
-- Staff.csv
--
CREATE view [dbo].[radix_Staff]
as      
---------------------------------------------
select distinct
     cast(u.emp_local_id as varchar(20)) as StaffNumber
    ,h.sch_state_id     as SchoolCode
    ,u.first_name       as FirstName
    ,u.middle_name      as MiddleName
    ,u.last_name        as LastName
    ,u.email            as Email
    ,case when u.students > 0            then 'Teacher'
          when u.instructional = 'Y'     then 'Teacher'
          when u.jobtitle like '%TEACH%' then 'Teacher'
                                         else 'Staff'   end as Role
    ,dbo.SingleSpace(u.jobtitle)  as PersonnelType
    ,cast(h.syear as varchar(20)) as SchoolYear
-- select *
from DS_Users   as u
join DS_Admins  as a on u.emp_id = a.emp_id
join DS_Schools as h on h.sch_id = 415
where u.location = '7331'
   or u.emp_id in (select emp_id from DS_Classes where sch_id = 415)

UNION ALL select 'StaffNumber','SchoolCode','FirstName','MiddleName','LastName','Email','Role','PersonnelType','SchoolYear'
GO
/****** Object:  View [dbo].[Clever7171_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7171_students
-- 00:00:30
-----------------------
create view [dbo].[Clever7171_students]
as
select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
       'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
       'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
       'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
       'Student_zip' as Student_zip, 'Student_email' as Student_email,
       'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
       'Username' as Username, 'Password' as Password

UNION ALL

select distinct
         ss.sch_state_id                        as School_id
        ,cast(stu.stu_id as varchar(30))        as Student_id
        ,stu.stu_local_id                       as Student_number
        ,stu.stu_state_id                       as State_id
        ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
        ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
        ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
        ,left(right(stu.GENDER,2),1)            as GENDER
        ,convert(varchar(10),stu.birthdate,101) as DOB
        ,stu.grade                              as Grade
        ,stu.race                               as Race
        ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
        ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
        ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
              when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
        ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
        ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
        ,stu.stu_username + '@pcsb.org'         as Student_email
        ,'"'+Contact_relationship+'"'           as Contact_relationship
        ,'"'+Contact_type+'"'                   as Contact_type
        ,'"'+Contact_name+'"'                   as Contact_name
        ,'"'+Contact_phone+'"'                  as Contact_phone
        ,'"'+Contact_email+'"'                  as Contact_email
        ,stu.stu_username                       as Username
        ,'s.'+right(stu.stu_local_id,8)         as Password
-- select count(*)
from DS_Classes         as ss
join Clever7171_schools as h   on ss.sch_state_id = h.School_id
join DS_Students        as stu on ss.stu_id = stu.stu_id
left join (
    select stu_id
          ,cont1_type                                                         as Contact_relationship
          ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                when cont1_emer             = 'Y'  then 'Emergency'
                when cont1_cstdy            = 'Y'  then 'Custody'
                                                   else 'Unknown' end               as Contact_type
          ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
          ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
          ,dbo.CleanEmail(cont1_email)       as Contact_email
    from DS_Students as s
    where s.cont1_type is not null
) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
where stu.stu_username is not null


GO
/****** Object:  View [dbo].[adobe_users_edit]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------
-- adobe_users_edit view
-- Step 3: Edit existing users that are missing product association
----------------------------------------------------
-- Groups are assigned based upon course_num from the DS_Apps_Options table
-- select * from adobe_users

CREATE view [dbo].[adobe_users_edit]
as

select 'Identity Type' as [Identity Type], 'Username' as [Username], 'Domain' as [Domain], 'Email' as [Email], 'First Name'as [First Name], 'Last Name' as [Last Name], 'Country Code' as [Country Code], 'User Groups' as [User Groups]

UNION ALL

select
     'Federated ID'                         as [Identity Type]
    ,username+'@pcsb.org'                   as [Username]
    ,'pcsb.org'                             as [Domain]
    ,username+'@pcsb.org'                   as [Email]
    ,firstname                              as [First Name]
    ,lastname                               as [Last Name]
    ,'US'                                   as [Country Code]
    ,'"'+left(groups,len(groups)-1)+'"'                         as [User Groups]
from (
        -- Students
        select
             c.stu_username     as username
            ,c.stu_firstname    as firstname
            ,c.stu_lastname     as lastname
            ,   max(case when oc.v03 = 'Art'         then 'Art,'         else '' end)
               +max(case when oc.v03 = 'Business Ed' then 'Business Ed,' else '' end)
               +max(case when oc.v03 = 'Tech Ed'     then 'Tech Ed,'     else '' end)
               as groups
        -- select *
        from DS_Classes         as c
        join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('T','W')
        join DS_Apps_Options    as oc on oc.app_id = 21 and oc.type = 'Courses' and c.course_num = oc.v01
        where c.stu_username is not null
          and getdate() between c.stu_start_date and c.stu_end_date
          and c.stu_username+'@pcsb.org' in (select username from work_adobe_import where product is null and roles is null)
        group by c.stu_username, c.stu_firstname, c.stu_lastname

        -- Teachers
        UNION ALL
        select
             c.emp_username     as username
            ,c.emp_firstname    as firstname
            ,c.emp_lastname     as lastname
            ,   max(case when oc.v03 = 'Art'         then 'Art,'         else '' end)
               +max(case when oc.v03 = 'Business Ed' then 'Business Ed,' else '' end)
               +max(case when oc.v03 = 'Tech Ed'     then 'Tech Ed,'     else '' end)
               as groups
        -- select *
        -- select distinct emp_username
        from DS_Classes         as c
        join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('T','W')
        join DS_Apps_Options    as oc on oc.app_id = 21 and oc.type = 'Courses' and c.course_num = oc.v01
        where c.emp_username is not null and c.emp_lastname <> 'TBA'
          and getdate() between c.start_date and c.end_date
          and c.emp_username+'@pcsb.org' in (select username from work_adobe_import where product is null and roles is null)
        group by c.emp_username, c.emp_firstname, c.emp_lastname

) as t

GO
/****** Object:  View [dbo].[adobe_users_remove]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------
-- adobe_users_remove view
-- Step 1: Remove users first to ensure there are enough licenses to cover new users
----------------------------------------------------
-- Groups are assigned based upon course_num from the DS_Apps_Options table
-- select * from adobe_users

CREATE view [dbo].[adobe_users_remove]
as

select 'Identity Type' as [Identity Type], 'Username' as [Username], 'Domain' as [Domain], 'Email' as [Email], 'First Name'as [First Name], 'Last Name' as [Last Name], 'Country Code' as [Country Code], 'User Groups' as [User Groups]

UNION ALL

select
     'Federated ID'                         as [Identity Type]
    ,i.username                             as [Username]
    ,'pcsb.org'                             as [Domain]
    ,i.email                                as [Email]
    ,i.firstname                            as [First Name]
    ,i.lastname                             as [Last Name]
    ,'US'                                   as [Country Code]
    ,null                                   as [User Groups]
from work_adobe_import  as i
left join (
        -- Students
        select
             c.stu_username     as username
            ,c.stu_firstname    as firstname
            ,c.stu_lastname     as lastname
            ,   max(case when oc.v03 = 'Art'         then 'Art,'         else '' end)
               +max(case when oc.v03 = 'Business Ed' then 'Business Ed,' else '' end)
               +max(case when oc.v03 = 'Tech Ed'     then 'Tech Ed,'     else '' end)
               as groups
        -- select *
        from DS_Classes         as c
        join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('T','W')
        join DS_Apps_Options    as oc on oc.app_id = 21 and oc.type = 'Courses' and c.course_num = oc.v01
        where c.stu_username is not null
          and getdate() between c.stu_start_date and c.stu_end_date
        group by c.stu_username, c.stu_firstname, c.stu_lastname

        -- Teachers
        UNION ALL
        select
             c.emp_username     as username
            ,c.emp_firstname    as firstname
            ,c.emp_lastname     as lastname
            ,   max(case when oc.v03 = 'Art'         then 'Art,'         else '' end)
               +max(case when oc.v03 = 'Business Ed' then 'Business Ed,' else '' end)
               +max(case when oc.v03 = 'Tech Ed'     then 'Tech Ed,'     else '' end)
               as groups
        -- select *
        -- select distinct emp_username
        from DS_Classes         as c
        join DS_Schools         as h on c.sch_id = h.sch_id and left(category,1) not in ('T','W')
        join DS_Apps_Options    as oc on oc.app_id = 21 and oc.type = 'Courses' and c.course_num = oc.v01
        where c.emp_username is not null and c.emp_lastname <> 'TBA'
          and getdate() between c.start_date and c.end_date
        group by c.emp_username, c.emp_firstname, c.emp_lastname

) as t on i.username = t.username+'@pcsb.org'
where t.username is null
  and i.roles is null
GO
/****** Object:  View [dbo].[NWEA_Programs]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------------
-- NWEA Programs File
-----------------------------------------------
CREATE view [dbo].[NWEA_Programs]
as

-- Header row
select
       'Student ID'     as [Student ID]
      ,'Program Name'   as [Program Name]

UNION ALL

select distinct * from (

        -- ELL students
        select distinct
             cast(s.stu_id as varchar(20))      as [Student ID]
            ,'English Language Learner (ELL)'   as [Program Name]
        from DS_Classes       as c
        join DS_Students      as s on c.stu_id = s.stu_id
        where dbo.GetCodeFromBrackets(ell_status) in ('LY','LF')
          and c.subject_group in ('math','science','english language arts')

        -- SWD students
        UNION ALL
        select distinct
             cast(s.stu_id as varchar(20))      as [Student ID]
            ,'Students with Disabilities (SWD)' as [Program Name]
        from DS_Classes       as c
        join DS_Students      as s on c.stu_id = s.stu_id
        where left(primary_exc,1) <> 'L'
          and c.subject_group in ('math','science','english language arts')

        -- Gifted Students
        UNION ALL
        select distinct
             cast(s.stu_id as varchar(20))  as [Student ID]
            ,'Gifted'                       as [Program Name]
        from DS_Classes       as c
        join DS_Students      as s on c.stu_id = s.stu_id
        where left(primary_exc,1) = 'L'
          and c.subject_group in ('math','science','english language arts')

) as t
where [Student ID] <> 'Student ID'
  and t.[Student ID] in (select [Student ID] from NWEA_Students)

GO
/****** Object:  Table [dbo].[Adult_Classes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Adult_Classes](
	[schedule_id] [numeric](18, 0) NOT NULL,
	[syear] [numeric](18, 0) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[sch_state_id] [varchar](4) NULL,
	[school] [varchar](100) NULL,
	[emp_id] [numeric](18, 0) NULL,
	[emp_local_id] [numeric](18, 0) NULL,
	[emp_username] [varchar](100) NULL,
	[emp_lastname] [varchar](100) NULL,
	[emp_firstname] [varchar](100) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[stu_local_id] [varchar](255) NULL,
	[stu_username] [varchar](100) NULL,
	[stu_lastname] [varchar](100) NULL,
	[stu_firstname] [varchar](100) NULL,
	[class_id] [numeric](18, 0) NULL,
	[course_id] [numeric](18, 0) NULL,
	[course_num_sch] [varchar](20) NULL,
	[course_num] [varchar](10) NULL,
	[course_weight] [varchar](10) NULL,
	[course_short] [varchar](100) NULL,
	[course] [varchar](100) NULL,
	[course_long] [varchar](265) NULL,
	[subject_area] [varchar](10) NULL,
	[subject_group] [varchar](100) NULL,
	[subject] [varchar](100) NULL,
	[marking_period_id] [numeric](18, 0) NULL,
	[term] [varchar](10) NULL,
	[start_date] [datetime] NULL,
	[end_date] [datetime] NULL,
	[stu_start_date] [datetime] NULL,
	[stu_end_date] [datetime] NULL,
	[days] [varchar](10) NULL,
	[period] [varchar](10) NULL,
	[room] [varchar](20) NULL,
	[display_room] [varchar](20) NULL,
	[total_seats] [numeric](18, 0) NULL,
	[filled_seats] [numeric](18, 0) NULL,
	[avg_grade] [varchar](10) NULL,
	[ELL_model] [varchar](255) NULL,
	[read_interv] [varchar](255) NULL,
	[online_course] [varchar](10) NULL,
	[VAM_course] [varchar](1) NULL,
	[does_grades] [varchar](10) NULL,
	[emp2_id] [numeric](18, 0) NULL,
	[emp2_local_id] [numeric](18, 0) NULL,
	[emp2_username] [varchar](100) NULL,
	[emp3_id] [numeric](18, 0) NULL,
	[emp3_local_id] [numeric](18, 0) NULL,
	[emp3_username] [varchar](100) NULL,
	[emp4_id] [numeric](18, 0) NULL,
	[emp4_local_id] [numeric](18, 0) NULL,
	[emp4_username] [varchar](100) NULL,
	[emp5_id] [numeric](18, 0) NULL,
	[emp5_local_id] [numeric](18, 0) NULL,
	[emp5_username] [varchar](100) NULL,
	[emp6_id] [numeric](18, 0) NULL,
	[emp6_local_id] [numeric](18, 0) NULL,
	[emp6_username] [varchar](100) NULL,
	[emp7_id] [numeric](18, 0) NULL,
	[emp7_local_id] [numeric](18, 0) NULL,
	[emp7_username] [varchar](100) NULL,
	[emp8_id] [numeric](18, 0) NULL,
	[emp8_local_id] [numeric](18, 0) NULL,
	[emp8_username] [varchar](100) NULL,
	[gradebook_term] [varchar](10) NULL,
	[gradebook_grade] [numeric](18, 4) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Adult_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Adult_Students](
	[sch_id] [bigint] NULL,
	[sch_state_id] [nvarchar](4) NULL,
	[school] [nvarchar](50) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[stu_local_id] [varchar](255) NULL,
	[stu_username] [varchar](100) NULL,
	[last_name] [varchar](255) NULL,
	[first_name] [varchar](255) NULL,
	[grade] [varchar](2) NULL,
	[birthdate] [date] NULL,
	[age] [int] NULL,
	[gender] [nvarchar](50) NULL,
	[local_ethnic_code] [nvarchar](10) NULL,
	[address] [varchar](255) NULL,
	[address_2] [varchar](100) NULL,
	[city] [varchar](60) NULL,
	[state] [varchar](10) NULL,
	[zip] [varchar](10) NULL,
	[phone] [varchar](30) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[Adult_Student_Schedule]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
------------------------------------------------
create view [dbo].[Adult_Student_Schedule]
as
------------------------------------------------
select
         c.schedule_id
        ,c.syear
        ,c.sch_id           as school_id
        ,c.sch_state_id     as schoolnum
        ,c.stu_id           as student_id
        ,c.stu_local_id     as permnum
        ,c.stu_lastname     as lastname
        ,c.stu_firstname    as firstname
        ,s.grade          
        ,''                 as status
        ,c.term             as termcode
        ,c.class_id         as course_period_id
        ,c.marking_period_id
        ,c.ELL_model
        ,c.period
        ,c.course           as coursetitle
        ,c.course_num       as coursenum
        ,c.course_weight
        ,c.room
        ,c.emp_id           as teacher_id
        ,c.emp_username     as username
        ,c.emp_lastname     as tch_lastname
        ,c.emp_firstname    as tch_firstname
        ,c.emp_firstname+' '+c.emp_lastname as tch_name
        ,c.stu_start_date   as start_date
        ,c.stu_end_date     as end_date

from Adult_Classes     as c
join Adult_Students    as s on c.stu_id = s.stu_id

GO
/****** Object:  View [dbo].[NWEA_Programs_Roster]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------
-- NWEA Student Roster
--      Needed in order to upload the programs. Only need to include students in the programs file.
----------------------------------------
create view [dbo].[NWEA_Programs_Roster]
as

select 
		 'School State Code'            as 'School State Code'
        ,'School Name'					as 'School Name'
		,'Previous Instructor ID'		as 'Previous Instructor ID'
		,'Instructor ID'				as 'Instructor ID'
        ,'Instructor State ID'          as 'Instructor State ID'
		,'Instructor Last Name'			as 'Instructor Last Name'
		,'Instructor First Name'		as 'Instructor First Name'
		,'Instructor Middle Initial'	as 'Instructor Middle Initial'
		,'User Name'					as 'User Name'
		,'Email Address'				as 'Email Address'
		,'Class Name'					as 'Class Name'
		,'Previous Student ID'			as 'Previous Student ID'
		,'Student ID'					as 'Student ID'
        ,'Student State ID'             as 'Student State ID'
		,'Student Last Name'			as 'Student Last Name'
		,'Student First Name'			as 'Student First Name'
		,'Student Middle Initial'		as 'Student Middle Initial'
		,'Student Date of Birth'		as 'Student Date of Birth'
		,'Student Gender'				as 'Student Gender'
		,'Student Grade'				as 'Student Grade'
		,'Student Ethnic Group Name'	as 'Student Ethnic Group Name'

UNION ALL
SELECT 
		 c.sch_state_id                                             as 'School State Code'
        ,c.school													as 'School Name'
		,convert(varchar(100),null)									as 'Previous Instructor ID'
		,'T'+convert(varchar(100),c.emp_id)  					    as 'Instructor ID'
        ,null                                                       as 'Instructor State ID'
		,c.emp_lastname												as 'Instructor Last Name'
		,c.emp_firstname											as 'Instructor First Name'
		,convert(varchar(1),null)									as 'Instructor Middle Initial'
		,c.emp_username+'@pcsb.org'         						as 'User Name'
		,c.emp_username+'@pcsb.org'								    as 'Email Address'
		,replace(c.course_long,',',' ')							    as 'Class Name'
		,convert(varchar(100),null)									as 'Previous Student ID'
		,convert(varchar(100),s.stu_id)								as 'Student ID'
        ,null                                                       as 'Student State ID'
		,s.last_name												as 'Student Last Name'
		,s.first_name												as 'Student First Name'
		,LEFT(s.middle_name,1)										as 'Student Middle Initial'
		,convert(varchar(10),s.birthdate,101)						as 'Student Date of Birth'
		,case when s.gender = 'Female [F]' then 'F' else 'M' end	as 'Student Gender'
		,case 
				when isnumeric(s.grade) = 1 then CAST(convert(numeric,s.grade) as varchar(2))
				when s.grade = 'KG' then 'K'
				else s.grade
		 end 														as 'Student Grade'
		,case 
				when s.local_ethnic_code = 'A' then 'Asian'								
				when s.local_ethnic_code = 'B' then 'Black or African American'
				when s.local_ethnic_code = 'H' then 'Hispanic or Latino'
				when s.local_ethnic_code = 'I' then 'American Indian or Alaskan Native'
				when s.local_ethnic_code = 'M' then 'Multi-ethnic'
				when s.local_ethnic_code = 'W' then 'White'
                else 'Not Specified or Other'
		 end														as 'Student Ethnic Group Name'

  from DS_Classes       as c
  join DS_Students      as s on c.stu_id = s.stu_id
  where cast(s.stu_id as varchar(20)) in (select [Student ID] from NWEA_Programs) -- only students in special programs
    and c.emp_username is not null
    and c.subject_group in ('math','science','english language arts')
    and c.course not like '%ELP%'


GO
/****** Object:  View [dbo].[Adult_Teacher_Schedule]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
------------------------------------------------
create view [dbo].[Adult_Teacher_Schedule]
as
------------------------------------------------
select distinct
     syear
    ,c.sch_id       as school_id
    ,c.sch_state_id as schoolnum
    ,c.school       as schooltitle
    ,c.emp_id       as teacher_id
    ,c.emp_username as username
    ,emp_lastname   as last_name
    ,emp_firstname  as first_name
    ,term           as termcode
    ,class_id       as course_period_id
    ,marking_period_id
    ,period
    ,course         as coursetitle
    ,course_num     as coursenum
    ,course_weight
    ,room
    ,total_seats
    ,filled_seats   as total_stu
    ,null           as total_male
    ,null           as total_female
    ,start_date
    ,end_date
	,emp_lastname + ', '+ emp_firstname	as teacher_dropdown
	,period + ' ' + course + ' (' + cast(class_id as varchar(20)) + ')' as class_dropdown

from Adult_Classes     as c
where c.emp_id is not null

GO
/****** Object:  View [dbo].[agilemind_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[agilemind_students]
as

select 'School' as 'School','Teacher' as 'Teacher','Period' as 'Period','Course' as 'Course','Grade' as 'Grade','Student First Name' as 'Student First Name','Student Last Name' as 'Student Last Name','Username' as 'Username','Password' as 'Password','Course Number' as 'Course Number','Co-Teacher' as 'Co-Teacher'
UNION ALL

select distinct
        c.school                                    as 'School'
       ,c.emp_firstname+' '+c.emp_lastname          as 'Teacher'
       ,case when isnumeric(left(c.period,2)) = 1 then cast(cast(left(c.period,2) as int) as varchar(30)) end   as 'Period'
       ,c.course                                    as 'Course'
       ,cast(cast(s.grade as int) as varchar(30))   as 'Grade'
       ,s.first_name                                as 'Student First Name'
       ,s.last_name                                 as 'Student Last Name'
       ,replace(c.stu_username,'.','')              as 'Username'
       ,'s.' + right(c.stu_local_id,8)              as 'Password'
       ,cast(c.course_num as varchar(30))           as 'Course Number'
       ,u2.first_name+' '+u2.last_name              as 'Co-Teacher'
-- select *
from DS_Classes     as c
join DS_Students    as s  on c.stu_id = s.stu_id
left join DS_Users  as u2 on c.emp2_id = u2.emp_id
--join focus_schools  as x on c.sch_id = s.school_id
where 
      c.course_num in ('1200370','1200380')
  and left(c.course_weight,1) = 'Z'
  and getdate() between case when getdate() < (select start_yr from constants where relative_year = 0) then getdate() else c.start_date end and c.end_date
  and c.stu_username is not null
GO
/****** Object:  View [dbo].[BTC_MiddleAlg]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[BTC_MiddleAlg]
as
select 
        p.stu_username
       ,p.grade as CurrGrade
       ,n.stu_id
       ,n.subject
       ,n.achievement_level
       ,n.partcode
	   ,n.AdmGrade
from FSA_history n
inner join DS_Students p
on n.stu_id = p.stu_id
where p.active = 1 
--and p.grade in ('06','07','08')
and n.AdmGrade in ('07', '08')
and Achievement_Level < 3
and n.PartCode = 'E1' 

GO
/****** Object:  View [dbo].[BTC_MS_Assessments]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[BTC_MS_Assessments]
as

select 
        p.stu_username
       ,p.grade as CurrGrade
       ,n.stu_id
       ,n.subject
       ,n.achievement_level
       ,n.partcode
	   ,n.AdmGrade
	   ,n.date
from FSA_history n
inner join DS_Students p
on n.stu_id = p.stu_id
where p.active = 1 
and p.grade in ('06','07','08')
and n.AdmGrade in ('06', '07', '08')
--and n.PartCode = 'E1' 
GO
/****** Object:  View [dbo].[SADD_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------------------------------
CREATE view [dbo].[SADD_students]
-- 00:01:00
as
-------------------------------------------------------------------------

select 
       cast(s.stu_id as varchar(100))                   as student_id
      ,cast(s.sch_id as varchar(100))                   as school_id
      ,s.sch_state_id                                   as statenum
      ,s.stu_local_id                                   as PERMNUM
      ,s.last_name                                      as LASTNAME
      ,s.first_name                                     as FIRSTNAME
      ,s.middle_name                                    as MIDDLENAME
      ,s.grade                                          as grade
      ,nullif(dbo.GetCodeFromBrackets(s.gender),'')     as GENDER
      ,s.local_ethnic_code                              as ETHNICCODE
      ,s.spec_rpt_ethnic_code                           as ETHNICCODE_black
      ,cast(s.birthdate as varchar(100))                as BIRTHDATE
      ,cast(s.age as varchar(100))                      as age
      ,s.cont1_last+' '+s.cont1_first                   as PRNTGUARD
      ,s.zone_school                                    as zoned_school
      ,nullif(dbo.GetCodeFromBrackets(s.freereduced_meals),'')      as FREEMEALS
      ,s.counselor                                      as COUNSELOR
      ,cast(s.hmroom_emp_id as varchar(100))            as teacher_id
      ,s.hmroom_emp_name                                as abbrevname
      ,s.retained                                       as RETAIN
      ,cast(s.gpa as varchar(100))                      as WTDCUMMGPA2
      ,nullif(dbo.GetCodeFromBrackets(s.instructional_setting),'')  as INSTRSET
      ,s.sch_previous                                   as LASTSCHOOL
      ,s.summer_sch                                     as SUMMERSCHL
      ,s.sch_next                                       as NEXTSCHOOL
      ,s.grd_next                                       as NEXTGRADE
      ,nullif(dbo.GetCodeFromBrackets(s.alt_assessment),'')         as alt_assessment
      ,nullif(dbo.GetCodeFromBrackets(s.assignment_code),'')        as ASSIGNCODE
      ,nullif(dbo.GetCodeFromBrackets(s.end_year_status),'')        as endyrst
      ,nullif(s.ssn,'')                                 as SOCSECNUM
      ,s.altid1                                         as ALTID1
      ,s.altid2                                         as ALTID2
      ,s.l35_read                                       as L35READ
      ,s.l35_mth                                        as L35MATH
      ,s.stu_username                                   as STULOGINID
      ,nullif(dbo.GetCodeFromBrackets(s.ell_status),'') as LEP
      ,s.elig_504                                       as SEC504ELIG
      ,nullif(dbo.GetCodeFromBrackets(qual_504),'')     as SEC504QUAL
      ,nullif(dbo.GetCodeFromBrackets(s.ceis),'')       as CEIS
      ,nullif(dbo.GetCodeFromBrackets(s.grd_prom_exmp),'')         as grprostgce
      ,left(s.primary_exc,1)                            as PRIEXC
      ,convert(varchar(10),med_letter_physical,101)     as med_letter_physical
      ,convert(varchar(10),med_letter_speech,101)       as med_letter_speech
      ,convert(varchar(10),med_letter_psych,101)        as med_letter_psych
      ,convert(varchar(10),med_letter_nursing,101)      as med_letter_nursing
      ,convert(varchar(10),med_letter_social,101)       as med_letter_social
      ,s.mail_address                                   as address
      ,s.mail_city                                      as city
      ,s.mail_state                                     as state
      ,s.mail_zip                                       as zip
      ,s.home_phone                                     as phone
      ,s.address                                        as hm_address
      ,s.city                                           as hm_city
      ,s.state                                          as hm_state
      ,s.zip                                            as hm_zip
      ,s.case_manager                                   as CASEMGR
      ,convert(varchar(10),s.enr_date,101)              as start_date
      ,convert(varchar(10),s.drop_date,101)             as end_date
      ,case when s.active = 1       then null
            else 'I'                end                 as status

from DS_Students as s
where stu_id in (select stu_id from DS_Enrollment as e join constants as y on e.syear >= y.syear and y.relative_year = -1)

UNION ALL 
select 'student_id', 'school_id', 'statenum', 'PERMNUM', 'LASTNAME', 'FIRSTNAME', 'MIDDLENAME', 'grade', 'GENDER', 'ETHNICCODE', 'ETHNICCODE_black', 'BIRTHDATE', 'age', 'PRNTGUARD', 'zoned_school', 'FREEMEALS', 'COUNSELOR', 'teacher_id', 'abbrevname', 'RETAIN', 'WTDCUMMGPA2', 'INSTRSET', 'LASTSCHOOL', 'SUMMERSCHL', 'NEXTSCHOOL', 'NEXTGRADE', 'alt_assessment', 'ASSIGNCODE', 'endyrst', 'SOCSECNUM', 'ALTID1', 'ALTID2', 'L35READ', 'L35MATH', 'STULOGINID', 'LEP', 'SEC504ELIG', 'SEC504QUAL', 'CEIS', 'grprostgce', 'PRIEXC', 'med_letter_physical', 'med_letter_speech', 'med_letter_psych', 'med_letter_nursing', 'med_letter_social', 'address', 'city', 'state', 'zip', 'phone', 'hm_address', 'hm_city', 'hm_state', 'hm_zip', 'CASEMGR', 'start_date', 'end_date', 'status'

GO
/****** Object:  Table [dbo].[Work_attendance_day]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_attendance_day](
	[syear] [int] NULL,
	[student_id] [numeric](18, 0) NULL,
	[school_id_event] [int] NULL,
	[school_date] [date] NULL,
	[marking_period_id] [numeric](18, 0) NULL,
	[term] [varchar](10) NULL,
	[present] [int] NULL,
	[code] [varchar](10) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Covid_dashboard_cases]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Covid_dashboard_cases](
	[case_id] [int] NOT NULL,
	[syear] [int] NULL,
	[created_timestamp] [datetime] NULL,
	[last_modified_timestamp] [datetime] NULL,
	[case_positive_confirmed_doh] [varchar](50) NULL,
	[case_positive_confirmed_doh_date] [date] NULL,
	[case_positive_confirmed_doh_time] [time](7) NULL,
	[case_positive_confirmed_doh_timestamp] [datetime] NULL,
	[q_hs_vaccinated] [varchar](50) NULL,
	[case_type] [varchar](50) NULL,
	[case_status] [varchar](50) NULL,
	[case_status_location] [varchar](50) NULL,
	[costcenter] [varchar](10) NULL,
	[costcenter_name] [varchar](100) NULL,
	[location_reporting] [varchar](10) NULL,
	[location_reporting_name] [varchar](100) NULL,
	[location_secondary] [varchar](10) NULL,
	[employee_id] [int] NULL,
	[employee_staff_id] [int] NULL,
	[employee_job_description] [varchar](50) NULL,
	[case_q_loc_incidence_confpositive] [varchar](50) NULL,
	[case_q_loc_incidence_confpositive_household] [varchar](50) NULL,
	[case_q_loc_incidence_contact_confirmed_case] [varchar](50) NULL,
	[case_q_loc_incidence_symptomatic] [varchar](50) NULL,
	[case_q_loc_incidence_childcare] [varchar](50) NULL,
	[case_q_loc_date_last_on_site] [date] NULL,
	[location_reporting_type] [varchar](50) NULL,
	[case_test_results_calc] [varchar](50) NULL,
	[case_test_results_received_calc] [date] NULL,
	[student_id] [varchar](50) NULL,
	[student_local_id] [varchar](50) NULL,
	[birthdate] [date] NULL,
	[age] [int] NULL,
	[race] [varchar](10) NULL,
	[gender] [varchar](10) NULL,
	[case_return_date] [date] NULL,
	[closecontact_linelist_num] [int] NULL,
 CONSTRAINT [PK_Covid_dashboard_cases] PRIMARY KEY CLUSTERED 
(
	[case_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Covid_dashboard_close_contacts]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Covid_dashboard_close_contacts](
	[id] [int] NOT NULL,
	[case_id] [int] NULL,
	[person_type] [varchar](50) NULL,
	[emp_local_id] [int] NULL,
	[stu_id] [int] NULL,
	[stu_id_adult] [int] NULL,
	[first_name] [varchar](50) NULL,
	[last_name] [varchar](50) NULL,
	[location] [varchar](10) NULL,
	[return_date] [date] NULL,
	[test_out_date] [date] NULL,
	[date_created] [datetime] NULL,
	[last_modified] [datetime] NULL,
	[case_last_modified] [datetime] NULL,
 CONSTRAINT [PK_Covid_dashboard_close_contacts] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[Covid_attendance]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------
CREATE view [dbo].[Covid_attendance]
as

/*
    Last updated: glandonh on 9-16-2021

    Used by: Reporting Services

    select top 10 * from Covid_attendance
*/
-----------------------------------------

select   c.case_id
        ,cast(c.stu_id as bigint) as stu_id
        ,s.last_first
        ,s.grade
        ,c.location
        ,h.school
        ,c.start_date
        ,c.return_date
        ,case when c.start_date < getdate() and getdate() < c.return_date then 1 else 0 end     as active_quarantine   -- does not take into account those who have returned early with a negative test
        ,count(distinct a.school_date)                                       as school_days
        ,sum(case when a.present = 1 then 1 else 0 end)                      as present
        ,sum(case when a.present = 1 and a.code = 'QP'  then 1 else 0 end)   as QP
        ,sum(case when a.present = 0 then 1 else 0 end)                      as abs_all
        ,sum(case when a.present = 0 and a.code in ('PND','SKP','FAM','EMP','TRA','DIS','MDU','QA','UNX') then 1 else 0 end)   as abs_unx
        ,sum(case when a.present = 0 and a.code = 'PND' then 1 else 0 end)   as PND_unx
        ,sum(case when a.present = 0 and a.code = 'SKP' then 1 else 0 end)   as SKP_unx
        ,sum(case when a.present = 0 and a.code = 'FAM' then 1 else 0 end)   as FAM_unx
        ,sum(case when a.present = 0 and a.code = 'EMP' then 1 else 0 end)   as EMP_unx
        ,sum(case when a.present = 0 and a.code = 'TRA' then 1 else 0 end)   as TRA_unx
        ,sum(case when a.present = 0 and a.code = 'DIS' then 1 else 0 end)   as DIS_unx
        ,sum(case when a.present = 0 and a.code = 'MDU' then 1 else 0 end)   as MDU_unx
        ,sum(case when a.present = 0 and a.code = 'QA'  then 1 else 0 end)   as QA_unx
        ,sum(case when a.present = 0 and a.code = 'UNX' then 1 else 0 end)   as UNX_unx
        ,sum(case when a.present = 0 and a.code in ('MDE','EME','LEG','ACE','REL','EXC') then 1 else 0 end)   as abs_exc
        ,sum(case when a.present = 0 and a.code = 'MDE' then 1 else 0 end)   as MDE_exc
        ,sum(case when a.present = 0 and a.code = 'EME' then 1 else 0 end)   as EME_exc
        ,sum(case when a.present = 0 and a.code = 'LEG' then 1 else 0 end)   as LEG_exc
        ,sum(case when a.present = 0 and a.code = 'ACE' then 1 else 0 end)   as ACE_exc
        ,sum(case when a.present = 0 and a.code = 'REL' then 1 else 0 end)   as REL_exc
        ,sum(case when a.present = 0 and a.code = 'EXC' then 1 else 0 end)   as EXC_exc
from (
        -- stundents that tested positive
        select case_id, CAST(c.student_id as bigint) as stu_id, location_reporting as location
              ,dateadd(d,1,case_q_loc_date_last_on_site) as start_date  -- quarantine start is day after date_last_on_site
              ,case_return_date as return_date
        from Covid_dashboard_cases as c
        join DS_Schools            as h on c.location_reporting = h.sch_state_idx and h.PCS_K12 = 'Y'
        where case_type = 'Student'
          and case_q_loc_date_last_on_site is not null
          and case_return_date is not null

        UNION ALL

        -- students that were close contacts
        select c.case_id, c.stu_id, location
              ,dateadd(d,1,cast(date_created as date)) as start_date    -- quarantine start is day after added to contacts list
              ,return_date
        from Covid_dashboard_close_contacts as c
        where c.person_type = 'Student'
          and stu_id is not null
          and date_created is not null
          and return_date is not null
) as c

join DS_Schools     as h on c.location = h.sch_state_idx
join DS_Students    as s on c.stu_id = s.stu_id

left join ( -- attendance records in quarantine date range
            select *
            from Work_attendance_day as d
) as a on c.stu_id = a.student_id and h.sch_id = a.school_id_event
      and a.school_date between c.start_date and DATEADD(d,-1,c.return_date) -- don't include attendance for the return date itself

group by c.case_id, c.stu_id, s.last_first, s.grade, c.location, h.school, c.start_date, c.return_date









GO
/****** Object:  View [dbo].[SaferWatch]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------
-- SaferWatch
CREATE view [dbo].[SaferWatch]
as
-------------------------------------
select
     dbo.Quotes(u.first_name)                   as [First Name]
    ,dbo.Quotes(u.last_name)                    as [Last Name]
    ,dbo.Quotes(u.email)                        as [Email]
    ,null                                       as [Phone]
    ,null                                       as [Country Code]
    ,dbo.Quotes(dbo.SingleSpace(replace(u.jobtitle,',',' - ')))    as [Title]
    ,dbo.Quotes(u.location_name)                as [Division]
    ,dbo.Quotes(u.emp_local_id)                 as [Employee ID]
    ,null                                       as [Alternate Email]
    ,dbo.Quotes(u.location)                     as [Location ID]
    ,'"1"'                                      as [Status]
from DS_Users as u
where u.emp_username is not null
  and u.email is not null
  and u.emp_local_id is not null
  and u.Account = 'Active'

UNION ALL select 'First Name', 'Last Name', 'Email', 'Phone', 'Country Code', 'Title', 'Division', 'Employee ID', 'Alternate Email', 'Location ID', 'Status'
GO
/****** Object:  Table [dbo].[Covid_charter]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Covid_charter](
	[pk] [int] IDENTITY(1,1) NOT NULL,
	[syear] [int] NULL,
	[syear_alt] [varchar](10) NULL,
	[created_timestamp] [datetime] NULL,
	[last_modified_timestamp] [datetime] NULL,
	[last_modified_by] [varchar](50) NULL,
	[costcenter] [varchar](10) NULL,
	[costcenter_name] [varchar](100) NULL,
	[report_date] [date] NULL,
	[positive_confirmed_students] [int] NULL,
	[positive_confirmed_staff] [int] NULL,
	[impacted_individuals] [int] NULL,
 CONSTRAINT [PK_Covid_charter] PRIMARY KEY CLUSTERED 
(
	[pk] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[Covid_report_charter]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

---------------------------------------
CREATE view [dbo].[Covid_report_charter]
as
-- select * from Covid_charter
---------------------------------------
select costcenter, costcenter_name, report_date
      ,'Positive Students'              as TypeofCase
      ,sum(positive_confirmed_students) as total
from Covid_charter
where positive_confirmed_students is not null
group by costcenter, costcenter_name, report_date


UNION ALL
select costcenter, costcenter_name, report_date
      ,'Positive Staff'              as TypeofCase
      ,sum(positive_confirmed_staff) as total
from Covid_charter
where positive_confirmed_staff is not null
group by costcenter, costcenter_name, report_date

UNION ALL
select costcenter, costcenter_name, report_date
      ,'Impacted Individuals'    as TypeofCase
      ,sum(impacted_individuals) as total
from Covid_charter
where impacted_individuals is not null
group by costcenter, costcenter_name, report_date



GO
/****** Object:  View [dbo].[CTAE_Referral_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------
CREATE view [dbo].[CTAE_Referral_Students]
-- select * from CTAE_Referral_Students
-------------------------------------------
as
select distinct
        c.sch_id, c.sch_state_id, c.school
       ,s.stu_id, s.stu_local_id, s.stu_state_id, s.stu_username, s.last_name, s.first_name, s.middle_name
       ,s.address, s.address_2, s.city, s.state, s.zip
       ,s.mail_address, s.mail_address_2, s.mail_city, s.mail_state, s.mail_zip
	   ,s.home_phone
       ,s.cont1_last, s.cont1_first, s.cont1_type, s.cont1_cstdy, isnull(s.cont1_home_phone, s.cont1_cell) as cont1_phone
       ,s.grade, s.birthdate, s.gender, s.resident_status, s.citizenship, s.primary_exc
       ,case when s.primary_exc is not null and left(s.primary_exc,1) <> 'L' then 'Y' else 'N' end as IEP
       ,s.group_hispanic, s.group_white, s.group_black, s.group_asian, s.group_native, s.group_pacific
       ,s.stu_local_id+' '+s.stu_username+' '+s.first_name+' '+s.last_name as stu_search
	   ,s.year_entered as cohort
	   ,s.ell_prog_participant
from DS_Students    as s
join DS_Classes     as c on s.stu_id = c.stu_id
join DS_Schools     as h on c.sch_id = h.sch_id and h.school_level like '%High' and isnumeric(h.sch_state_idx) = 1 and left(h.category,1) in ('A','C','E','F','J')
where s.grade in ('09','10','11','12')
GO
/****** Object:  Table [dbo].[CTAE_Referral_Requests]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CTAE_Referral_Requests](
	[id] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[uuid] [uniqueidentifier] NULL,
	[syear] [numeric](9, 0) NULL,
	[date_created] [smalldatetime] NULL,
	[emp_username] [nvarchar](100) NULL,
	[sch_id] [numeric](9, 0) NULL,
	[stu_id] [numeric](9, 0) NULL,
	[stu_local_id] [nvarchar](10) NULL,
	[course_num] [nvarchar](10) NULL,
	[key_id] [numeric](18, 0) NULL,
	[semester] [nvarchar](10) NULL,
	[previous_DF] [nvarchar](10) NULL,
	[rec_sch_id] [numeric](9, 0) NULL,
 CONSTRAINT [PK_CTAE_Referral_Requests] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[CTAE_Referrals_FMimport]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------
CREATE view [dbo].[CTAE_Referrals_FMimport]
-------------------------------------------
as
select distinct
        r.sch_id                        as [sch_id sending]
       ,r.rec_sch_id                    as [sch_id receiving]
       ,r.date_created                  as date
       ,s.stu_local_id
       ,s.grade
       ,s.address+isnull(' / '+s.address_2,'')+', '+s.city_state+' '+s.zip as address
       ,s.birthdate
       ,s.gender
       ,s.group_hispanic                as ethnicity
       ,s.group_white                   as race_white
       ,s.group_black                   as race_black
       ,s.group_asian                   as race_asian
       ,s.group_native                  as race_american
       ,s.group_pacific                 as race_pacific
       ,s.citizenship
       ,case when s.primary_exc is not null and left(s.primary_exc,1) <> 'L' then 'Y' else 'N' end as IEP
       ,s.cont1_first+' '+s.cont1_last  as [parent name]
       ,isnull(s.cont1_home_phone,s.cont1_cell) as [parent phone]
       ,r.emp_username                  as created_by
       ,s.first_name
       ,s.last_name
       ,r.stu_id
       ,s.last_name+', '+first_name     as last_first
       ,r.uuid                          as fm_referral_uuid
       ,r.syear

from CTAE_Referral_Requests as r
join DS_Students            as s on r.stu_id = s.stu_id
GO
/****** Object:  View [dbo].[Demo_Calc_Schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------------------
-- Demo_Calc_Schools
-------------------------------------------------

CREATE view [dbo].[Demo_Calc_Schools]
as

select *
from DS_Schools  as s
where left(s.category,1) not in ('P','T','W','Z')
  and isnumeric(s.sch_state_idx) = 1
  and s.active = 1
GO
/****** Object:  View [dbo].[student_conductor]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-------------------------------------
-- student_conductor view
--     select * from student_conductor where StudentMiddleName like '%,%'
-------------------------------------

CREATE view [dbo].[student_conductor]
as

select distinct
     replace(replace(h.school,' School',''),' ','_')+'.csv' as FileName

    ,'"'+ case when o.v01 = 'foodservicesPIN' then cast(s.foodservicesPIN as varchar(20))
               when o.v01 = 'stu_local_id'    then s.stu_local_id
               when o.v01 = 'stu_id'		  then cast(s.stu_id as varchar(20))
               when o.v01 = 'spc_student_id'  then cast(cast(dbo.CleanNumber(spc_student_id) as decimal(19,0)) as varchar(20))
               end                              +'"'        as StudentID

    ,'"'+ replace(s.first_name,',','.')         +'"'        as StudentFirstName
    ,'"'+ replace(s.middle_name,',','.')        +'"'        as StudentMiddleName
    ,'"'+ replace(s.last_name,',','.')          +'"'        as StudentLastName
    ,'"'+ s.grade                               +'"'        as Grade
    ,'"'+ dbo.CleanEmail(s.cont1_email)         +'"'        as ParentEmail1
    ,'"'+ dbo.CleanEmail(s.cont2_email)         +'"'        as ParentEmail2
    ,'"'+ replace(s.cont1_cell,',',';')         +'"'        as ParentCell1
    ,'"'+ replace(s.cont2_cell,',',';')         +'"'        as ParentCell2
-- select top 100 *
from DS_Classes         as c
join DS_Students        as s on c.stu_id = s.stu_id
join DS_Schools         as h on c.sch_id = h.sch_id
join constants          as y on y.relative_year = 0 and y.school_date between c.stu_start_date and c.stu_end_date
join DS_Apps_Options    as o on o.app_id = 25 and o.type = 'Schools' and o.v01 is not null and c.sch_id = o.i01 


GO
/****** Object:  View [dbo].[EWS_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[EWS_students]
AS
-----------------------------------------------------

select
	 sch_state_id										as curr_schoolnum_distr
	,sch_id												as curr_focus_school_id
	,school												as schl_name
	,stu_id												as focus_student_id
	,stu_local_id										as permnum
	,last_first											as stdt_name
	,birthdate											as DOB
	,age												as Age
	,grade
	,local_ethnic_code
	,left(primary_exc,1)								as handicapct
	,nullif(dbo.GetCodeFromBrackets(ell_status),'ZZ')	as ELL
	,cast(gpa_unwtd as decimal(9,2))					as UNWTDCUMMGPA1
	,null												as fcat_math_lvl
	,null												as fcat_read_lvl
	,ela_level											as FSA_ELA_lvl
	,mth_level											as FSA_math_lvl
	,beh_iss											as ISS_count
	,beh_oss											as OSS_count
	,beh_ref											as DISC_count
	,abs_all											as stdt_abs_count
	,att_days											as stdt_att_count
	,abs_all_per										as stdt_att_percent
	,F_rptcard											as F_count
	,last_updated
from KPI_Students	as k
;
GO
/****** Object:  View [dbo].[Demographics_Schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[Demographics_Schools]
as

select
         active
        ,syear
        ,region
        ,category
        ,school_level
        ,sch_id
        ,sch_state_id
        ,school
        ,Nth_date
        ,sum(enrToday) as enrToday
        ,sum(enrNth) as enrNth
        ,sum(enrQ1) as enrQ1
        ,sum(enrQ2) as enrQ2
        ,sum(enrQ3) as enrQ3
        ,sum(enrQ4) as enrQ4
        ,sum(enrS1) as enrS1
        ,sum(enrS2) as enrS2
        ,sum(enrYR) as enrYR
        ,sum(enr08) as enr08
        ,sum(enr09) as enr09
        ,sum(enr10) as enr10
        ,sum(enr11) as enr11
        ,sum(enr12) as enr12
        ,sum(enr01) as enr01
        ,sum(enr02) as enr02
        ,sum(enr03) as enr03
        ,sum(enr04) as enr04
        ,sum(enr05) as enr05
        ,sum(enr06) as enr06
        ,sum(enr07) as enr07
        ,sum(gPK) as gPK
        ,sum(gKG) as gKG
        ,sum(g01) as g01
        ,sum(g02) as g02
        ,sum(g03) as g03
        ,sum(g04) as g04
        ,sum(g05) as g05
        ,sum(g06) as g06
        ,sum(g07) as g07
        ,sum(g08) as g08
        ,sum(g09) as g09
        ,sum(g10) as g10
        ,sum(g11) as g11
        ,sum(g12) as g12
        ,sum(male) as male
        ,sum(female) as female
        ,sum(group_hispanic) as group_hispanic
        ,sum(group_native) as group_native
        ,sum(group_asian) as group_asian
        ,sum(group_pacific) as group_pacific
        ,sum(group_white) as group_white
        ,sum(group_black) as group_black
        ,sum(group_nonblack) as group_nonblack
        ,sum(local_multi) as local_multi
        ,sum(local_hispanic) as local_hispanic
        ,sum(local_native) as local_native
        ,sum(local_asian) as local_asian
        ,sum(local_white) as local_white
        ,sum(local_unknown) as local_unknown
        ,sum(local_black) as local_black
        ,sum(local_nonblack) as local_nonblack
        ,sum(econ_dis) as econ_dis
        ,sum(ell) as ell
        ,sum(disabilities) as disabilities
        ,sum(migrant) as migrant
        ,sum(homeless) as homeless
        ,sum(L1read) as L1read
        ,sum(L2read) as L2read
        ,sum(L12read) as L12read
        ,sum(L1math) as L1math
        ,sum(L2math) as L2math
        ,sum(L12math) as L12math
from Demographics_Students
group by active,syear,region,category,school_level,sch_id,sch_state_id,school,Nth_date




GO
/****** Object:  View [dbo].[SSWIMS_Absences]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[SSWIMS_Absences]
as

select
     t.syear
    ,s.sch_id
    ,s.sch_state_id
    ,s.school
    ,t.sch_abs_average
    ,s.stu_id
    ,s.stu_local_id
    ,s.stu_username
    ,s.last_name
    ,s.first_name
    ,e.stdt_abs_count       as stu_abs_count

from EWS_students   as e
join DS_Students    as s on e.focus_student_id = s.stu_id

join ( -- only take into account active home school student absences
        select a.syear, a.sch_id ,cast(avg(cast(a.ttl_absences as real)) as decimal(9,2)) as sch_abs_average
        from DS_Attendance  as a
        join DS_Students    as s on a.stu_id = s.stu_id and a.sch_id = s.sch_id -- home school students
        join DS_Classes     as c on s.stu_id = c.stu_id and s.sch_id = c.sch_id -- active students
        join constants      as y on a.syear = y.syear and y.relative_year = 0
        where a.grade in ('KG','01','02','03','04','05','06','07','08','09','10','11','12')
        group by a.syear, a.sch_id, a.school
) as t on s.sch_id = t.sch_id

group by t.syear, s.sch_id, s.sch_state_id, s.school, s.stu_id, s.stu_local_id, s.stu_username, s.last_name, s.first_name, e.stdt_abs_count, t.sch_abs_average






GO
/****** Object:  View [dbo].[DS_Behavior_Demographics]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[DS_Behavior_Demographics]
as
select b.*
      ,region, gPK, gKG, g01, g02, g03, g04, g05, g06, g07, g08, g09, g10, g11, g12, male, female, group_hispanic, group_native, group_asian, group_pacific, group_white, group_black, group_nonblack, local_hispanic, local_native, local_asian, local_white, local_multi, local_black, local_unknown, local_nonblack, econ_dis, ell, disabilities, homeless, L1read, L2read, L12read, L1math, L2math, L12math
from DS_Behavior            as b
join Demographics_Students  as d on b.syear = d.syear and b.stu_id = d.stu_id

GO
/****** Object:  View [dbo].[ReadySub_Locations]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------
CREATE view [dbo].[ReadySub_Locations]
as
----------------------------------------------
    select distinct
         u.location
        --,u.location_name    as original
        ,isnull(a.i01,cast(a.v03 as int)) as food_area
        ,isnull(a.i02,cast(a.v03 as int)) as plant_area
        ,case when h.valid_grades is not null
               and location_name not like '%adult%'
               and location_name not like '%elem%'
               and location_name not like '%middle%'
               and location_name not like '%high%'
               and location_name not like '%college%'
               and location_name not like '%K-8%'
               then h.school+' '+case when SUBSTRING(h.valid_grades,7,2) = 'KG' then 'K-'
                                      when SUBSTRING(h.valid_grades,3,2) = 'KG' then 'K-'
                                      when SUBSTRING(h.valid_grades,3,1) = '0'  then SUBSTRING(h.valid_grades,4,1)+'-' 
                                      when SUBSTRING(h.valid_grades,3,1) = '1'  then SUBSTRING(h.valid_grades,3,2)+'-'
                                      else SUBSTRING(h.valid_grades,3,2) end
                                +case when h.valid_grades like '%||12||%' then '12'
                                      when left(right(h.valid_grades,4),1) = '0' then left(right(h.valid_grades,3),1)
                                      when left(right(h.valid_grades,4),1) = '1' then left(right(h.valid_grades,4),2)
                                      else left(right(h.valid_grades,4),2) end
               else isnull(h.school,dbo.ProperCase(u.location_name)) end as location_name
    from DS_Users           as u
    join DS_Apps_Options    as a on a.app_id = 28 and a.type = 'Areas' and u.location = a.v01
    left join DS_Schools    as h on u.location = h.sch_state_idx
    where u.location_name is not null


GO
/****** Object:  View [dbo].[edge_student_roster]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[edge_student_roster]
as

select 'School Name' as 'School Name', 'Teacher First Name' as 'Teacher First Name', 'Teacher Middle Name' as 'Teacher Middle Name', 'Teacher Last Name' as 'Teacher Last Name', 'Teacher School E-Mail Address' as 'Teacher School E-Mail Address', 'Teacher Password' as 'Teacher Password', 'Teacher LMS ID' as 'Teacher LMS ID', 'Class Name' as 'Class Name', 'Class Grade' as 'Class Grade', 'Student First Name' as 'Student First Name', 'Student Middle Name' as 'Student Middle Name', 'Student Last Name' as 'Student Last Name', 'Student ID Number' as 'Student ID Number', 'Student Grade' as 'Student Grade', 'Student Password' as 'Student Password', 'Student Username' as 'Student Username', 'Student LMS ID' as 'Student LMS ID'

UNION ALL

select o.v02                                       as 'School Name'
      ,t.first_name                                as 'Teacher First Name'
      ,null                                        as 'Teacher Middle Name'
      ,t.last_name                                 as 'Teacher Last Name'
      ,t.email                                     as 'Teacher School E-Mail Address'
      ,isnull( left(replace(convert(varchar(20),t.birthdate,101),'/',''),4)+lower(t.emp_username), reverse(lower(t.emp_username)) )      as 'Teacher Password'
      ,null                                        as 'Teacher LMS ID'
      ,c.course_long                               as 'Class Name'
      ,null                                        as 'Class Grade'
      ,s.first_name                                as 'Student First Name'
      ,s.middle_name                               as 'Student Middle Name'
      ,s.last_name                                 as 'Student Last Name'
      ,cast(s.stu_id as varchar(50))               as 'Student ID Number'
      ,cast(cast(s.grade as int) as varchar(5))    as 'Student Grade'
      ,'s'+right(s.stu_local_id,8)                 as 'Student Password'
      ,'52'+replace(s.stu_username, '.', '')       as 'Student Username'
      ,null                                        as 'Student LMS ID'
-- select c.*
from DS_Classes         as c
join constants          as y on y.relative_year = 0 and case when getdate() < y.start_yr then y.start_yr else getdate() end between c.start_date and c.end_date
join DS_Students        as s on c.stu_id = s.stu_id
join DS_Users           as t on c.emp_id = t.emp_id
join DS_Apps_Options    as o on o.app_id = 5 and o.type = 'School' and c.sch_id = o.i01
where s.Grade in ('11','12') 
  and c.course_num in ('1008350')
GO
/****** Object:  View [dbo].[ReadySub_AreaSites]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

----------------------------------------------
CREATE view [dbo].[ReadySub_AreaSites]
as
----------------------------------------------
    select *
    from (
            select Division, Area, 'Site '+cast(seq as varchar(300)) as sitenum, location_name
            from (
                    select 'Food Services' as Division, food_area as area, ROW_NUMBER() over (partition by food_area order by location_name) as seq, location_name
                    from ReadySub_Locations
                    where food_area > 0
                    UNION ALL
                    select 'Plant Operations' as Division, plant_area as area, ROW_NUMBER() over (partition by plant_area order by location_name) as seq, location_name
                    from ReadySub_Locations
                    where plant_area > 0
            ) as t
    ) as t
    pivot(
        max(location_name)
        for sitenum IN ([Site 1],[Site 2],[Site 3],[Site 4],[Site 5],[Site 6],[Site 7],[Site 8],[Site 9],[Site 10],[Site 11],[Site 12],[Site 13],[Site 14],[Site 15],[Site 16],[Site 17],[Site 18],[Site 19],[Site 20],[Site 21],[Site 22],[Site 23],[Site 24],[Site 25],[Site 26],[Site 27],[Site 28],[Site 29],[Site 30],[Site 31],[Site 32],[Site 33],[Site 34],[Site 35],[Site 36],[Site 37],[Site 38],[Site 39],[Site 40],[Site 41],[Site 42],[Site 43],[Site 44],[Site 45],[Site 46],[Site 47],[Site 48],[Site 49],[Site 50],[Site 51],[Site 52],[Site 53],[Site 54],[Site 55],[Site 56],[Site 57],[Site 58],[Site 59],[Site 60],[Site 61],[Site 62],[Site 63],[Site 64],[Site 65],[Site 66],[Site 67],[Site 68],[Site 69],[Site 70],[Site 71],[Site 72],[Site 73],[Site 74],[Site 75],[Site 76],[Site 77],[Site 78],[Site 79],[Site 80],[Site 81],[Site 82],[Site 83],[Site 84],[Site 85],[Site 86],[Site 87],[Site 88],[Site 89],[Site 90],[Site 91],[Site 92],[Site 93],[Site 94],[Site 95],[Site 96],[Site 97],[Site 98],[Site 99],[Site 100],[Site 101],[Site 102],[Site 103],[Site 104],[Site 105],[Site 106],[Site 107],[Site 108],[Site 109],[Site 110],[Site 111],[Site 112],[Site 113],[Site 114],[Site 115],[Site 116],[Site 117],[Site 118],[Site 119],[Site 120],[Site 121],[Site 122],[Site 123],[Site 124],[Site 125],[Site 126],[Site 127],[Site 128],[Site 129],[Site 130],[Site 131],[Site 132],[Site 133],[Site 134],[Site 135],[Site 136],[Site 137],[Site 138],[Site 139],[Site 140]
        )
    ) as p

GO
/****** Object:  View [dbo].[edgenuity_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- edgenuity_schools
--      select * from edgenuity_schools
-----------------------
CREATE view [dbo].[edgenuity_schools]
as

select 'School_Code' as School_Code, 'School_Name' as School_Name, 'Street_Address' as Street_Address, 'City' as City, 'State' as State, 'Zip' as Zip, 'Phone' as Phone, 'Principal' as Principal, 'Principal_Email' as Principal_Email, 'Grades' as Grades, 'Type' as Type
UNION ALL
select distinct
     s.sch_state_id             as School_Code
    ,s.school                   as School_Name
    ,s.address                  as Street_Address
    ,s.city                     as City
    ,s.state                    as State
    ,s.zipcode                  as Zip
    ,s.phone                    as Phone
    ,s.principal                as Principal
    ,s.principal_email          as Principal_Email
    ,s.grade_range              as Grades
    ,case when s.level = 'M' then 'Middle'
          when s.level = 'H' then 'High'
          end as Type
    
from DS_Schools as s
where s.sch_id in (79)

GO
/****** Object:  View [dbo].[ReadySub_AllSites]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------
CREATE view [dbo].[ReadySub_AllSites]
as
    -- select * from ReadySub_Locations
----------------------------------------------
    select *
    from (
            select Division, 'Site '+cast(seq as varchar(300)) as sitenum, location_name
            from (
                    select 'Food Services' as division, ROW_NUMBER() over (order by location_name) as seq, location_name
                    from ReadySub_Locations
                    where food_area is not null
                    UNION ALL
                    select 'Plant Operations' as division, ROW_NUMBER() over (order by location_name) as seq, location_name
                    from ReadySub_Locations
                    where plant_area is not null
            ) as t
    ) as t
    pivot(
        max(location_name)
        for sitenum IN ([Site 1],[Site 2],[Site 3],[Site 4],[Site 5],[Site 6],[Site 7],[Site 8],[Site 9],[Site 10],[Site 11],[Site 12],[Site 13],[Site 14],[Site 15],[Site 16],[Site 17],[Site 18],[Site 19],[Site 20],[Site 21],[Site 22],[Site 23],[Site 24],[Site 25],[Site 26],[Site 27],[Site 28],[Site 29],[Site 30],[Site 31],[Site 32],[Site 33],[Site 34],[Site 35],[Site 36],[Site 37],[Site 38],[Site 39],[Site 40],[Site 41],[Site 42],[Site 43],[Site 44],[Site 45],[Site 46],[Site 47],[Site 48],[Site 49],[Site 50],[Site 51],[Site 52],[Site 53],[Site 54],[Site 55],[Site 56],[Site 57],[Site 58],[Site 59],[Site 60],[Site 61],[Site 62],[Site 63],[Site 64],[Site 65],[Site 66],[Site 67],[Site 68],[Site 69],[Site 70],[Site 71],[Site 72],[Site 73],[Site 74],[Site 75],[Site 76],[Site 77],[Site 78],[Site 79],[Site 80],[Site 81],[Site 82],[Site 83],[Site 84],[Site 85],[Site 86],[Site 87],[Site 88],[Site 89],[Site 90],[Site 91],[Site 92],[Site 93],[Site 94],[Site 95],[Site 96],[Site 97],[Site 98],[Site 99],[Site 100],[Site 101],[Site 102],[Site 103],[Site 104],[Site 105],[Site 106],[Site 107],[Site 108],[Site 109],[Site 110],[Site 111],[Site 112],[Site 113],[Site 114],[Site 115],[Site 116],[Site 117],[Site 118],[Site 119],[Site 120],[Site 121],[Site 122],[Site 123],[Site 124],[Site 125],[Site 126],[Site 127],[Site 128],[Site 129],[Site 130],[Site 131],[Site 132],[Site 133],[Site 134],[Site 135],[Site 136],[Site 137],[Site 138],[Site 139],[Site 140]
        )
    ) as p

GO
/****** Object:  View [dbo].[edgenuity_teachers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- edgenuity_teachers
-----------------------
CREATE view [dbo].[edgenuity_teachers]
as

select 'Teacher_ID' as Teacher_ID, 'School_Code' as School_Code, 'Username' as Username, 'password' as password, 'First_Name' as First_Name, 'Last_Name' as Last_Name, 'Email' as Email, 'Status' as Status
--select 'Teacher_ID' as Teacher_ID, 'School_Code' as School_Code, 'Username' as Username, 'password' as password, 'First_Name' as First_Name, 'Middle_Name' as Middle_Name, 'Last_Name' as Last_Name, 'Email' as Email, 'Status' as Status, 'Course_Code' as Course_Code, 'Course_Section' as Course_Section
UNION ALL
select distinct
     cast(c.emp_id as varchar(50))     as Teacher_ID
    ,c.sch_state_id                    as School_Code
    ,u.email                           as Username
    ,'Pcs' + isnull( left(replace(convert(varchar(20),u.birthdate,101),'/',''),4) +  right(convert(varchar(20),u.birthdate,101),2) + '!', reverse(lower(u.emp_username)) )   as password
    ,u.first_name                      as First_Name
    --,null                              as Middle_Name
    ,u.last_name                       as Last_Name
    ,u.email                           as Email
    ,'Active'                          as Status
    --,cast(c.course_id as varchar(50))  as Course_Code
    --,cast(c.class_id as varchar(50))   as Course_Section
from DS_Classes  as c
join DS_Users as u on c.emp_id = u.emp_id
where c.sch_id in (79)
GO
/****** Object:  View [dbo].[ESE_SSR_form]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE view [dbo].[ESE_SSR_form]
as

select cast(left(stu_local_id, 255) as varchar(255))							as stu_local_id
      ,cast(left(last_name, 255) as varchar(255))								as	last_name
	  ,cast(left(first_name, 255) as varchar(255))								as	first_name
      ,cast(left(grade, 255) as varchar(255))									as	grade
	  ,cast(left(local_ethnic_code, 255) as varchar(255))						as	local_ethnic_code
      ,cast(left(primary_exc, 255) as varchar(255))								as	primary_exc
      ,cast(left(instructional_setting, 255) as varchar(255))					as instructional_setting
      ,cast(left(ft_sdc, 255) as varchar(255))									as	ft_sdc			
	  ,cast(left(SUBSTRING(RIGHT(ft_sdc, 3), 1, 2), 255) as varchar(255))		as ft_sdc_ext
from DS_Students
where active = 1
	or ( last_syear = 2021 and sch_id = 197 )
--and SUBSTRING(RIGHT(ft_sdc, 3), 1, 2) = 's1'


GO
/****** Object:  View [dbo].[Clever7581_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7581_students
-- 00:00:30
-----------------------
    create view [dbo].[Clever7581_students]
    as
    select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
           'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
           'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
           'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
           'Student_zip' as Student_zip, 'Student_email' as Student_email,
           'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
           'Username' as Username, 'Password' as Password

    UNION ALL

    select distinct
             ss.sch_state_id                        as School_id
            ,cast(stu.stu_id as varchar(30))        as Student_id
            ,stu.stu_local_id                       as Student_number
            ,stu.stu_state_id                       as State_id
            ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
            ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
            ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
            ,left(right(stu.GENDER,2),1)            as GENDER
            ,convert(varchar(10),stu.birthdate,101) as DOB
            ,stu.grade                              as Grade
            ,stu.race                               as Race
            ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
            ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
            ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
                  when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
            ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
            ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
            ,stu.stu_username + '@pcsb.org'         as Student_email
            ,'"'+Contact_relationship+'"'           as Contact_relationship
            ,'"'+Contact_type+'"'                   as Contact_type
            ,'"'+Contact_name+'"'                   as Contact_name
            ,'"'+Contact_phone+'"'                  as Contact_phone
            ,'"'+Contact_email+'"'                  as Contact_email
            ,stu.stu_username                       as Username
            ,'s.'+right(stu.stu_local_id,8)         as Password
    -- select count(*)
    from DS_Classes         as ss
    join Clever7581_schools as h   on ss.sch_state_id = h.School_id
    join DS_Students        as stu on ss.stu_id = stu.stu_id
    left join (
        select stu_id
              ,cont1_type                                                         as Contact_relationship
              ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                    when cont1_emer             = 'Y'  then 'Emergency'
                    when cont1_cstdy            = 'Y'  then 'Custody'
                                                       else 'Unknown' end               as Contact_type
              ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
              ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
              ,dbo.CleanEmail(cont1_email)       as Contact_email
        from DS_Students as s
        where s.cont1_type is not null
    ) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
    where stu.stu_username is not null
GO
/****** Object:  View [dbo].[ESY_stu_info]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[ESY_stu_info]
as

select cast(left(stu_local_id, 255) as varchar(255))											as stu_local_id
      ,cast(left(stu_id, 255) as varchar(255))													as	stu_id
	  ,cast(left(last_name, 255) as varchar(255))												as	last_name
	  ,cast(left(first_name, 255) as varchar(255))												as	first_name
      ,cast(left(grade, 255) as varchar(255))													as	grade
	  ,cast(left(local_ethnic_code, 255) as varchar(255))										as	local_ethnic_code
      ,isnull(cast(left(primary_exc, 255) as varchar(255)), 'n/a')								as	primary_exc
      ,isnull(cast(left(instructional_setting, 255) as varchar(255)), 'n/a')					as instructional_setting
      ,isnull(cast(left(ft_sdc, 255) as varchar(255)), 'n/a')									as	ft_sdc			
	  ,isnull(cast(left(SUBSTRING(RIGHT(ft_sdc, 3), 1, 2), 255) as varchar(255)), 'n/a')		as ft_sdc_ext
	  ,SUBSTRING(right(ese_extschyrsv, 2), 1,1)													as ext_svc
      ,isnull(cast(left(pt_sdc1, 255) as varchar(255)), 'n/a')									as	pt_sdc			
	  ,school
	  ,sch_state_id
	  ,address + ' ' + city + ', ' + state														as address
	  ,home_phone
	  ,case when cont1_cstdy = 'Y' then cont1_last + ', ' + cont1_first end						as parent
	  ,isnull(case when cont1_cstdy = 'Y' then cont1_email end, 'n/a')							as parent_email
-- select *
from DS_Students
where active = 1
and SUBSTRING(right(ese_extschyrsv, 2), 1,1) like 'y'
--order by school 
--and SUBSTRING(RIGHT(ft_sdc, 3), 1, 2) = 's1'

--and SUBSTRING(RIGHT(ft_sdc, 3), 1, 2) = 's1'

--and stu_id = 431239 
GO
/****** Object:  Table [dbo].[focus_assigned_schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[focus_assigned_schools](
	[username] [varchar](50) NULL,
	[staff_id] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](50) NULL,
	[profiles] [varchar](4095) NULL,
	[view_stu_ssn] [varchar](1) NULL,
	[view_stu_meals] [varchar](1) NULL,
	[view_user_ssn] [varchar](1) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[ESY_Teachers]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create view [dbo].[ESY_Teachers]
as

select username, schoolnum, sch_state_idx, school, region
--select *
from focus_assigned_schools as fs
join DS_Schools as ds on schoolnum = sch_state_id
where right(sch_state_idx, 1) = 'E'
and sch_state_id in ('0811', '0851', '2581', '0681', '2821', '3431', '1261')


GO
/****** Object:  Table [dbo].[KPI_Schools]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[KPI_Schools](
	[sch_id] [numeric](18, 0) NOT NULL,
	[population] [int] NULL,
	[flag_absences] [numeric](24, 12) NULL,
	[flag_behavior] [numeric](24, 12) NULL,
	[flag_Fs] [numeric](24, 12) NULL,
	[flag_GPA] [numeric](24, 12) NULL,
	[flag_tests] [numeric](24, 12) NULL,
	[flag_multiple] [numeric](24, 12) NULL,
 CONSTRAINT [PK_KPI_Schools_Flags] PRIMARY KEY CLUSTERED 
(
	[sch_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[EWS_schools_flags]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------------------
create view [dbo].[EWS_schools_flags]
AS
-----------------------------------------------------

select
	 sch_id		as school_id
	,population
	,flag_absences
	,flag_behavior
	,flag_Fs
	,flag_GPA
	,flag_tests
	,flag_multiple
from KPI_Schools


GO
/****** Object:  Table [dbo].[KPI_Students_Flags]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[KPI_Students_Flags](
	[syear] [int] NULL,
	[sch_id] [numeric](18, 0) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[grade] [varchar](2) NULL,
	[flag_absences] [int] NULL,
	[flag_behavior] [int] NULL,
	[flag_Fs] [int] NULL,
	[flag_GPA] [int] NULL,
	[flag_tests] [int] NULL,
	[flag_multiple] [int] NULL,
 CONSTRAINT [PK_KPI_Students_Flags] PRIMARY KEY CLUSTERED 
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[EWS_students_flags]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------------------
create view [dbo].[EWS_students_flags]
AS
-----------------------------------------------------

select
	 syear
	,sch_id		as school_id
	,stu_id		as student_id
	,grade
	,flag_absences
	,flag_behavior
	,flag_Fs
	,flag_GPA
	,flag_tests
	,flag_multiple
from KPI_Students_Flags
GO
/****** Object:  View [dbo].[Clever7131_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7131_students
-- 00:00:30
-----------------------
CREATE view [dbo].[Clever7131_students]
as
select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
       'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
       'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
       'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
       'Student_zip' as Student_zip, 'Student_email' as Student_email,
       'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
       'Username' as Username, 'Password' as Password

UNION ALL

select distinct
         ss.sch_state_id                        as School_id
        ,cast(stu.stu_id as varchar(30))        as Student_id
        ,stu.stu_local_id                       as Student_number
        ,stu.stu_state_id                       as State_id
        ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
        ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
        ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
        ,left(right(stu.GENDER,2),1)            as GENDER
        ,convert(varchar(10),stu.birthdate,101) as DOB
        ,stu.grade                              as Grade
        ,stu.race                               as Race
        ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
        ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
        ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
              when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
        ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
        ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
        ,stu.stu_username + '@pcsb.org'         as Student_email
        ,'"'+Contact_relationship+'"'           as Contact_relationship
        ,'"'+Contact_type+'"'                   as Contact_type
        ,'"'+Contact_name+'"'                   as Contact_name
        ,'"'+Contact_phone+'"'                  as Contact_phone
        ,'"'+Contact_email+'"'                  as Contact_email
        ,stu.stu_username                       as Username
        ,'s.'+right(stu.stu_local_id,8)         as Password
-- select count(*)
from DS_Classes         as ss
join Clever7131_schools as h   on ss.sch_state_id = h.School_id
join DS_Students        as stu on ss.stu_id = stu.stu_id
left join (
    select stu_id
          ,cont1_type                                                         as Contact_relationship
          ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                when cont1_emer             = 'Y'  then 'Emergency'
                when cont1_cstdy            = 'Y'  then 'Custody'
                                                   else 'Unknown' end               as Contact_type
          ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
          ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
          ,dbo.CleanEmail(cont1_email)       as Contact_email
    from DS_Students as s
    where s.cont1_type is not null
) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
where stu.stu_username is not null

GO
/****** Object:  View [dbo].[focus_discipline_referrals]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE view [dbo].[focus_discipline_referrals]
as

select 
	 syear
	,b.stu_local_id		as permnum
	,null				as grade
	,b.stu_id			as student_id
	,s.sch_id			as stu_school_id
	,null				as status
	,b.sch_id			as school_id
	,null				as schoolnum
	,b.sch_state_id		as statenum
	,null				as region
	,null				as eds_group
	,incident_date		as ReferDate
	,null				as ReportDate
	,null				as comments
	,incident_code		as desccode
	,incident_code_ext	as desccodeS
	,case when incident like '%SESIR%' then 1 end				as SESIR
	,incident			as description
	,null				as descr
	,response_code		as DispCode
	,response			as DispDESC
	,response_start		as DispStrtDt
	,response_end		as DispEndDt
	,response_days		as DispDays
	,null				as DispHrs
	,response_admin		as ActionBy
	,incident_location	as INCIDLOC
	,emp_username		as REFERREDBY
	,emp_local_id		as staff_EmployeeID
	,emp_id				as staff_id
	,isnull(response_id,referral_id) as pk
from DS_Behavior		as b
left join DS_Students	as s on b.stu_id = s.stu_id




GO
/****** Object:  View [dbo].[focus_students_ell]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[focus_students_ell]
as

select 
       stu_id                as FocusStuID
      ,stu_local_id          as LocalStuID
      ,ell_status            as ELL_Status
      ,test_acmdt            as Test_Accommodations
      ,home_lang_survey_date as Home_Lang_Survey_Date
      ,classification_date   as Classification_Date
      ,entry_date            as Entry_Date
      ,lep_basis_entry       as LEP_Basis_Entry
      ,stu_plan_date         as Stu_Plan_Date
      ,ell_reeval_date       as Reeval_Date
      ,extension_instr       as Extension_Instr
      ,exit_date             as Exit_Date
      ,lep_basis_exit        as LEP_Basis_Exit
      ,lep_basis_exit2       as LEP_Basis_Exit2
      ,monitor_date1         as Monitor_Date1
      ,monitor_date2         as Monitor_Date2
      ,monitor_date3         as Monitor_Date3
      ,monitor_date4         as Monitor_Date4
      ,reclass_entry_date    as Reclass_Entry_Date
      ,reclass_exit_date     as Reclass_Exit_Date
      ,lang_parent           as Parent_Lang
      ,lang_student          as Student_Lang
      ,immigrant_stu         as Immigrant_Stu
      ,country_birth         as Country_Birth
      ,year_entered_us       as Date_Enter_US_School
      ,ell_prog_participant  as ELL_Prog_Participant
      ,ell_tier              as ELL_Tier

from DS_Students    as s
where ell_status is not null and right(ell_status,3) not in ('ZZ]','TZ]')
GO
/****** Object:  View [dbo].[focus_students_ese]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE view [dbo].[focus_students_ese]
as

select
     stu_id                     as student_id
    ,stu_local_id               as PERMNUM
    ,primary_exc                as PRIEXC
    ,iep_date                   as IEPDATE
    ,iep_reevaldate             as REEVALDATE
    ,ft_sdc                     as FT_SER_CODE
    ,pt_sdc1                    as PT_SER_CODE1
    ,pt_sdc2                    as PT_SER_CODE2
    ,pt_sdc3                    as PT_SER_CODE3
    ,iep_resch                  as RESSCH
    ,ese_totdis_minswkly        as TOTDIS_MINSWKLY
    ,ese_totnondis_minswkly     as TOTNONDIS_MINSWKLY
    ,ese_earlyint               as EARLYINT
    ,equipment_code             as EQUIPCODE
    ,ese_fefpcode               as FEFPCODE
    ,case_manager               as CASE_MGR
    ,ese_extschyrsv             as EXTSCHYRSV
    ,iep_stop_location          as IEPSTOPLOC
    ,hearing_screening_date     as HearingScreeningDate
    ,hearing_screening_status   as HearingScreeningStatus
    ,vision_screening_date      as VisionScreeningDate
    ,vision_screening_status    as VisionScreeningStatus
from DS_Students    as s
where iep_date is not null

GO
/****** Object:  View [dbo].[focus_teacher_schedule]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[focus_teacher_schedule]
as

select distinct
     syear
    ,c.sch_id       as school_id
    ,c.sch_state_id as schoolnum
    ,c.school       as schooltitle
    ,c.emp_id       as teacher_id
    ,c.emp_username as username
    ,emp_lastname   as last_name
    ,emp_firstname  as first_name
    ,u.grades       as grades
    ,term           as termcode
    ,class_id       as course_period_id
    ,marking_period_id
    ,period
    ,course         as coursetitle
    ,course_num     as coursenum
    ,course_weight
    ,room
    ,total_seats
    ,filled_seats   as total_stu
    ,null           as total_male
    ,null           as total_female
    ,start_date
    ,end_date
	,emp_lastname + ', '+ emp_firstname + isnull(' ('+u.grades+')','')	as teacher_dropdown
	,period + ' ' + course + ' (' + cast(class_id as varchar(20)) + ')' as class_dropdown

from DS_Classes     as c
left join DS_Users  as u on c.emp_id = u.emp_id
where c.emp_id is not null
GO
/****** Object:  View [dbo].[transact_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------
-- transact_students
-- 00:00:00
CREATE view [dbo].[transact_students]
as
----------------------------------


select 
     cast(stu_id as varchar(20))				    [Student ID]
    ,last_name									    [Last Name]
    ,first_name									    [First Name]
    ,middle_name								    [Middle Name]
    ,local_ethnic_code							    [Ethnicity]
    ,gender										    [Gender]
    ,cast(birthdate as varchar(20))				    [DOB]
    ,school										    [School Name]
    ,sch_state_id								    [School Code]
    ,grade										    [Grade]
    ,dbo.Quotes(address)						    [Physical Address]
    ,dbo.Quotes(address_2)						    [Physical Address Line 2]
    ,city										    [City]
    ,state										    [State]
    ,zip										    [Zip Code]
    ,dbo.Quotes(mail_address)					    [Mailing Address 1]
    ,dbo.Quotes(mail_address_2)					    [Mailing Address Line 2]
    ,mail_city									    [Mailing City]
    ,mail_state									    [Mailing State]
    ,mail_zip									    [Mailing Zip Code]
    ,dbo.Quotes(cont1_last + ', ' + cont1_first)    [Contact 1 Full Name]
    ,cont1_home_phone							    [Contact 1 Home phone]
    ,cont1_cell									    [Contact 1 Cell phone]
    ,cont1_work									    [Contact 1 Work phone]
    ,cont1_email								    [Contact 1 email]
    ,cont1_type								        [Contact 1 Relationship]
    ,dbo.Quotes(cont2_last + ', ' + cont2_first)    [Contact 2 Full Name]
    ,cont2_home_phone							    [Contact 2 Home phone]
    ,cont2_cell									    [Contact 2 Cell phone]
    ,cont2_work									    [Contact 2 Work phone]
    ,cont2_email								    [Contact 2 email]
    ,cont2_type									    [Contact 2 Relationship]
    ,dbo.Quotes(cont3_last + ', ' + cont3_first)    [Contact 3 Full Name]
    ,cont3_home_phone							    [Contact 3 Home phone]
    ,cont3_cell									    [Contact 3 Cell phone]
    ,cont3_work									    [Contact 3 Work phone]
    ,cont3_email								    [Contact 3 email]
    ,cont3_type									    [Contact 3 Relationship]
    ,cast(drop_date as varchar(20))			        [Withdrawn Date]
    ,case when primary_exc is not null and left(primary_exc, 1) <> 'L' then 'Y' else 'N' end	[IEP]
    ,case when primary_exc is not null and left(primary_exc, 1) <> 'L' then 'Y' else 'N' end	[SPED]
from DS_Students
where last_syear =  (select syear from constants where relative_year = 0)

UNION ALL select 'Student ID', 'Last Name', 'First Name', 'Middle Name', 'Ethnicity', 'Gender', 'DOB', 'School Name', 'School Code', 'Grade', 'Physical Address'
, 'Physical Address Line 2', 'City', 'State', 'Zip Code', 'Mailing Address 1', 'Mailing Address Line 2', 'Mailing City', 'Mailing State', 'Mailing Zip Code'
, 'Contact 1 Full Name', 'Contact 1 Home phone', 'Contact 1 Cell phone', 'Contact 1 Work phone', 'Contact 1 email'
, 'Contact 1 Relationship', 'Contact 2 Full Name', 'Contact 2 Home phone', 'Contact 2 Cell phone', 'Contact 2 Work phone', 'Contact 2 email', 'Contact 2 Relationship'
, 'Contact 3 Full Name', 'Contact 3 Home phone', 'Contact 3 Cell phone', 'Contact 3 Work phone', 'Contact 3 email', 'Contact 3 Relationship', 'Withdrawn Date'
, 'IEP', 'SPED'
GO
/****** Object:  View [dbo].[Clever7181_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7181_students
-- 00:00:30
-----------------------
    create view [dbo].[Clever7181_students]
    as
    select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
           'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
           'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
           'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
           'Student_zip' as Student_zip, 'Student_email' as Student_email,
           'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
           'Username' as Username, 'Password' as Password

    UNION ALL

    select distinct
             ss.sch_state_id                        as School_id
            ,cast(stu.stu_id as varchar(30))        as Student_id
            ,stu.stu_local_id                       as Student_number
            ,stu.stu_state_id                       as State_id
            ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
            ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
            ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
            ,left(right(stu.GENDER,2),1)            as GENDER
            ,convert(varchar(10),stu.birthdate,101) as DOB
            ,stu.grade                              as Grade
            ,stu.race                               as Race
            ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
            ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
            ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
                  when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
            ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
            ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
            ,stu.stu_username + '@pcsb.org'         as Student_email
            ,'"'+Contact_relationship+'"'           as Contact_relationship
            ,'"'+Contact_type+'"'                   as Contact_type
            ,'"'+Contact_name+'"'                   as Contact_name
            ,'"'+Contact_phone+'"'                  as Contact_phone
            ,'"'+Contact_email+'"'                  as Contact_email
            ,stu.stu_username                       as Username
            ,'s.'+right(stu.stu_local_id,8)         as Password
    -- select count(*)
    from DS_Classes         as ss
    join Clever7181_schools as h   on ss.sch_state_id = h.School_id
    join DS_Students        as stu on ss.stu_id = stu.stu_id
    left join (
        select stu_id
              ,cont1_type                                                         as Contact_relationship
              ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                    when cont1_emer             = 'Y'  then 'Emergency'
                    when cont1_cstdy            = 'Y'  then 'Custody'
                                                       else 'Unknown' end               as Contact_type
              ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
              ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
              ,dbo.CleanEmail(cont1_email)       as Contact_email
        from DS_Students as s
        where s.cont1_type is not null
    ) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
    where stu.stu_username is not null

GO
/****** Object:  Table [dbo].[Focus_UUID]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Focus_UUID](
	[field] [varchar](50) NULL,
	[id] [bigint] NULL,
	[value] [varchar](500) NULL,
	[uuid] [varchar](255) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[Focus_UUID_Lookup]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE view [dbo].[Focus_UUID_Lookup]
as

-- schools
select u.field as type, u.value as descr, u.id as focus_id, sch_state_idx as local_id, u.uuid as sourceid
from Focus_UUID        as u
left join DS_Schools   as s on u.id = s.sch_id
where field = 'sch_id'

-- staff
UNION ALL
select u.field as type, u.value as descr, u.id as focus_id, cast(emp_local_id as varchar(50)) as local_id, u.uuid as sourceid
from Focus_UUID      as u
left join DS_Users   as s on u.id = s.emp_id
where field = 'emp_id'

-- students
UNION ALL
select u.field as type, u.value as descr, u.id as focus_id, cast(stu_local_id as varchar(50)) as local_id, u.uuid as sourceid
from Focus_UUID       as u
left join DS_Students as s on u.id = s.stu_id
where field = 'stu_id'

-- classes
UNION ALL
select distinct u.field as type, u.value as descr, u.id as focus_id, course_num_sch+isnull(': '+course_weight,'') as local_id, u.uuid as sourceid
from Focus_UUID      as u
left join DS_Classes as s on u.id = s.class_id
where field = 'class_id'


GO
/****** Object:  View [dbo].[identakid]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[identakid]
as
select 'sch_uuid'       as sch_uuid
      ,'school_id'   as school_id
      ,'school'         as school
      ,'stu_uuid'       as stu_uuid
      ,'student_id'     as student_id
      ,'stu_lastfirst'  as stu_lastfirst
      ,'am_run'         as am_run
      ,'am_route'       as am_route
      ,'pm_run'         as pm_run
      ,'pm_route'       as pm_route

UNION ALL
select
     hu.uuid            as sch_uuid
    ,s.sch_state_id
    ,s.school
    ,su.uuid            as stu_uuid
    ,s.stu_local_id
    ,s.last_first
    ,s.am_run_id
    ,s.am_route_id
    ,s.pm_run_id
    ,s.pm_route_id

from DS_Students    as s
join Focus_UUID     as su on su.field = 'stu_id' and s.stu_id = su.id
join Focus_UUID     as hu on hu.field = 'sch_id' and s.sch_id = hu.id
where s.active = 1
  and ( s.am_run_id is not null or s.pm_run_id is not null )

GO
/****** Object:  View [dbo].[insights_to_behavior]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------------------------------
CREATE view [dbo].[insights_to_behavior]
AS
-----------------------------------------------
select first_name as [First Name], last_name as [Last Name], Email, Org, Title
from (
		select
			   case when o.v03 in (
						 'ESE Specialist'
						,'Executive Director'
						,'Managing Officer'
						,'District Behavior Specialist'
						,'School Social Worker'
						,'School Psychologist'
						,'Behavior Specialist'
						,'School Counselor'
						)
					then 'Pinellas County Schools FL'
					else l.school end		as Org
			  ,o.v03 as Title
			  ,u.*
		from DS_Users			as u
		join DS_Apps_Options	as o on o.app_id = 33 and o.type = 'JobCode' and u.pcsbjobcode = o.v01
		left join DS_Schools	as l on u.location = l.sch_state_idx
		where 
		   EmpStatus in ('A - Active','L - On Leave')
		  and EmpStatusType in ('F - Full Time','P - Part Time')

) as u where Org is not null

-- Header row
UNION ALL
select 'First Name','Last Name','Email','Org','Title'


GO
/****** Object:  View [dbo].[MySchoolID]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
---------------------------
-- MySchoolID
-- 00:00:10
--
--  select * from myschoolid

CREATE view [dbo].[MySchoolID]
as

select 'School_ID' as School_ID,'School_Name' as School_Name,'DCID' as DCID,'Last_Name' as Last_Name,'First_Name' as First_Name,'Email' as Email,'Grade_Level' as Grade_Level,'Student_ID' as Student_ID
      ,'Guardian_First_Name'  as Guardian_First_Name, 'Guardian_Last_Name'  as Guardian_Last_Name, 'Guardian_Email'  as Guardian_Email
      ,'Guardian2_First_Name' as Guardian2_First_Name,'Guardian2_Last_Name' as Guardian2_Last_Name,'Guardian2_Email' as Guardian2_Email

UNION ALL

select distinct
     '"'+ h.sch_state_id +'"'                   as School_ID
    ,'"'+ h.school +'"'                         as School_Name
    ,'"'+ u.uuid + '"'                          as DCID
    ,'"'+ s.last_name +'"'                      as Last_Name
    ,'"'+ s.first_name +'"'                     as First_Name
    ,'"'+ s.stu_username +'@pcsb.org"'          as Email
    ,'"'+ s.grade +'"'                          as Grade_Level
    ,'"'+ s.stu_local_id +'"'                   as Student_ID

    ,'"'+ Guardian_First_Name +'"'              as Guardian_First_Name
    ,'"'+ Guardian_Last_Name  +'"'              as Guardian_Last_Name
    ,'"'+ Guardian_Email      +'"'              as Guardian_Email

    ,'"'+ Guardian2_First_Name +'"'             as Guardian2_First_Name
    ,'"'+ Guardian2_Last_Name  +'"'             as Guardian2_Last_Name
    ,'"'+ Guardian2_Email      +'"'             as Guardian2_Email

from DS_Students    as s
join DS_Schools     as h on s.sch_id = h.sch_id and h.PCS_K12 = 'Y'
join Focus_UUID     as u on s.stu_id = u.id and u.field = 'stu_id'
left join (
        select stu_id
              ,max(case when seq = 1 then first_name end) as Guardian_First_Name
              ,max(case when seq = 1 then last_name  end) as Guardian_Last_Name
              ,max(case when seq = 1 then email      end) as Guardian_Email
              ,max(case when seq = 2 then first_name end) as Guardian2_First_Name
              ,max(case when seq = 2 then last_name  end) as Guardian2_Last_Name
              ,max(case when seq = 2 then email      end) as Guardian2_Email         
        from DS_Contacts as c
        where left(email,charindex('@',email)-1) not like '%[!''=+#`/"]%'  -- filter out mailbox names having characters not supported by MySchoolID: ! ' = + # ` / "
          and email <> (select stu_username+'@pcsb.org' from DS_Students where stu_id = c.stu_id) -- filter out guardians using student's PCS email
        group by stu_id
) as c on s.stu_id = c.stu_id
where s.active = 1
  and s.stu_username is not null


GO
/****** Object:  View [dbo].[NWEA_Additional_Users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- NWEA MAP Additional Users
--      select * from NWEA_Additional_Users
CREATE view [dbo].[NWEA_Additional_Users]
as
select
     'School State Code'                        as sch_state_id
    ,'School Name'                              as school
    ,'Instructor ID'                            as emp_id
    ,'Instructor State ID'                      as emp_state_id
    ,'Last Name'                                as last
    ,'First Name'                               as first
    ,'Middle Name'                              as middle
    ,'User Name'                                as username
    ,'Email Address'                            as email
    ,'Role = School Proctor?'                   as role_proc_sch
    ,'Role = School Assessment Coordinator?'    as role_assess_sch
    ,'Role = Administrator?'                    as role_admin
    ,'Role = District Proctor?'                 as role_proc_dist
    ,'Role = Data Administrator?'               as role_data
    ,'Role = District Assessment Coordinator?'  as role_assess_dist
    ,'Role = Interventionist?'                  as role_interv
    ,'Role = SN Administrator?'                 as role_sn_admin
UNION ALL

select
         u.location
        ,h.school
        ,'T'+cast(u.emp_id as varchar(20))  as instructor_id
        ,emp_state_id
        ,last_name
        ,first_name
        ,null                                   as middle_name
        ,email                                  as username
        ,email                                  as email
        ,null                                   as role_proc_sch
        ,null                                   as role_assess_sch
        ,case when o.v03 in ('Principal','Assistant Principal','Guidance','Coach'           ) then 'Y' end as role_admin
        ,case when o.v03 in ('Principal','Assistant Principal','Guidance','Coach','Tech'    ) then 'Y' end as role_proc_dist
        ,null                                   as role_data
        ,null                                   as role_assess_dist
        ,null                                   as role_interv
        ,null                                   as role_sn_admin
         
-- select *
-- select distinct o.v03
from DS_Users           as u 
join DS_Apps_Options    as o on o.app_id = 11 and o.type = 'School Admins' and u.pcsbjobcode = o.v01
join DS_Apps_Options    as s on s.app_id = 16 and s.type = 'Schools' and u.location = s.v01
join DS_Schools         as h on s.i01 = h.sch_id
where u.account = 'Active'
  and u.email is not null
  and u.emp_id not in (select i01 from DS_Apps_Options where app_id = 11 and type = 'School Admins Override')
  and o.v03 in ('Principal','Assistant Principal','Guidance','Coach','Tech')
GO
/****** Object:  Table [dbo].[o365_School]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[o365_School](
	[SIS ID] [varchar](20) NULL,
	[Name] [varchar](50) NULL,
	[State ID] [varchar](20) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[o365_Opt_Sections]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------
-- o365_Opt_Sections
-- Used by o365_Sections view
-- Contains course-based teams for elementary teachers defined by pcsbjobcode in DS_Apps_Options table.
-- Join on [SIS ID] which is sch_id+emp_id+course_num
----------------------

create view [dbo].[o365_Opt_Sections]
as

        select distinct
			 cast(t.class_id			as varchar(20))	as [SIS ID]
			,cast(t.sch_id				as varchar(20))	as [School SIS ID]
              ,'"'+t.course+' ('+upper(c.emp_username)+') '+cast(t.class_id as varchar(50))+'"' as [Section Name]
              ,'YR'                                     as [Term Name]
              ,convert(varchar(20),t.start_date,101)    as [Term StartDate]
              ,convert(varchar(20),t.end_date  ,101)    as [Term EndDate]
        from DS_Classes         as c
		join DS_Students	    as s on c.stu_id = s.stu_id and s.Account = 'Active' and s.active = 1
		join DS_Users		    as u on c.emp_id = u.emp_id and u.Account = 'Active'
        join constants          as y on c.syear = y.syear
        join DS_Apps_Options    as o on o.app_id = 17 and o.type = 'byCourse' and u.pcsbjobcode = o.v01
        join ( -- each teacher's courses, at each school (not sections)
                select c.emp_id, c.sch_id, c.course_num, c.course
                      ,cast(sch_id as varchar(20))+'.'+cast(c.emp_id as varchar(20))+'.'+cast(course_num as varchar(20)) as class_id
                      ,min(start_date) as start_date, max(end_date) as end_date
                from DS_Classes         as c
                join DS_Users           as u on c.emp_id = u.emp_id
                join DS_Apps_Options    as o on o.app_id = 17 and o.type = 'byCourse' and u.pcsbjobcode = o.v01
                where isnumeric(c.course_num) = 1
                group by c.emp_id, c.sch_id, c.course_num, c.course
        ) as t on c.emp_id = t.emp_id and c.sch_id = t.sch_id and c.course_num = t.course_num
        where c.sch_id in (select [SIS ID] from o365_School where isnumeric([SIS ID])=1)
          and y.school_date <= c.stu_end_date 
GO
/****** Object:  View [dbo].[OPS_staff_dem]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[OPS_staff_dem]
as

select	 emp_id
		,last_name
		,first_name
		,gender
		,race
		,jobtitle
		,SSN
		,birthdate
		,costcenter
		,costcenter_name
		,hiredate

 -- select *
from DS_Users 
GO
/****** Object:  View [dbo].[Clever7781_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7781_students
-- 00:00:30
-----------------------
    create view [dbo].[Clever7781_students]
    as
    select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
           'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
           'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
           'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
           'Student_zip' as Student_zip, 'Student_email' as Student_email,
           'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
           'Username' as Username, 'Password' as Password

    UNION ALL

    select distinct
             ss.sch_state_id                        as School_id
            ,cast(stu.stu_id as varchar(30))        as Student_id
            ,stu.stu_local_id                       as Student_number
            ,stu.stu_state_id                       as State_id
            ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
            ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
            ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
            ,left(right(stu.GENDER,2),1)            as GENDER
            ,convert(varchar(10),stu.birthdate,101) as DOB
            ,stu.grade                              as Grade
            ,stu.race                               as Race
            ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
            ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
            ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
                  when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
            ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
            ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
            ,stu.stu_username + '@pcsb.org'         as Student_email
            ,'"'+Contact_relationship+'"'           as Contact_relationship
            ,'"'+Contact_type+'"'                   as Contact_type
            ,'"'+Contact_name+'"'                   as Contact_name
            ,'"'+Contact_phone+'"'                  as Contact_phone
            ,'"'+Contact_email+'"'                  as Contact_email
            ,stu.stu_username                       as Username
            ,'s.'+right(stu.stu_local_id,8)         as Password
    -- select count(*)
    from DS_Classes         as ss
    join Clever7781_schools as h   on ss.sch_state_id = h.School_id
    join DS_Students        as stu on ss.stu_id = stu.stu_id
    left join (
        select stu_id
              ,cont1_type                                                         as Contact_relationship
              ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                    when cont1_emer             = 'Y'  then 'Emergency'
                    when cont1_cstdy            = 'Y'  then 'Custody'
                                                       else 'Unknown' end               as Contact_type
              ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
              ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
              ,dbo.CleanEmail(cont1_email)       as Contact_email
        from DS_Students as s
        where s.cont1_type is not null
    ) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
    where stu.stu_username is not null


GO
/****** Object:  Table [dbo].[bright_futures_gpa]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[bright_futures_gpa](
	[stu_id] [int] NULL,
	[ss_top_grade] [int] NULL,
	[run_crdern_tot_ss] [decimal](18, 2) NULL,
	[run_pts_ss] [decimal](18, 2) NULL,
	[gpa_ss] [int] NULL,
	[en_top_grade] [int] NULL,
	[run_crdern_tot_en] [decimal](18, 2) NULL,
	[run_pts_en] [decimal](18, 2) NULL,
	[gpa_en] [int] NULL,
	[mth_top_grade] [int] NULL,
	[run_crdern_tot_mth] [decimal](18, 2) NULL,
	[run_pts_mth] [decimal](18, 2) NULL,
	[gpa_mth] [int] NULL,
	[sc_top_grade] [int] NULL,
	[run_crdern_tot_sc] [decimal](18, 2) NULL,
	[run_pts_sc] [decimal](18, 2) NULL,
	[gpa_sc] [int] NULL,
	[fl_top_grade] [int] NULL,
	[run_crdern_tot_fl] [decimal](18, 0) NULL,
	[run_pts_fl] [decimal](18, 0) NULL,
	[gpa_fl] [int] NULL,
	[pt_tot] [decimal](18, 2) NULL,
	[crs_tot] [int] NULL,
	[gpa] [decimal](18, 5) NULL,
	[gpa_partial] [decimal](18, 5) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[PLP_bright_fut_gpa]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[PLP_bright_fut_gpa]
as

select cast(g.stu_id as varchar(20)) as stu_id, stu_username, grade, g.gpa as brt_fut_gpa
from bright_futures_gpa as g
join DS_Students as ds on g.stu_id = ds.stu_id
where active = 1
and g.gpa is not null

GO
/****** Object:  View [dbo].[PLP_ES_Demographics]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[PLP_ES_Demographics]
as

select 
	 cast(s.stu_username as varchar(10))					as stu_username
	 ,s.last_name
	 ,s.first_name
	 ,s.school
	,cast(s.stu_id as varchar(10))							as stu_id
	,cast(M.syear as varchar(10))							as syear
	,cast(s.grade as varchar(10))							as grade
	,s.gender
	,case when M.[group] = 'Ethnicity' then subgroup end	as Ethnicity
	,cast(M.abs_rate as varchar(10))						as Abs_Percent

from DS_Students		as s

left join (  --Ethnicity
		select
			 ROW_NUMBER() over (partition by c.stu_id order by c.syear desc) as seq
			,c.stu_id
			,c.syear
			,c.subgroup
			,c.[group]
			,c.abs_rate
			,c.timeframe
			,c.timeframe_id

		from Profile_Attendance_Students	as c
		where c.[group] = 'Ethnicity'

) as M on M.seq = 1 and s.stu_id = M.stu_id

left join( -- Current Year

	select
		 syear
		,relative_year
	from constants 
	where relative_year = 0
) as y on y.syear = timeframe_id
where s.active = 1
and s.grade in ('02', '03', '04', '05')
--and s.stu_id = 386610 
GO
/****** Object:  View [dbo].[PLP_ES_Form_ELA]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

--USE [EDS]
--GO

--/****** Object:  View [dbo].[PLP_MS_Form_Asmt]    Script Date: 2/27/2019 10:10:03 AM ******/
--SET ANSI_NULLS ON
--GO

--SET QUOTED_IDENTIFIER ON
--GO

CREATE view [dbo].[PLP_ES_Form_ELA]
as

select 
	 t.stu_username + '@pcsb.org'	as stu_email
	,cast(t.stu_id as varchar)		as stu_id
	,t.stu_lastname
	,t.stu_firstname
	,t.course
	,t.emp_username + '@pcsb.org'	as emp_email
	,t.emp_lastname
	,t.emp_firstname
  ,course_num
from 
(select  
   ROW_NUMBER() over(partition by stu_id order by course_num desc) as seq
  ,stu_username, stu_lastname, stu_firstname, course, emp_username, emp_lastname, emp_firstname, course_num, stu_id, does_grades
  --select *
 from DS_Classes 
 where course_num in ('5010045', '7710016', '7710015', '5010044', '5010046', '7710014')
 and does_grades = 'Y'
  ) as t
where t.seq = 1
GO
/****** Object:  View [dbo].[PLP_ES_Progress]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[PLP_ES_Progress]
as

select 
     cast(s.stu_username as varchar(10))		as stu_username
    ,cast(s.stu_id as varchar(10))				as stu_id
    ,cast(M.syear as varchar(10))		        as MTH_syear
    ,M.title									as MTH_course
    ,cast(M.mark as varchar(10))		        as MTH_grade		--9 Weeks gradbook grade
    ,cast(E.syear as varchar(10))		        as ELA_syear
    ,E.title									as ELA_course
    ,E.mark										as ELA_grade		--9 Weeks gradbook grade

from DS_Students    as s

left join ( -- Math courses
        select
             row_number() over (partition by c.stu_id order by c.start_date desc) as seq
            ,c.stu_id
            ,c.syear
            ,c.start_date
            ,c.course_num
            ,c.title
            ,c.mark
        from [Profile_Student_Courses] as c
        where c.mark is not null
          and left(c.title, 4) = 'MATH'
) as M on M.seq=1 and s.stu_id = M.stu_id

left join ( -- ELA courses
        select
             row_number() over (partition by c.stu_id order by c.start_date desc, mark desc) as seq
            ,c.stu_id
            ,c.syear
            ,c.start_date
            ,c.course_num
            ,c.title
            ,c.mark
        from [Profile_Student_Courses] as c
        where c.mark is not null
          and left(c.title, 4) = 'LANG'
) as E on E.seq=1 and s.stu_id = E.stu_id

where s.active = 1
  and s.grade in ('02', '03', '04', '05')
--  and s.stu_id = 450501
GO
/****** Object:  View [dbo].[Clever7681_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7681_students
-- 00:00:30
-----------------------
    create view [dbo].[Clever7681_students]
    as
    select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
           'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
           'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
           'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
           'Student_zip' as Student_zip, 'Student_email' as Student_email,
           'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
           'Username' as Username, 'Password' as Password

    UNION ALL

    select distinct
             ss.sch_state_id                        as School_id
            ,cast(stu.stu_id as varchar(30))        as Student_id
            ,stu.stu_local_id                       as Student_number
            ,stu.stu_state_id                       as State_id
            ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
            ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
            ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
            ,left(right(stu.GENDER,2),1)            as GENDER
            ,convert(varchar(10),stu.birthdate,101) as DOB
            ,stu.grade                              as Grade
            ,stu.race                               as Race
            ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
            ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
            ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
                  when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
            ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
            ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
            ,stu.stu_username + '@pcsb.org'         as Student_email
            ,'"'+Contact_relationship+'"'           as Contact_relationship
            ,'"'+Contact_type+'"'                   as Contact_type
            ,'"'+Contact_name+'"'                   as Contact_name
            ,'"'+Contact_phone+'"'                  as Contact_phone
            ,'"'+Contact_email+'"'                  as Contact_email
            ,stu.stu_username                       as Username
            ,'s.'+right(stu.stu_local_id,8)         as Password
    -- select count(*)
    from DS_Classes         as ss
    join Clever7681_schools as h   on ss.sch_state_id = h.School_id
    join DS_Students        as stu on ss.stu_id = stu.stu_id
    left join (
        select stu_id
              ,cont1_type                                                         as Contact_relationship
              ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                    when cont1_emer             = 'Y'  then 'Emergency'
                    when cont1_cstdy            = 'Y'  then 'Custody'
                                                       else 'Unknown' end               as Contact_type
              ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
              ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
              ,dbo.CleanEmail(cont1_email)       as Contact_email
        from DS_Students as s
        where s.cont1_type is not null
    ) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
    where stu.stu_username is not null

GO
/****** Object:  View [dbo].[PLP_ES_Students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[PLP_ES_Students]
as

select 
	 cast(s.stu_username as varchar(10))					as stu_username
	 ,'''' + s.last_name + ''''								as last_name
	 ,'''' + s.first_name + ''''							as first_name
	 ,'''' + s.school + ''''								as school
	,cast(s.stu_id as varchar(10))							as stu_id
	,cast(s.stu_local_id as varchar(10))	as stu_local_id
	,cast(s.last_syear as varchar(10))						as syear
	,cast(s.grade as varchar(10))							as grade
	,s.gender
	,m.local_ethnic_code									as Ethnicity
	,cast(m.abs_all_per as varchar(10))						as Abs_Percent
	,cast(s.yr_grad as varchar(10))							as yr_grad
from DS_Students		as s

left join (  --Ethnicity
		select
			 c.stu_id
			,c.abs_all_per
			,c.local_ethnic_code

		from KPI_Students	as c
		--where stu_id = 386610
) as M on s.stu_id = M.stu_id

--left join( -- Current Year

--	select
--		 syear
--		,relative_year
--	from constants 
--	where relative_year = 0
--) as y on y.syear = timeframe_id
where s.active = 1
and s.grade in ('02', '03', '04', '05')
--and s.stu_id = 386610 
GO
/****** Object:  View [dbo].[write_score]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[write_score]
as

select 'School Name' as school, 'Grade' as grade, 'Teacher First name' as teacher_first, 'Teacher Last name' as teacher_last, 'Teacher Email' as teacher_email,
       'Period' as period, 'Course Number' as course_num, 'Course Name' as course, 'Additional Teacher First Name' as teacher2_first, 'Additional Teacher Last Name' as teacher2_last, 'Additional Teacher Email' as teacher2_email,
       'Student First Name' as student_first, 'Student Last Name' as student_last, 'Student ID' as studentid, 'Subject' as subject,
       'Race' as race, 'Gender' as gender, 'ELL' as ell, 'Migrant' as migrant, 'Free Lunch' as freelunch, 'Disabled' as disabled,
       'Username' as username, 'Password' as password

UNION ALL
select school, grade, teacher_first, teacher_last, teacher_email, period, course_num, course, teacher2_first, teacher2_last, teacher2_email,
       student_first, student_last, studentid, subject, race, gender, ell, migrant, freelunch, disabled, username, password
from (
        select row_number() over (partition by studentid order by ela desc, ese, course_num desc, teacher_email, period) as seq, *
        from (
            select c.school
                   ,case when left(s.grade,1) = '0' then right(s.grade,1)
                         else s.grade end                                       as grade
                   ,'"'+ c.emp_firstname  +'"'                                     as teacher_first
                   ,'"'+ c.emp_lastname +'"'                                       as teacher_last
                   ,isnull(u.email,c.emp_username+'@pcsb.org')                                                     as teacher_email
                   ,left(c.period,2)                                            as period
                   ,'"'+ c.stu_firstname + '"'                                  as student_first
                   ,'"'+ c.stu_lastname  + '"'                                  as student_last
                   ,s.stu_id
                   ,s.stu_local_id                                              as studentid
                   ,'W'                                                         as subject
                  ,rtrim(case when group_asian = 'Y' or group_pacific = 'Y' then 'A ' else '' end
                        +case when group_black = 'Y'      then 'B ' else '' end
                        +case when group_hispanic = 'Y'   then 'H ' else '' end
                        +case when group_native = 'Y'     then 'I ' else '' end
                        +case when group_white = 'Y'      then 'W'  else '' end)
                                                                                as race
                   ,dbo.getcodefrombrackets(s.gender)                           as gender
                   ,case dbo.GetCodeFromBrackets(s.ell_status)
                            when 'LF' then 'Y'
                            when 'LY' then 'Y'
                            end                                                 as ell
                   ,null                                                        as migrant
                   ,null                                                        as disabled
                   ,s.stu_username                                              as Username
                   ,'s.'+right(s.stu_local_id,8)                                as Password
                  ,u.jobtitle                                                   as title
                  ,case when left(c.course_num,2) = '10'   then 1
                        when left(c.course_num,4) = '5010' then 1
                        else 0 end                                              as ela
                  ,case when u.jobtitle like '%exce%' then 1
                        when u.jobtitle like '%emot%' then 1
                        when u.jobtitle like '%beha%' then 1 else 0 end         as ese
                  ,null                                                         as freelunch
                  ,c.course_num                                                 as course_num
                  ,c.course                                                     as course

            -- select c.*
            -- select distinct permnum
            from DS_Classes     as c
            join DS_Students    as s   on c.stu_id = s.stu_id
            left join DS_Users  as u   on c.emp_id = u.emp_id
            where c.stu_username is not null -- only valid students
              --and c.email is not null        -- only valid teachers
              and case when getdate() < (select start_yr from constants where relative_year=0) then (select start_yr from constants where relative_year=0) else getdate() end between c.start_date and c.end_date  -- only want active classes as of today
              and s.grade in ('05','06','07','08','09','10','11','12')
              and (
                        c.course_num in (
                                    '1001010'     -- M/J LANG ARTS 1
                                   ,'1001020'     -- M/J LANG ARTS 1, ADV
                                   ,'1001025'	  -- M/J ENG 1 CAMB SEC 1
                                   ,'1001030'     -- M/J IB MYP LANG/LIT1
                                   ,'1001040'     -- M/J LANG ARTS 2
                                   ,'1001050'     -- M/J LANG ARTS 2, ADV
                                   ,'1001055'	  -- M/J ENG 2 CAMB SEC 1
                                   ,'1001060'	  -- M/J IB MYP LANG/LIT2
                                   ,'1001070'     -- M/J LANG ARTS 3
                                   ,'1001080'     -- M/J LANG ARTS 3, ADV
                                   ,'1001090'     -- M/J IB MYP LANG/LIT3
                                   ,'1002000'     -- M/J LANG ARTS 1 ESOL
                                   ,'1002010'     -- M/J LANG ARTS 2 ESOL
                                   ,'1002020'     -- M/J LANG ARTS 3 ESOL
                                   ,'1001310'     -- ENG 1
                                   ,'1001320'     -- ENG HON 1
                                   ,'1001340'     -- ENG 2
                                   ,'1001350'     -- ENG HON 2
                                   ,'1001370'     -- ENG 3
                                   ,'1001380'     -- ENG HON 3
                                   ,'1001420'     -- AP ENG COMPO
                                   ,'1001425'     -- AP ENG COMPO INNOV
                                   ,'1001430'     -- AP ENG LIT COMPO
                                   ,'1001550'     -- AICE ENG LANG AS
                                   ,'1001551'     -- AICE ENG LANG 2 AL
                                   ,'1001560'     -- PRE-AICE ENG LANG IG
                                   ,'1001800'     -- FL PRE-IB ENG 1
                                   ,'1001810'     -- FL PRE-IB ENG 2
                                   ,'1001820'     -- IB ENGLISH LIT 3
                                   ,'1001840'     -- IB MYP ENG 1
                                   ,'1002300'     -- ENG 1 THROUGH ESOL
                                   ,'1002310'     -- ENG 2 THROUGH ESOL
                                   ,'1002320'     -- ENG 3 THROUGH ESOL
                                   ,'1002380'     -- DEV LANG ARTS ESOL
                                   ,'1002381'     -- DEV LANG ARTS ESOL-R
                                   ,'1005370'     -- AICE ENG LIT 1 AS
                                   ,'1005375'     -- AICE ENG LIT 2 AL
                                   ,'1005380'     -- PRE-AICE ENG LIT IG
                                   ,'1009360'     -- AICE GEN PAPER AS
                                   ,'1009400'     -- AICE ENG GEN PAPER 1


                                   )

                     or (c.sch_id in (61,92) and c.course_num = '5010046') -- Lealman Innov, Clearwater Int 5.5th grade students

                  )
            --and c.stu_username = 'd8.gv'
        ) as t
) as w
left join ( -- these are the students' reading teachers
        select row_number() over (partition by c.stu_id order by u.emp_id) as seq, c.stu_id, u.first_name as teacher2_first, u.last_name as teacher2_last, u.email as teacher2_email 
        -- select *
        from DS_Classes as c
        join DS_Users   as u on c.emp_id = u.emp_id
        where c.course_num in (
                 '1002381'     -- DEV LANG ARTS ESOL-R
                ,'1000410'     -- INTENS READ
                ,'1008350'     -- READ COLL. SUCCESS
                )
        --or (c.course_num = '1008350' and c.course_weight in ('N','T')) -- READ COLL. SUCCESS for Ninth and Tenth grades

) as t2 on t2.seq = 1 and w.stu_id = t2.stu_id

where w.seq = 1


GO
/****** Object:  View [dbo].[PLP_HS_Demographics]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[PLP_HS_Demographics]
as

select 
	 cast(s.stu_username as varchar(10))					as stu_username
	 ,s.last_name
	 ,s.first_name
	 ,s.school
	,cast(s.stu_id as varchar(10))							as stu_id
	,cast(M.syear as varchar(10))							as syear
	,cast(s.grade as varchar(10))							as grade
	,s.gender
	,case when M.[group] = 'Ethnicity' then subgroup end	as Ethnicity

from DS_Students		as s

left join (  --Ethnicity
		select
			 ROW_NUMBER() over (partition by c.stu_id order by c.syear desc) as seq
			,c.stu_id
			,c.syear
			,c.subgroup
			,c.[group]
			,c.abs_rate
			,c.timeframe

		from Profile_Attendance_Students	as c
		where c.[group] = 'Ethnicity'

) as M on M.seq = 1 and s.stu_id = M.stu_id

where s.active = 1
and s.grade in ('09', '10', '11', '12')
--and s.stu_id = 12272
GO
/****** Object:  View [dbo].[PLP_HS_Form_ELA]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



--USE [EDS]
--GO

--/****** Object:  View [dbo].[PLP_MS_Form_Asmt]    Script Date: 2/27/2019 10:10:03 AM ******/
--SET ANSI_NULLS ON
--GO

--SET QUOTED_IDENTIFIER ON
--GO

CREATE view [dbo].[PLP_HS_Form_ELA]
as

select 
	 t.stu_username + '@pcsb.org'	as stu_email
	,cast(t.stu_id as varchar(100))		as stu_id
	,t.stu_lastname
	,t.stu_firstname
	,t.course
	,t.emp_username + '@pcsb.org'	as emp_email
	,t.emp_lastname
	,t.emp_firstname
from 
(select  
   ROW_NUMBER() over(partition by stu_id order by course_num desc) as seq
  ,stu_username, stu_id, stu_lastname, stu_firstname, course, emp_username, emp_lastname, emp_firstname, does_grades
  --select *
 from DS_Classes 
 where course_num in ('1001370', '1001410', '1001340', '1001310', '1001380', '1001350', '1001320', '1001405', '1001430')
 and does_grades = 'Y'
  ) as t
where t.seq = 1

GO
/****** Object:  View [dbo].[PLP_MS_Demographics]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[PLP_MS_Demographics]
as

select 
	 cast(s.stu_username as varchar(10))					as stu_username
	 ,s.last_name
	 ,s.first_name
	 ,s.school
	,cast(s.stu_id as varchar(10))							as stu_id
	,cast(M.syear as varchar(10))							as syear
	,cast(s.grade as varchar(10))							as grade
	,s.gender
	,case when M.[group] = 'Ethnicity' then subgroup end	as Ethnicity

from DS_Students		as s

left join (  --Ethnicity
		select
			 ROW_NUMBER() over (partition by c.stu_id order by c.syear desc) as seq
			,c.stu_id
			,c.syear
			,c.subgroup
			,c.[group]
			,c.abs_rate
			,c.timeframe

		from Profile_Attendance_Students	as c
		where c.[group] = 'Ethnicity'

) as M on M.seq = 1 and s.stu_id = M.stu_id

where s.active = 1
and s.grade in ('06', '07', '08')
--and s.stu_id = 12272

GO
/****** Object:  View [dbo].[PLP_MS_Form_Asmt]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE view [dbo].[PLP_MS_Form_Asmt]
as

select 
	 t.stu_username + '@pcsb.org'	as stu_email
	,cast(t.stu_id as varchar)		as stu_id
	,t.stu_lastname
	,t.stu_firstname
	,t.course
	,t.emp_username + '@pcsb.org'	as emp_email
	,t.emp_lastname
	,t.emp_firstname
from 
(select  
   ROW_NUMBER() over(partition by stu_id order by course_num desc) as seq
  ,*
  --select *
 from DS_Classes 
 where course_num in ('1205010', '1205020', '1205040', '1205050', '1200320', '1205070', '1200310', '1205090')
 and avg_grade in ('06', '07', '08')
 and does_grades = 'Y'
   ) as t
where t.seq = 1



GO
/****** Object:  View [dbo].[PLP_MS_Form_ELA]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



--USE [EDS]
--GO

--/****** Object:  View [dbo].[PLP_MS_Form_Asmt]    Script Date: 2/27/2019 10:10:03 AM ******/
--SET ANSI_NULLS ON
--GO

--SET QUOTED_IDENTIFIER ON
--GO

CREATE view [dbo].[PLP_MS_Form_ELA]
as

select 
	 t.stu_username + '@pcsb.org'	as stu_email
	,cast(t.stu_id as varchar)		as stu_id
	,t.stu_lastname
	,t.stu_firstname
	,t.course
	,t.emp_username + '@pcsb.org'	as emp_email
	,t.emp_lastname
	,t.emp_firstname
from 
(select  
   ROW_NUMBER() over(partition by stu_id order by course_num desc) as seq
  ,*
  --select *
 from DS_Classes 
 where course_num in ('1001010', '1001025', '1001055', '1001020', '1001040', '1001050', '1001070', '10010708', '1001320', '1001040', '10010106', '1001320', '1001080', '1001090', '1001060', '1001030', '1001060', '1001090', '1001840')
 and does_grades = 'Y'
  ) as t
where t.seq = 1

GO
/****** Object:  View [dbo].[PLP_MS_Honor_Courses]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[PLP_MS_Honor_Courses]
as
	select
	  convert(varchar(10), p.stu_id) + convert(varchar(10), p.course_num) as U_id
	, ds.stu_id
	, ds.stu_username
	, ds.grade						as curr_grade
	, title							as course
	, mark							
	, p.credearned
	, p.term

from Profile_Student_Courses		as p
join DS_Students					as ds on p.stu_id = ds.stu_id
where honors_course = 1
and ds.grade in ('08', '07', '06')
and ds.active = 1
--and p.stu_id = 83488
--order by U_id
GO
/****** Object:  Table [dbo].[PLP_MS_Progression]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PLP_MS_Progression](
	[localid] [varchar](255) NULL,
	[student_id] [numeric](18, 0) NOT NULL,
	[SchoolId] [numeric](18, 0) NOT NULL,
	[SchoolName] [varchar](356) NULL,
	[SchoolNum] [varchar](255) NULL,
	[studentname] [varchar](153) NOT NULL,
	[InstrSet] [varchar](1) NOT NULL,
	[CurrentGrade] [varchar](50) NULL,
	[age] [varchar](2) NULL,
	[birthdate] [varchar](10) NULL,
	[Local_EthnicCode] [varchar](1) NULL,
	[RecentReadAdmDate] [varchar](10) NULL,
	[RecentReadAdmGrade] [varchar](10) NULL,
	[RecentReading] [float] NULL,
	[RecentReadLvl] [float] NULL,
	[RecentMathAdmDate] [varchar](10) NULL,
	[RecentMathAdmGrade] [varchar](10) NULL,
	[RecentMath] [float] NULL,
	[RecentMathLvl] [float] NULL,
	[nondisminwkly] [varchar](255) NULL,
	[handicapct] [varchar](1) NULL,
	[LAcount] [int] NULL,
	[SScount] [int] NULL,
	[SCIcount] [int] NULL,
	[MTHcount] [float] NULL,
	[ALG1count] [float] NULL,
	[GEO_enr] [int] NULL,
	[GEOcount] [float] NULL,
	[F_MTH] [varchar](1) NULL,
	[F_MTH_most_recent_mp] [varchar](1) NULL,
	[F_MTH_S1] [varchar](1) NULL,
	[F_MTH_S2_FY] [varchar](1) NULL,
	[F_LA] [varchar](1) NULL,
	[F_LA_most_recent_mp] [varchar](1) NULL,
	[F_LA_S1] [varchar](1) NULL,
	[F_LA_S2_FY] [varchar](1) NULL,
	[F_SS] [varchar](1) NULL,
	[F_SS_most_recent_mp] [varchar](1) NULL,
	[F_SS_S1] [varchar](1) NULL,
	[F_SS_S2_FY] [varchar](1) NULL,
	[F_SCI] [varchar](1) NULL,
	[F_SCI_most_recent_mp] [varchar](1) NULL,
	[F_SCI_S1] [varchar](1) NULL,
	[F_SCI_S2_FY] [varchar](1) NULL,
	[on_track_flag] [varchar](1) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[PLP_MS_Progress]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[PLP_MS_Progress]
as
select 
	 cast(ds.stu_username as varchar(10))	as stu_username
	,cast(p.student_id as varchar(10))		as stu_id
	,cast(p.CurrentGrade as varchar(10))	as Grade
	,cast(ds.yr_grad as varchar(10))		as yr_grad
	,cast(ds.gpa_unwtd as varchar(10))		as gpa
	,cast(p.RecentReading as varchar(10))	as ReadScl
	,cast(p.RecentReadLvl as varchar(10))	as ReadLvl
	,cast(p.RecentMathlvl as varchar(10))	as MathLvl
	,cast(p.RecentMath as varchar(10))	as MathScl
	,cast(p.MTHcount as varchar(10))		as MTHCredit
	,cast(p.LAcount as varchar(10))			as ELACredit
	,cast(p.SScount as varchar(10))			as SSCredit
	,cast(p.SCIcount as varchar(10))		as SCICredit
	,cast(p.ALG1count as varchar(10))		as ALG1Credit
	,p.F_MTH								as F_MTH
	,p.F_MTH_most_recent_mp					as F_MTH_recent_mp
	,p.F_LA									as F_ELA
	,p.F_LA_most_recent_mp					as F_ELA_recent_mp
	,p.F_SS									as F_SS
	,p.F_SS_most_recent_mp					as F_SS_recent_mp
	,p.F_SCI								as F_SCI
	,p.F_SCI_most_recent_mp					as F_SCI_recent_mp
	
from PLP_MS_Progression				as p
join DS_Students					as ds on p.student_id = ds.stu_id

union All select 'stu_username', 'stu_id', 'Grade', 'yr_grad', 'gpa', 'ReadScl', 'ReadLvl', 'MathLvl', 'MathScl', 'MTHCredit', 'ELACredit', 'SSCredit', 'SCICredit', 'ALG1Credit', 'F_MTH', 'F_MTH_recent_mp', 'F_ELA', 'F_ELA_recent_mp', 'F_SS', 'F_SS_recent_mp', 'F_SCI', 'F_SCI_recent_mp'
GO
/****** Object:  View [dbo].[Clever7481_students]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-----------------------
-- Clever7481_students
-- 00:00:30
-----------------------
    create view [dbo].[Clever7481_students]
    as
    select 'School_id' as School_id, 'Student_id' as Student_id, 'Student_number' as Student_number, 'State_id' as State_id,
           'Last_name' as Last_name, 'Middle_name' as Middle_name, 'First_name' as First_name, 'Gender' as Gender,
           'Dob' as Dob, 'Grade' as Grade, 'Race' as Race, 'Hispanic_Latino' as Hispanic_Latino, 'Ell_status' as Ell_status,
           'Frl_status' as Frl_status, 'Iep_status' as Iep_status,
           'Student_zip' as Student_zip, 'Student_email' as Student_email,
           'Contact_relationship' as Contact_relationship, 'Contact_type' as Contact_type, 'Contact_name' as Contact_name, 'Contact_phone' as Contact_phone, 'Contact_email' as Contact_email,
           'Username' as Username, 'Password' as Password

    UNION ALL

    select distinct
             ss.sch_state_id                        as School_id
            ,cast(stu.stu_id as varchar(30))        as Student_id
            ,stu.stu_local_id                       as Student_number
            ,stu.stu_state_id                       as State_id
            ,'"'+rtrim(stu.last_name)+'"'           as LASTNAME
            ,'"'+rtrim(stu.middle_name)+'"'         as MIDDLENAME
            ,'"'+rtrim(stu.first_name)+'"'          as FIRSTNAME
            ,left(right(stu.GENDER,2),1)            as GENDER
            ,convert(varchar(10),stu.birthdate,101) as DOB
            ,stu.grade                              as Grade
            ,stu.race                               as Race
            ,isnull(stu.group_hispanic,'N')         as Hispanic_Latino
            ,case when right(stu.ell_status,3) in ('LY]','LF]') then 'Y' else 'N' end						as Ell_status
            ,case when right(stu.freereduced_meals,2) in ('2]','9]','C]')   then 'F'
                  when right(stu.freereduced_meals,2) in ('3]')             then 'R' end					as Frl_status
            ,case when stu.primary_exc is not null and left(stu.primary_exc,1) <> 'L' then 'Y' end			as Iep_status
            ,substring(stu.zip,1,5)+substring(stu.zip,7,4)													as Student_zip
            ,stu.stu_username + '@pcsb.org'         as Student_email
            ,'"'+Contact_relationship+'"'           as Contact_relationship
            ,'"'+Contact_type+'"'                   as Contact_type
            ,'"'+Contact_name+'"'                   as Contact_name
            ,'"'+Contact_phone+'"'                  as Contact_phone
            ,'"'+Contact_email+'"'                  as Contact_email
            ,stu.stu_username                       as Username
            ,'s.'+right(stu.stu_local_id,8)         as Password
    -- select count(*)
    from DS_Classes         as ss
    join Clever7481_schools as h   on ss.sch_state_id = h.School_id
    join DS_Students        as stu on ss.stu_id = stu.stu_id
    left join (
        select stu_id
              ,cont1_type                                                         as Contact_relationship
              ,case when cont1_cstdy+cont1_emer = 'YY' then 'Custody/Emergency'
                    when cont1_emer             = 'Y'  then 'Emergency'
                    when cont1_cstdy            = 'Y'  then 'Custody'
                                                       else 'Unknown' end               as Contact_type
              ,dbo.SingleSpace(isnull(cont1_first,'') + ' ' + isnull(cont1_last,''))    as Contact_name
              ,dbo.CleanNumber(isnull(cont1_cell,cont1_home_phone))                     as Contact_phone
              ,dbo.CleanEmail(cont1_email)       as Contact_email
        from DS_Students as s
        where s.cont1_type is not null
    ) as cnt on stu.stu_id = cnt.stu_id and cnt.Contact_name is not null
    where stu.stu_username is not null



GO
/****** Object:  Table [dbo].[PLP_PSAT_Scores]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PLP_PSAT_Scores](
	[U_id] [varchar](20) NULL,
	[stu_username] [varchar](100) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[Title] [varchar](100) NOT NULL,
	[part_id] [smallint] NOT NULL,
	[score] [float] NULL,
	[test_name] [varchar](100) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[PLP_MS_PSAT_Scores]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create view [dbo].[PLP_MS_PSAT_Scores]
as

select * 

from PLP_PSAT_Scores
GO
/****** Object:  View [dbo].[sswims_aar_report]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[sswims_aar_report]

as

Select	stu.school_id, stu.statenum, sch.title
       ,stu.student_id, stu.PERMNUM, stu.STULOGINID as username
       ,stu.LASTNAME, stu.FIRSTNAME, stu.grade, stu.GENDER, stu.ETHNICCODE, stu.status, stu.start_date

From	dbo.focus_students as stu left join
		dbo.focus_schools as sch on stu.school_id = sch.school_id

where	stu.school_id in (17, 36, 55, 64, 67)
GO
/****** Object:  Table [dbo].[clever_reports_resources]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[clever_reports_resources](
	[usertype] [varchar](100) NULL,
	[filetitle] [varchar](100) NULL,
	[logdate] [date] NULL,
	[sis_id] [varchar](20) NULL,
	[clever_user_id] [varchar](50) NULL,
	[clever_school_id] [varchar](50) NULL,
	[school_name] [varchar](100) NULL,
	[resource_type] [varchar](20) NULL,
	[resource_name] [varchar](100) NULL,
	[resource_id] [varchar](50) NULL,
	[num_access] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[PM_Clever_Resources]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE view [dbo].[PM_Clever_Resources]
as

    select 'Student ID' as [Student ID], 'Test Date' as [Test Date], 'Folder 1 Desc' as [Folder 1 Desc], 'Folder 1 Score' as [Folder 1 Score], 'Folder 2 Desc' as [Folder 2 Desc], 'Folder 2 Score' as [Folder 2 Score], 'Folder 3 Desc' as [Folder 3 Desc], 'Folder 3 Score' as [Folder 3 Score], 'Folder 4 Desc' as [Folder 4 Desc], 'Folder 4 Score' as [Folder 4 Score], 'Folder 5 Desc' as [Folder 5 Desc], 'Folder 5 Score' as [Folder 5 Score]

UNION ALL

    select
         sis_id as [Student ID]
        ,convert(varchar(20), getdate()-day(getdate())+1, 101)  as [Test Date]
        ,'Clever Resources'             as [Folder 1 Desc]
        ,null                           as [Folder 1 Score]

        ,case when month between 8 and 12 then cast(year as varchar(4))+'-'+right(cast(year+1 as varchar(4)),2)
		      when month between 1 and  7 then cast(year-1 as varchar(4))+'-'+right(cast(year as varchar(4)),2)
			  end                       as [Folder 2 Desc]

        ,null                           as [Folder 2 Score]
        ,datename( month , dateadd( month , month , -1 ) )      as [Folder 3 Desc]
        ,null                           as [Folder 3 Score]
        ,resource                       as [Folder 4 Desc]
        ,null                           as [Folder 4 Score]
        ,'Number of times accessed'     as [Folder 5 Desc]
        ,cast(accessed as varchar(10))  as [Folder 5 Score]

    from (
            select 
				 sis_id
				,year(logdate)	 as year
				,month(logdate)	 as month
				,o.v02			 as resource
				,sum(num_access) as accessed
			--  select top 100 *
            from clever_reports_resources as r
			join DS_Apps_Options		  as o on o.app_id = 13 and o.type = 'clever_resources' and r.resource_id = o.v01
			where r.logdate >= (select convert(date, cast(syear as varchar(4))+'-08-01') from constants where relative_year=0)
			  and r.logdate < convert(date, getdate()-day(getdate())+1)
			group by sis_id, year(logdate), month(logdate), v02

         ) as r

GO
/****** Object:  View [dbo].[Profile_Timeframes]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE view [dbo].[Profile_Timeframes]
as

              select syear, 'Year'      as timeframe, cast(syear as varchar(20))                as timeframe_id, start_yr    as start_date, end_yr      as end_date from constants as y
    UNION ALL select syear, 'Nth Day'   as timeframe, cast(school_days_elapsed as varchar(20))  as timeframe_id, start_yr    as start_date, school_date as end_date from constants as y where school_days_elapsed is not null
    UNION ALL select syear, 'Today'     as timeframe, cast(school_date as varchar(20))          as timeframe_id, school_date as start_date, school_date as end_date from constants as y where school_date is not null
    UNION ALL select syear, 'Quarter'   as timeframe, 'Q1'                                      as timeframe_id, start_mp1   as start_date, end_mp1     as end_date from constants as y where syear >= 2014
    UNION ALL select syear, 'Quarter'   as timeframe, 'Q2'                                      as timeframe_id, start_mp2   as start_date, end_mp2     as end_date from constants as y where syear >= 2014
    UNION ALL select syear, 'Quarter'   as timeframe, 'Q3'                                      as timeframe_id, start_mp3   as start_date, end_mp3     as end_date from constants as y where syear >= 2014
    UNION ALL select syear, 'Quarter'   as timeframe, 'Q4'                                      as timeframe_id, start_mp4   as start_date, end_mp4     as end_date from constants as y where syear >= 2014
    UNION ALL select syear, 'Semester'  as timeframe, 'S1'                                      as timeframe_id, start_s1    as start_date, end_s1      as end_date from constants as y where end_s1 is not null
    UNION ALL select syear, 'Semester'  as timeframe, 'S2'                                      as timeframe_id, start_s2    as start_date, end_s2      as end_date from constants as y where end_s2 is not null





GO
/****** Object:  Table [dbo].[AAR_GradRequirementsMet_ByCohort]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AAR_GradRequirementsMet_ByCohort](
	[Status] [varchar](5) NULL,
	[Student_id] [numeric](18, 0) NULL,
	[LocalStuID] [varchar](255) NULL,
	[FLEID] [varchar](255) NULL,
	[SchoolName] [varchar](255) NULL,
	[EAS_Second_School] [varchar](255) NULL,
	[YrEnterHS] [varchar](255) NULL,
	[LastName] [varchar](255) NULL,
	[FirstName] [varchar](255) NULL,
	[Grade] [varchar](255) NULL,
	[EthnicCode] [varchar](255) NULL,
	[Gender] [varchar](255) NULL,
	[LEP] [varchar](255) NULL,
	[FRL] [varchar](255) NULL,
	[PriExc] [varchar](255) NULL,
	[CASEMGR] [varchar](255) NULL,
	[Eligible504] [varchar](255) NULL,
	[Counselor] [varchar](255) NULL,
	[SmallLearningCommunity] [varchar](255) NULL,
	[AssignCode] [varchar](255) NULL,
	[SPECCODE] [varchar](255) NULL,
	[LeaveCode] [varchar](255) NULL,
	[LeaveDate] [varchar](255) NULL,
	[INSTRSET] [varchar](255) NULL,
	[GradOption] [varchar](255) NULL,
	[UNWTDCUMMGPA1] [numeric](7, 4) NULL,
	[CREDATMPT] [numeric](7, 4) NULL,
	[CREDEARNED] [numeric](7, 4) NULL,
	[TotalCreditsEarned] [numeric](7, 4) NULL,
	[USGovernmentCredits_NeedHalf] [numeric](7, 4) NULL,
	[EconomicsCredits_NeedHalf] [numeric](7, 4) NULL,
	[EnglishCredits_Need4] [numeric](7, 4) NULL,
	[MathCredits_Need2] [numeric](7, 4) NULL,
	[AlgebraCredits_Need1] [numeric](7, 4) NULL,
	[GeometryCredits_Need1] [numeric](7, 4) NULL,
	[IND_Credits_SubMathSci] [numeric](7, 4) NULL,
	[ScienceEQCredits_Need2] [numeric](7, 4) NULL,
	[BiologyCredits_Need1] [numeric](7, 4) NULL,
	[USHistoryCredits_Need1] [numeric](7, 4) NULL,
	[WorldHistoryCredits_Need1] [numeric](7, 4) NULL,
	[ArtsCredits_Need1] [varchar](255) NULL,
	[ForeignLanguageCredits_Need2forCollege] [numeric](7, 4) NULL,
	[PECredits_Need0] [varchar](255) NULL,
	[HopeCredits_Need1] [varchar](255) NULL,
	[LifeMgmtSkills_Need0] [numeric](7, 4) NULL,
	[VocationalCredits_Need0] [numeric](7, 4) NULL,
	[ElectiveCredits_Need8] [numeric](7, 4) NULL,
	[Online_TotalCredits_NeedHalf] [varchar](255) NULL,
	[MetIConline] [varchar](255) NULL,
	[NonCredits_Need0] [numeric](7, 4) NULL,
	[FSA_ELA_PassFail] [numeric](7, 4) NULL,
	[ELA_Waiver] [varchar](255) NULL,
	[EL_ELA_Waiver] [numeric](7, 4) NULL,
	[EL_ELA_Waiver_Eligible] [varchar](255) NULL,
	[ACT_EngReadAVG18_Results] [numeric](7, 4) NULL,
	[SAT_EBRW480_Results] [numeric](7, 4) NULL,
	[SAT_EBRW480_Attempts] [numeric](7, 4) NULL,
	[ELA_MET] [numeric](7, 4) NULL,
	[ALG_EOC_PassFail] [numeric](7, 4) NULL,
	[ALGBEST_EOC_PassFail] [numeric](7, 4) NULL,
	[ALG_Waiver] [varchar](255) NULL,
	[GEO_EOC_PassFail] [numeric](7, 4) NULL,
	[GEOBEST_EOC_PassFail] [numeric](7, 4) NULL,
	[Bio_EOC_PassFail] [numeric](7, 4) NULL,
	[US_Hist_EOC_PassFail] [numeric](7, 4) NULL,
	[ACT_Attempts_Math16plus] [numeric](7, 4) NULL,
	[ACT_Pass_Math16plus] [numeric](7, 4) NULL,
	[SAT_Attempts_Math_420plus] [numeric](7, 4) NULL,
	[SAT_Pass_Math_420plus] [numeric](7, 4) NULL,
	[PSAT_Attempts_Math_430plus] [numeric](7, 4) NULL,
	[PSAT_Pass_Math_430plus] [numeric](7, 4) NULL,
	[ALG_MET] [numeric](7, 4) NULL,
	[FSAA_Attempts_Gr10ELA] [numeric](7, 4) NULL,
	[FSAA_Pass_Gr10ELA] [numeric](7, 4) NULL,
	[FSAA_Attempts_ALG1] [numeric](7, 4) NULL,
	[FSAA_Pass_ALG1] [numeric](7, 4) NULL,
	[FSAA_Attempts_GEO] [numeric](7, 4) NULL,
	[FSAA_Pass_Geo] [numeric](7, 4) NULL,
	[Course_Period_01_S1] [varchar](255) NULL,
	[Course_PercentGrade_01_S1] [varchar](255) NULL,
	[Course_Grade_01_S1] [varchar](255) NULL,
	[Absence_Period_01_S1] [numeric](18, 0) NULL,
	[Course_Period_01_S2] [varchar](255) NULL,
	[Course_PercentGrade_01_S2] [varchar](255) NULL,
	[Course_Grade_01_S2] [varchar](255) NULL,
	[Absence_Period_01_S2] [numeric](18, 0) NULL,
	[Course_Period_02_S1] [varchar](255) NULL,
	[Course_PercentGrade_02_S1] [varchar](255) NULL,
	[Course_Grade_02_S1] [varchar](255) NULL,
	[Absence_Period_02_S1] [numeric](18, 0) NULL,
	[Course_Period_02_S2] [varchar](255) NULL,
	[Course_PercentGrade_02_S2] [varchar](255) NULL,
	[Course_Grade_02_S2] [varchar](255) NULL,
	[Absence_Period_02_S2] [numeric](18, 0) NULL,
	[Course_Period_03_S1] [varchar](255) NULL,
	[Course_PercentGrade_03_S1] [varchar](255) NULL,
	[Course_Grade_03_S1] [varchar](255) NULL,
	[Absence_Period_03_S1] [numeric](18, 0) NULL,
	[Course_Period_03_S2] [varchar](255) NULL,
	[Course_PercentGrade_03_S2] [varchar](255) NULL,
	[Course_Grade_03_S2] [varchar](255) NULL,
	[Absence_Period_03_S2] [numeric](18, 0) NULL,
	[Course_Period_04_S1] [varchar](255) NULL,
	[Course_PercentGrade_04_S1] [varchar](255) NULL,
	[Course_Grade_04_S1] [varchar](255) NULL,
	[Absence_Period_04_S1] [numeric](18, 0) NULL,
	[Course_Period_04_S2] [varchar](255) NULL,
	[Course_PercentGrade_04_S2] [varchar](255) NULL,
	[Course_Grade_04_S2] [varchar](255) NULL,
	[Absence_Period_04_S2] [numeric](18, 0) NULL,
	[Course_Period_05_S1] [varchar](255) NULL,
	[Course_PercentGrade_05_S1] [varchar](255) NULL,
	[Course_Grade_05_S1] [varchar](255) NULL,
	[Absence_Period_05_S1] [numeric](18, 0) NULL,
	[Course_Period_05_S2] [varchar](255) NULL,
	[Course_PercentGrade_05_S2] [varchar](255) NULL,
	[Course_Grade_05_S2] [varchar](255) NULL,
	[Absence_Period_05_S2] [numeric](18, 0) NULL,
	[Course_Period_06_S1] [varchar](255) NULL,
	[Course_PercentGrade_06_S1] [varchar](255) NULL,
	[Course_Grade_06_S1] [varchar](255) NULL,
	[Absence_Period_06_S1] [numeric](18, 0) NULL,
	[Course_Period_06_S2] [varchar](255) NULL,
	[Course_PercentGrade_06_S2] [varchar](255) NULL,
	[Course_Grade_06_S2] [varchar](255) NULL,
	[Absence_Period_06_S2] [numeric](18, 0) NULL,
	[Course_Period_07_S1] [varchar](255) NULL,
	[Course_PercentGrade_07_S1] [varchar](255) NULL,
	[Course_Grade_07_S1] [varchar](255) NULL,
	[Absence_Period_07_S1] [numeric](18, 0) NULL,
	[Course_Period_07_S2] [varchar](255) NULL,
	[Course_PercentGrade_07_S2] [varchar](255) NULL,
	[Course_Grade_07_S2] [varchar](255) NULL,
	[Absence_Period_07_S2] [numeric](18, 0) NULL,
	[Course_Period_08_S1] [varchar](255) NULL,
	[Course_PercentGrade_08_S1] [varchar](255) NULL,
	[Course_Grade_08_S1] [varchar](255) NULL,
	[Absence_Period_08_S1] [numeric](18, 0) NULL,
	[Course_Period_08_S2] [varchar](255) NULL,
	[Course_PercentGrade_08_S2] [varchar](255) NULL,
	[Course_Grade_08_S2] [varchar](255) NULL,
	[Absence_Period_08_S2] [numeric](18, 0) NULL,
	[Course_Period_09_S1] [varchar](255) NULL,
	[Course_PercentGrade_09_S1] [varchar](255) NULL,
	[Course_Grade_09_S1] [varchar](255) NULL,
	[Absence_Period_09_S1] [numeric](18, 0) NULL,
	[Course_Period_09_S2] [varchar](255) NULL,
	[Course_PercentGrade_09_S2] [varchar](255) NULL,
	[Course_Grade_09_S2] [varchar](255) NULL,
	[Absence_Period_09_S2] [numeric](18, 0) NULL,
	[MET_Accelerated] [varchar](255) NULL,
	[abs_rate] [numeric](7, 4) NULL,
	[abs_all] [numeric](18, 0) NULL,
	[OnTrack] [varchar](3) NULL,
	[Warning] [varchar](3) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[adobe_options_counts]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[adobe_options_counts](
	[option_id] [int] NOT NULL,
	[schools] [int] NULL,
	[teachers] [int] NULL,
	[courses] [int] NULL,
	[sections] [int] NULL,
	[students] [int] NULL,
 CONSTRAINT [PK_adobe_options_counts] PRIMARY KEY CLUSTERED 
(
	[option_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[behavior_gap_trend]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[behavior_gap_trend](
	[syear] [int] NULL,
	[timeframe] [varchar](50) NULL,
	[timeframe_id] [varchar](50) NULL,
	[as_of_date] [date] NULL,
	[school_days] [int] NULL,
	[category] [varchar](50) NULL,
	[category_id] [int] NULL,
	[subgroup] [varchar](50) NULL,
	[value_list] [varchar](50) NULL,
	[enrolled] [int] NULL,
	[enrolled_per] [decimal](9, 3) NULL,
	[ref_stu] [int] NULL,
	[ref_num] [int] NULL,
	[ref_risk] [decimal](9, 3) NULL,
	[ref_risk_ratio] [decimal](9, 3) NULL,
	[ref_stu_composition] [decimal](9, 3) NULL,
	[ref_composition] [decimal](9, 3) NULL,
	[ref_rate] [decimal](9, 3) NULL,
	[ref_rate_ratio] [decimal](9, 3) NULL,
	[ref_stu_comp_exp] [decimal](9, 3) NULL,
	[ref_stu_comp_flag] [int] NULL,
	[oss_stu] [int] NULL,
	[oss_num] [int] NULL,
	[oss_risk] [decimal](9, 3) NULL,
	[oss_risk_ratio] [decimal](9, 3) NULL,
	[oss_stu_composition] [decimal](9, 3) NULL,
	[oss_composition] [decimal](9, 3) NULL,
	[oss_rate] [decimal](9, 3) NULL,
	[oss_rate_ratio] [decimal](9, 3) NULL,
	[oss_stu_comp_exp] [decimal](9, 3) NULL,
	[oss_stu_comp_flag] [int] NULL,
	[iss_stu] [int] NULL,
	[iss_num] [int] NULL,
	[iss_risk] [decimal](9, 3) NULL,
	[iss_risk_ratio] [decimal](9, 3) NULL,
	[iss_stu_composition] [decimal](9, 3) NULL,
	[iss_composition] [decimal](9, 3) NULL,
	[iss_rate] [decimal](9, 3) NULL,
	[iss_rate_ratio] [decimal](9, 3) NULL,
	[iss_stu_comp_exp] [decimal](9, 3) NULL,
	[iss_stu_comp_flag] [int] NULL,
	[arr_num] [int] NULL,
	[arr_composition] [decimal](9, 3) NULL,
	[arr_rate] [decimal](10, 4) NULL,
	[arr_rate_ratio] [decimal](9, 3) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CA_scores]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CA_scores](
	[student_id] [int] NOT NULL,
	[curr_sch_id] [int] NULL,
	[school_id] [int] NULL,
	[sch_state_id] [varchar](10) NULL,
	[type] [varchar](50) NULL,
	[testid_pcsb] [varchar](10) NULL,
	[syear] [int] NULL,
	[cycle] [int] NULL,
	[grade] [varchar](50) NULL,
	[subj] [varchar](50) NULL,
	[test_date] [date] NULL,
	[testid] [varchar](50) NULL,
	[test_name] [varchar](500) NULL,
	[questions] [int] NULL,
	[num_correct] [numeric](5, 2) NULL,
	[score] [numeric](5, 2) NULL,
	[proficiency] [numeric](5, 2) NULL,
	[advanced] [numeric](5, 2) NULL,
	[pass] [int] NULL,
	[fieldname] [varchar](50) NULL,
	[seq_fieldname] [int] NULL,
	[seq_testid] [int] NULL,
	[dup_fieldname] [int] NULL,
	[dup_testid] [int] NULL,
	[low_proficiency] [int] NULL,
	[mid_proficiency] [int] NULL,
	[high_proficiency] [int] NULL,
	[below_stdev] [int] NULL,
	[within_stdev] [int] NULL,
	[above_stdev] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CA_scores_school]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CA_scores_school](
	[syear] [int] NULL,
	[school_id] [int] NOT NULL,
	[title] [varchar](100) NULL,
	[subj] [varchar](50) NULL,
	[testid] [varchar](50) NULL,
	[test_name] [varchar](500) NULL,
	[students] [int] NULL,
	[mean] [numeric](8, 2) NULL,
	[proficiency] [numeric](8, 2) NULL,
	[advanced] [numeric](8, 2) NULL,
	[low_proficiency] [int] NULL,
	[mid_proficiency] [int] NULL,
	[high_proficiency] [int] NULL,
	[low_proficency_ratio] [numeric](8, 2) NULL,
	[mid_proficency_ratio] [numeric](8, 2) NULL,
	[high_proficency_ratio] [numeric](8, 2) NULL,
	[below_stdev] [int] NULL,
	[within_stdev] [int] NULL,
	[above_stdev] [int] NULL,
	[below_stdev_ratio] [numeric](8, 2) NULL,
	[within_stdev_ratio] [numeric](8, 2) NULL,
	[above_stdev_ratio] [numeric](8, 2) NULL,
	[flagged] [int] NULL,
	[flagged_ratio] [numeric](8, 2) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CA_scores_student]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CA_scores_student](
	[syear] [int] NOT NULL,
	[student_id] [int] NOT NULL,
	[a1num_correct] [numeric](18, 4) NULL,
	[a1per_correct] [numeric](18, 4) NULL,
	[a2num_correct] [numeric](18, 4) NULL,
	[a2per_correct] [numeric](18, 4) NULL,
	[ah1num_correct] [numeric](18, 4) NULL,
	[ah1per_correct] [numeric](18, 4) NULL,
	[g1num_correct] [numeric](18, 4) NULL,
	[g1per_correct] [numeric](18, 4) NULL,
	[g2num_correct] [numeric](18, 4) NULL,
	[g2per_correct] [numeric](18, 4) NULL,
	[m1num_correct] [numeric](18, 4) NULL,
	[m1per_correct] [numeric](18, 4) NULL,
	[m2num_correct] [numeric](18, 4) NULL,
	[m2per_correct] [numeric](18, 4) NULL,
	[m3num_correct] [numeric](18, 4) NULL,
	[m3per_correct] [numeric](18, 4) NULL,
	[madv1num_correct] [numeric](18, 4) NULL,
	[madv1per_correct] [numeric](18, 4) NULL,
	[mp1num_correct] [numeric](18, 4) NULL,
	[mp1per_correct] [numeric](18, 4) NULL,
	[mp3num_correct] [numeric](18, 4) NULL,
	[mp3per_correct] [numeric](18, 4) NULL,
	[mpa1num_correct] [numeric](18, 4) NULL,
	[mpa1per_correct] [numeric](18, 4) NULL,
	[p1num_correct] [numeric](18, 4) NULL,
	[p1per_correct] [numeric](18, 4) NULL,
	[p2num_correct] [numeric](18, 4) NULL,
	[p2per_correct] [numeric](18, 4) NULL,
	[p3num_correct] [numeric](18, 4) NULL,
	[p3per_correct] [numeric](18, 4) NULL,
	[p4num_correct] [numeric](18, 4) NULL,
	[p4per_correct] [numeric](18, 4) NULL,
	[p5num_correct] [numeric](18, 4) NULL,
	[p5per_correct] [numeric](18, 4) NULL,
	[p6num_correct] [numeric](18, 4) NULL,
	[p6per_correct] [numeric](18, 4) NULL,
	[p7num_correct] [numeric](18, 4) NULL,
	[p7per_correct] [numeric](18, 4) NULL,
	[p8num_correct] [numeric](18, 4) NULL,
	[p8per_correct] [numeric](18, 4) NULL,
	[p2modB_r] [numeric](18, 4) NULL,
	[p2modB_w] [numeric](18, 4) NULL,
	[r1PLS] [numeric](18, 4) NULL,
	[r2PLS] [numeric](18, 4) NULL,
	[r3PLS] [numeric](18, 4) NULL,
	[r1_RunRec] [numeric](18, 4) NULL,
	[r2_RunRec] [numeric](18, 4) NULL,
	[r3_RunRec] [numeric](18, 4) NULL,
	[r1num_correct] [numeric](18, 4) NULL,
	[r1per_correct] [numeric](18, 4) NULL,
	[r2num_correct] [numeric](18, 4) NULL,
	[r2per_correct] [numeric](18, 4) NULL,
	[r3num_correct] [numeric](18, 4) NULL,
	[r3per_correct] [numeric](18, 4) NULL,
	[rp1num_correct] [numeric](18, 4) NULL,
	[rp1per_correct] [numeric](18, 4) NULL,
	[rp2num_correct] [numeric](18, 4) NULL,
	[rp2per_correct] [numeric](18, 4) NULL,
	[rp3num_correct] [numeric](18, 4) NULL,
	[rp3per_correct] [numeric](18, 4) NULL,
	[s1num_correct] [numeric](18, 4) NULL,
	[s1per_correct] [numeric](18, 4) NULL,
	[s2num_correct] [numeric](18, 4) NULL,
	[s2per_correct] [numeric](18, 4) NULL,
	[s3num_correct] [numeric](18, 4) NULL,
	[s3per_correct] [numeric](18, 4) NULL,
	[sp1num_correct] [numeric](18, 4) NULL,
	[sp1per_correct] [numeric](18, 4) NULL,
	[ss1num_correct] [numeric](18, 4) NULL,
	[ss1per_correct] [numeric](18, 4) NULL,
	[w1stgscr] [numeric](18, 4) NULL,
	[w2stgscr] [numeric](18, 4) NULL,
 CONSTRAINT [PK_CA_scores_student] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC,
	[syear] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CA_tests]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CA_tests](
	[test_id] [varchar](50) NOT NULL,
	[test_name] [varchar](500) NULL,
	[subject] [varchar](50) NULL,
	[proficiency_level] [varchar](50) NULL,
	[advanced_level] [varchar](50) NULL,
	[min_grade_code] [varchar](50) NULL,
	[max_grade_code] [varchar](50) NULL,
	[nbr_questions] [varchar](50) NULL,
	[test_category] [varchar](50) NULL,
	[test_count] [int] NULL,
	[insert_date] [datetime] NULL,
	[update_date] [datetime] NULL,
 CONSTRAINT [PK_CA_tests] PRIMARY KEY CLUSTERED 
(
	[test_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[canvas_charter_users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[canvas_charter_users](
	[user_id] [varchar](255) NOT NULL,
	[integration_id] [varchar](255) NULL,
	[login_id] [varchar](255) NOT NULL,
	[password] [varchar](255) NULL,
	[ssha_password] [varchar](255) NULL,
	[authentication_provider_id] [varchar](255) NULL,
	[first_name] [varchar](255) NOT NULL,
	[last_name] [varchar](255) NOT NULL,
	[full_name] [varchar](255) NULL,
	[sortable_name] [varchar](255) NULL,
	[short_name] [varchar](255) NULL,
	[email] [varchar](255) NOT NULL,
	[pronouns] [varchar](255) NULL,
	[status] [varchar](255) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[canvas_users]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[canvas_users](
	[user_id] [varchar](255) NOT NULL,
	[integration_id] [varchar](255) NULL,
	[login_id] [varchar](255) NOT NULL,
	[password] [varchar](255) NULL,
	[ssha_password] [varchar](255) NULL,
	[authentication_provider_id] [varchar](255) NULL,
	[first_name] [varchar](255) NOT NULL,
	[last_name] [varchar](255) NOT NULL,
	[full_name] [varchar](255) NULL,
	[sortable_name] [varchar](255) NULL,
	[short_name] [varchar](255) NULL,
	[email] [varchar](255) NOT NULL,
	[pronouns] [varchar](255) NULL,
	[status] [varchar](255) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[career_cruising_student_courses_yesterday]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[career_cruising_student_courses_yesterday](
	[StudentID] [varchar](100) NULL,
	[CourseCode] [varchar](100) NULL,
	[CourseName] [varchar](100) NULL,
	[DateCourseComplete] [varchar](100) NULL,
	[GradeMark] [varchar](100) NULL,
	[CreditValue] [varchar](100) NULL,
	[HSCourse] [varchar](100) NULL,
	[CoursePart] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Clever_IDs]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Clever_IDs](
	[last_updated] [datetime] NULL,
	[logdate] [date] NULL,
	[category] [nvarchar](100) NULL,
	[name] [nvarchar](500) NULL,
	[id1_field] [nvarchar](500) NULL,
	[id1] [nvarchar](500) NULL,
	[id2_field] [nvarchar](500) NULL,
	[id2] [nvarchar](500) NULL,
	[clever_id] [nvarchar](500) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DELETE FLDOE_SSO_Roles]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DELETE FLDOE_SSO_Roles](
	[employee_id] [int] NULL,
	[application] [int] NULL,
	[role] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DELETE PhoneExtensions]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DELETE PhoneExtensions](
	[sAMAccountName] [varchar](128) NOT NULL,
	[ipphone] [varchar](128) NULL,
 CONSTRAINT [PK__PhoneExtensions_sAMAccountName] PRIMARY KEY CLUSTERED 
(
	[sAMAccountName] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DELETE Profile_Core_Subject_Predictive_Trend]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DELETE Profile_Core_Subject_Predictive_Trend](
	[sch_id] [int] NULL,
	[school] [varchar](255) NULL,
	[group] [varchar](50) NULL,
	[subgroup] [varchar](50) NULL,
	[subject] [varchar](255) NULL,
	[cycle] [varchar](1) NULL,
	[grade] [int] NULL,
	[syear2_students] [int] NULL,
	[syear2_num_pass] [int] NULL,
	[syear2_per_pass] [float] NOT NULL,
	[syear1_students] [int] NULL,
	[syear1_num_pass] [int] NULL,
	[syear1_per_pass] [float] NOT NULL,
	[syear0_students] [int] NULL,
	[syear0_num_pass] [int] NULL,
	[syear0_per_pass] [float] NOT NULL,
	[trend1_students] [int] NULL,
	[trend1_num_pass] [int] NULL,
	[trend1_per_pass] [float] NULL,
	[trend2_students] [int] NULL,
	[trend2_num_pass] [int] NULL,
	[trend2_per_pass] [float] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DELETE work_MAP_scores]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DELETE work_MAP_scores](
	[TermName] [varchar](8000) NULL,
	[DistrictName] [varchar](8000) NULL,
	[SchoolName] [varchar](8000) NULL,
	[StudentLastName] [varchar](8000) NULL,
	[StudentFirstName] [varchar](8000) NULL,
	[StudentMI] [varchar](8000) NULL,
	[StudentID] [varchar](8000) NULL,
	[StudentDateOfBirth] [varchar](8000) NULL,
	[StudentEthnicGroup] [varchar](8000) NULL,
	[StudentGender] [varchar](8000) NULL,
	[Grade] [varchar](8000) NULL,
	[MeasurementScale] [varchar](8000) NULL,
	[Discipline] [varchar](8000) NULL,
	[NormsReferenceData] [varchar](8000) NULL,
	[WISelectedAYFall] [varchar](8000) NULL,
	[WISelectedAYWinter] [varchar](8000) NULL,
	[WISelectedAYSpring] [varchar](8000) NULL,
	[WIPreviousAYFall] [varchar](8000) NULL,
	[WIPreviousAYWinter] [varchar](8000) NULL,
	[WIPreviousAYSpring] [varchar](8000) NULL,
	[TestType] [varchar](8000) NULL,
	[TestName] [varchar](8000) NULL,
	[TestStartDate] [varchar](8000) NULL,
	[TestDurationMinutes] [varchar](8000) NULL,
	[TestRITScore] [varchar](8000) NULL,
	[TestStandardError] [varchar](8000) NULL,
	[TestPercentile] [varchar](8000) NULL,
	[FallToFallProjectedGrowth] [varchar](8000) NULL,
	[FallToFallObservedGrowth] [varchar](8000) NULL,
	[FallToFallObservedGrowthSE] [varchar](8000) NULL,
	[FallToFallMetProjectedGrowth] [varchar](8000) NULL,
	[FallToFallConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToFallConditionalGrowthPercentile] [varchar](8000) NULL,
	[FallToWinterProjectedGrowth] [varchar](8000) NULL,
	[FallToWinterObservedGrowth] [varchar](8000) NULL,
	[FallToWinterObservedGrowthSE] [varchar](8000) NULL,
	[FallToWinterMetProjectedGrowth] [varchar](8000) NULL,
	[FallToWinterConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToWinterConditionalGrowthPercentile] [varchar](8000) NULL,
	[FallToSpringProjectedGrowth] [varchar](8000) NULL,
	[FallToSpringObservedGrowth] [varchar](8000) NULL,
	[FallToSpringObservedGrowthSE] [varchar](8000) NULL,
	[FallToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[FallToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[WinterToWinterProjectedGrowth] [varchar](8000) NULL,
	[WinterToWinterObservedGrowth] [varchar](8000) NULL,
	[WinterToWinterObservedGrowthSE] [varchar](8000) NULL,
	[WinterToWinterMetProjectedGrowth] [varchar](8000) NULL,
	[WinterToWinterConditionalGrowthIndex] [varchar](8000) NULL,
	[WinterToWinterConditionalGrowthPercentile] [varchar](8000) NULL,
	[WinterToSpringProjectedGrowth] [varchar](8000) NULL,
	[WinterToSpringObservedGrowth] [varchar](8000) NULL,
	[WinterToSpringObservedGrowthSE] [varchar](8000) NULL,
	[WinterToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[WinterToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[WinterToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[SpringToSpringProjectedGrowth] [varchar](8000) NULL,
	[SpringToSpringObservedGrowth] [varchar](8000) NULL,
	[SpringToSpringObservedGrowthSE] [varchar](8000) NULL,
	[SpringToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[SpringToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[SpringToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[RITtoReadingScore] [varchar](8000) NULL,
	[RITtoReadingMin] [varchar](8000) NULL,
	[RITtoReadingMax] [varchar](8000) NULL,
	[Goal1Name] [varchar](8000) NULL,
	[Goal1RitScore] [varchar](8000) NULL,
	[Goal1StdErr] [varchar](8000) NULL,
	[Goal1Range] [varchar](8000) NULL,
	[Goal1Adjective] [varchar](8000) NULL,
	[Goal2Name] [varchar](8000) NULL,
	[Goal2RitScore] [varchar](8000) NULL,
	[Goal2StdErr] [varchar](8000) NULL,
	[Goal2Range] [varchar](8000) NULL,
	[Goal2Adjective] [varchar](8000) NULL,
	[Goal3Name] [varchar](8000) NULL,
	[Goal3RitScore] [varchar](8000) NULL,
	[Goal3StdErr] [varchar](8000) NULL,
	[Goal3Range] [varchar](8000) NULL,
	[Goal3Adjective] [varchar](8000) NULL,
	[Goal4Name] [varchar](8000) NULL,
	[Goal4RitScore] [varchar](8000) NULL,
	[Goal4StdErr] [varchar](8000) NULL,
	[Goal4Range] [varchar](8000) NULL,
	[Goal4Adjective] [varchar](8000) NULL,
	[Goal5Name] [varchar](8000) NULL,
	[Goal5RitScore] [varchar](8000) NULL,
	[Goal5StdErr] [varchar](8000) NULL,
	[Goal5Range] [varchar](8000) NULL,
	[Goal5Adjective] [varchar](8000) NULL,
	[Goal6Name] [varchar](8000) NULL,
	[Goal6RitScore] [varchar](8000) NULL,
	[Goal6StdErr] [varchar](8000) NULL,
	[Goal6Range] [varchar](8000) NULL,
	[Goal6Adjective] [varchar](8000) NULL,
	[Goal7Name] [varchar](8000) NULL,
	[Goal7RitScore] [varchar](8000) NULL,
	[Goal7StdErr] [varchar](8000) NULL,
	[Goal7Range] [varchar](8000) NULL,
	[Goal7Adjective] [varchar](8000) NULL,
	[Goal8Name] [varchar](8000) NULL,
	[Goal8RitScore] [varchar](8000) NULL,
	[Goal8StdErr] [varchar](8000) NULL,
	[Goal8Range] [varchar](8000) NULL,
	[Goal8Adjective] [varchar](8000) NULL,
	[TestStartTime] [varchar](8000) NULL,
	[PercentCorrect] [varchar](8000) NULL,
	[ProjectedProficiencyStudy1] [varchar](8000) NULL,
	[ProjectedProficiencyLevel1] [varchar](8000) NULL,
	[ProjectedProficiencyStudy2] [varchar](8000) NULL,
	[ProjectedProficiencyLevel2] [varchar](8000) NULL,
	[ProjectedProficiencyStudy3] [varchar](8000) NULL,
	[ProjectedProficiencyLevel3] [varchar](8000) NULL,
	[AccommodationCategory] [varchar](8000) NULL,
	[Accommodations] [varchar](8000) NULL,
	[TypicalFallToFallGrowth] [varchar](8000) NULL,
	[TypicalFallToWinterGrowth] [varchar](8000) NULL,
	[TypicalFallToSpringGrowth] [varchar](8000) NULL,
	[TypicalWinterToWinterGrowth] [varchar](8000) NULL,
	[TypicalWinterToSpringGrowth] [varchar](8000) NULL,
	[TypicalSpringToSpringGrowth] [varchar](8000) NULL,
	[ProjectedProficiencyStudy4] [varchar](8000) NULL,
	[ProjectedProficiencyLevel4] [varchar](8000) NULL,
	[ProjectedProficiencyStudy5] [varchar](8000) NULL,
	[ProjectedProficiencyLevel5] [varchar](8000) NULL,
	[ProjectedProficiencyStudy6] [varchar](8000) NULL,
	[ProjectedProficiencyLevel6] [varchar](8000) NULL,
	[ProjectedProficiencyStudy7] [varchar](8000) NULL,
	[ProjectedProficiencyLevel7] [varchar](8000) NULL,
	[ProjectedProficiencyStudy8] [varchar](8000) NULL,
	[ProjectedProficiencyLevel8] [varchar](8000) NULL,
	[ProjectedProficiencyStudy9] [varchar](8000) NULL,
	[ProjectedProficiencyLevel9] [varchar](8000) NULL,
	[ProjectedProficiencyStudy10] [varchar](8000) NULL,
	[ProjectedProficiencyLevel10] [varchar](8000) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DELETE work_Read180_Import]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DELETE work_Read180_Import](
	[USER_NAME] [nvarchar](500) NULL,
	[USER_ID] [nvarchar](500) NULL,
	[SIS_ID] [nvarchar](500) NULL,
	[FIRST_NAME] [nvarchar](500) NULL,
	[LAST_NAME] [nvarchar](500) NULL,
	[MIDDLE_NAME] [nvarchar](500) NULL,
	[BIRTH_DATE] [nvarchar](500) NULL,
	[GRADE] [nvarchar](500) NULL,
	[DISTRICT_ID] [nvarchar](500) NULL,
	[DISTRICT_NAME] [nvarchar](500) NULL,
	[SCHOOL_ID] [nvarchar](500) NULL,
	[SCHOOL_NUMBER] [nvarchar](500) NULL,
	[SCHOOL_NAME] [nvarchar](500) NULL,
	[CLASS_NAME] [nvarchar](500) NULL,
	[CLASS_ID] [nvarchar](500) NULL,
	[LEXILE_SCORE] [nvarchar](500) NULL,
	[LEXILE_MOD_DATE] [nvarchar](500) NULL,
	[IS_ENABLED] [nvarchar](500) NULL,
	[EXTERNAL_ID] [nvarchar](500) NULL,
	[AYP_ECON_DISADVANTAGED] [nvarchar](500) NULL,
	[AYP_GIFTED_TALENTED] [nvarchar](500) NULL,
	[AYP_LTD_ENGLISH_PROFICIENCY] [nvarchar](500) NULL,
	[AYP_MIGRANT] [nvarchar](500) NULL,
	[AYP_WITH_DISABILITIES] [nvarchar](500) NULL,
	[GENDER_FEMALE] [nvarchar](500) NULL,
	[GENDER_MALE] [nvarchar](500) NULL,
	[ETHNIC_AM_IND_AK_NATIVE] [nvarchar](500) NULL,
	[ETHNIC_ASIAN] [nvarchar](500) NULL,
	[ETHNIC_AFRICAN_AM] [nvarchar](500) NULL,
	[ETHNIC_HISPANIC] [nvarchar](500) NULL,
	[ETHNIC_PACIFIC_ISL] [nvarchar](500) NULL,
	[ETHNIC_CAUCASIAN] [nvarchar](500) NULL,
	[ETHNIC_TWO_OR_MORE_RACES] [nvarchar](500) NULL,
	[CUSTOMDEMOGRAPHIC1] [nvarchar](500) NULL,
	[CUSTOMDEMOGRAPHIC2] [nvarchar](500) NULL,
	[CUSTOMDEMOGRAPHIC3] [nvarchar](500) NULL,
	[CDX_ENROLLED] [nvarchar](500) NULL,
	[DTM2_ENROLLED] [nvarchar](500) NULL,
	[DTM_ENROLLED] [nvarchar](500) NULL,
	[E3D_ENROLLED] [nvarchar](500) NULL,
	[FAD_ENROLLED] [nvarchar](500) NULL,
	[FM_ENROLLED] [nvarchar](500) NULL,
	[FMNG_ENROLLED] [nvarchar](500) NULL,
	[M180_ENROLLED] [nvarchar](500) NULL,
	[M180Y2_ENROLLED] [nvarchar](500) NULL,
	[R180NG_ENROLLED] [nvarchar](500) NULL,
	[R180U_ENROLLED] [nvarchar](500) NULL,
	[R180UY2_ENROLLED] [nvarchar](500) NULL,
	[R180_ENROLLED] [nvarchar](500) NULL,
	[RT_ENROLLED] [nvarchar](500) NULL,
	[RTNG_ENROLLED] [nvarchar](500) NULL,
	[S44_ENROLLED] [nvarchar](500) NULL,
	[S44JR_ENROLLED] [nvarchar](500) NULL,
	[S44NG_ENROLLED] [nvarchar](500) NULL,
	[SMI_ENROLLED] [nvarchar](500) NULL,
	[SPI_ENROLLED] [nvarchar](500) NULL,
	[SRC_ENROLLED] [nvarchar](500) NULL,
	[SRI_ENROLLED] [nvarchar](500) NULL,
	[XT_ENROLLED] [nvarchar](500) NULL,
	[EXPORT_START_DATE] [nvarchar](500) NULL,
	[EXPORT_END_DATE] [nvarchar](500) NULL,
	[SAM_CFN] [nvarchar](500) NULL,
	[student_id] [nvarchar](500) NULL,
	[site_id] [nvarchar](500) NULL,
	[student_firstname] [nvarchar](500) NULL,
	[student_lastname] [nvarchar](500) NULL,
	[class_name_1] [nvarchar](500) NULL,
	[class_id_1] [nvarchar](500) NULL,
	[class_name_2] [nvarchar](500) NULL,
	[class_id_2] [nvarchar](500) NULL,
	[class_name_3] [nvarchar](500) NULL,
	[class_id_3] [nvarchar](500) NULL,
	[class_name_4] [nvarchar](500) NULL,
	[class_id_4] [nvarchar](500) NULL,
	[initial_stage] [nvarchar](500) NULL,
	[current_stage] [nvarchar](500) NULL,
	[initial_level] [nvarchar](500) NULL,
	[current_level] [nvarchar](500) NULL,
	[first_session_date] [nvarchar](500) NULL,
	[most_recent_session_date] [nvarchar](500) NULL,
	[total_segments_completed] [nvarchar](500) NULL,
	[total_sessions] [nvarchar](500) NULL,
	[total_minutes_spent] [nvarchar](500) NULL,
	[average_sessions_per_segment] [nvarchar](500) NULL,
	[average_sessions_per_week] [nvarchar](500) NULL,
	[average_session_minutes] [nvarchar](500) NULL,
	[segment_reset_count] [nvarchar](500) NULL,
	[STUDENT_ID2] [nvarchar](500) NULL,
	[EOW_AVG_SCORE_LEVELA] [nvarchar](500) NULL,
	[EOW_AVG_SCORE_LEVELB] [nvarchar](500) NULL,
	[EOW_NUM_TESTS_TAKEN_LEVELA] [nvarchar](500) NULL,
	[EOW_NUM_TESTS_TAKEN_LEVELB] [nvarchar](500) NULL,
	[EOW_TESTID_1] [nvarchar](500) NULL,
	[EOW_TEST_DATE_TEST_1] [nvarchar](500) NULL,
	[EOW_TOTAL_SCORE_TEST_1] [nvarchar](500) NULL,
	[EOW_TESTID_2] [nvarchar](500) NULL,
	[EOW_TEST_DATE_TEST_2] [nvarchar](500) NULL,
	[EOW_TOTAL_SCORE_TEST_2] [nvarchar](500) NULL,
	[EOW_TESTID_3] [nvarchar](500) NULL,
	[EOW_TEST_DATE_TEST_3] [nvarchar](500) NULL,
	[EOW_TOTAL_SCORE_TEST_3] [nvarchar](500) NULL,
	[EOW_TESTID_4] [nvarchar](500) NULL,
	[EOW_TEST_DATE_TEST_4] [nvarchar](500) NULL,
	[EOW_TOTAL_SCORE_TEST_4] [nvarchar](500) NULL,
	[EOW_TESTID_5] [nvarchar](500) NULL,
	[EOW_TEST_DATE_TEST_5] [nvarchar](500) NULL,
	[EOW_TOTAL_SCORE_TEST_5] [nvarchar](500) NULL,
	[EOW_TESTID_6] [nvarchar](500) NULL,
	[EOW_TEST_DATE_TEST_6] [nvarchar](500) NULL,
	[EOW_TOTAL_SCORE_TEST_6] [nvarchar](500) NULL,
	[INTERIM_AVG_SCORE_LEVELA] [nvarchar](500) NULL,
	[INTERIM_AVG_SCORE_LEVELB] [nvarchar](500) NULL,
	[INTERIM_NUM_TESTS_TAKEN_LEVELA] [nvarchar](500) NULL,
	[INTERIM_NUM_TESTS_TAKEN_LEVELB] [nvarchar](500) NULL,
	[INTERIM_TESTID_1] [nvarchar](500) NULL,
	[INTERIM_TEST_DATE_TEST_1] [nvarchar](500) NULL,
	[INTERIM_TOTAL_SCORE_TEST_1] [nvarchar](500) NULL,
	[INTERIM_TESTID_2] [nvarchar](500) NULL,
	[INTERIM_TEST_DATE_TEST_2] [nvarchar](500) NULL,
	[INTERIM_TOTAL_SCORE_TEST_2] [nvarchar](500) NULL,
	[INTERIM_TESTID_3] [nvarchar](500) NULL,
	[INTERIM_TEST_DATE_TEST_3] [nvarchar](500) NULL,
	[INTERIM_TOTAL_SCORE_TEST_3] [nvarchar](500) NULL,
	[INTERIM_TESTID_4] [nvarchar](500) NULL,
	[INTERIM_TEST_DATE_TEST_4] [nvarchar](500) NULL,
	[INTERIM_TOTAL_SCORE_TEST_4] [nvarchar](500) NULL,
	[INTERIM_TESTID_5] [nvarchar](500) NULL,
	[INTERIM_TEST_DATE_TEST_5] [nvarchar](500) NULL,
	[INTERIM_TOTAL_SCORE_TEST_5] [nvarchar](500) NULL,
	[INTERIM_TESTID_6] [nvarchar](500) NULL,
	[INTERIM_TEST_DATE_TEST_6] [nvarchar](500) NULL,
	[INTERIM_TOTAL_SCORE_TEST_6] [nvarchar](500) NULL,
	[USER_ID2] [nvarchar](500) NULL,
	[IR_NUMBER_OF_TESTS_TAKEN] [nvarchar](500) NULL,
	[IR_NUMBER_OF_TESTS_PASSED] [nvarchar](500) NULL,
	[IR_POINTS_EARNED] [nvarchar](500) NULL,
	[IR_WORDS_READ] [nvarchar](500) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_Apps]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Apps](
	[app_id] [int] IDENTITY(1,1) NOT NULL,
	[title] [nvarchar](50) NULL,
	[company] [nvarchar](50) NULL,
 CONSTRAINT [PK_DS_Apps] PRIMARY KEY CLUSTERED 
(
	[app_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_Apps_Options_Info]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Apps_Options_Info](
	[info_id] [int] IDENTITY(1,1) NOT NULL,
	[last_modified] [datetime] NULL,
	[modified_by] [nvarchar](50) NULL,
	[app_id] [int] NULL,
	[type] [nvarchar](100) NULL,
	[description] [nvarchar](500) NULL,
	[i01] [nvarchar](500) NULL,
	[i02] [nvarchar](500) NULL,
	[v01] [nvarchar](500) NULL,
	[v02] [nvarchar](500) NULL,
	[v03] [nvarchar](500) NULL,
	[v04] [nvarchar](500) NULL,
	[v05] [nvarchar](500) NULL,
	[r01] [nvarchar](500) NULL,
	[r02] [nvarchar](500) NULL,
	[t01] [nvarchar](500) NULL,
 CONSTRAINT [PK_DS_Apps_Options_Info] PRIMARY KEY CLUSTERED 
(
	[info_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_Certifications]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Certifications](
	[id] [bigint] NOT NULL,
	[emp_id] [int] NOT NULL,
	[TermsCode] [varchar](10) NULL,
	[SubjectArea] [varchar](100) NULL,
	[SubjectArea_Code] [varchar](10) NULL,
	[Level] [varchar](100) NULL,
	[Level_Code] [varchar](10) NULL,
	[Type] [varchar](100) NULL,
	[Type_Code] [varchar](10) NULL,
	[IssueDate] [date] NULL,
	[ExpirationDate] [date] NULL,
	[HighlyQualified] [varchar](10) NULL,
	[Scope] [varchar](100) NULL,
	[Scope_Code] [varchar](10) NULL,
 CONSTRAINT [PK_DS_Certifications] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_Conferences]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Conferences](
	[id] [numeric](18, 0) NOT NULL,
	[sch_id] [numeric](18, 0) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[Date] [varchar](max) NULL,
	[Title] [varchar](max) NULL,
	[Staff] [varchar](max) NULL,
	[Notes] [varchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_ContactLog]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_ContactLog](
	[id] [numeric](18, 0) NOT NULL,
	[sch_id] [int] NULL,
	[stu_id] [int] NULL,
	[Date] [varchar](20) NULL,
	[Time] [varchar](20) NULL,
	[PersonMakingContact] [varchar](100) NULL,
	[Reason] [varchar](100) NULL,
	[PersonContacted] [varchar](100) NULL,
	[NumberCalled] [varchar](20) NULL,
	[Notes] [varchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_Log]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_Log](
	[log_id] [int] IDENTITY(1,1) NOT NULL,
	[date] [datetime] NULL,
	[job_name] [nvarchar](100) NULL,
	[table_name] [nvarchar](100) NULL,
	[action] [nvarchar](100) NULL,
	[result] [nvarchar](100) NULL,
	[description] [nvarchar](500) NULL,
 CONSTRAINT [PK_DS_Log] PRIMARY KEY CLUSTERED 
(
	[log_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DS_School_Enrollment]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DS_School_Enrollment](
	[syear] [int] NOT NULL,
	[sch_id] [int] NOT NULL,
	[school_date] [date] NULL,
	[stu_Today_All] [int] NULL,
	[stu_Today] [int] NULL,
	[stu_Nth] [int] NULL,
	[stu_YR_All] [int] NULL,
	[stu_YR] [int] NULL,
	[stu_S1] [int] NULL,
	[stu_S2] [int] NULL,
	[stu_Q1] [int] NULL,
	[stu_Q2] [int] NULL,
	[stu_Q3] [int] NULL,
	[stu_Q4] [int] NULL,
	[stu_M08] [int] NULL,
	[stu_M09] [int] NULL,
	[stu_M10] [int] NULL,
	[stu_M11] [int] NULL,
	[stu_M12] [int] NULL,
	[stu_M01] [int] NULL,
	[stu_M02] [int] NULL,
	[stu_M03] [int] NULL,
	[stu_M04] [int] NULL,
	[stu_M05] [int] NULL,
	[stu_M06] [int] NULL,
	[stu_M07] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [varchar](1) NULL,
	[alt_assessment] [varchar](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [varchar](1) NULL,
	[priexc] [varchar](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[m1status] [varchar](4) NULL,
	[m2status] [varchar](4) NULL,
	[m3status] [varchar](4) NULL,
	[r1Ktotal] [int] NULL,
	[r2Ktotal] [int] NULL,
	[r3Ktotal] [int] NULL,
	[r4Ktotal] [int] NULL,
	[r1Kentered] [int] NULL,
	[r2Kentered] [int] NULL,
	[r3Kentered] [int] NULL,
	[r4Kentered] [int] NULL,
	[m1Ktotal] [int] NULL,
	[m2Ktotal] [int] NULL,
	[m3Ktotal] [int] NULL,
	[m4Ktotal] [int] NULL,
	[m1Kentered] [int] NULL,
	[m2Kentered] [int] NULL,
	[m3Kentered] [int] NULL,
	[m4Kentered] [int] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [decimal](9, 4) NULL,
	[m1perf] [varchar](1) NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [decimal](9, 4) NULL,
	[m2perf] [varchar](1) NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [decimal](9, 4) NULL,
	[m3perf] [varchar](1) NULL,
	[p1num_correct] [decimal](9, 4) NULL,
	[p1per_correct] [decimal](9, 4) NULL,
	[p2num_correct] [decimal](9, 4) NULL,
	[p2per_correct] [decimal](9, 4) NULL,
	[p3num_correct] [decimal](9, 4) NULL,
	[p3per_correct] [decimal](9, 4) NULL,
	[p4num_correct] [decimal](9, 4) NULL,
	[p4per_correct] [decimal](9, 4) NULL,
	[p5num_correct] [decimal](9, 4) NULL,
	[p5per_correct] [decimal](9, 4) NULL,
	[p6num_correct] [decimal](9, 4) NULL,
	[p6per_correct] [decimal](9, 4) NULL,
	[p7num_correct] [decimal](9, 4) NULL,
	[p7per_correct] [decimal](9, 4) NULL,
	[p8num_correct] [decimal](9, 4) NULL,
	[p8per_correct] [decimal](9, 4) NULL,
	[pChecks] [int] NULL,
	[p2modB_r] [decimal](9, 4) NULL,
	[p2modB_w] [decimal](9, 4) NULL,
	[rdg_intervention] [nvarchar](50) NULL,
	[r1status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[r3status] [varchar](8) NULL,
	[r1_RunRec] [int] NULL,
	[r1num_correct] [decimal](9, 4) NULL,
	[r1per_correct] [decimal](9, 4) NULL,
	[r2_RunRec] [int] NULL,
	[r2num_correct] [decimal](9, 4) NULL,
	[r2per_correct] [decimal](9, 4) NULL,
	[r3_RunRec] [int] NULL,
	[r3num_correct] [decimal](9, 4) NULL,
	[r3per_correct] [decimal](9, 4) NULL,
	[r4num_correct] [decimal](9, 4) NULL,
	[r4per_correct] [decimal](9, 4) NULL,
	[r5num_correct] [decimal](9, 4) NULL,
	[r5per_correct] [decimal](9, 4) NULL,
	[s1status] [varchar](4) NULL,
	[s2status] [varchar](4) NULL,
	[s3status] [varchar](4) NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [decimal](9, 4) NULL,
	[s1perf] [varchar](1) NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [decimal](9, 4) NULL,
	[s2perf] [varchar](1) NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [decimal](9, 4) NULL,
	[s3perf] [varchar](1) NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [decimal](9, 4) NULL,
	[ss1status] [varchar](4) NULL,
	[ss2status] [varchar](4) NULL,
	[ss3status] [varchar](4) NULL,
	[w1status] [varchar](4) NULL,
	[w2status] [varchar](4) NULL,
	[w3status] [varchar](4) NULL,
	[w1stgscr] [varchar](10) NULL,
	[w2stgscr] [varchar](10) NULL,
	[w3perf] [varchar](1) NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[cella_W] [varchar](10) NULL,
	[r1_level] [int] NULL,
	[r1_percentile] [int] NULL,
	[r2_level] [int] NULL,
	[r2_percentile] [int] NULL,
	[r3_level] [int] NULL,
	[r3_percentile] [int] NULL,
	[m1_percentile] [int] NULL,
	[m2_percentile] [int] NULL,
	[m3_percentile] [int] NULL,
	[fsa_math] [int] NULL,
	[fsa_read] [int] NULL,
	[fsa_math_ss] [int] NULL,
	[fsa_read_ss] [int] NULL,
 CONSTRAINT [PK_eds_assessments_NEW] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[EDS_assessments08]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[EDS_assessments08](
	[studentid] [varchar](10) NOT NULL,
	[permnum] [varchar](50) NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[advisor] [numeric](3, 0) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](40) NULL,
	[firstname] [varchar](20) NULL,
	[grade] [varchar](8) NULL,
	[endyrst] [varchar](1) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](1) NULL,
	[freemeals] [varchar](1) NULL,
	[lep] [varchar](3) NULL,
	[sec504elig] [varchar](3) NULL,
	[priexc] [varchar](3) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[r1num_correct] [int] NULL,
	[m1num_correct] [int] NULL,
	[s1num_correct] [int] NULL,
	[w1stgscr] [real] NULL,
	[w1status] [varchar](3) NULL,
	[r1runrec] [varchar](1) NULL,
	[r1SRI] [int] NULL,
	[r1dictsurv] [int] NULL,
	[r1currgr] [varchar](1) NULL,
	[m1currgr] [varchar](1) NULL,
	[s1currgr] [varchar](1) NULL,
	[r1status] [varchar](3) NULL,
	[m1status] [varchar](3) NULL,
	[s1status] [varchar](3) NULL,
	[r2num_correct] [int] NULL,
	[m2num_correct] [int] NULL,
	[s2num_correct] [int] NULL,
	[w2stgscr] [real] NULL,
	[w2status] [varchar](3) NULL,
	[r2runrec] [varchar](1) NULL,
	[r2SRI] [int] NULL,
	[r2currgr] [varchar](1) NULL,
	[m2currgr] [varchar](1) NULL,
	[s2currgr] [varchar](1) NULL,
	[r2status] [varchar](3) NULL,
	[m2Ktotal] [int] NULL,
	[m2status] [varchar](3) NULL,
	[s2status] [varchar](3) NULL,
	[r3num_correct] [int] NULL,
	[m3num_correct] [int] NULL,
	[s3num_correct] [int] NULL,
	[w3stgscr] [real] NULL,
	[w3status] [varchar](3) NULL,
	[r3runrec] [varchar](1) NULL,
	[r3SRI] [int] NULL,
	[r3currgr] [varchar](1) NULL,
	[m3currgr] [varchar](1) NULL,
	[s3currgr] [varchar](1) NULL,
	[r3status] [varchar](3) NULL,
	[m3Ktotal] [int] NULL,
	[m3status] [varchar](3) NULL,
	[s3status] [varchar](3) NULL,
	[r4status] [varchar](3) NULL,
	[m4Ktotal] [int] NULL,
	[m4status] [varchar](3) NULL,
	[w4status] [varchar](3) NULL,
	[grade_cal] [int] NULL,
 CONSTRAINT [PK_EDS_assessments08] PRIMARY KEY CLUSTERED 
(
	[studentid] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments09]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments09](
	[studentid] [varchar](12) NOT NULL,
	[permnum] [varchar](50) NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[advisor] [numeric](3, 0) NULL,
	[abbrevname] [varchar](15) NULL,
	[lastname] [varchar](40) NULL,
	[firstname] [varchar](20) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [char](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [char](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [char](1) NULL,
	[priexc] [char](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[r1num_correct] [int] NULL,
	[r1per_correct] [real] NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [real] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [real] NULL,
	[w1stgscr] [varchar](10) NULL,
	[w1status] [varchar](3) NULL,
	[m1currgr] [varchar](1) NULL,
	[s1currgr] [varchar](1) NULL,
	[s1status] [varchar](3) NULL,
	[r1status] [varchar](3) NULL,
	[m1Ktotal] [int] NULL,
	[m1status] [varchar](3) NULL,
	[r2num_correct] [int] NULL,
	[r2per_correct] [real] NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [real] NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [real] NULL,
	[w2stgscr] [varchar](10) NULL,
	[w2status] [varchar](3) NULL,
	[m2currgr] [varchar](1) NULL,
	[s2currgr] [varchar](1) NULL,
	[s2status] [varchar](3) NULL,
	[r2status] [varchar](3) NULL,
	[m2Ktotal] [int] NULL,
	[m2status] [varchar](3) NULL,
	[r3num_correct] [int] NULL,
	[r3per_correct] [real] NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [real] NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [real] NULL,
	[w3stgscr] [varchar](10) NULL,
	[w3status] [varchar](3) NULL,
	[m3currgr] [varchar](1) NULL,
	[s3currgr] [varchar](1) NULL,
	[s3status] [varchar](3) NULL,
	[r3status] [varchar](3) NULL,
	[m3Ktotal] [int] NULL,
	[m3status] [varchar](3) NULL,
	[r4num_correct] [int] NULL,
	[r4per_correct] [real] NULL,
	[r5num_correct] [int] NULL,
	[r5per_correct] [real] NULL,
	[r6num_correct] [int] NULL,
	[r6per_correct] [real] NULL,
	[r7num_correct] [int] NULL,
	[r7per_correct] [real] NULL,
	[r8num_correct] [int] NULL,
	[r8per_correct] [real] NULL,
	[alg_placement] [varchar](16) NULL,
	[alg_num_correct] [int] NULL,
	[alg_per_correct] [real] NULL,
 CONSTRAINT [PK_eds_assessments09] PRIMARY KEY CLUSTERED 
(
	[studentid] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments10]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments10](
	[student_id] [varchar](12) NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](20) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [char](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [char](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [char](1) NULL,
	[priexc] [char](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[a1num_correct] [int] NULL,
	[a1per_correct] [real] NULL,
	[r1num_correct] [int] NULL,
	[r1per_correct] [real] NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [real] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [real] NULL,
	[w1stgscr] [varchar](10) NULL,
	[w1status] [varchar](3) NULL,
	[m1perf] [varchar](1) NULL,
	[s1perf] [varchar](1) NULL,
	[s1status] [varchar](3) NULL,
	[a1status] [varchar](8) NULL,
	[r1status] [varchar](8) NULL,
	[m1Ktotal] [int] NULL,
	[m1status] [varchar](3) NULL,
	[a2num_correct] [int] NULL,
	[a2per_correct] [real] NULL,
	[r2num_correct] [int] NULL,
	[r2per_correct] [real] NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [real] NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [real] NULL,
	[w2stgscr] [varchar](10) NULL,
	[w2status] [varchar](3) NULL,
	[m2perf] [varchar](1) NULL,
	[s2perf] [varchar](1) NULL,
	[s2status] [varchar](3) NULL,
	[a2status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[m2Ktotal] [int] NULL,
	[m2status] [varchar](3) NULL,
	[r3num_correct] [int] NULL,
	[r3per_correct] [real] NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [real] NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [real] NULL,
	[w3stgscr] [varchar](10) NULL,
	[w3status] [varchar](3) NULL,
	[m3perf] [varchar](1) NULL,
	[s3perf] [varchar](1) NULL,
	[s3status] [varchar](3) NULL,
	[r3status] [varchar](8) NULL,
	[m3Ktotal] [int] NULL,
	[m3status] [varchar](3) NULL,
	[r4num_correct] [int] NULL,
	[r4per_correct] [real] NULL,
	[r5num_correct] [int] NULL,
	[r5per_correct] [real] NULL,
	[r6num_correct] [int] NULL,
	[r6per_correct] [real] NULL,
	[r7num_correct] [int] NULL,
	[r7per_correct] [real] NULL,
	[r8num_correct] [int] NULL,
	[r8per_correct] [real] NULL,
	[alg_placement] [varchar](16) NULL,
	[alg_num_correct] [int] NULL,
	[alg_per_correct] [real] NULL,
	[r1PRS_FSP] [int] NULL,
	[r2PRS_FSP] [int] NULL,
	[r3PRS_FSP] [int] NULL,
 CONSTRAINT [PK_eds_assessments10] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments11]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments11](
	[student_id] [varchar](12) NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](20) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [char](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [char](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [char](1) NULL,
	[priexc] [char](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[a1num_correct] [int] NULL,
	[a1per_correct] [real] NULL,
	[r1num_correct] [int] NULL,
	[r1per_correct] [real] NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [real] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [real] NULL,
	[w1stgscr] [varchar](10) NULL,
	[w1status] [varchar](3) NULL,
	[m1perf] [varchar](1) NULL,
	[s1perf] [varchar](1) NULL,
	[s1status] [varchar](3) NULL,
	[a1status] [varchar](8) NULL,
	[r1status] [varchar](8) NULL,
	[m1Ktotal] [int] NULL,
	[m1status] [varchar](3) NULL,
	[a2num_correct] [int] NULL,
	[a2per_correct] [real] NULL,
	[r2num_correct] [int] NULL,
	[r2per_correct] [real] NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [real] NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [real] NULL,
	[w2stgscr] [varchar](10) NULL,
	[w2status] [varchar](3) NULL,
	[m2perf] [varchar](1) NULL,
	[s2perf] [varchar](1) NULL,
	[s2status] [varchar](3) NULL,
	[a2status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[m2Ktotal] [int] NULL,
	[m2status] [varchar](3) NULL,
	[r3num_correct] [int] NULL,
	[r3per_correct] [real] NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [real] NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [real] NULL,
	[w3stgscr] [varchar](10) NULL,
	[w3status] [varchar](3) NULL,
	[m3perf] [varchar](1) NULL,
	[s3perf] [varchar](1) NULL,
	[s3status] [varchar](3) NULL,
	[r3status] [varchar](8) NULL,
	[m3Ktotal] [int] NULL,
	[m3status] [varchar](3) NULL,
	[p1num_correct] [int] NULL,
	[p1per_correct] [real] NULL,
	[p2num_correct] [int] NULL,
	[p2per_correct] [real] NULL,
	[p3num_correct] [int] NULL,
	[p3per_correct] [real] NULL,
	[p4num_correct] [int] NULL,
	[p4per_correct] [real] NULL,
	[p5num_correct] [int] NULL,
	[p5per_correct] [real] NULL,
	[p6num_correct] [int] NULL,
	[p6per_correct] [real] NULL,
	[p7num_correct] [int] NULL,
	[p7per_correct] [real] NULL,
	[p8num_correct] [int] NULL,
	[p8per_correct] [real] NULL,
	[alg_placement] [varchar](16) NULL,
	[alg_num_correct] [int] NULL,
	[alg_per_correct] [real] NULL,
	[r1PRS_FSP] [int] NULL,
	[r2PRS_FSP] [int] NULL,
	[r3PRS_FSP] [int] NULL,
	[r4num_correct] [int] NULL,
	[r4per_correct] [real] NULL,
	[r5num_correct] [int] NULL,
	[r5per_correct] [real] NULL,
	[mu1num_correct] [int] NULL,
	[mu1per_correct] [real] NULL,
	[mu2num_correct] [int] NULL,
	[mu2per_correct] [real] NULL,
	[mu3num_correct] [int] NULL,
	[mu3per_correct] [real] NULL,
	[mu4num_correct] [int] NULL,
	[mu4per_correct] [real] NULL,
	[mu5num_correct] [int] NULL,
	[mu5per_correct] [real] NULL,
	[mu6num_correct] [int] NULL,
	[mu6per_correct] [real] NULL,
	[ssu1num_correct] [int] NULL,
	[ssu1per_correct] [real] NULL,
	[ssu2num_correct] [int] NULL,
	[ssu2per_correct] [real] NULL,
	[ssu3num_correct] [int] NULL,
	[ssu3per_correct] [real] NULL,
	[ssu4num_correct] [int] NULL,
	[ssu4per_correct] [real] NULL,
	[ssu5num_correct] [int] NULL,
	[ssu5per_correct] [real] NULL,
	[ssu6num_correct] [int] NULL,
	[ssu6per_correct] [real] NULL,
	[su1num_correct] [int] NULL,
	[su1per_correct] [real] NULL,
	[su2num_correct] [int] NULL,
	[su2per_correct] [real] NULL,
	[su3num_correct] [int] NULL,
	[su3per_correct] [real] NULL,
	[su4num_correct] [int] NULL,
	[su4per_correct] [real] NULL,
	[su5num_correct] [int] NULL,
	[su5per_correct] [real] NULL,
	[su6num_correct] [int] NULL,
	[su6per_correct] [real] NULL,
 CONSTRAINT [PK_eds_assessments11] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments12]    Script Date: 3/27/2023 10:28:47 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments12](
	[student_id] [varchar](12) NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](20) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [char](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [char](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [char](1) NULL,
	[priexc] [char](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[a1num_correct] [int] NULL,
	[a1per_correct] [real] NULL,
	[g1num_correct] [int] NULL,
	[g1per_correct] [real] NULL,
	[r1num_correct] [int] NULL,
	[r1per_correct] [real] NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [real] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [real] NULL,
	[w1stgscr] [varchar](10) NULL,
	[w1status] [varchar](3) NULL,
	[m1perf] [varchar](1) NULL,
	[s1perf] [varchar](1) NULL,
	[s1status] [varchar](3) NULL,
	[a1status] [varchar](8) NULL,
	[r1status] [varchar](8) NULL,
	[m1Ktotal] [int] NULL,
	[m1status] [varchar](3) NULL,
	[a2num_correct] [int] NULL,
	[a2per_correct] [real] NULL,
	[g2num_correct] [int] NULL,
	[g2per_correct] [real] NULL,
	[r2num_correct] [int] NULL,
	[r2per_correct] [real] NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [real] NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [real] NULL,
	[w2stgscr] [varchar](10) NULL,
	[w2status] [varchar](3) NULL,
	[m2perf] [varchar](1) NULL,
	[s2perf] [varchar](1) NULL,
	[s2status] [varchar](3) NULL,
	[a2status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[m2Ktotal] [int] NULL,
	[m2status] [varchar](3) NULL,
	[r3num_correct] [int] NULL,
	[r3per_correct] [real] NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [real] NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [real] NULL,
	[w3stgscr] [varchar](10) NULL,
	[w3status] [varchar](3) NULL,
	[m3perf] [varchar](1) NULL,
	[s3perf] [varchar](1) NULL,
	[s3status] [varchar](3) NULL,
	[r3status] [varchar](8) NULL,
	[m3Ktotal] [int] NULL,
	[m3status] [varchar](3) NULL,
	[p1num_correct] [int] NULL,
	[p1per_correct] [real] NULL,
	[p2num_correct] [int] NULL,
	[p2per_correct] [real] NULL,
	[p3num_correct] [int] NULL,
	[p3per_correct] [real] NULL,
	[p4num_correct] [int] NULL,
	[p4per_correct] [real] NULL,
	[p5num_correct] [int] NULL,
	[p5per_correct] [real] NULL,
	[p6num_correct] [int] NULL,
	[p6per_correct] [real] NULL,
	[p7num_correct] [int] NULL,
	[p7per_correct] [real] NULL,
	[p8num_correct] [int] NULL,
	[p8per_correct] [real] NULL,
	[pnum_total] [int] NULL,
	[pper_average] [real] NULL,
	[alg_placement] [varchar](16) NULL,
	[alg_num_correct] [int] NULL,
	[alg_per_correct] [real] NULL,
	[r1PRS_FSP] [int] NULL,
	[r2PRS_FSP] [int] NULL,
	[r3PRS_FSP] [int] NULL,
	[r4num_correct] [int] NULL,
	[r4per_correct] [real] NULL,
	[r5num_correct] [int] NULL,
	[r5per_correct] [real] NULL,
	[mu1num_correct] [int] NULL,
	[mu1per_correct] [real] NULL,
	[mu2num_correct] [int] NULL,
	[mu2per_correct] [real] NULL,
	[mu3num_correct] [int] NULL,
	[mu3per_correct] [real] NULL,
	[mu4num_correct] [int] NULL,
	[mu4per_correct] [real] NULL,
	[mu5num_correct] [int] NULL,
	[mu5per_correct] [real] NULL,
	[mu6num_correct] [int] NULL,
	[mu6per_correct] [real] NULL,
	[ssu1num_correct] [int] NULL,
	[ssu1per_correct] [real] NULL,
	[ssu2num_correct] [int] NULL,
	[ssu2per_correct] [real] NULL,
	[ssu3num_correct] [int] NULL,
	[ssu3per_correct] [real] NULL,
	[ssu4num_correct] [int] NULL,
	[ssu4per_correct] [real] NULL,
	[ssu5num_correct] [int] NULL,
	[ssu5per_correct] [real] NULL,
	[ssu6num_correct] [int] NULL,
	[ssu6per_correct] [real] NULL,
	[su1num_correct] [int] NULL,
	[su1per_correct] [real] NULL,
	[su2num_correct] [int] NULL,
	[su2per_correct] [real] NULL,
	[su3num_correct] [int] NULL,
	[su3per_correct] [real] NULL,
	[su4num_correct] [int] NULL,
	[su4per_correct] [real] NULL,
	[su5num_correct] [int] NULL,
	[su5per_correct] [real] NULL,
	[su6num_correct] [int] NULL,
	[su6per_correct] [real] NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_W] [varchar](10) NULL,
	[cella_T] [int] NULL,
 CONSTRAINT [PK_eds_assessments12] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments13]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments13](
	[student_id] [varchar](12) NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](20) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [char](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [char](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [char](1) NULL,
	[priexc] [char](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[a1num_correct] [int] NULL,
	[a1per_correct] [real] NULL,
	[g1num_correct] [int] NULL,
	[g1per_correct] [real] NULL,
	[r1num_correct] [int] NULL,
	[r1per_correct] [real] NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [real] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [real] NULL,
	[w1stgscr] [varchar](10) NULL,
	[w1status] [varchar](3) NULL,
	[m1perf] [varchar](1) NULL,
	[s1perf] [varchar](1) NULL,
	[s1status] [varchar](3) NULL,
	[a1status] [varchar](8) NULL,
	[r1status] [varchar](8) NULL,
	[m1Ktotal] [int] NULL,
	[m1status] [varchar](3) NULL,
	[a2num_correct] [int] NULL,
	[a2per_correct] [real] NULL,
	[g2num_correct] [int] NULL,
	[g2per_correct] [real] NULL,
	[r2num_correct] [int] NULL,
	[r2per_correct] [real] NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [real] NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [real] NULL,
	[w2stgscr] [varchar](10) NULL,
	[w2status] [varchar](3) NULL,
	[m2perf] [varchar](1) NULL,
	[s2perf] [varchar](1) NULL,
	[s2status] [varchar](3) NULL,
	[a2status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[m2Ktotal] [int] NULL,
	[m2status] [varchar](3) NULL,
	[r3num_correct] [int] NULL,
	[r3per_correct] [real] NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [real] NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [real] NULL,
	[w3stgscr] [varchar](10) NULL,
	[w3status] [varchar](3) NULL,
	[w3perf] [varchar](1) NULL,
	[m3perf] [varchar](1) NULL,
	[s3perf] [varchar](1) NULL,
	[s3status] [varchar](3) NULL,
	[r3status] [varchar](8) NULL,
	[m3Ktotal] [int] NULL,
	[m3status] [varchar](3) NULL,
	[p1num_correct] [int] NULL,
	[p1per_correct] [real] NULL,
	[p2num_correct] [int] NULL,
	[p2per_correct] [real] NULL,
	[p3num_correct] [int] NULL,
	[p3per_correct] [real] NULL,
	[p4num_correct] [int] NULL,
	[p4per_correct] [real] NULL,
	[p5num_correct] [int] NULL,
	[p5per_correct] [real] NULL,
	[p6num_correct] [int] NULL,
	[p6per_correct] [real] NULL,
	[p7num_correct] [int] NULL,
	[p7per_correct] [real] NULL,
	[p8num_correct] [int] NULL,
	[p8per_correct] [real] NULL,
	[pnum_total] [int] NULL,
	[pper_average] [real] NULL,
	[alg_placement] [varchar](16) NULL,
	[alg_num_correct] [int] NULL,
	[alg_per_correct] [real] NULL,
	[r1PRS_FSP] [int] NULL,
	[r2PRS_FSP] [int] NULL,
	[r3PRS_FSP] [int] NULL,
	[r4num_correct] [int] NULL,
	[r4per_correct] [real] NULL,
	[r5num_correct] [int] NULL,
	[r5per_correct] [real] NULL,
	[mu1num_correct] [int] NULL,
	[mu1per_correct] [real] NULL,
	[mu2num_correct] [int] NULL,
	[mu2per_correct] [real] NULL,
	[mu3num_correct] [int] NULL,
	[mu3per_correct] [real] NULL,
	[mu4num_correct] [int] NULL,
	[mu4per_correct] [real] NULL,
	[mu5num_correct] [int] NULL,
	[mu5per_correct] [real] NULL,
	[mu6num_correct] [int] NULL,
	[mu6per_correct] [real] NULL,
	[ssu1num_correct] [int] NULL,
	[ssu1per_correct] [real] NULL,
	[ssu2num_correct] [int] NULL,
	[ssu2per_correct] [real] NULL,
	[ssu3num_correct] [int] NULL,
	[ssu3per_correct] [real] NULL,
	[ssu4num_correct] [int] NULL,
	[ssu4per_correct] [real] NULL,
	[ssu5num_correct] [int] NULL,
	[ssu5per_correct] [real] NULL,
	[ssu6num_correct] [int] NULL,
	[ssu6per_correct] [real] NULL,
	[su1num_correct] [int] NULL,
	[su1per_correct] [real] NULL,
	[su2num_correct] [int] NULL,
	[su2per_correct] [real] NULL,
	[su3num_correct] [int] NULL,
	[su3per_correct] [real] NULL,
	[su4num_correct] [int] NULL,
	[su4per_correct] [real] NULL,
	[su5num_correct] [int] NULL,
	[su5per_correct] [real] NULL,
	[su6num_correct] [int] NULL,
	[su6per_correct] [real] NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_W] [varchar](10) NULL,
	[cella_T] [int] NULL,
 CONSTRAINT [PK_eds_assessments13] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments14]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments14](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [char](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [char](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [char](1) NULL,
	[priexc] [char](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[a1num_correct] [int] NULL,
	[a1per_correct] [real] NULL,
	[g1num_correct] [int] NULL,
	[g1per_correct] [real] NULL,
	[r1num_correct] [int] NULL,
	[r1per_correct] [real] NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [real] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [real] NULL,
	[w1stgscr] [varchar](10) NULL,
	[w1status] [varchar](3) NULL,
	[m1perf] [varchar](1) NULL,
	[s1perf] [varchar](1) NULL,
	[s1status] [varchar](3) NULL,
	[a1status] [varchar](8) NULL,
	[r1status] [varchar](8) NULL,
	[m1Ktotal] [int] NULL,
	[m1status] [varchar](3) NULL,
	[a2num_correct] [int] NULL,
	[a2per_correct] [real] NULL,
	[g2num_correct] [int] NULL,
	[g2per_correct] [real] NULL,
	[r2num_correct] [int] NULL,
	[r2per_correct] [real] NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [real] NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [real] NULL,
	[w2stgscr] [varchar](10) NULL,
	[w2status] [varchar](3) NULL,
	[m2perf] [varchar](1) NULL,
	[s2perf] [varchar](1) NULL,
	[s2status] [varchar](3) NULL,
	[a2status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[m2Ktotal] [int] NULL,
	[m2status] [varchar](3) NULL,
	[r3num_correct] [int] NULL,
	[r3per_correct] [real] NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [real] NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [real] NULL,
	[w3stgscr] [varchar](10) NULL,
	[w3status] [varchar](3) NULL,
	[w3perf] [varchar](1) NULL,
	[m3perf] [varchar](1) NULL,
	[s3perf] [varchar](1) NULL,
	[s3status] [varchar](3) NULL,
	[r3status] [varchar](8) NULL,
	[m3Ktotal] [int] NULL,
	[m3status] [varchar](3) NULL,
	[m4Ktotal] [int] NULL,
	[p1num_correct] [real] NULL,
	[p1per_correct] [real] NULL,
	[p2num_correct] [real] NULL,
	[p2per_correct] [real] NULL,
	[p3num_correct] [real] NULL,
	[p3per_correct] [real] NULL,
	[p4num_correct] [real] NULL,
	[p4per_correct] [real] NULL,
	[p5num_correct] [real] NULL,
	[p5per_correct] [real] NULL,
	[p6num_correct] [real] NULL,
	[p6per_correct] [real] NULL,
	[p7num_correct] [real] NULL,
	[p7per_correct] [real] NULL,
	[p8num_correct] [real] NULL,
	[p8per_correct] [real] NULL,
	[pnum_total] [real] NULL,
	[pper_average] [real] NULL,
	[alg_placement] [varchar](16) NULL,
	[alg_num_correct] [int] NULL,
	[alg_per_correct] [real] NULL,
	[r1PLS] [int] NULL,
	[r2PLS] [int] NULL,
	[r3PLS] [int] NULL,
	[r4num_correct] [int] NULL,
	[r4per_correct] [real] NULL,
	[r5num_correct] [int] NULL,
	[r5per_correct] [real] NULL,
	[mu1num_correct] [int] NULL,
	[mu1per_correct] [real] NULL,
	[mu2num_correct] [int] NULL,
	[mu2per_correct] [real] NULL,
	[mu3num_correct] [int] NULL,
	[mu3per_correct] [real] NULL,
	[mu4num_correct] [int] NULL,
	[mu4per_correct] [real] NULL,
	[mu5num_correct] [int] NULL,
	[mu5per_correct] [real] NULL,
	[mu6num_correct] [int] NULL,
	[mu6per_correct] [real] NULL,
	[ss1num_correct] [int] NULL,
	[ss1per_correct] [real] NULL,
	[ss2num_correct] [int] NULL,
	[ss2per_correct] [real] NULL,
	[ss3num_correct] [int] NULL,
	[ss3per_correct] [real] NULL,
	[ss4num_correct] [int] NULL,
	[ss4per_correct] [real] NULL,
	[ssu5num_correct] [int] NULL,
	[ssu5per_correct] [real] NULL,
	[ssu6num_correct] [int] NULL,
	[ssu6per_correct] [real] NULL,
	[su1num_correct] [int] NULL,
	[su1per_correct] [real] NULL,
	[su2num_correct] [int] NULL,
	[su2per_correct] [real] NULL,
	[su3num_correct] [int] NULL,
	[su3per_correct] [real] NULL,
	[su4num_correct] [int] NULL,
	[su4per_correct] [real] NULL,
	[su5num_correct] [int] NULL,
	[su5per_correct] [real] NULL,
	[su6num_correct] [int] NULL,
	[su6per_correct] [real] NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_W] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[rp1num_correct] [int] NULL,
	[rp1per_correct] [real] NULL,
	[rp2num_correct] [numeric](4, 1) NULL,
	[rp2per_correct] [real] NULL,
	[rp3num_correct] [int] NULL,
	[rp3per_correct] [real] NULL,
	[r1_RunRec] [int] NULL,
	[r2_RunRec] [int] NULL,
	[r3_RunRec] [int] NULL,
	[mp1num_correct] [int] NULL,
	[mp1per_correct] [real] NULL,
	[mp2num_correct] [int] NULL,
	[mp2per_correct] [real] NULL,
	[mp3num_correct] [int] NULL,
	[mp3per_correct] [real] NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [real] NULL,
	[mpa1num_correct] [int] NULL,
	[mpa1per_correct] [real] NULL,
	[madv1num_correct] [int] NULL,
	[madv1per_correct] [real] NULL,
	[ah1num_correct] [int] NULL,
	[ah1per_correct] [real] NULL,
	[ah2num_correct] [int] NULL,
	[ah2per_correct] [real] NULL,
	[mpa2num_correct] [int] NULL,
	[mpa2per_correct] [real] NULL,
	[madv2num_correct] [int] NULL,
	[madv2per_correct] [real] NULL,
	[r_sb_pre_num_correct] [int] NULL,
	[r_sb_pre_per_correct] [real] NULL,
	[m_sb_pre_num_correct] [int] NULL,
	[m_sb_pre_per_correct] [real] NULL,
	[r_sb_post_num_correct] [int] NULL,
	[r_sb_post_per_correct] [real] NULL,
	[m_sb_post_num_correct] [int] NULL,
	[m_sb_post_per_correct] [real] NULL,
	[s_sb_pre_num_correct] [int] NULL,
	[s_sb_pre_per_correct] [real] NULL,
	[s_sb_post_num_correct] [int] NULL,
	[s_sb_post_per_correct] [real] NULL,
 CONSTRAINT [PK_eds_assessments14] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments15]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments15](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [varchar](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [varchar](1) NULL,
	[priexc] [varchar](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[m1status] [varchar](4) NULL,
	[m2status] [varchar](4) NULL,
	[m3status] [varchar](4) NULL,
	[m1Ktotal] [int] NULL,
	[m2Ktotal] [int] NULL,
	[m3Ktotal] [int] NULL,
	[m4Ktotal] [int] NULL,
	[m1Kentered] [int] NULL,
	[m2Kentered] [int] NULL,
	[m3Kentered] [int] NULL,
	[m4Kentered] [int] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [decimal](9, 4) NULL,
	[m1perf] [varchar](1) NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [decimal](9, 4) NULL,
	[m2perf] [varchar](1) NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [decimal](9, 4) NULL,
	[m3perf] [varchar](1) NULL,
	[p1num_correct] [decimal](9, 4) NULL,
	[p1per_correct] [decimal](9, 4) NULL,
	[p2num_correct] [decimal](9, 4) NULL,
	[p2per_correct] [decimal](9, 4) NULL,
	[p3num_correct] [decimal](9, 4) NULL,
	[p3per_correct] [decimal](9, 4) NULL,
	[p4num_correct] [decimal](9, 4) NULL,
	[p4per_correct] [decimal](9, 4) NULL,
	[p5num_correct] [decimal](9, 4) NULL,
	[p5per_correct] [decimal](9, 4) NULL,
	[p6num_correct] [decimal](9, 4) NULL,
	[p6per_correct] [decimal](9, 4) NULL,
	[p7num_correct] [decimal](9, 4) NULL,
	[p7per_correct] [decimal](9, 4) NULL,
	[p8num_correct] [decimal](9, 4) NULL,
	[p8per_correct] [decimal](9, 4) NULL,
	[pChecks] [int] NULL,
	[r1status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[r3status] [varchar](8) NULL,
	[r1_RunRec] [int] NULL,
	[r1num_correct] [decimal](9, 4) NULL,
	[r1per_correct] [decimal](9, 4) NULL,
	[r2_RunRec] [int] NULL,
	[r2num_correct] [decimal](9, 4) NULL,
	[r2per_correct] [decimal](9, 4) NULL,
	[r3_RunRec] [int] NULL,
	[r3num_correct] [decimal](9, 4) NULL,
	[r3per_correct] [decimal](9, 4) NULL,
	[r4num_correct] [decimal](9, 4) NULL,
	[r4per_correct] [decimal](9, 4) NULL,
	[r5num_correct] [decimal](9, 4) NULL,
	[r5per_correct] [decimal](9, 4) NULL,
	[s1status] [varchar](4) NULL,
	[s2status] [varchar](4) NULL,
	[s3status] [varchar](4) NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [decimal](9, 4) NULL,
	[s1perf] [varchar](1) NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [decimal](9, 4) NULL,
	[s2perf] [varchar](1) NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [decimal](9, 4) NULL,
	[s3perf] [varchar](1) NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [decimal](9, 4) NULL,
	[ss1status] [varchar](4) NULL,
	[ss2status] [varchar](4) NULL,
	[ss3status] [varchar](4) NULL,
	[w1status] [varchar](4) NULL,
	[w2status] [varchar](4) NULL,
	[w3status] [varchar](4) NULL,
	[w1stgscr] [varchar](10) NULL,
	[w2stgscr] [varchar](10) NULL,
	[w3perf] [varchar](1) NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[cella_W] [varchar](10) NULL,
 CONSTRAINT [PK_eds_assessments15] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments16]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments16](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [varchar](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [varchar](1) NULL,
	[priexc] [varchar](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[m1status] [varchar](4) NULL,
	[m2status] [varchar](4) NULL,
	[m3status] [varchar](4) NULL,
	[m1Ktotal] [int] NULL,
	[m2Ktotal] [int] NULL,
	[m3Ktotal] [int] NULL,
	[m4Ktotal] [int] NULL,
	[m1Kentered] [int] NULL,
	[m2Kentered] [int] NULL,
	[m3Kentered] [int] NULL,
	[m4Kentered] [int] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [decimal](9, 4) NULL,
	[m1perf] [varchar](1) NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [decimal](9, 4) NULL,
	[m2perf] [varchar](1) NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [decimal](9, 4) NULL,
	[m3perf] [varchar](1) NULL,
	[p1num_correct] [decimal](9, 4) NULL,
	[p1per_correct] [decimal](9, 4) NULL,
	[p2num_correct] [decimal](9, 4) NULL,
	[p2per_correct] [decimal](9, 4) NULL,
	[p3num_correct] [decimal](9, 4) NULL,
	[p3per_correct] [decimal](9, 4) NULL,
	[p4num_correct] [decimal](9, 4) NULL,
	[p4per_correct] [decimal](9, 4) NULL,
	[p5num_correct] [decimal](9, 4) NULL,
	[p5per_correct] [decimal](9, 4) NULL,
	[p6num_correct] [decimal](9, 4) NULL,
	[p6per_correct] [decimal](9, 4) NULL,
	[p7num_correct] [decimal](9, 4) NULL,
	[p7per_correct] [decimal](9, 4) NULL,
	[p8num_correct] [decimal](9, 4) NULL,
	[p8per_correct] [decimal](9, 4) NULL,
	[pChecks] [int] NULL,
	[p2modB_r] [decimal](9, 4) NULL,
	[p2modB_w] [decimal](9, 4) NULL,
	[r1status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[r3status] [varchar](8) NULL,
	[r1_RunRec] [int] NULL,
	[r1num_correct] [decimal](9, 4) NULL,
	[r1per_correct] [decimal](9, 4) NULL,
	[r2_RunRec] [int] NULL,
	[r2num_correct] [decimal](9, 4) NULL,
	[r2per_correct] [decimal](9, 4) NULL,
	[r3_RunRec] [int] NULL,
	[r3num_correct] [decimal](9, 4) NULL,
	[r3per_correct] [decimal](9, 4) NULL,
	[r4num_correct] [decimal](9, 4) NULL,
	[r4per_correct] [decimal](9, 4) NULL,
	[r5num_correct] [decimal](9, 4) NULL,
	[r5per_correct] [decimal](9, 4) NULL,
	[s1status] [varchar](4) NULL,
	[s2status] [varchar](4) NULL,
	[s3status] [varchar](4) NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [decimal](9, 4) NULL,
	[s1perf] [varchar](1) NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [decimal](9, 4) NULL,
	[s2perf] [varchar](1) NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [decimal](9, 4) NULL,
	[s3perf] [varchar](1) NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [decimal](9, 4) NULL,
	[ss1status] [varchar](4) NULL,
	[ss2status] [varchar](4) NULL,
	[ss3status] [varchar](4) NULL,
	[w1status] [varchar](4) NULL,
	[w2status] [varchar](4) NULL,
	[w3status] [varchar](4) NULL,
	[w1stgscr] [varchar](10) NULL,
	[w2stgscr] [varchar](10) NULL,
	[w3perf] [varchar](1) NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[cella_W] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[fsa_math] [int] NULL,
	[fsa_read] [int] NULL,
	[fsa_math_ss] [int] NULL,
	[fsa_read_ss] [int] NULL,
 CONSTRAINT [PK_eds_assessments16] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments17]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments17](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [varchar](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [varchar](1) NULL,
	[priexc] [varchar](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[m1status] [varchar](4) NULL,
	[m2status] [varchar](4) NULL,
	[m3status] [varchar](4) NULL,
	[m1Ktotal] [int] NULL,
	[m2Ktotal] [int] NULL,
	[m3Ktotal] [int] NULL,
	[m4Ktotal] [int] NULL,
	[m1Kentered] [int] NULL,
	[m2Kentered] [int] NULL,
	[m3Kentered] [int] NULL,
	[m4Kentered] [int] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [decimal](9, 4) NULL,
	[m1perf] [varchar](1) NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [decimal](9, 4) NULL,
	[m2perf] [varchar](1) NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [decimal](9, 4) NULL,
	[m3perf] [varchar](1) NULL,
	[p1num_correct] [decimal](9, 4) NULL,
	[p1per_correct] [decimal](9, 4) NULL,
	[p2num_correct] [decimal](9, 4) NULL,
	[p2per_correct] [decimal](9, 4) NULL,
	[p3num_correct] [decimal](9, 4) NULL,
	[p3per_correct] [decimal](9, 4) NULL,
	[p4num_correct] [decimal](9, 4) NULL,
	[p4per_correct] [decimal](9, 4) NULL,
	[p5num_correct] [decimal](9, 4) NULL,
	[p5per_correct] [decimal](9, 4) NULL,
	[p6num_correct] [decimal](9, 4) NULL,
	[p6per_correct] [decimal](9, 4) NULL,
	[p7num_correct] [decimal](9, 4) NULL,
	[p7per_correct] [decimal](9, 4) NULL,
	[p8num_correct] [decimal](9, 4) NULL,
	[p8per_correct] [decimal](9, 4) NULL,
	[pChecks] [int] NULL,
	[p2modB_r] [decimal](9, 4) NULL,
	[p2modB_w] [decimal](9, 4) NULL,
	[r1status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[r3status] [varchar](8) NULL,
	[r1_RunRec] [int] NULL,
	[r1num_correct] [decimal](9, 4) NULL,
	[r1per_correct] [decimal](9, 4) NULL,
	[r2_RunRec] [int] NULL,
	[r2num_correct] [decimal](9, 4) NULL,
	[r2per_correct] [decimal](9, 4) NULL,
	[r3_RunRec] [int] NULL,
	[r3num_correct] [decimal](9, 4) NULL,
	[r3per_correct] [decimal](9, 4) NULL,
	[r4num_correct] [decimal](9, 4) NULL,
	[r4per_correct] [decimal](9, 4) NULL,
	[r5num_correct] [decimal](9, 4) NULL,
	[r5per_correct] [decimal](9, 4) NULL,
	[s1status] [varchar](4) NULL,
	[s2status] [varchar](4) NULL,
	[s3status] [varchar](4) NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [decimal](9, 4) NULL,
	[s1perf] [varchar](1) NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [decimal](9, 4) NULL,
	[s2perf] [varchar](1) NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [decimal](9, 4) NULL,
	[s3perf] [varchar](1) NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [decimal](9, 4) NULL,
	[ss1status] [varchar](4) NULL,
	[ss2status] [varchar](4) NULL,
	[ss3status] [varchar](4) NULL,
	[w1status] [varchar](4) NULL,
	[w2status] [varchar](4) NULL,
	[w3status] [varchar](4) NULL,
	[w1stgscr] [varchar](10) NULL,
	[w2stgscr] [varchar](10) NULL,
	[w3perf] [varchar](1) NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[cella_W] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[fsa_math] [int] NULL,
	[fsa_read] [int] NULL,
	[fsa_math_ss] [int] NULL,
	[fsa_read_ss] [int] NULL,
 CONSTRAINT [PK_eds_assessments17] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments18]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments18](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [varchar](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [varchar](1) NULL,
	[priexc] [varchar](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[m1status] [varchar](4) NULL,
	[m2status] [varchar](4) NULL,
	[m3status] [varchar](4) NULL,
	[m1Ktotal] [int] NULL,
	[m2Ktotal] [int] NULL,
	[m3Ktotal] [int] NULL,
	[m4Ktotal] [int] NULL,
	[m1Kentered] [int] NULL,
	[m2Kentered] [int] NULL,
	[m3Kentered] [int] NULL,
	[m4Kentered] [int] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [decimal](9, 4) NULL,
	[m1perf] [varchar](1) NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [decimal](9, 4) NULL,
	[m2perf] [varchar](1) NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [decimal](9, 4) NULL,
	[m3perf] [varchar](1) NULL,
	[p1num_correct] [decimal](9, 4) NULL,
	[p1per_correct] [decimal](9, 4) NULL,
	[p2num_correct] [decimal](9, 4) NULL,
	[p2per_correct] [decimal](9, 4) NULL,
	[p3num_correct] [decimal](9, 4) NULL,
	[p3per_correct] [decimal](9, 4) NULL,
	[p4num_correct] [decimal](9, 4) NULL,
	[p4per_correct] [decimal](9, 4) NULL,
	[p5num_correct] [decimal](9, 4) NULL,
	[p5per_correct] [decimal](9, 4) NULL,
	[p6num_correct] [decimal](9, 4) NULL,
	[p6per_correct] [decimal](9, 4) NULL,
	[p7num_correct] [decimal](9, 4) NULL,
	[p7per_correct] [decimal](9, 4) NULL,
	[p8num_correct] [decimal](9, 4) NULL,
	[p8per_correct] [decimal](9, 4) NULL,
	[pChecks] [int] NULL,
	[p2modB_r] [decimal](9, 4) NULL,
	[p2modB_w] [decimal](9, 4) NULL,
	[r1status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[r3status] [varchar](8) NULL,
	[r1_RunRec] [int] NULL,
	[r1num_correct] [decimal](9, 4) NULL,
	[r1per_correct] [decimal](9, 4) NULL,
	[r2_RunRec] [int] NULL,
	[r2num_correct] [decimal](9, 4) NULL,
	[r2per_correct] [decimal](9, 4) NULL,
	[r3_RunRec] [int] NULL,
	[r3num_correct] [decimal](9, 4) NULL,
	[r3per_correct] [decimal](9, 4) NULL,
	[r4num_correct] [decimal](9, 4) NULL,
	[r4per_correct] [decimal](9, 4) NULL,
	[r5num_correct] [decimal](9, 4) NULL,
	[r5per_correct] [decimal](9, 4) NULL,
	[s1status] [varchar](4) NULL,
	[s2status] [varchar](4) NULL,
	[s3status] [varchar](4) NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [decimal](9, 4) NULL,
	[s1perf] [varchar](1) NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [decimal](9, 4) NULL,
	[s2perf] [varchar](1) NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [decimal](9, 4) NULL,
	[s3perf] [varchar](1) NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [decimal](9, 4) NULL,
	[ss1status] [varchar](4) NULL,
	[ss2status] [varchar](4) NULL,
	[ss3status] [varchar](4) NULL,
	[w1status] [varchar](4) NULL,
	[w2status] [varchar](4) NULL,
	[w3status] [varchar](4) NULL,
	[w1stgscr] [varchar](10) NULL,
	[w2stgscr] [varchar](10) NULL,
	[w3perf] [varchar](1) NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[cella_W] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[fsa_math] [int] NULL,
	[fsa_read] [int] NULL,
	[fsa_math_ss] [int] NULL,
	[fsa_read_ss] [int] NULL,
 CONSTRAINT [PK_eds_assessments18] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments19]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments19](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [varchar](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [varchar](1) NULL,
	[priexc] [varchar](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[m1status] [varchar](4) NULL,
	[m2status] [varchar](4) NULL,
	[m3status] [varchar](4) NULL,
	[r1Ktotal] [int] NULL,
	[r2Ktotal] [int] NULL,
	[r3Ktotal] [int] NULL,
	[r4Ktotal] [int] NULL,
	[r1Kentered] [int] NULL,
	[r2Kentered] [int] NULL,
	[r3Kentered] [int] NULL,
	[r4Kentered] [int] NULL,
	[m1Ktotal] [int] NULL,
	[m2Ktotal] [int] NULL,
	[m3Ktotal] [int] NULL,
	[m4Ktotal] [int] NULL,
	[m1Kentered] [int] NULL,
	[m2Kentered] [int] NULL,
	[m3Kentered] [int] NULL,
	[m4Kentered] [int] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [decimal](9, 4) NULL,
	[m1perf] [varchar](1) NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [decimal](9, 4) NULL,
	[m2perf] [varchar](1) NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [decimal](9, 4) NULL,
	[m3perf] [varchar](1) NULL,
	[p1num_correct] [decimal](9, 4) NULL,
	[p1per_correct] [decimal](9, 4) NULL,
	[p2num_correct] [decimal](9, 4) NULL,
	[p2per_correct] [decimal](9, 4) NULL,
	[p3num_correct] [decimal](9, 4) NULL,
	[p3per_correct] [decimal](9, 4) NULL,
	[p4num_correct] [decimal](9, 4) NULL,
	[p4per_correct] [decimal](9, 4) NULL,
	[p5num_correct] [decimal](9, 4) NULL,
	[p5per_correct] [decimal](9, 4) NULL,
	[p6num_correct] [decimal](9, 4) NULL,
	[p6per_correct] [decimal](9, 4) NULL,
	[p7num_correct] [decimal](9, 4) NULL,
	[p7per_correct] [decimal](9, 4) NULL,
	[p8num_correct] [decimal](9, 4) NULL,
	[p8per_correct] [decimal](9, 4) NULL,
	[pChecks] [int] NULL,
	[p2modB_r] [decimal](9, 4) NULL,
	[p2modB_w] [decimal](9, 4) NULL,
	[r1status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[r3status] [varchar](8) NULL,
	[r1_RunRec] [int] NULL,
	[r1num_correct] [decimal](9, 4) NULL,
	[r1per_correct] [decimal](9, 4) NULL,
	[r2_RunRec] [int] NULL,
	[r2num_correct] [decimal](9, 4) NULL,
	[r2per_correct] [decimal](9, 4) NULL,
	[r3_RunRec] [int] NULL,
	[r3num_correct] [decimal](9, 4) NULL,
	[r3per_correct] [decimal](9, 4) NULL,
	[r4num_correct] [decimal](9, 4) NULL,
	[r4per_correct] [decimal](9, 4) NULL,
	[r5num_correct] [decimal](9, 4) NULL,
	[r5per_correct] [decimal](9, 4) NULL,
	[s1status] [varchar](4) NULL,
	[s2status] [varchar](4) NULL,
	[s3status] [varchar](4) NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [decimal](9, 4) NULL,
	[s1perf] [varchar](1) NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [decimal](9, 4) NULL,
	[s2perf] [varchar](1) NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [decimal](9, 4) NULL,
	[s3perf] [varchar](1) NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [decimal](9, 4) NULL,
	[ss1status] [varchar](4) NULL,
	[ss2status] [varchar](4) NULL,
	[ss3status] [varchar](4) NULL,
	[w1status] [varchar](4) NULL,
	[w2status] [varchar](4) NULL,
	[w3status] [varchar](4) NULL,
	[w1stgscr] [varchar](10) NULL,
	[w2stgscr] [varchar](10) NULL,
	[w3perf] [varchar](1) NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[cella_W] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[fsa_math] [int] NULL,
	[fsa_read] [int] NULL,
	[fsa_math_ss] [int] NULL,
	[fsa_read_ss] [int] NULL,
 CONSTRAINT [PK_eds_assessments19] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments20]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments20](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [varchar](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [varchar](1) NULL,
	[priexc] [varchar](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[m1status] [varchar](4) NULL,
	[m2status] [varchar](4) NULL,
	[m3status] [varchar](4) NULL,
	[r1Ktotal] [int] NULL,
	[r2Ktotal] [int] NULL,
	[r3Ktotal] [int] NULL,
	[r4Ktotal] [int] NULL,
	[r1Kentered] [int] NULL,
	[r2Kentered] [int] NULL,
	[r3Kentered] [int] NULL,
	[r4Kentered] [int] NULL,
	[m1Ktotal] [int] NULL,
	[m2Ktotal] [int] NULL,
	[m3Ktotal] [int] NULL,
	[m4Ktotal] [int] NULL,
	[m1Kentered] [int] NULL,
	[m2Kentered] [int] NULL,
	[m3Kentered] [int] NULL,
	[m4Kentered] [int] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [decimal](9, 4) NULL,
	[m1perf] [varchar](1) NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [decimal](9, 4) NULL,
	[m2perf] [varchar](1) NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [decimal](9, 4) NULL,
	[m3perf] [varchar](1) NULL,
	[p1num_correct] [decimal](9, 4) NULL,
	[p1per_correct] [decimal](9, 4) NULL,
	[p2num_correct] [decimal](9, 4) NULL,
	[p2per_correct] [decimal](9, 4) NULL,
	[p3num_correct] [decimal](9, 4) NULL,
	[p3per_correct] [decimal](9, 4) NULL,
	[p4num_correct] [decimal](9, 4) NULL,
	[p4per_correct] [decimal](9, 4) NULL,
	[p5num_correct] [decimal](9, 4) NULL,
	[p5per_correct] [decimal](9, 4) NULL,
	[p6num_correct] [decimal](9, 4) NULL,
	[p6per_correct] [decimal](9, 4) NULL,
	[p7num_correct] [decimal](9, 4) NULL,
	[p7per_correct] [decimal](9, 4) NULL,
	[p8num_correct] [decimal](9, 4) NULL,
	[p8per_correct] [decimal](9, 4) NULL,
	[pChecks] [int] NULL,
	[p2modB_r] [decimal](9, 4) NULL,
	[p2modB_w] [decimal](9, 4) NULL,
	[rdg_intervention] [nvarchar](50) NULL,
	[r1status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[r3status] [varchar](8) NULL,
	[r1_RunRec] [int] NULL,
	[r1num_correct] [decimal](9, 4) NULL,
	[r1per_correct] [decimal](9, 4) NULL,
	[r2_RunRec] [int] NULL,
	[r2num_correct] [decimal](9, 4) NULL,
	[r2per_correct] [decimal](9, 4) NULL,
	[r3_RunRec] [int] NULL,
	[r3num_correct] [decimal](9, 4) NULL,
	[r3per_correct] [decimal](9, 4) NULL,
	[r4num_correct] [decimal](9, 4) NULL,
	[r4per_correct] [decimal](9, 4) NULL,
	[r5num_correct] [decimal](9, 4) NULL,
	[r5per_correct] [decimal](9, 4) NULL,
	[s1status] [varchar](4) NULL,
	[s2status] [varchar](4) NULL,
	[s3status] [varchar](4) NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [decimal](9, 4) NULL,
	[s1perf] [varchar](1) NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [decimal](9, 4) NULL,
	[s2perf] [varchar](1) NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [decimal](9, 4) NULL,
	[s3perf] [varchar](1) NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [decimal](9, 4) NULL,
	[ss1status] [varchar](4) NULL,
	[ss2status] [varchar](4) NULL,
	[ss3status] [varchar](4) NULL,
	[w1status] [varchar](4) NULL,
	[w2status] [varchar](4) NULL,
	[w3status] [varchar](4) NULL,
	[w1stgscr] [varchar](10) NULL,
	[w2stgscr] [varchar](10) NULL,
	[w3perf] [varchar](1) NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[cella_W] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[fsa_math] [int] NULL,
	[fsa_read] [int] NULL,
	[fsa_math_ss] [int] NULL,
	[fsa_read_ss] [int] NULL,
 CONSTRAINT [PK_eds_assessments20] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assessments21]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assessments21](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[schoolname] [varchar](50) NULL,
	[abbrevname] [varchar](50) NULL,
	[lastname] [varchar](50) NULL,
	[firstname] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[endyrst] [varchar](3) NULL,
	[gender] [varchar](1) NULL,
	[ethniccode] [varchar](3) NULL,
	[freemeals] [varchar](1) NULL,
	[alt_assessment] [varchar](1) NULL,
	[lep] [varchar](2) NULL,
	[sec504elig] [varchar](1) NULL,
	[priexc] [varchar](1) NULL,
	[PriExc_Name] [varchar](8) NULL,
	[priexc_cal] [int] NULL,
	[grade_cal] [int] NULL,
	[m1status] [varchar](4) NULL,
	[m2status] [varchar](4) NULL,
	[m3status] [varchar](4) NULL,
	[r1Ktotal] [int] NULL,
	[r2Ktotal] [int] NULL,
	[r3Ktotal] [int] NULL,
	[r4Ktotal] [int] NULL,
	[r1Kentered] [int] NULL,
	[r2Kentered] [int] NULL,
	[r3Kentered] [int] NULL,
	[r4Kentered] [int] NULL,
	[m1Ktotal] [int] NULL,
	[m2Ktotal] [int] NULL,
	[m3Ktotal] [int] NULL,
	[m4Ktotal] [int] NULL,
	[m1Kentered] [int] NULL,
	[m2Kentered] [int] NULL,
	[m3Kentered] [int] NULL,
	[m4Kentered] [int] NULL,
	[m1num_correct] [int] NULL,
	[m1per_correct] [decimal](9, 4) NULL,
	[m1perf] [varchar](1) NULL,
	[m2num_correct] [int] NULL,
	[m2per_correct] [decimal](9, 4) NULL,
	[m2perf] [varchar](1) NULL,
	[m3num_correct] [int] NULL,
	[m3per_correct] [decimal](9, 4) NULL,
	[m3perf] [varchar](1) NULL,
	[p1num_correct] [decimal](9, 4) NULL,
	[p1per_correct] [decimal](9, 4) NULL,
	[p2num_correct] [decimal](9, 4) NULL,
	[p2per_correct] [decimal](9, 4) NULL,
	[p3num_correct] [decimal](9, 4) NULL,
	[p3per_correct] [decimal](9, 4) NULL,
	[p4num_correct] [decimal](9, 4) NULL,
	[p4per_correct] [decimal](9, 4) NULL,
	[p5num_correct] [decimal](9, 4) NULL,
	[p5per_correct] [decimal](9, 4) NULL,
	[p6num_correct] [decimal](9, 4) NULL,
	[p6per_correct] [decimal](9, 4) NULL,
	[p7num_correct] [decimal](9, 4) NULL,
	[p7per_correct] [decimal](9, 4) NULL,
	[p8num_correct] [decimal](9, 4) NULL,
	[p8per_correct] [decimal](9, 4) NULL,
	[pChecks] [int] NULL,
	[p2modB_r] [decimal](9, 4) NULL,
	[p2modB_w] [decimal](9, 4) NULL,
	[rdg_intervention] [nvarchar](50) NULL,
	[r1status] [varchar](8) NULL,
	[r2status] [varchar](8) NULL,
	[r3status] [varchar](8) NULL,
	[r1_RunRec] [int] NULL,
	[r1num_correct] [decimal](9, 4) NULL,
	[r1per_correct] [decimal](9, 4) NULL,
	[r2_RunRec] [int] NULL,
	[r2num_correct] [decimal](9, 4) NULL,
	[r2per_correct] [decimal](9, 4) NULL,
	[r3_RunRec] [int] NULL,
	[r3num_correct] [decimal](9, 4) NULL,
	[r3per_correct] [decimal](9, 4) NULL,
	[r4num_correct] [decimal](9, 4) NULL,
	[r4per_correct] [decimal](9, 4) NULL,
	[r5num_correct] [decimal](9, 4) NULL,
	[r5per_correct] [decimal](9, 4) NULL,
	[s1status] [varchar](4) NULL,
	[s2status] [varchar](4) NULL,
	[s3status] [varchar](4) NULL,
	[s1num_correct] [int] NULL,
	[s1per_correct] [decimal](9, 4) NULL,
	[s1perf] [varchar](1) NULL,
	[s2num_correct] [int] NULL,
	[s2per_correct] [decimal](9, 4) NULL,
	[s2perf] [varchar](1) NULL,
	[s3num_correct] [int] NULL,
	[s3per_correct] [decimal](9, 4) NULL,
	[s3perf] [varchar](1) NULL,
	[sp1num_correct] [int] NULL,
	[sp1per_correct] [decimal](9, 4) NULL,
	[ss1status] [varchar](4) NULL,
	[ss2status] [varchar](4) NULL,
	[ss3status] [varchar](4) NULL,
	[w1status] [varchar](4) NULL,
	[w2status] [varchar](4) NULL,
	[w3status] [varchar](4) NULL,
	[w1stgscr] [varchar](10) NULL,
	[w2stgscr] [varchar](10) NULL,
	[w3perf] [varchar](1) NULL,
	[cella_date] [datetime] NULL,
	[cella_form] [varchar](10) NULL,
	[cella_LS] [varchar](10) NULL,
	[cella_R] [varchar](10) NULL,
	[cella_T] [int] NULL,
	[cella_W] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[fsa_math] [int] NULL,
	[fsa_read] [int] NULL,
	[fsa_math_ss] [int] NULL,
	[fsa_read_ss] [int] NULL,
 CONSTRAINT [PK_eds_assessments21] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eds_assignedschools]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eds_assignedschools](
	[assignedschoolnum] [nchar](3) NULL,
	[username] [varchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_eds_assignedschools] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[eLearn_users]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[eLearn_users](
	[action] [varchar](100) NULL,
	[username] [varchar](100) NULL,
	[idnumber] [varchar](100) NULL,
	[email] [varchar](100) NULL,
	[auth] [varchar](100) NULL,
	[firstname] [varchar](100) NULL,
	[lastname] [varchar](100) NULL,
	[city] [varchar](100) NULL,
	[country] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_access_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_access_scores](
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[test] [varchar](20) NULL,
	[Comprehension_SS] [varchar](100) NULL,
	[Comprehension_PL] [varchar](100) NULL,
	[Listening_SS] [varchar](100) NULL,
	[Listening_PL] [varchar](100) NULL,
	[Reading_SS] [varchar](100) NULL,
	[Reading_PL] [varchar](100) NULL,
	[Writing_SS] [varchar](100) NULL,
	[Writing_PL] [varchar](100) NULL,
	[Speaking_SS] [varchar](100) NULL,
	[Speaking_PL] [varchar](100) NULL,
	[Oral_SS] [varchar](100) NULL,
	[Oral_PL] [varchar](100) NULL,
	[Literacy_SS] [varchar](100) NULL,
	[Literacy_PL] [varchar](100) NULL,
	[Overall_SS] [varchar](100) NULL,
	[Overall_PL] [varchar](100) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_act_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_act_scores](
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[Reading_SS] [varchar](50) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_cella_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_cella_scores](
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[test_lvl] [varchar](100) NULL,
	[Listening_Speaking_SS] [varchar](100) NULL,
	[Reading_SS] [varchar](100) NULL,
	[Writing_SS] [varchar](100) NULL,
	[Listening_Speaking_PL] [varchar](100) NULL,
	[Reading_PL] [varchar](100) NULL,
	[Writing_PL] [varchar](100) NULL,
	[Overall_SS] [varchar](100) NULL,
	[Overall_PL] [varchar](100) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_fcat_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_fcat_scores](
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[Reading_Total_SS] [varchar](100) NULL,
	[Reading_Total_AL] [varchar](100) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_fsa_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_fsa_scores](
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[Reading_Total_AL] [varchar](100) NULL,
	[Reading_Total_RS] [varchar](100) NULL,
	[Reading_Total_SS] [varchar](100) NULL,
	[Math_Total_AL] [varchar](100) NULL,
	[Math_Total_RS] [varchar](100) NULL,
	[Math_Total_SS] [varchar](100) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_ipt_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_ipt_scores](
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[BASIC_SS] [varchar](100) NULL,
	[BASIC_RS] [varchar](100) NULL,
	[ORAL_SS] [varchar](100) NULL,
	[ORAL_RS] [varchar](100) NULL,
	[READ(T)_SS] [varchar](100) NULL,
	[READ(T)_RS] [varchar](100) NULL,
	[WRITTEN_SS] [varchar](100) NULL,
	[WRITTEN_RS] [varchar](100) NULL,
	[LANG_PL_SS] [varchar](100) NULL,
	[LANG_PL_RS] [varchar](100) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_lab_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_lab_scores](
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[Speaking_Oral_SS] [varchar](100) NULL,
	[Speaking_Oral_RS] [varchar](100) NULL,
	[Listening_Aural_SS] [varchar](100) NULL,
	[Listening_Aural_RS] [varchar](100) NULL,
	[Written_SS] [varchar](100) NULL,
	[Written_RS] [varchar](100) NULL,
	[Reading_Total_SS] [varchar](100) NULL,
	[Reading_Total_RS] [varchar](100) NULL,
	[Total_Battery_SS] [varchar](100) NULL,
	[Total_Battery_RS] [varchar](100) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_map_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_map_scores](
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[Reading_PC] [varchar](50) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_sat_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_sat_scores](
	[seq] [varchar](100) NULL,
	[student_id] [varchar](100) NULL,
	[admdate] [varchar](100) NULL,
	[admgrade] [varchar](100) NULL,
	[EB_ReadingWriting_NP] [varchar](100) NULL,
	[EB_ReadingWriting_SS] [varchar](100) NULL,
	[Reading_Subtest_RS] [varchar](100) NULL,
	[screener] [varchar](100) NULL,
	[ell_stat] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_schedule]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_schedule](
	[Student ID] [varchar](255) NULL,
	[Course Name] [varchar](255) NULL,
	[Course Period] [varchar](255) NULL,
	[Course Code] [varchar](255) NULL,
	[Teacher Staff ID] [varchar](255) NULL,
	[Teacher Name] [varchar](255) NULL,
	[FEFP Number] [varchar](255) NULL,
	[ELL Instructional Model] [varchar](255) NULL,
	[Classroom Minutes] [varchar](255) NULL,
	[Section] [varchar](255) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_staff]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_staff](
	[Staff Last Name] [varchar](100) NULL,
	[Staff First Name] [varchar](100) NULL,
	[Staff / Employee ID] [varchar](100) NULL,
	[School Email Address] [varchar](100) NULL,
	[School Assignment Code] [varchar](100) NULL,
	[School Assignment Name] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ellevation_students]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ellevation_students](
	[First Name] [varchar](100) NULL,
	[Middle Name] [varchar](100) NULL,
	[Last Name] [varchar](100) NULL,
	[Active] [varchar](100) NULL,
	[Assigned School] [varchar](100) NULL,
	[Alternate School] [varchar](100) NULL,
	[ESL Teacher] [varchar](100) NULL,
	[Local Student Number] [varchar](100) NULL,
	[State Testing ID] [varchar](255) NULL,
	[Grade Level] [varchar](50) NULL,
	[Gender] [varchar](100) NULL,
	[Birthdate] [varchar](10) NULL,
	[Address 1] [varchar](255) NULL,
	[Address 2] [varchar](100) NULL,
	[City] [varchar](100) NULL,
	[State] [varchar](100) NULL,
	[Zip Code] [varchar](100) NULL,
	[Home Phone] [varchar](8000) NULL,
	[Cell Phone] [varchar](100) NULL,
	[City/Town of Birth] [varchar](100) NULL,
	[Native Language] [varchar](255) NULL,
	[Nationality] [varchar](255) NULL,
	[Ethnicity] [varchar](100) NULL,
	[Race] [varchar](100) NULL,
	[Homeroom Teacher] [varchar](201) NULL,
	[Classroom Schedule 1] [varchar](100) NULL,
	[Classroom Schedule 2] [varchar](100) NULL,
	[Classroom Schedule 3] [varchar](100) NULL,
	[Classroom Schedule 4] [varchar](100) NULL,
	[Classroom Schedule 5] [varchar](100) NULL,
	[Classroom Schedule 6] [varchar](100) NULL,
	[Classroom Schedule 7] [varchar](100) NULL,
	[Classroom Schedule 8] [varchar](100) NULL,
	[Classroom Teacher 1] [varchar](201) NULL,
	[Classroom Teacher 2] [varchar](201) NULL,
	[Classroom Teacher 3] [varchar](201) NULL,
	[Classroom Teacher 4] [varchar](201) NULL,
	[Classroom Teacher 5] [varchar](201) NULL,
	[Classroom Teacher 6] [varchar](201) NULL,
	[Classroom Teacher 7] [varchar](201) NULL,
	[Classroom Teacher 8] [varchar](201) NULL,
	[ELP Designation] [varchar](100) NOT NULL,
	[Tier Placement Code] [varchar](255) NULL,
	[LEP Status] [varchar](255) NULL,
	[Monitoring Status] [varchar](100) NULL,
	[Monitor Date 1] [varchar](50) NULL,
	[Monitor Date 2] [varchar](50) NULL,
	[Monitor Date 3] [varchar](50) NULL,
	[Monitor Date 4] [varchar](50) NULL,
	[ESL Program] [varchar](255) NULL,
	[Bilingual Program] [varchar](100) NULL,
	[Receiving ESL Services] [varchar](100) NOT NULL,
	[Years in US Schools] [varchar](100) NULL,
	[Date Entered US] [varchar](100) NULL,
	[Date Enrolled in the US] [varchar](100) NULL,
	[Date Enrolled in the District] [varchar](100) NULL,
	[Date Withdrawn] [varchar](100) NULL,
	[Date Graduated] [varchar](100) NULL,
	[Date Dropped Out] [varchar](100) NULL,
	[Date Entered LEP] [varchar](100) NULL,
	[Date Exited LEP] [varchar](100) NULL,
	[Date Monitoring Started] [varchar](100) NULL,
	[Homebound] [varchar](100) NULL,
	[Migrant] [varchar](100) NULL,
	[Immigrant] [varchar](100) NOT NULL,
	[Dropped Out] [varchar](100) NULL,
	[Withdrawn] [varchar](100) NULL,
	[Deceased] [varchar](100) NULL,
	[Homeless] [varchar](100) NULL,
	[Bilingual] [varchar](100) NULL,
	[Dual Language Program] [varchar](100) NULL,
	[IEP] [varchar](100) NULL,
	[SIFE] [varchar](100) NULL,
	[504] [varchar](100) NULL,
	[Reclassification Entry Date] [varchar](100) NULL,
	[Reclassification Exit Date] [varchar](100) NULL,
	[Extension of Instruction] [varchar](255) NULL,
	[Home Language Survey Date] [varchar](100) NULL,
	[LEP Basis of Entry] [varchar](255) NULL,
	[LEP Basis of Exit] [varchar](255) NULL,
	[Student Plan Date] [varchar](100) NULL,
	[Classification Date] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[EmployeeForms_LOA_IntentToReturn]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[EmployeeForms_LOA_IntentToReturn](
	[LOA_ITR_ID] [int] IDENTITY(1,1) NOT NULL,
	[LOA_ID_FK] [varchar](50) NULL,
	[EmpID] [varchar](50) NULL,
	[SSN] [int] NULL,
	[ExpireText] [varchar](250) NULL,
	[ReinstateText] [varchar](250) NULL,
	[ResignText] [varchar](500) NULL,
	[RetireText] [varchar](250) NULL,
	[ExtendText] [varchar](250) NULL,
	[Choice] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[FixedAssets]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[FixedAssets](
	[Dist] [nvarchar](3) NULL,
	[ItemNbr] [nvarchar](8) NULL,
	[SerialNbr] [nvarchar](20) NULL,
	[ItemDescription1] [nvarchar](38) NULL,
	[ItemDescription2] [nvarchar](38) NULL,
	[Model] [nvarchar](20) NULL,
	[Manufacturer] [nvarchar](10) NULL,
	[Dept] [nvarchar](2) NULL,
	[AQYY] [nvarchar](2) NULL,
	[AQMM] [nvarchar](2) NULL,
	[AQDD] [nvarchar](2) NULL,
	[AcquireDate] [datetime] NULL,
	[AcquireChk] [nvarchar](6) NULL,
	[AcquirePONbr] [nvarchar](6) NULL,
	[AcquireOlg] [nvarchar](1) NULL,
	[AcquireOwnCode] [nvarchar](1) NULL,
	[AcquireVendor] [nvarchar](10) NULL,
	[Tagged] [nvarchar](1) NULL,
	[Print] [nvarchar](1) NULL,
	[Condition] [nvarchar](1) NULL,
	[Disposition] [nvarchar](2) NULL,
	[EYY] [nvarchar](2) NULL,
	[EMM] [nvarchar](2) NULL,
	[EDD] [nvarchar](2) NULL,
	[EnterDate] [datetime] NULL,
	[UpYY] [nvarchar](2) NULL,
	[UpMM] [nvarchar](2) NULL,
	[UpDD] [nvarchar](2) NULL,
	[UpdateDate] [datetime] NULL,
	[SlYY] [nvarchar](2) NULL,
	[SlMM] [nvarchar](2) NULL,
	[SlDD] [nvarchar](2) NULL,
	[SaleDate] [datetime] NULL,
	[SRCPT] [nvarchar](6) NULL,
	[RetYY] [nvarchar](2) NULL,
	[RetMM] [nvarchar](2) NULL,
	[RetDD] [nvarchar](2) NULL,
	[RetirementDate] [datetime] NULL,
	[InvCondition] [nvarchar](1) NULL,
	[InvDisposition] [nvarchar](2) NULL,
	[InvYY] [nvarchar](2) NULL,
	[InvMM] [nvarchar](2) NULL,
	[InvDD] [nvarchar](2) NULL,
	[InventoryDate] [datetime] NULL,
	[InvLocation] [nvarchar](4) NULL,
	[InvBldg] [nvarchar](2) NULL,
	[InvRoom] [nvarchar](4) NULL,
	[VehicleNbr] [nvarchar](6) NULL,
	[VehicleTag] [nvarchar](7) NULL,
	[VehicleTitle] [nvarchar](10) NULL,
	[Location] [nvarchar](4) NULL,
	[Building] [nvarchar](2) NULL,
	[Room] [nvarchar](4) NULL,
	[Classification] [nvarchar](7) NULL,
	[Filler01] [nvarchar](50) NULL,
	[Life] [numeric](3, 0) NULL,
	[OrigValue] [numeric](11, 2) NULL,
	[CurrentValue] [numeric](11, 2) NULL,
	[SaleValue] [numeric](11, 2) NULL,
	[Sold] [numeric](11, 2) NULL,
	[Filler02] [nvarchar](12) NULL,
	[MonthDepreciation] [numeric](11, 2) NULL,
	[AccumDepreciation] [numeric](13, 2) NULL,
	[LeasePurchase] [nvarchar](8) NULL,
	[SpecialProject] [nvarchar](8) NULL,
	[SProjNbr] [nvarchar](3) NULL,
	[SProjYr] [nvarchar](2) NULL,
	[OffSite] [nvarchar](4) NULL,
	[M1M2] [nvarchar](4) NULL,
	[StateID] [nvarchar](7) NULL,
	[ItemNbr2] [nvarchar](8) NULL,
	[AccountNbr] [nvarchar](40) NULL,
	[ItemNbr3] [nvarchar](8) NULL,
	[comment1] [nvarchar](75) NULL,
	[comment2] [nvarchar](75) NULL,
	[comment3] [nvarchar](75) NULL,
	[comment4] [nvarchar](75) NULL,
	[comment5] [nvarchar](75) NULL,
	[filler03] [nvarchar](89) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[focus_enrollment]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[focus_enrollment](
	[statenum] [varchar](255) NULL,
	[school_id] [numeric](18, 0) NULL,
	[student_id] [numeric](18, 0) NOT NULL,
	[LocalStuID] [varchar](257) NULL,
	[schoolnum] [varchar](255) NOT NULL,
	[schoolname] [varchar](255) NULL,
	[grade] [varchar](2) NOT NULL,
	[entercode] [varchar](10) NOT NULL,
	[leavecode] [varchar](10) NOT NULL,
	[sequence] [bigint] NOT NULL,
	[effdate] [datetime] NULL,
	[syear] [numeric](18, 0) NULL,
	[priordist] [varchar](255) NULL,
	[priorstate] [varchar](255) NULL,
	[priorcntry] [varchar](255) NULL,
 CONSTRAINT [IX_focus_enrollment] UNIQUE NONCLUSTERED 
(
	[student_id] ASC,
	[sequence] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[General_Records_Schedules]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[General_Records_Schedules](
	[Schedule] [varchar](10) NOT NULL,
	[Schedule_Title] [varchar](500) NOT NULL,
	[Item] [varchar](10) NOT NULL,
	[Title] [varchar](500) NOT NULL,
	[Description] [varchar](2500) NOT NULL,
	[Retention] [varchar](500) NOT NULL,
	[Version] [varchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Grad_Cohort_All_2020]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Grad_Cohort_All_2020](
	[type] [varchar](4) NOT NULL,
	[type2] [varchar](5) NOT NULL,
	[SchoolId] [bigint] NULL,
	[SchoolNum] [varchar](50) NULL,
	[SchoolName] [varchar](151) NULL,
	[student_id] [bigint] NULL,
	[LocalId] [varchar](255) NULL,
	[WDCode] [varchar](10) NULL,
	[secschl] [varchar](50) NULL,
	[SLC] [varchar](8000) NULL,
	[ConcEnrollment] [varchar](255) NULL,
	[StudentName] [varchar](768) NULL,
	[BirthDate] [varchar](10) NULL,
	[InstrSet] [varchar](2) NULL,
	[CurrentGrade] [varchar](50) NULL,
	[YrEntHS] [varchar](4) NULL,
	[LEP] [varchar](2) NULL,
	[GPA] [float] NULL,
	[leavecode] [varchar](10) NULL,
	[GradOption] [varchar](1) NOT NULL,
	[MyPCSOnline] [varchar](1) NULL,
	[FTSVCCD] [varchar](500) NULL,
	[CredAtmpt] [varchar](255) NULL,
	[CredEarned] [varchar](255) NULL,
	[race] [varchar](1) NULL,
	[gender] [varchar](1) NULL,
	[CredEarnMark] [numeric](5, 2) NULL,
	[F1code] [varchar](2) NULL,
	[spdip] [varchar](500) NULL,
	[spdiploma] [varchar](1) NOT NULL,
	[AtRisk] [varchar](1) NOT NULL,
	[GPAOnTrack] [varchar](1) NOT NULL,
	[CredAtmptOnTrack] [varchar](1) NOT NULL,
	[CredEarnedOnTrack] [varchar](1) NOT NULL,
	[endyrstat] [varchar](1) NULL,
	[assign_code] [varchar](1) NOT NULL,
	[AtRiskOnTrack1] [varchar](1) NOT NULL,
	[GradOnTrack1] [varchar](1) NOT NULL,
	[SEStudent] [int] NOT NULL,
	[DstYear] [varchar](4) NULL,
	[AtRiskOnTrack] [varchar](1) NULL,
	[FCATreadgrdbad] [varchar](1) NOT NULL,
	[AtRiskReading] [float] NULL,
	[ELA_waiver] [char](1) NULL,
	[FSA_read] [varchar](255) NULL,
	[FSA_ELA_SS] [float] NULL,
	[FSA_ELA_on_track] [varchar](1) NULL,
	[RecentReadAdmGrade] [varchar](10) NULL,
	[ACTRead] [float] NULL,
	[ACTenglish] [float] NULL,
	[ACTReadAVG] [float] NULL,
	[SATRead] [float] NULL,
	[SAT4_Read] [float] NULL,
	[SAT4s_Read] [float] NULL,
	[ReadActConScore] [varchar](1) NOT NULL,
	[ReadSATConScore] [varchar](1) NOT NULL,
	[ReadConScore] [varchar](1) NOT NULL,
	[FA1_reading] [varchar](1) NOT NULL,
	[Alg1EOCAdmDate] [date] NULL,
	[ALG1EOC_Score2] [float] NULL,
	[ALG1EOC_Score] [float] NULL,
	[ALG1EOC_TScore] [varchar](1) NOT NULL,
	[ALG1EOC_PassFail] [varchar](255) NULL,
	[GeoEOC_PassFail] [varchar](255) NULL,
	[PERT_flag] [varchar](1) NOT NULL,
	[ALGEOC_waiver] [char](1) NULL,
	[ACTMath] [float] NULL,
	[SATMath] [float] NULL,
	[SAT4Math] [float] NULL,
	[PSATMath] [float] NULL,
	[MathActConScore] [varchar](1) NOT NULL,
	[MathSATConScore] [varchar](1) NOT NULL,
	[MathConScore] [varchar](1) NOT NULL,
	[FA1_math] [varchar](1) NOT NULL,
	[AtRiskMath] [float] NULL,
	[ALG1EOC_PassFail2] [varchar](255) NULL,
	[AlgEOC_Flag] [varchar](1) NOT NULL,
	[GeoEOC_Score] [float] NULL,
	[Alg_GradOnTrack] [varchar](1) NOT NULL,
	[ConScM] [varchar](1) NOT NULL,
	[stdt_gradontrack1] [varchar](1) NOT NULL,
	[GradOnTrack] [varchar](1) NOT NULL,
	[DOP_WDCode] [varchar](1) NOT NULL,
	[WDCode2] [varchar](10) NULL,
	[ESE_EntHS] [varchar](1) NOT NULL,
	[ell_status] [varchar](1) NOT NULL,
	[DE_passer] [varchar](1) NULL,
	[AP_passed] [varchar](1) NULL,
	[AICE_passed] [varchar](1) NULL,
	[IB_passed] [varchar](1) NULL,
	[INDCERT_passer] [varchar](1) NULL,
	[IndCert_hrs] [varchar](1) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Grad_Cohort_All_2021]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Grad_Cohort_All_2021](
	[type] [varchar](4) NOT NULL,
	[type2] [varchar](5) NOT NULL,
	[SchoolId] [bigint] NULL,
	[SchoolNum] [varchar](50) NULL,
	[SchoolName] [varchar](151) NULL,
	[student_id] [bigint] NULL,
	[LocalId] [varchar](255) NULL,
	[WDCode] [varchar](10) NULL,
	[secschl] [varchar](50) NULL,
	[SLC] [varchar](8000) NULL,
	[ConcEnrollment] [varchar](255) NULL,
	[StudentName] [varchar](768) NULL,
	[BirthDate] [varchar](10) NULL,
	[InstrSet] [varchar](2) NULL,
	[CurrentGrade] [varchar](50) NULL,
	[YrEntHS] [varchar](4) NULL,
	[LEP] [varchar](2) NULL,
	[GPA] [float] NULL,
	[leavecode] [varchar](10) NULL,
	[GradOption] [varchar](1) NOT NULL,
	[MyPCSOnline] [varchar](1) NULL,
	[FTSVCCD] [varchar](500) NULL,
	[CredAtmpt] [varchar](255) NULL,
	[CredEarned] [varchar](255) NULL,
	[race] [varchar](1) NULL,
	[gender] [varchar](1) NULL,
	[CredEarnMark] [numeric](5, 2) NULL,
	[F1code] [varchar](2) NULL,
	[spdip] [varchar](500) NULL,
	[spdiploma] [varchar](1) NOT NULL,
	[AtRisk] [varchar](1) NOT NULL,
	[GPAOnTrack] [varchar](1) NOT NULL,
	[CredAtmptOnTrack] [varchar](1) NOT NULL,
	[CredEarnedOnTrack] [varchar](1) NOT NULL,
	[endyrstat] [varchar](1) NULL,
	[assign_code] [varchar](1) NOT NULL,
	[AtRiskOnTrack1] [varchar](1) NOT NULL,
	[GradOnTrack1] [varchar](1) NOT NULL,
	[SEStudent] [int] NOT NULL,
	[DstYear] [varchar](4) NULL,
	[AtRiskOnTrack] [varchar](1) NULL,
	[FCATreadgrdbad] [varchar](1) NOT NULL,
	[AtRiskReading] [float] NULL,
	[ELA_waiver] [char](1) NULL,
	[FSA_read] [varchar](255) NULL,
	[FSA_ELA_SS] [float] NULL,
	[FSA_ELA_on_track] [varchar](1) NULL,
	[RecentReadAdmGrade] [varchar](10) NULL,
	[ACTRead] [float] NULL,
	[ACTenglish] [float] NULL,
	[ACTReadAVG] [float] NULL,
	[SATRead] [float] NULL,
	[SAT4_Read] [float] NULL,
	[SAT4s_Read] [float] NULL,
	[ReadActConScore] [varchar](1) NOT NULL,
	[ReadSATConScore] [varchar](1) NOT NULL,
	[ReadConScore] [varchar](1) NOT NULL,
	[FA1_reading] [varchar](1) NOT NULL,
	[Alg1EOCAdmDate] [date] NULL,
	[ALG1EOC_Score2] [float] NULL,
	[ALG1EOC_Score] [float] NULL,
	[ALG1EOC_TScore] [varchar](1) NOT NULL,
	[ALG1EOC_PassFail] [varchar](255) NULL,
	[GeoEOC_PassFail] [varchar](255) NULL,
	[PERT_flag] [varchar](1) NOT NULL,
	[ALGEOC_waiver] [char](1) NULL,
	[ACTMath] [float] NULL,
	[SATMath] [float] NULL,
	[SAT4Math] [float] NULL,
	[PSATMath] [float] NULL,
	[MathActConScore] [varchar](1) NOT NULL,
	[MathSATConScore] [varchar](1) NOT NULL,
	[MathConScore] [varchar](1) NOT NULL,
	[FA1_math] [varchar](1) NOT NULL,
	[AtRiskMath] [float] NULL,
	[ALG1EOC_PassFail2] [varchar](255) NULL,
	[AlgEOC_Flag] [varchar](1) NOT NULL,
	[GeoEOC_Score] [float] NULL,
	[Alg_GradOnTrack] [varchar](1) NOT NULL,
	[ConScM] [varchar](1) NOT NULL,
	[stdt_gradontrack1] [varchar](1) NOT NULL,
	[GradOnTrack] [varchar](1) NOT NULL,
	[DOP_WDCode] [varchar](1) NOT NULL,
	[WDCode2] [varchar](10) NULL,
	[ESE_EntHS] [varchar](1) NOT NULL,
	[ell_status] [varchar](1) NOT NULL,
	[DE_passer] [varchar](1) NULL,
	[AP_passed] [varchar](1) NULL,
	[AICE_passed] [varchar](1) NULL,
	[IB_passed] [varchar](1) NULL,
	[INDCERT_passer] [varchar](1) NULL,
	[IndCert_hrs] [varchar](1) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_DeductionsContributions]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_DeductionsContributions](
	[Dist] [nvarchar](2) NOT NULL,
	[SSN] [nvarchar](10) NOT NULL,
	[FY] [numeric](3, 0) NOT NULL,
	[JobID] [nvarchar](2) NOT NULL,
	[FY9] [nvarchar](2) NULL,
	[Class] [nvarchar](2) NULL,
	[SubClass] [nvarchar](3) NULL,
	[MaxAmt] [numeric](9, 2) NULL,
	[MaxYr] [nvarchar](1) NULL,
	[PlanToDate] [numeric](9, 2) NULL,
	[LifeToDate] [numeric](9, 2) NULL,
	[TrmsEffectiveDate] [nvarchar](6) NULL,
	[EffectiveDate] [datetime] NULL,
	[TrmsTerminateDate] [nvarchar](6) NULL,
	[TerminateDate] [datetime] NULL,
	[NumOfDep] [numeric](3, 0) NULL,
	[TrmsWaiverStart] [nvarchar](6) NULL,
	[WaiverStart] [datetime] NULL,
	[TrmsWaiverStop] [nvarchar](6) NULL,
	[WaiverStop] [datetime] NULL,
	[ProverFac] [nvarchar](10) NULL,
	[Filler] [nvarchar](15) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_FMLA_ELIG]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_FMLA_ELIG](
	[emp_local_id] [int] NOT NULL,
	[FMLA_Weeks] [int] NULL,
	[FMLA_Weeks_Elig] [int] NOT NULL,
	[FMLA_Wk_Est_Elig] [datetime] NULL,
	[FMLA_Hours] [numeric](38, 2) NULL,
	[FMLA_Hours_Elig] [int] NOT NULL,
	[FMLA_Hr_Est_Elig] [datetime] NULL,
	[FMLA_Elig] [int] NOT NULL,
	[UpdateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_FMLA_Hours]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_FMLA_Hours](
	[emp_local_id] [int] NOT NULL,
	[Job] [nvarchar](2) NULL,
	[ContractHours] [numeric](5, 3) NULL,
	[HoursWorked] [numeric](38, 2) NULL,
	[PaidHolidays] [int] NULL,
	[HolidayTime] [numeric](16, 3) NULL,
	[FMLA_Hours] [numeric](38, 2) NULL,
	[UpdateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_FMLA_Weeks]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_FMLA_Weeks](
	[emp_local_id] [int] NOT NULL,
	[ContinueHireDate] [datetime] NULL,
	[WeeksCurr] [int] NULL,
	[WeeksPast] [int] NULL,
	[FMLA_Weeks] [int] NULL,
	[UpdateDate] [datetime] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_Paid_Holidays]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_Paid_Holidays](
	[FY] [nvarchar](2) NULL,
	[PT] [nvarchar](2) NULL,
	[Date] [datetime] NULL,
	[Code] [nvarchar](1) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_Payroll_Calendar]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_Payroll_Calendar](
	[FY] [nvarchar](2) NULL,
	[PT] [nvarchar](2) NULL,
	[YY] [nvarchar](2) NULL,
	[MM] [nvarchar](2) NULL,
	[Date] [date] NULL,
	[CalendarRow] [numeric](3, 0) NULL,
	[ContractDay] [numeric](3, 0) NULL,
	[DoW] [nvarchar](1) NULL,
	[WorkDay] [int] NULL,
	[PaidHoliday] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_Payroll_Calendar_Historical]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_Payroll_Calendar_Historical](
	[FY] [nvarchar](2) NULL,
	[PT] [nvarchar](2) NULL,
	[Run] [nvarchar](3) NULL,
	[PayPeriodStart] [date] NULL,
	[PayPeriodEnd] [date] NULL,
	[Date] [date] NULL,
	[DoW] [nvarchar](30) NULL,
	[Wk] [int] NOT NULL,
	[PPCalDays] [int] NULL,
	[Code] [nvarchar](1) NULL,
	[WorkDay] [int] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_Payroll_Calendar_Weeks]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_Payroll_Calendar_Weeks](
	[PT] [nvarchar](2) NULL,
	[FY] [nvarchar](2) NULL,
	[YY] [nvarchar](2) NULL,
	[MM] [nvarchar](2) NULL,
	[CalendarRow] [numeric](3, 0) NULL,
	[Sunday] [date] NULL,
	[Monday] [date] NULL,
	[Tuesday] [date] NULL,
	[Wednesday] [date] NULL,
	[Thursday] [date] NULL,
	[Friday] [date] NULL,
	[Saturday] [date] NULL,
	[WDN] [int] NULL,
	[WDM] [int] NULL,
	[WDT] [int] NULL,
	[WDW] [int] NULL,
	[WDR] [int] NULL,
	[WDF] [int] NULL,
	[WDS] [int] NULL,
	[PHN] [int] NULL,
	[PHM] [int] NULL,
	[PHT] [int] NULL,
	[PHW] [int] NULL,
	[PHR] [int] NULL,
	[PHF] [int] NULL,
	[PHS] [int] NULL,
	[WorkWeek] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HR_PT_CAL_xRef]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HR_PT_CAL_xRef](
	[FY] [nvarchar](2) NULL,
	[PT] [nvarchar](14) NULL,
	[Description] [nvarchar](30) NULL,
	[CAL] [nvarchar](14) NULL,
	[Type] [nvarchar](2) NULL,
	[Days] [nchar](10) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ID_Lookup]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ID_Lookup](
	[source] [nvarchar](50) NULL,
	[type] [nvarchar](50) NULL,
	[description] [nvarchar](500) NULL,
	[username] [nvarchar](100) NULL,
	[id] [bigint] NULL,
	[local_id] [nvarchar](150) NULL,
	[state_id] [nvarchar](150) NULL,
	[UUID_Focus] [nvarchar](255) NOT NULL,
	[Clever_ID1] [nvarchar](255) NULL,
	[Clever_ID2] [nvarchar](255) NULL,
 CONSTRAINT [PK_ID_Lookup] PRIMARY KEY CLUSTERED 
(
	[UUID_Focus] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[import_temp]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[import_temp](
	[f001] [varchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[iObs_buildings]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[iObs_buildings](
	[Building UUID] [varchar](100) NULL,
	[Building Name] [varchar](100) NULL,
	[Address Line 1] [varchar](100) NULL,
	[Address Line 2] [varchar](100) NULL,
	[City] [varchar](100) NULL,
	[State] [varchar](2) NULL,
	[Zipcode] [varchar](10) NULL,
	[Country] [varchar](3) NOT NULL,
	[Building Demographics] [varchar](100) NULL,
	[Public Tags] [varchar](100) NULL,
	[Private Tags] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[iObs_evaluations]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[iObs_evaluations](
	[evaltypeid] [varchar](50) NULL,
	[evaltitle] [varchar](100) NULL,
	[category] [varchar](50) NULL,
	[growth] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[iObs_job_settings]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[iObs_job_settings](
	[jobcode] [nvarchar](50) NOT NULL,
	[jobtitle] [nvarchar](50) NULL,
	[employees] [int] NULL,
	[max_slot] [nvarchar](50) NULL,
	[eval] [nvarchar](50) NULL,
	[eval_prob] [nvarchar](50) NULL,
	[role] [nvarchar](50) NULL,
	[evaluated] [nvarchar](50) NULL,
	[upload] [int] NULL,
 CONSTRAINT [PK_iObservation_jobcodes] PRIMARY KEY CLUSTERED 
(
	[jobcode] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[iObs_user_settings]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[iObs_user_settings](
	[employeeid] [int] NULL,
	[location] [varchar](500) NULL,
	[role] [varchar](100) NULL,
	[eval] [varchar](500) NULL,
	[eval_prob] [varchar](100) NULL,
	[growth] [varchar](500) NULL,
	[evaluator] [varchar](100) NULL,
	[privileges] [varchar](500) NULL,
	[district_ism] [varchar](4) NULL,
	[sem1_done] [int] NULL,
	[supervisor] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[iObs_users]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[iObs_users](
	[UUID] [varchar](100) NOT NULL,
	[Email Address] [varchar](100) NULL,
	[First Name] [varchar](100) NULL,
	[Last Name] [varchar](100) NULL,
	[Assigned Buildings] [varchar](800) NULL,
	[Role] [varchar](100) NULL,
	[Grade] [varchar](100) NULL,
	[Department] [varchar](100) NULL,
	[Subject Area] [varchar](100) NULL,
	[Position] [varchar](100) NULL,
	[Tenured] [varchar](100) NULL,
	[Certified] [varchar](100) NULL,
	[Start Date] [varchar](100) NULL,
	[Public Tags] [varchar](100) NULL,
	[Private Tags] [varchar](100) NULL,
	[Evaluation Tag] [varchar](100) NULL,
	[Deliberate Practice Tag] [varchar](100) NULL,
	[Additional Privileges] [varchar](100) NULL,
	[Conduct Permission Tags] [varchar](100) NULL,
	[Evaluate Permission Tags] [varchar](100) NULL,
	[Plan Permission Tags] [varchar](100) NULL,
	[Completed Observation Permission Tags] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[iObs_users_special]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[iObs_users_special](
	[UUID] [varchar](100) NOT NULL,
	[Email Address] [varchar](100) NULL,
	[First Name] [varchar](100) NULL,
	[Last Name] [varchar](100) NULL,
	[Assigned Buildings] [varchar](800) NULL,
	[Role] [varchar](100) NULL,
	[Grade] [varchar](100) NULL,
	[Department] [varchar](100) NULL,
	[Subject Area] [varchar](100) NULL,
	[Position] [varchar](100) NULL,
	[Tenured] [varchar](100) NULL,
	[Certified] [varchar](100) NULL,
	[Start Date] [varchar](100) NULL,
	[Public Tags] [varchar](100) NULL,
	[Private Tags] [varchar](100) NULL,
	[Evaluation Tag] [varchar](100) NULL,
	[Deliberate Practice Tag] [varchar](100) NULL,
	[Additional Privileges] [varchar](100) NULL,
	[Conduct Permission Tags] [varchar](100) NULL,
	[Evaluate Permission Tags] [varchar](100) NULL,
	[Plan Permission Tags] [varchar](100) NULL,
	[Completed Observation Permission Tags] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ISBNs]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ISBNs](
	[ISBN] [nvarchar](20) NOT NULL,
	[ISBN10] [nvarchar](20) NULL,
	[dewey_decimal] [nvarchar](20) NULL,
	[title] [nvarchar](100) NULL,
	[title_long] [nvarchar](255) NULL,
	[edition] [nvarchar](50) NULL,
	[publisher] [nvarchar](255) NULL,
	[date_published] [nvarchar](50) NULL,
	[authors] [nvarchar](255) NULL,
	[subjects] [nvarchar](255) NULL,
	[format] [nvarchar](50) NULL,
	[coverlink] [nvarchar](255) NULL,
 CONSTRAINT [PK_ISBNs] PRIMARY KEY CLUSTERED 
(
	[ISBN] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[IXL]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[IXL](
	[pk] [int] NULL,
	[stu_id] [varchar](50) NULL,
	[Lastname] [varchar](50) NULL,
	[Firstname] [varchar](50) NULL,
	[School] [varchar](50) NULL,
	[Grade] [varchar](50) NULL,
	[Overall_math] [varchar](50) NULL,
	[Num_oper_lvl] [varchar](50) NULL,
	[Alg_think_lvl] [varchar](50) NULL,
	[Frac_lvl] [varchar](50) NULL,
	[Geo_lvl] [varchar](50) NULL,
	[Meas_lvl] [varchar](50) NULL,
	[Data_stat_prob_lvl] [varchar](50) NULL,
	[Overall_ELA] [varchar](50) NULL,
	[Overall_reading_lvl] [varchar](50) NULL,
	[Reading_strat_lvl] [varchar](50) NULL,
	[Vocab_lvl] [varchar](50) NULL,
	[Writing_strat_lvl] [varchar](50) NULL,
	[Gram_mech_lvl] [varchar](50) NULL,
	[month] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[johns_eastern]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[johns_eastern](
	[Tier_1_company_id] [varchar](50) NOT NULL,
	[Student_number] [varchar](50) NULL,
	[Student_last_name] [varchar](50) NULL,
	[Student_first_name] [varchar](50) NULL,
	[Student_grade] [varchar](50) NULL,
	[Student_phone] [varchar](255) NULL,
	[Student_address] [varchar](255) NULL,
	[Student_city] [varchar](60) NULL,
	[Student_state] [varchar](50) NULL,
	[Student_zip] [varchar](50) NULL,
	[Student_guardian_first] [varchar](50) NULL,
	[Student_guardian_last] [varchar](50) NULL,
	[Student_guardian_phone] [varchar](255) NULL,
	[Student_date_of_birth] [varchar](50) NULL,
	[Student_age] [varchar](50) NULL,
	[School_site_code] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[JWB_Program_Students]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[JWB_Program_Students](
	[stu_id] [numeric](18, 0) NOT NULL,
	[ParticipantBusinessKeys] [nvarchar](max) NULL,
	[matched_on] [nvarchar](100) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[KG_standards_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[KG_standards_scores](
	[district_id] [int] NULL,
	[school_id] [int] NULL,
	[teacher_id] [numeric](18, 0) NULL,
	[sort] [varchar](13) NULL,
	[title] [varchar](255) NOT NULL,
	[category] [varchar](50) NOT NULL,
	[RQ1_0] [varchar](4) NULL,
	[RQ1_1] [varchar](4) NULL,
	[RQ1_2] [varchar](4) NULL,
	[RQ1_3] [varchar](4) NULL,
	[RQ1_4] [varchar](4) NULL,
	[RQ2_0] [varchar](4) NULL,
	[RQ2_1] [varchar](4) NULL,
	[RQ2_2] [varchar](4) NULL,
	[RQ2_3] [varchar](4) NULL,
	[RQ2_4] [varchar](4) NULL,
	[RQ3_0] [varchar](4) NULL,
	[RQ3_1] [varchar](4) NULL,
	[RQ3_2] [varchar](4) NULL,
	[RQ3_3] [varchar](4) NULL,
	[RQ3_4] [varchar](4) NULL,
	[RQ4_0] [varchar](4) NULL,
	[RQ4_1] [varchar](4) NULL,
	[RQ4_2] [varchar](4) NULL,
	[RQ4_3] [varchar](4) NULL,
	[RQ4_4] [varchar](4) NULL,
	[RQ1_avg] [varchar](4) NULL,
	[RQ2_avg] [varchar](4) NULL,
	[RQ3_avg] [varchar](4) NULL,
	[RQ4_avg] [varchar](4) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[log_jobs]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[log_jobs](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[log_time] [datetime] NULL,
	[job] [varchar](50) NULL,
	[step] [varchar](50) NULL,
	[result] [varchar](800) NULL,
	[detail] [varchar](800) NULL,
	[step_duration] [varchar](50) NULL,
	[job_duration] [varchar](50) NULL,
 CONSTRAINT [PK_log_jobs] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MAP_Data_Summary]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MAP_Data_Summary](
	[focus_stu_id] [int] NULL,
	[stu_local_id] [varchar](50) NULL,
	[stu_username] [varchar](10) NULL,
	[last_name] [varchar](255) NULL,
	[first_name] [varchar](255) NULL,
	[grade] [varchar](2) NULL,
	[race] [varchar](10) NULL,
	[ELL_Status] [varchar](max) NULL,
	[school] [varchar](100) NULL,
	[Area] [int] NULL,
	[Geometry] [varchar](50) NULL,
	[Meas_and_Data] [varchar](50) NULL,
	[Oper_and_Alg] [varchar](50) NULL,
	[Num_and_Oper] [varchar](50) NULL,
	[FSA_Math Projection] [varchar](50) NULL,
	[Info_Text] [varchar](50) NULL,
	[Info_Key] [varchar](50) NULL,
	[Voc_Acq] [varchar](50) NULL,
	[Lit_Lang] [varchar](50) NULL,
	[Lit_Key] [varchar](50) NULL,
	[FSA_ELA Projection] [varchar](50) NULL,
	[Reading Percentile] [varchar](50) NULL,
	[Math Percentile] [varchar](50) NULL,
	[Math RIT] [varchar](50) NULL,
	[Reading RIT] [varchar](50) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MAP_Import_Formatted]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MAP_Import_Formatted](
	[ID] [varchar](8000) NULL,
	[IMPORT_DATE] [varchar](8000) NULL,
	[IMPORT_FILENAME] [varchar](8000) NULL,
	[TEMPLATE_VERSION] [varchar](8000) NULL,
	[MATCH_STATUS] [varchar](8000) NULL,
	[focus_stu_id] [varchar](8000) NULL,
	[Local_stu_id] [varchar](8000) NULL,
	[TestDate_CCYYMMDD] [varchar](8000) NULL,
	[BirthDate_CCYYMMDD] [varchar](8000) NULL,
	[DW_ACCEPTED_DATE] [varchar](8000) NULL,
	[RAW_DATA] [varchar](8000) NULL,
	[Term_Name] [varchar](8000) NULL,
	[District_Name] [varchar](8000) NULL,
	[School_Name] [varchar](8000) NULL,
	[Stu_Last_Name] [varchar](8000) NULL,
	[Stu_First_Name] [varchar](8000) NULL,
	[Stu_Middle_init] [varchar](8000) NULL,
	[Student_ID] [varchar](8000) NULL,
	[Stu_Birthdate] [varchar](8000) NULL,
	[Ethnic_Group] [varchar](8000) NULL,
	[Gender] [varchar](8000) NULL,
	[Grade] [varchar](8000) NULL,
	[MeasurementScale] [varchar](8000) NULL,
	[Discipline] [varchar](8000) NULL,
	[NormsReferenceData] [varchar](8000) NULL,
	[WISelectedAYFall] [varchar](8000) NULL,
	[WISelectedAYWinter] [varchar](8000) NULL,
	[WISelectedAYSpring] [varchar](8000) NULL,
	[WIPreviousAYFall] [varchar](8000) NULL,
	[WIPreviousAYWinter] [varchar](8000) NULL,
	[WIPreviousAYSpring] [varchar](8000) NULL,
	[TestType] [varchar](8000) NULL,
	[TestName] [varchar](8000) NULL,
	[TestStartDate] [varchar](8000) NULL,
	[TestDurationMinutes] [varchar](8000) NULL,
	[TestRITScore] [varchar](8000) NULL,
	[TestStandardError] [varchar](8000) NULL,
	[TestPercentile] [varchar](8000) NULL,
	[FallToFallProjectedGrowth] [varchar](8000) NULL,
	[FallToFallObservedGrowth] [varchar](8000) NULL,
	[FallToFallObservedGrowthSE] [varchar](8000) NULL,
	[FallToFallMetProjectedGrowth] [varchar](8000) NULL,
	[FallToFallConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToFallConditionalGrowthPercentile] [varchar](8000) NULL,
	[FallToWinterProjectedGrowth] [varchar](8000) NULL,
	[FallToWinterObservedGrowth] [varchar](8000) NULL,
	[FallToWinterObservedGrowthSE] [varchar](8000) NULL,
	[FallToWinterMetProjectedGrowth] [varchar](8000) NULL,
	[FallToWinterConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToWinterConditionalGrowthPercentile] [varchar](8000) NULL,
	[FallToSpringProjectedGrowth] [varchar](8000) NULL,
	[FallToSpringObservedGrowth] [varchar](8000) NULL,
	[FallToSpringObservedGrowthSE] [varchar](8000) NULL,
	[FallToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[FallToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[WinterToWinterProjectedGrowth] [varchar](8000) NULL,
	[WinterToWinterObservedGrowth] [varchar](8000) NULL,
	[WinterToWinterObservedGrowthSE] [varchar](8000) NULL,
	[WinterToWinterMetProjectedGrowth] [varchar](8000) NULL,
	[WinterToWinterConditionalGrowthIndex] [varchar](8000) NULL,
	[WinterToWinterConditionalGrowthPercentile] [varchar](8000) NULL,
	[WinterToSpringProjectedGrowth] [varchar](8000) NULL,
	[WinterToSpringObservedGrowth] [varchar](8000) NULL,
	[WinterToSpringObservedGrowthSE] [varchar](8000) NULL,
	[WinterToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[WinterToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[WinterToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[SpringToSpringProjectedGrowth] [varchar](8000) NULL,
	[SpringToSpringObservedGrowth] [varchar](8000) NULL,
	[SpringToSpringObservedGrowthSE] [varchar](8000) NULL,
	[SpringToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[SpringToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[SpringToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[RITtoReadingScore] [varchar](8000) NULL,
	[RITtoReadingMin] [varchar](8000) NULL,
	[RITtoReadingMax] [varchar](8000) NULL,
	[Goal1Name] [varchar](8000) NULL,
	[Goal1RitScore] [varchar](8000) NULL,
	[Goal1StdErr] [varchar](8000) NULL,
	[Goal1Range] [varchar](8000) NULL,
	[Goal1Adjective] [varchar](8000) NULL,
	[Goal2Name] [varchar](8000) NULL,
	[Goal2RitScore] [varchar](8000) NULL,
	[Goal2StdErr] [varchar](8000) NULL,
	[Goal2Range] [varchar](8000) NULL,
	[Goal2Adjective] [varchar](8000) NULL,
	[Goal3Name] [varchar](8000) NULL,
	[Goal3RitScore] [varchar](8000) NULL,
	[Goal3StdErr] [varchar](8000) NULL,
	[Goal3Range] [varchar](8000) NULL,
	[Goal3Adjective] [varchar](8000) NULL,
	[Goal4Name] [varchar](8000) NULL,
	[Goal4RitScore] [varchar](8000) NULL,
	[Goal4StdErr] [varchar](8000) NULL,
	[Goal4Range] [varchar](8000) NULL,
	[Goal4Adjective] [varchar](8000) NULL,
	[Goal5Name] [varchar](8000) NULL,
	[Goal5RitScore] [varchar](8000) NULL,
	[Goal5StdErr] [varchar](8000) NULL,
	[Goal5Range] [varchar](8000) NULL,
	[Goal5Adjective] [varchar](8000) NULL,
	[Goal6Name] [varchar](8000) NULL,
	[Goal6RitScore] [varchar](8000) NULL,
	[Goal6StdErr] [varchar](8000) NULL,
	[Goal6Range] [varchar](8000) NULL,
	[Goal6Adjective] [varchar](8000) NULL,
	[Goal7Name] [varchar](8000) NULL,
	[Goal7RitScore] [varchar](8000) NULL,
	[Goal7StdErr] [varchar](8000) NULL,
	[Goal7Range] [varchar](8000) NULL,
	[Goal7Adjective] [varchar](8000) NULL,
	[Goal8Name] [varchar](8000) NULL,
	[Goal8RitScore] [varchar](8000) NULL,
	[Goal8StdErr] [varchar](8000) NULL,
	[Goal8Range] [varchar](8000) NULL,
	[Goal8Adjective] [varchar](8000) NULL,
	[TestStartTime] [varchar](8000) NULL,
	[PercentCorrect] [varchar](8000) NULL,
	[ProjectedProficiencyStudy1] [varchar](8000) NULL,
	[ProjectedProficiencyLevel1] [varchar](8000) NULL,
	[ProjectedProficiencyStudy2] [varchar](8000) NULL,
	[ProjectedProficiencyLevel2] [varchar](8000) NULL,
	[ProjectedProficiencyStudy3] [varchar](8000) NULL,
	[ProjectedProficiencyLevel3] [varchar](8000) NULL,
	[AccommodationCategory] [varchar](8000) NULL,
	[Accommodations] [varchar](8000) NULL,
	[TypicalFallToFallGrowth] [varchar](8000) NULL,
	[TypicalFallToWinterGrowth] [varchar](8000) NULL,
	[TypicalFallToSpringGrowth] [varchar](8000) NULL,
	[TypicalWinterToWinterGrowth] [varchar](8000) NULL,
	[TypicalWinterToSpringGrowth] [varchar](8000) NULL,
	[TypicalSpringToSpringGrowth] [varchar](8000) NULL,
	[ProjectedProficiencyStudy4] [varchar](8000) NULL,
	[ProjectedProficiencyLevel4] [varchar](8000) NULL,
	[ProjectedProficiencyStudy5] [varchar](8000) NULL,
	[ProjectedProficiencyLevel5] [varchar](8000) NULL,
	[ProjectedProficiencyStudy6] [varchar](8000) NULL,
	[ProjectedProficiencyLevel6] [varchar](8000) NULL,
	[ProjectedProficiencyStudy7] [varchar](8000) NULL,
	[ProjectedProficiencyLevel7] [varchar](8000) NULL,
	[ProjectedProficiencyStudy8] [varchar](8000) NULL,
	[ProjectedProficiencyLevel8] [varchar](8000) NULL,
	[ProjectedProficiencyStudy9] [varchar](8000) NULL,
	[ProjectedProficiencyLevel9] [varchar](8000) NULL,
	[ProjectedProficiencyStudy10] [varchar](8000) NULL,
	[ProjectedProficiencyLevel10] [varchar](8000) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MAP_scores]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MAP_scores](
	[TermName] [varchar](8000) NULL,
	[DistrictName] [varchar](8000) NULL,
	[SchoolName] [varchar](8000) NULL,
	[StudentLastName] [varchar](8000) NULL,
	[StudentFirstName] [varchar](8000) NULL,
	[StudentMI] [varchar](8000) NULL,
	[StudentID] [varchar](8000) NULL,
	[StudentDateOfBirth] [varchar](8000) NULL,
	[StudentEthnicGroup] [varchar](8000) NULL,
	[StudentGender] [varchar](8000) NULL,
	[Grade] [varchar](8000) NULL,
	[MeasurementScale] [varchar](8000) NULL,
	[Discipline] [varchar](8000) NULL,
	[NormsReferenceData] [varchar](8000) NULL,
	[WISelectedAYFall] [varchar](8000) NULL,
	[WISelectedAYWinter] [varchar](8000) NULL,
	[WISelectedAYSpring] [varchar](8000) NULL,
	[WIPreviousAYFall] [varchar](8000) NULL,
	[WIPreviousAYWinter] [varchar](8000) NULL,
	[WIPreviousAYSpring] [varchar](8000) NULL,
	[TestType] [varchar](8000) NULL,
	[TestName] [varchar](8000) NULL,
	[TestStartDate] [varchar](8000) NULL,
	[TestDurationMinutes] [varchar](8000) NULL,
	[TestRITScore] [varchar](8000) NULL,
	[TestStandardError] [varchar](8000) NULL,
	[TestPercentile] [varchar](8000) NULL,
	[FallToFallProjectedGrowth] [varchar](8000) NULL,
	[FallToFallObservedGrowth] [varchar](8000) NULL,
	[FallToFallObservedGrowthSE] [varchar](8000) NULL,
	[FallToFallMetProjectedGrowth] [varchar](8000) NULL,
	[FallToFallConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToFallConditionalGrowthPercentile] [varchar](8000) NULL,
	[FallToWinterProjectedGrowth] [varchar](8000) NULL,
	[FallToWinterObservedGrowth] [varchar](8000) NULL,
	[FallToWinterObservedGrowthSE] [varchar](8000) NULL,
	[FallToWinterMetProjectedGrowth] [varchar](8000) NULL,
	[FallToWinterConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToWinterConditionalGrowthPercentile] [varchar](8000) NULL,
	[FallToSpringProjectedGrowth] [varchar](8000) NULL,
	[FallToSpringObservedGrowth] [varchar](8000) NULL,
	[FallToSpringObservedGrowthSE] [varchar](8000) NULL,
	[FallToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[FallToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[FallToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[WinterToWinterProjectedGrowth] [varchar](8000) NULL,
	[WinterToWinterObservedGrowth] [varchar](8000) NULL,
	[WinterToWinterObservedGrowthSE] [varchar](8000) NULL,
	[WinterToWinterMetProjectedGrowth] [varchar](8000) NULL,
	[WinterToWinterConditionalGrowthIndex] [varchar](8000) NULL,
	[WinterToWinterConditionalGrowthPercentile] [varchar](8000) NULL,
	[WinterToSpringProjectedGrowth] [varchar](8000) NULL,
	[WinterToSpringObservedGrowth] [varchar](8000) NULL,
	[WinterToSpringObservedGrowthSE] [varchar](8000) NULL,
	[WinterToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[WinterToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[WinterToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[SpringToSpringProjectedGrowth] [varchar](8000) NULL,
	[SpringToSpringObservedGrowth] [varchar](8000) NULL,
	[SpringToSpringObservedGrowthSE] [varchar](8000) NULL,
	[SpringToSpringMetProjectedGrowth] [varchar](8000) NULL,
	[SpringToSpringConditionalGrowthIndex] [varchar](8000) NULL,
	[SpringToSpringConditionalGrowthPercentile] [varchar](8000) NULL,
	[RITtoReadingScore] [varchar](8000) NULL,
	[RITtoReadingMin] [varchar](8000) NULL,
	[RITtoReadingMax] [varchar](8000) NULL,
	[Goal1Name] [varchar](8000) NULL,
	[Goal1RitScore] [varchar](8000) NULL,
	[Goal1StdErr] [varchar](8000) NULL,
	[Goal1Range] [varchar](8000) NULL,
	[Goal1Adjective] [varchar](8000) NULL,
	[Goal2Name] [varchar](8000) NULL,
	[Goal2RitScore] [varchar](8000) NULL,
	[Goal2StdErr] [varchar](8000) NULL,
	[Goal2Range] [varchar](8000) NULL,
	[Goal2Adjective] [varchar](8000) NULL,
	[Goal3Name] [varchar](8000) NULL,
	[Goal3RitScore] [varchar](8000) NULL,
	[Goal3StdErr] [varchar](8000) NULL,
	[Goal3Range] [varchar](8000) NULL,
	[Goal3Adjective] [varchar](8000) NULL,
	[Goal4Name] [varchar](8000) NULL,
	[Goal4RitScore] [varchar](8000) NULL,
	[Goal4StdErr] [varchar](8000) NULL,
	[Goal4Range] [varchar](8000) NULL,
	[Goal4Adjective] [varchar](8000) NULL,
	[Goal5Name] [varchar](8000) NULL,
	[Goal5RitScore] [varchar](8000) NULL,
	[Goal5StdErr] [varchar](8000) NULL,
	[Goal5Range] [varchar](8000) NULL,
	[Goal5Adjective] [varchar](8000) NULL,
	[Goal6Name] [varchar](8000) NULL,
	[Goal6RitScore] [varchar](8000) NULL,
	[Goal6StdErr] [varchar](8000) NULL,
	[Goal6Range] [varchar](8000) NULL,
	[Goal6Adjective] [varchar](8000) NULL,
	[Goal7Name] [varchar](8000) NULL,
	[Goal7RitScore] [varchar](8000) NULL,
	[Goal7StdErr] [varchar](8000) NULL,
	[Goal7Range] [varchar](8000) NULL,
	[Goal7Adjective] [varchar](8000) NULL,
	[Goal8Name] [varchar](8000) NULL,
	[Goal8RitScore] [varchar](8000) NULL,
	[Goal8StdErr] [varchar](8000) NULL,
	[Goal8Range] [varchar](8000) NULL,
	[Goal8Adjective] [varchar](8000) NULL,
	[TestStartTime] [varchar](8000) NULL,
	[PercentCorrect] [varchar](8000) NULL,
	[ProjectedProficiencyStudy1] [varchar](8000) NULL,
	[ProjectedProficiencyLevel1] [varchar](8000) NULL,
	[ProjectedProficiencyStudy2] [varchar](8000) NULL,
	[ProjectedProficiencyLevel2] [varchar](8000) NULL,
	[ProjectedProficiencyStudy3] [varchar](8000) NULL,
	[ProjectedProficiencyLevel3] [varchar](8000) NULL,
	[AccommodationCategory] [varchar](8000) NULL,
	[Accommodations] [varchar](8000) NULL,
	[TypicalFallToFallGrowth] [varchar](8000) NULL,
	[TypicalFallToWinterGrowth] [varchar](8000) NULL,
	[TypicalFallToSpringGrowth] [varchar](8000) NULL,
	[TypicalWinterToWinterGrowth] [varchar](8000) NULL,
	[TypicalWinterToSpringGrowth] [varchar](8000) NULL,
	[TypicalSpringToSpringGrowth] [varchar](8000) NULL,
	[ProjectedProficiencyStudy4] [varchar](8000) NULL,
	[ProjectedProficiencyLevel4] [varchar](8000) NULL,
	[ProjectedProficiencyStudy5] [varchar](8000) NULL,
	[ProjectedProficiencyLevel5] [varchar](8000) NULL,
	[ProjectedProficiencyStudy6] [varchar](8000) NULL,
	[ProjectedProficiencyLevel6] [varchar](8000) NULL,
	[ProjectedProficiencyStudy7] [varchar](8000) NULL,
	[ProjectedProficiencyLevel7] [varchar](8000) NULL,
	[ProjectedProficiencyStudy8] [varchar](8000) NULL,
	[ProjectedProficiencyLevel8] [varchar](8000) NULL,
	[ProjectedProficiencyStudy9] [varchar](8000) NULL,
	[ProjectedProficiencyLevel9] [varchar](8000) NULL,
	[ProjectedProficiencyStudy10] [varchar](8000) NULL,
	[ProjectedProficiencyLevel10] [varchar](8000) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MS_Project_tbl]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MS_Project_tbl](
	[stu_local_id] [varchar](20) NULL,
	[local_ethnic_code] [varchar](20) NULL,
	[gender] [varchar](20) NULL,
	[grid_code] [varchar](20) NULL,
	[g6_syear] [varchar](20) NULL,
	[g6_sch_state_id] [varchar](20) NULL,
	[g6_days_pres] [int] NULL,
	[g6_days_abs] [int] NULL,
	[g6_gpa] [numeric](9, 3) NULL,
	[g6_ref] [int] NOT NULL,
	[g6_iss] [int] NOT NULL,
	[g6_oss] [int] NULL,
	[g6_eoy_st] [varchar](20) NULL,
	[g7_syear] [varchar](20) NULL,
	[g7_sch_state_id] [varchar](20) NULL,
	[g7_days_pres] [int] NULL,
	[g7_days_abs] [int] NULL,
	[g7_gpa] [numeric](9, 3) NULL,
	[g7_ref] [int] NULL,
	[g7_iss] [int] NULL,
	[g7_oss] [int] NULL,
	[g7_eoy_st] [varchar](20) NULL,
	[g8_syear] [varchar](20) NULL,
	[g8_sch_state_id] [varchar](20) NULL,
	[g8_days_pres] [int] NULL,
	[g8_days_abs] [int] NULL,
	[g8_gpa] [numeric](9, 3) NULL,
	[g8_ref] [int] NULL,
	[g8_iss] [int] NULL,
	[g8_oss] [int] NULL,
	[g8_eoy_st] [varchar](20) NULL,
	[Gr3Mth_Lvl] [varchar](20) NULL,
	[Gr3Rdg_Lvl] [varchar](20) NULL,
	[Gr6Mth_Lvl] [varchar](20) NULL,
	[Gr6Rdg_Lvl] [varchar](20) NULL,
	[Gr7Mth_Lvl] [varchar](20) NULL,
	[Gr7Rdg_Lvl] [varchar](20) NULL,
	[Gr8Mth_Lvl] [varchar](20) NULL,
	[Gr8Rdg_Lvl] [varchar](20) NULL,
	[Alg1_Lvl] [varchar](20) NULL,
	[drop_syear] [varchar](20) NULL,
	[drop_date] [varchar](20) NULL,
	[drop_school] [varchar](20) NULL,
	[drop_grade] [varchar](20) NULL,
	[drop_code] [varchar](20) NULL,
	[Graduate] [varchar](20) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[my_eclassroom_users]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[my_eclassroom_users](
	[action] [varchar](100) NULL,
	[username] [varchar](100) NULL,
	[idnumber] [varchar](100) NOT NULL,
	[email] [varchar](100) NULL,
	[auth] [varchar](100) NULL,
	[firstname] [varchar](100) NULL,
	[lastname] [varchar](100) NULL,
	[city] [varchar](100) NULL,
	[country] [varchar](100) NULL,
 CONSTRAINT [PK_my_eschool_users] PRIMARY KEY CLUSTERED 
(
	[idnumber] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[num]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[num](
	[n] [int] IDENTITY(1,1) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OLE DB Grad_assess_Test]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OLE DB Grad_assess_Test](
	[stu_id] [nvarchar](255) NULL,
	[stu_username] [nvarchar](255) NULL,
	[test_id] [nvarchar](255) NULL,
	[test_title] [nvarchar](255) NULL,
	[part_id] [nvarchar](255) NULL,
	[part_title] [nvarchar](255) NULL,
	[score] [nvarchar](255) NULL,
	[test_code] [nvarchar](255) NULL,
	[administration_date] [nvarchar](255) NULL,
	[gradelevel] [nvarchar](255) NULL,
	[syear] [nvarchar](255) NULL,
	[ID] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_academicSessions]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_academicSessions](
	[sourcedId] [varchar](17) NULL,
	[status] [varchar](6) NULL,
	[dateLastModified] [varchar](16) NULL,
	[title] [varchar](20) NULL,
	[type] [varchar](13) NOT NULL,
	[startDate] [varchar](10) NULL,
	[endDate] [varchar](10) NULL,
	[parentSourcedId] [varchar](15) NULL,
	[schoolYear] [varchar](10) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_classes]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_classes](
	[sourcedId] [varchar](15) NULL,
	[status] [varchar](6) NULL,
	[dateLastModified] [varchar](16) NULL,
	[title] [varchar](267) NULL,
	[grades] [nvarchar](max) NULL,
	[courseSourcedId] [varchar](16) NULL,
	[classCode] [varchar](15) NULL,
	[classType] [varchar](100) NULL,
	[location] [varchar](8) NULL,
	[schoolSourcedId] [varchar](15) NULL,
	[termSourcedIds] [varchar](21) NULL,
	[subjects] [varchar](102) NULL,
	[subjectCodes] [varchar](12) NULL,
	[periods] [varchar](7) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_courses]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_courses](
	[sourcedId] [varchar](16) NULL,
	[status] [varchar](6) NULL,
	[dateLastModified] [varchar](16) NULL,
	[schoolYearSourcedId] [varchar](19) NULL,
	[title] [varchar](102) NULL,
	[courseCode] [varchar](10) NULL,
	[grades] [nvarchar](max) NULL,
	[orgSourcedId] [varchar](12) NULL,
	[subjects] [varchar](8) NULL,
	[subjectCodes] [varchar](12) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_demographics]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_demographics](
	[sourcedId] [varchar](100) NULL,
	[status] [varchar](6) NULL,
	[dateLastModified] [varchar](16) NULL,
	[birthDate] [varchar](10) NULL,
	[sex] [varchar](max) NULL,
	[americanIndianOrAlaskaNative] [varchar](28) NOT NULL,
	[asian] [varchar](5) NOT NULL,
	[blackOrAfricanAmerican] [varchar](22) NOT NULL,
	[nativeHawaiianOrOtherPacificIslander] [varchar](36) NOT NULL,
	[white] [varchar](5) NOT NULL,
	[demographicRaceTwoOrMoreRaces] [varchar](29) NOT NULL,
	[hispanicOrLatinoEthnicity] [varchar](25) NOT NULL,
	[countryOfBirthCode] [varchar](18) NULL,
	[stateOfBirthAbbreviation] [varchar](24) NULL,
	[cityOfBirth] [varchar](11) NULL,
	[publicSchoolResidenceStatus] [varchar](27) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_enrollments]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_enrollments](
	[sourcedId] [varchar](37) NULL,
	[status] [varchar](6) NULL,
	[dateLastModified] [varchar](16) NULL,
	[classSourcedId] [varchar](15) NULL,
	[schoolSourcedId] [varchar](15) NULL,
	[userSourcedId] [varchar](100) NULL,
	[role] [varchar](7) NOT NULL,
	[primary] [varchar](7) NULL,
	[beginDate] [varchar](10) NULL,
	[endDate] [varchar](10) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_manifest]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_manifest](
	[sort] [varchar](10) NULL,
	[Property Name] [nvarchar](500) NULL,
	[Value Description] [nvarchar](500) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_orgs]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_orgs](
	[sourcedId] [varchar](13) NULL,
	[status] [varchar](6) NULL,
	[dateLastModified] [varchar](16) NULL,
	[name] [varchar](8000) NULL,
	[type] [varchar](8) NOT NULL,
	[identifier] [varchar](20) NOT NULL,
	[parentSourcedId] [varchar](15) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_teacher_schools]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_teacher_schools](
	[emp_id] [numeric](18, 0) NULL,
	[sch_state_id] [varchar](4) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OneRoster_users]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OneRoster_users](
	[sourcedId] [varchar](100) NULL,
	[status] [varchar](6) NULL,
	[dateLastModified] [varchar](16) NULL,
	[enabledUser] [varchar](11) NOT NULL,
	[orgSourcedIds] [nvarchar](max) NULL,
	[role] [varchar](15) NULL,
	[username] [nvarchar](102) NULL,
	[userIds] [nvarchar](58) NULL,
	[givenName] [varchar](8000) NULL,
	[familyName] [varchar](8000) NULL,
	[middleName] [varchar](8000) NULL,
	[identifier] [nvarchar](255) NULL,
	[email] [nvarchar](109) NULL,
	[sms] [varchar](3) NULL,
	[phone] [varchar](5) NULL,
	[agentSourcedIds] [varchar](15) NULL,
	[grades] [varchar](6) NULL,
	[password] [varchar](8) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[P_Timeframes]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[P_Timeframes](
	[syear] [int] NOT NULL,
	[timeframe] [varchar](50) NOT NULL,
	[timeframe_id] [varchar](50) NULL,
	[timeframe_days] [int] NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[pcs_arrests_table]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[pcs_arrests_table](
	[dup] [bigint] NULL,
	[StudentID] [varchar](20) NULL,
	[pk] [varchar](50) NOT NULL,
	[Name] [varchar](100) NULL,
	[race] [varchar](20) NULL,
	[sex] [varchar](20) NULL,
	[dob] [date] NULL,
	[charge] [varchar](500) NULL,
	[LocationOccurred] [varchar](100) NULL,
	[SchoolOccurred] [varchar](100) NULL,
	[SchoolName] [varchar](100) NULL,
	[SchoolID] [varchar](10) NULL,
	[AgencyInitials] [varchar](10) NULL,
	[Officer] [varchar](100) NULL,
	[Juvenile] [varchar](100) NULL,
	[JuvProgram] [varchar](100) NULL,
	[ArrestDate] [datetime] NULL,
	[last_first] [varchar](8000) NULL,
	[currentSchool] [varchar](100) NULL,
	[currentSch_id] [varchar](4) NULL,
	[primary_exc] [varchar](255) NULL,
	[local_ethnic_code] [varchar](max) NULL,
	[gender] [varchar](max) NULL,
	[stu_id] [numeric](18, 0) NULL,
 CONSTRAINT [PK_pcs_arrests_table] PRIMARY KEY CLUSTERED 
(
	[pk] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1_CollabConversation] [nvarchar](10) NULL,
	[r2_CollabConversation] [nvarchar](10) NULL,
	[r3_CollabConversation] [nvarchar](10) NULL,
	[r4_CollabConversation] [nvarchar](10) NULL,
	[r1_DecodeWords] [nvarchar](10) NULL,
	[r2_DecodeWords] [nvarchar](10) NULL,
	[r3_DecodeWords] [nvarchar](10) NULL,
	[r4_DecodeWords] [nvarchar](10) NULL,
	[r1_DrawDictWri] [nvarchar](10) NULL,
	[r2_DrawDictWri] [nvarchar](10) NULL,
	[r3_DrawDictWri] [nvarchar](10) NULL,
	[r4_DrawDictWri] [nvarchar](10) NULL,
	[r1_LetterNaming] [nvarchar](10) NULL,
	[r2_LetterNaming] [nvarchar](10) NULL,
	[r3_LetterNaming] [nvarchar](10) NULL,
	[r4_LetterNaming] [nvarchar](10) NULL,
	[r1_LetterSounds] [nvarchar](10) NULL,
	[r2_LetterSounds] [nvarchar](10) NULL,
	[r3_LetterSounds] [nvarchar](10) NULL,
	[r4_LetterSounds] [nvarchar](10) NULL,
	[r1_MainTopic] [nvarchar](10) NULL,
	[r2_MainTopic] [nvarchar](10) NULL,
	[r3_MainTopic] [nvarchar](10) NULL,
	[r4_MainTopic] [nvarchar](10) NULL,
	[r1_PhonoAware] [nvarchar](10) NULL,
	[r2_PhonoAware] [nvarchar](10) NULL,
	[r3_PhonoAware] [nvarchar](10) NULL,
	[r4_PhonoAware] [nvarchar](10) NULL,
	[r1_Print] [nvarchar](10) NULL,
	[r2_Print] [nvarchar](10) NULL,
	[r3_Print] [nvarchar](10) NULL,
	[r4_Print] [nvarchar](10) NULL,
	[r1_ReadEmerg] [nvarchar](10) NULL,
	[r2_ReadEmerg] [nvarchar](10) NULL,
	[r3_ReadEmerg] [nvarchar](10) NULL,
	[r4_ReadEmerg] [nvarchar](10) NULL,
	[r1_SightWords] [nvarchar](10) NULL,
	[r2_SightWords] [nvarchar](10) NULL,
	[r3_SightWords] [nvarchar](10) NULL,
	[r4_SightWords] [nvarchar](10) NULL,
	[r1_Story] [nvarchar](10) NULL,
	[r2_Story] [nvarchar](10) NULL,
	[r3_Story] [nvarchar](10) NULL,
	[r4_Story] [nvarchar](10) NULL,
	[m1_AddSub] [nvarchar](10) NULL,
	[m2_AddSub] [nvarchar](10) NULL,
	[m3_AddSub] [nvarchar](10) NULL,
	[m4_AddSub] [nvarchar](10) NULL,
	[m1_CompShapes] [nvarchar](10) NULL,
	[m2_CompShapes] [nvarchar](10) NULL,
	[m3_CompShapes] [nvarchar](10) NULL,
	[m4_CompShapes] [nvarchar](10) NULL,
	[m1_Concept] [nvarchar](10) NULL,
	[m2_Concept] [nvarchar](10) NULL,
	[m3_Concept] [nvarchar](10) NULL,
	[m4_Concept] [nvarchar](10) NULL,
	[m1_CountForward] [nvarchar](10) NULL,
	[m2_CountForward] [nvarchar](10) NULL,
	[m3_CountForward] [nvarchar](10) NULL,
	[m4_CountForward] [nvarchar](10) NULL,
	[m1_Groups] [nvarchar](10) NULL,
	[m2_Groups] [nvarchar](10) NULL,
	[m3_Groups] [nvarchar](10) NULL,
	[m4_Groups] [nvarchar](10) NULL,
	[m1_Numbers] [nvarchar](10) NULL,
	[m2_Numbers] [nvarchar](10) NULL,
	[m3_Numbers] [nvarchar](10) NULL,
	[m4_Numbers] [nvarchar](10) NULL,
	[m1_ObjectsMeasure] [nvarchar](10) NULL,
	[m2_ObjectsMeasure] [nvarchar](10) NULL,
	[m3_ObjectsMeasure] [nvarchar](10) NULL,
	[m4_ObjectsMeasure] [nvarchar](10) NULL,
	[m1_ObjectsNumerals] [nvarchar](10) NULL,
	[m2_ObjectsNumerals] [nvarchar](10) NULL,
	[m3_ObjectsNumerals] [nvarchar](10) NULL,
	[m4_ObjectsNumerals] [nvarchar](10) NULL,
	[m1_Shapes] [nvarchar](10) NULL,
	[m2_Shapes] [nvarchar](10) NULL,
	[m3_Shapes] [nvarchar](10) NULL,
	[m4_Shapes] [nvarchar](10) NULL,
	[b1_Copes] [nvarchar](10) NULL,
	[b2_Copes] [nvarchar](10) NULL,
	[b3_Copes] [nvarchar](10) NULL,
	[b4_Copes] [nvarchar](10) NULL,
	[b1_FollowRules] [nvarchar](10) NULL,
	[b2_FollowRules] [nvarchar](10) NULL,
	[b3_FollowRules] [nvarchar](10) NULL,
	[b4_FollowRules] [nvarchar](10) NULL,
	[b1_ListDir] [nvarchar](10) NULL,
	[b2_ListDir] [nvarchar](10) NULL,
	[b3_ListDir] [nvarchar](10) NULL,
	[b4_ListDir] [nvarchar](10) NULL,
	[b1_Moves] [nvarchar](10) NULL,
	[b2_Moves] [nvarchar](10) NULL,
	[b3_Moves] [nvarchar](10) NULL,
	[b4_Moves] [nvarchar](10) NULL,
	[b1_Participates] [nvarchar](10) NULL,
	[b2_Participates] [nvarchar](10) NULL,
	[b3_Participates] [nvarchar](10) NULL,
	[b4_Participates] [nvarchar](10) NULL,
	[b2_ReadingLevel] [nvarchar](10) NULL,
	[b3_ReadingLevel] [nvarchar](10) NULL,
	[b4_ReadingLevel] [nvarchar](10) NULL,
	[b1_Respects] [nvarchar](10) NULL,
	[b2_Respects] [nvarchar](10) NULL,
	[b3_Respects] [nvarchar](10) NULL,
	[b4_Respects] [nvarchar](10) NULL,
	[b1_Responsibility] [nvarchar](10) NULL,
	[b2_Responsibility] [nvarchar](10) NULL,
	[b3_Responsibility] [nvarchar](10) NULL,
	[b4_Responsibility] [nvarchar](10) NULL,
	[b1_Selects] [nvarchar](10) NULL,
	[b2_Selects] [nvarchar](10) NULL,
	[b3_Selects] [nvarchar](10) NULL,
	[b4_Selects] [nvarchar](10) NULL,
	[b1_SelfConf] [nvarchar](10) NULL,
	[b2_SelfConf] [nvarchar](10) NULL,
	[b3_SelfConf] [nvarchar](10) NULL,
	[b4_SelfConf] [nvarchar](10) NULL,
	[b1_Shares] [nvarchar](10) NULL,
	[b2_Shares] [nvarchar](10) NULL,
	[b3_Shares] [nvarchar](10) NULL,
	[b4_Shares] [nvarchar](10) NULL,
	[b1_UseOfTime] [nvarchar](10) NULL,
	[b2_UseOfTime] [nvarchar](10) NULL,
	[b3_UseOfTime] [nvarchar](10) NULL,
	[b4_UseOfTime] [nvarchar](10) NULL,
	[s1_Collaborates] [nvarchar](10) NULL,
	[s2_Collaborates] [nvarchar](10) NULL,
	[s3_Collaborates] [nvarchar](10) NULL,
	[s1_Investigates] [nvarchar](10) NULL,
	[s2_Investigates] [nvarchar](10) NULL,
	[s3_Investigates] [nvarchar](10) NULL,
	[s1_Recognizes] [nvarchar](10) NULL,
	[s2_Recognizes] [nvarchar](10) NULL,
	[s3_Recognizes] [nvarchar](10) NULL,
	[s1_Science] [nvarchar](10) NULL,
	[s2_Science] [nvarchar](10) NULL,
	[s3_Science] [nvarchar](10) NULL,
	[s4_Science] [nvarchar](10) NULL,
	[s1_Senses] [nvarchar](10) NULL,
	[s2_Senses] [nvarchar](10) NULL,
	[s3_Senses] [nvarchar](10) NULL,
	[s1_SocialStudies] [nvarchar](10) NULL,
	[s2_SocialStudies] [nvarchar](10) NULL,
	[s3_SocialStudies] [nvarchar](10) NULL,
	[s1_VisualRep] [nvarchar](10) NULL,
	[s2_VisualRep] [nvarchar](10) NULL,
	[s3_VisualRep] [nvarchar](10) NULL,
	[ms1_Fine] [nvarchar](10) NULL,
	[ms2_Fine] [nvarchar](10) NULL,
	[ms3_Fine] [nvarchar](10) NULL,
	[ms4_Fine] [nvarchar](10) NULL,
	[ms1_Large] [nvarchar](10) NULL,
	[ms2_Large] [nvarchar](10) NULL,
	[ms3_Large] [nvarchar](10) NULL,
	[ms4_Large] [nvarchar](10) NULL,
 CONSTRAINT [PK_PIAP_22] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP07]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP07](
	[permnum] [varchar](50) NOT NULL,
	[C1_Rdg_DictSur] [int] NULL,
	[C1_Rdg_RunRec] [int] NULL,
	[C1_Rdg_RCA] [int] NULL,
	[C1_Rdg_CurrGr] [varchar](50) NULL,
	[C1_Mth_MCA] [int] NULL,
	[C1_Mth_CurrGr] [varchar](50) NULL,
	[C1_Wrt_StgScr] [int] NULL,
	[C1_Sci_SCA] [int] NULL,
	[C1_Sci_CurrGr] [varchar](50) NULL,
	[C2_Rdg_RunRec] [int] NULL,
	[C2_Rdg_RCA] [int] NULL,
	[C2_Mth_MCA] [int] NULL,
	[C2_Sci_SCA] [int] NULL,
	[C2_Rdg_Alpha] [int] NULL,
	[C2_Rdg_ListComp] [int] NULL,
	[C2_Rdg_PrintConc] [int] NULL,
	[C3_Rdg_RunRec] [int] NULL,
	[C3_Rdg_RCA] [int] NULL,
	[C3_Rdg_CurrGr] [varchar](50) NULL,
	[C3_Mth_MCA] [int] NULL,
	[C3_Mth_CurrGr] [varchar](50) NULL,
	[C3_Wrt_StgScr] [int] NULL,
	[C3_Sci_SCA] [int] NULL,
	[C3_Sci_CurrGr] [varchar](50) NULL,
	[C3_Rdg_Alpha] [int] NULL,
	[C3_Rdg_ListComp] [int] NULL,
	[C3_Mth_Kdg] [int] NULL,
	[C4_Rdg_RunRec] [int] NULL,
	[C4_Rdg_RCA] [int] NULL,
	[C4_Mth_MCA] [int] NULL,
	[C4_Sci_SCA] [int] NULL,
	[C5_Rdg_Alpha] [int] NULL,
	[C5_Rdg_DictSurv] [int] NULL,
	[C5_Rdg_SightWds] [int] NULL,
	[C5_Rdg_OralLang] [int] NULL,
	[C5_Mth_Kdg] [int] NULL,
	[C5_Rdg_RunRec] [int] NULL,
	[C5_Rdg_RCA] [int] NULL,
	[C5_Rdg_CurrGr] [varchar](50) NULL,
	[C5_Mth_MCA] [int] NULL,
	[C5_Mth_CurrGr] [varchar](50) NULL,
	[C5_Wrt_StgScr] [int] NULL,
	[C5_Sci_SCA] [int] NULL,
	[C5_Sci_CurrGr] [varchar](50) NULL,
	[FCAT_Rdg_Lvl] [int] NULL,
	[FCAT_Mth_Lvl] [int] NULL,
	[FCAT_Wrt_Prompt] [int] NULL,
	[C1_Rdg_DictSurv] [int] NULL,
 CONSTRAINT [PK_PCAS] PRIMARY KEY CLUSTERED 
(
	[permnum] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP08]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP08](
	[permnum] [varchar](50) NOT NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[advisor] [varchar](3) NULL,
	[C1.Mth_CurrGr] [varchar](1) NULL,
	[C1.Rdg_CurrGr] [varchar](1) NULL,
	[C1.Rdg_DictSurv] [int] NULL,
	[C1.Rdg_HWL] [varchar](50) NULL,
	[C1.Rdg_KgAlpha] [int] NULL,
	[C1.Rdg_KgOralLang] [int] NULL,
	[C1.Rdg_RunRec] [varchar](1) NULL,
	[C1.Rdg_SRI] [int] NULL,
	[C1.Sci_CurrGr] [varchar](1) NULL,
	[C1.Wrt_StgScr] [real] NULL,
	[C2.KgBSG_Copes] [varchar](10) NULL,
	[C2.KgBSG_Directions] [varchar](10) NULL,
	[C2.KgBSG_Moves] [varchar](10) NULL,
	[C2.KgBSG_Participates] [varchar](10) NULL,
	[C2.KgBSG_Respects] [varchar](10) NULL,
	[C2.KgBSG_Responsibility] [varchar](10) NULL,
	[C2.KgBSG_Rules] [varchar](10) NULL,
	[C2.KgBSG_Selects] [varchar](10) NULL,
	[C2.KgBSG_SelfConfidence] [varchar](10) NULL,
	[C2.KgBSG_Shares] [varchar](10) NULL,
	[C2.KgBSG_Time] [varchar](10) NULL,
	[C2.KgMS_FineMotor] [varchar](10) NULL,
	[C2.KgMS_LargeMotor] [varchar](10) NULL,
	[C2.Mth_KgPatt] [int] NULL,
	[C2.Mth_KgShapes_2Dim] [int] NULL,
	[C2.Mth_KgShapes_3Dim] [int] NULL,
	[C2.Mth_KgSortClass] [int] NULL,
	[C2.Mth_KgMthBhv] [varchar](10) NULL,
	[C2.Mth_CurrGr] [varchar](1) NULL,
	[C2.Rdg_CurrGr] [varchar](1) NULL,
	[C2.Rdg_HWL] [varchar](50) NULL,
	[C2.Rdg_KgAlpha] [int] NULL,
	[C2.Rdg_KgListComp] [int] NULL,
	[C2.Rdg_KgOralLang] [int] NULL,
	[C2.Rdg_KgPrintCon] [int] NULL,
	[C2.Rdg_KgRdgBhv] [varchar](10) NULL,
	[C2.Rdg_RunRec] [varchar](1) NULL,
	[C2.Rdg_SRI] [int] NULL,
	[C2.Sci_KgSciSSHBhv] [varchar](10) NULL,
	[C2.Sci_CurrGr] [varchar](1) NULL,
	[C2.Wrt_KgWrtBhv] [varchar](10) NULL,
	[C2.Wrt_StgScr] [real] NULL,
	[C3.KgBSG_Copes] [varchar](10) NULL,
	[C3.KgBSG_Directions] [varchar](10) NULL,
	[C3.KgBSG_Moves] [varchar](10) NULL,
	[C3.KgBSG_Participates] [varchar](10) NULL,
	[C3.KgBSG_Respects] [varchar](10) NULL,
	[C3.KgBSG_Responsibility] [varchar](10) NULL,
	[C3.KgBSG_Rules] [varchar](10) NULL,
	[C3.KgBSG_Selects] [varchar](10) NULL,
	[C3.KgBSG_SelfConfidence] [varchar](10) NULL,
	[C3.KgBSG_Shares] [varchar](10) NULL,
	[C3.KgBSG_Time] [varchar](10) NULL,
	[C3.KgMS_FineMotor] [varchar](10) NULL,
	[C3.KgMS_LargeMotor] [varchar](10) NULL,
	[C3.Mth_KgComparing] [int] NULL,
	[C3.Mth_KgMeasurement] [int] NULL,
	[C3.Mth_KgNumerals] [int] NULL,
	[C3.Mth_KgPatt] [int] NULL,
	[C3.Mth_KgShapes_2Dim] [int] NULL,
	[C3.Mth_KgShapes_3Dim] [int] NULL,
	[C3.Mth_KgSortClass] [int] NULL,
	[C3.Mth_KgMthBhv] [varchar](10) NULL,
	[C3.Mth_CurrGr] [varchar](1) NULL,
	[C3.Rdg_CurrGr] [varchar](1) NULL,
	[C3.Rdg_HWL] [varchar](50) NULL,
	[C3.Rdg_KgAlpha] [int] NULL,
	[C3.Rdg_KgDictSurv] [int] NULL,
	[C3.Rdg_KgListComp] [int] NULL,
	[C3.Rdg_KgOralLang] [int] NULL,
	[C3.Rdg_KgPrintCon] [int] NULL,
	[C3.Rdg_KgRhym] [int] NULL,
	[C3.Rdg_KgSightWrds] [int] NULL,
	[C3.Rdg_KgRdgBhv] [varchar](10) NULL,
	[C3.Rdg_RunRec] [varchar](1) NULL,
	[C3.Rdg_SRI] [int] NULL,
	[C3.Sci_KgSciSSHBhv] [varchar](10) NULL,
	[C3.Sci_CurrGr] [varchar](1) NULL,
	[C3.Wrt_KgWrtBhv] [varchar](10) NULL,
	[C3.Wrt_StgScr] [real] NULL,
	[C4.KgBSG_Copes] [varchar](10) NULL,
	[C4.KgBSG_Directions] [varchar](10) NULL,
	[C4.KgBSG_Moves] [varchar](10) NULL,
	[C4.KgBSG_Participates] [varchar](10) NULL,
	[C4.KgBSG_Respects] [varchar](10) NULL,
	[C4.KgBSG_Responsibility] [varchar](10) NULL,
	[C4.KgBSG_Rules] [varchar](10) NULL,
	[C4.KgBSG_Selects] [varchar](10) NULL,
	[C4.KgBSG_SelfConfidence] [varchar](10) NULL,
	[C4.KgBSG_Shares] [varchar](10) NULL,
	[C4.KgBSG_Time] [varchar](10) NULL,
	[C4.KgMS_FineMotor] [varchar](10) NULL,
	[C4.KgMS_LargeMotor] [varchar](10) NULL,
	[C4.Mth_KgComparing] [int] NULL,
	[C4.Mth_KgMeasurement] [int] NULL,
	[C4.Mth_KgNumerals] [int] NULL,
	[C4.Mth_KgPatt] [int] NULL,
	[C4.Mth_KgShapes_2Dim] [int] NULL,
	[C4.Mth_KgShapes_3Dim] [int] NULL,
	[C4.Mth_KgSortClass] [int] NULL,
	[C4.Mth_KgJoinSepSets] [int] NULL,
	[C4.Mth_KgMthBhv] [varchar](10) NULL,
	[C4.Rdg_KgAlpha] [int] NULL,
	[C4.Rdg_KgDictSurv] [int] NULL,
	[C4.Rdg_KgListComp] [int] NULL,
	[C4.Rdg_KgOralLang] [int] NULL,
	[C4.Rdg_KgPrintCon] [int] NULL,
	[C4.Rdg_KgRhym] [int] NULL,
	[C4.Rdg_KgSightWrds] [int] NULL,
	[C4.Rdg_KgRunRec] [varchar](1) NULL,
	[C4.Rdg_KgRdgBhv] [varchar](10) NULL,
	[C4.Sci_KgSciSSHBhv] [varchar](10) NULL,
	[C4.Wrt_KgWrtBhv] [varchar](10) NULL,
	[C4.Wrt_StgScr] [real] NULL,
	[DB.C1_ISF] [int] NULL,
	[DB.C1_LNF] [int] NULL,
	[DB.C1_NWF] [int] NULL,
	[DB.C1_PSF] [int] NULL,
	[DB.C1_ORF] [int] NULL,
	[DB.C2_ISF] [int] NULL,
	[DB.C2_LNF] [int] NULL,
	[DB.C2_NWF] [int] NULL,
	[DB.C2_PSF] [int] NULL,
	[DB.C2_ORF] [int] NULL,
	[DB.C3_ISF] [int] NULL,
	[DB.C3_ISF_RL] [varchar](2) NULL,
	[DB.C3_LNF] [int] NULL,
	[DB.C3_NWF] [int] NULL,
	[DB.C3_PSF] [int] NULL,
	[DB.C3_ORF] [int] NULL,
	[DAR.Auditory_Blending_1] [int] NULL,
	[DAR.Auditory_Blending_2] [int] NULL,
	[DAR.Auditory_Blending_3] [int] NULL,
	[DAR.Consonant_Blends_1] [int] NULL,
	[DAR.Consonant_Blends_2] [int] NULL,
	[DAR.Consonant_Blends_3] [int] NULL,
	[DAR.Date_Tested_1] [int] NULL,
	[DAR.Date_Tested_2] [int] NULL,
	[DAR.Date_Tested_3] [int] NULL,
	[DAR.Dipthongs_1] [int] NULL,
	[DAR.Dipthongs_2] [int] NULL,
	[DAR.Dipthongs_3] [int] NULL,
	[DAR.Hearing_Final_Cons._Sds_1] [int] NULL,
	[DAR.Hearing_Final_Cons._Sds_2] [int] NULL,
	[DAR.Hearing_Final_Cons._Sds_3] [int] NULL,
	[DAR.Hearing_Initial_Cons._Sds_1] [int] NULL,
	[DAR.Hearing_Initial_Cons._Sds_2] [int] NULL,
	[DAR.Hearing_Initial_Cons._Sds_3] [int] NULL,
	[DAR.Matching_Letters_1] [int] NULL,
	[DAR.Matching_Letters_2] [int] NULL,
	[DAR.Matching_Letters_3] [int] NULL,
	[DAR.Matching_Words_1] [int] NULL,
	[DAR.Matching_Words_2] [int] NULL,
	[DAR.Matching_Words_3] [int] NULL,
	[DAR.Naming_Capital_Letters_1] [int] NULL,
	[DAR.Naming_Capital_Letters_2] [int] NULL,
	[DAR.Naming_Capital_Letters_3] [int] NULL,
	[DAR.Naming_Lowercase_Letters_1] [int] NULL,
	[DAR.Naming_Lowercase_Letters_2] [int] NULL,
	[DAR.Naming_Lowercase_Letters_3] [int] NULL,
	[DAR.Notes] [varchar](300) NULL,
	[DAR.Oral_Reading_1] [int] NULL,
	[DAR.Oral_Reading_2] [int] NULL,
	[DAR.Oral_Reading_3] [int] NULL,
	[DAR.Poly_Syllabic_Words_1] [int] NULL,
	[DAR.Poly_Syllabic_Words_2] [int] NULL,
	[DAR.Poly_Syllabic_Words_3] [int] NULL,
	[DAR.Rhyming_Words_1] [int] NULL,
	[DAR.Rhyming_Words_2] [int] NULL,
	[DAR.Rhyming_Words_3] [int] NULL,
	[DAR.Rule_of_Silent_E_1] [int] NULL,
	[DAR.Rule_of_Silent_E_2] [int] NULL,
	[DAR.Rule_of_Silent_E_3] [int] NULL,
	[DAR.Segmenting_Words_1] [int] NULL,
	[DAR.Segmenting_Words_2] [int] NULL,
	[DAR.Segmenting_Words_3] [int] NULL,
	[DAR.Short_Vowel_Sounds_1] [int] NULL,
	[DAR.Short_Vowel_Sounds_2] [int] NULL,
	[DAR.Short_Vowel_Sounds_3] [int] NULL,
	[DAR.Silent_Reading_Comp.1] [int] NULL,
	[DAR.Silent_Reading_Comp.2] [int] NULL,
	[DAR.Silent_Reading_Comp.3] [int] NULL,
	[DAR.Spelling_1] [int] NULL,
	[DAR.Spelling_2] [int] NULL,
	[DAR.Spelling_3] [int] NULL,
	[DAR.Two_Syllable_Words_1] [int] NULL,
	[DAR.Two_Syllable_Words_2] [int] NULL,
	[DAR.Two_Syllable_Words_3] [int] NULL,
	[DAR.Vowel_Digraphs_1] [int] NULL,
	[DAR.Vowel_Digraphs_2] [int] NULL,
	[DAR.Vowel_Digraphs_3] [int] NULL,
	[DAR.Vowel_with_R_1] [int] NULL,
	[DAR.Vowel_with_R_2] [int] NULL,
	[DAR.Vowel_with_R_3] [int] NULL,
	[DAR.Word_Meaning_1] [int] NULL,
	[DAR.Word_Meaning_2] [int] NULL,
	[DAR.Word_Meaning_3] [int] NULL,
	[DAR.Word_Recognition_1] [int] NULL,
	[DAR.Word_Recognition_2] [int] NULL,
	[DAR.Word_Recognition_3] [int] NULL,
	[DAR.Writing_Words_1] [int] NULL,
	[DAR.Writing_Words_2] [int] NULL,
	[DAR.Writing_Words_3] [int] NULL,
	[MacA] [int] NULL,
	[MacB] [int] NULL,
	[MacC] [int] NULL,
	[MacD] [int] NULL,
	[Gr3SumBench] [int] NULL,
	[C2mNotTest] [varchar](1) NULL,
	[C2rNotTest] [varchar](1) NULL,
	[C2sNotTest] [varchar](1) NULL,
	[C2wNotTest] [varchar](1) NULL,
	[C2.KgConf_Held] [varchar](3) NULL,
	[C2.KgConf_Requested] [varchar](3) NULL,
	[C2.KgEdPlan_IEP] [varchar](3) NULL,
	[C2.KgEdPlan_PMP] [varchar](3) NULL,
	[C3.KgConf_Held] [varchar](3) NULL,
	[C3.KgConf_Requested] [varchar](3) NULL,
	[C3.KgEdPlan_IEP] [varchar](3) NULL,
	[C3.KgEdPlan_PMP] [varchar](3) NULL,
	[C4.KgConf_Held] [varchar](3) NULL,
	[C4.KgConf_Requested] [varchar](3) NULL,
	[C4.KgEdPlan_IEP] [varchar](3) NULL,
	[C4.KgEdPlan_PMP] [varchar](3) NULL,
	[C2.KgLit_AbsTar] [varchar](3) NULL,
	[C3.KgLit_AbsTar] [varchar](3) NULL,
	[C4.KgLit_AbsTar] [varchar](3) NULL,
	[C2.KgLit_BehCond] [varchar](3) NULL,
	[C3.KgLit_BehCond] [varchar](3) NULL,
	[C4.KgLit_BehCond] [varchar](3) NULL,
	[Gr5grade1] [varchar](1) NULL,
	[Gr5grade2] [varchar](1) NULL,
	[Gr5grade3] [varchar](1) NULL,
	[C3kgNotTest] [varchar](1) NULL,
	[Gr5DevScr_fail] [varchar](1) NULL,
	[Gr5DevScr_pass] [varchar](1) NULL,
	[c1rNoScr] [varchar](1) NULL,
	[c1mNoScr] [varchar](1) NULL,
	[c1sNoScr] [varchar](1) NULL,
	[c1wNoScr] [varchar](1) NULL,
	[c2rNoScr] [varchar](1) NULL,
	[c2mNoScr] [varchar](1) NULL,
	[c2sNoScr] [varchar](1) NULL,
	[c2wNoScr] [varchar](1) NULL,
	[c3rNoScr] [varchar](1) NULL,
	[c3mNoScr] [varchar](1) NULL,
	[c3sNoScr] [varchar](1) NULL,
	[c3wNoScr] [varchar](1) NULL,
	[c4kgNoScr] [varchar](1) NULL,
	[G3_ProRetInfo_Code1] [varchar](1) NULL,
	[G3_ProRetInfo_Code2] [varchar](1) NULL,
	[G3_ProRetInfo_Code3] [varchar](1) NULL,
	[G3_ProRetInfo_Code4] [varchar](1) NULL,
	[G3_ProRetInfo_Code5] [varchar](1) NULL,
	[G3_ProRetInfo_Code6] [varchar](1) NULL,
	[G3_ProRetInfo_Except] [varchar](1) NULL,
	[G3_ProRetInfo_Except_desc] [varchar](100) NULL,
 CONSTRAINT [PK_PCAS8] PRIMARY KEY CLUSTERED 
(
	[permnum] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP09]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP09](
	[permnum] [varchar](50) NOT NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[advisor] [varchar](3) NULL,
	[PotRetain] [varchar](3) NULL,
	[r1PRS] [int] NULL,
	[r1Fluency] [int] NULL,
	[r1Accuracy] [int] NULL,
	[r1GrFP] [varchar](2) NULL,
	[r1PassNum] [int] NULL,
	[r1TarPassNum] [int] NULL,
	[r1CompExplicit] [int] NULL,
	[r1CompImplicit] [int] NULL,
	[r1VocabRawScore] [int] NULL,
	[r1VocabPercentile] [int] NULL,
	[r1SpellRawScore] [int] NULL,
	[r1SpellPercentile] [int] NULL,
	[r1RCPercentile] [int] NULL,
	[r1RCStandScore] [int] NULL,
	[r1RCAbilityScore] [int] NULL,
	[r1RCLexile] [int] NULL,
	[r1WP] [int] NULL,
	[r1MI] [int] NULL,
	[r1CC] [int] NULL,
	[r1RR] [int] NULL,
	[r1MazePercentile] [int] NULL,
	[r1MazeStandScore] [int] NULL,
	[r1AdjMazeScore] [int] NULL,
	[r1WAPercentile] [int] NULL,
	[r1WAStandScore] [int] NULL,
	[r1WAAbility] [int] NULL,
	[m1CurGr] [varchar](10) NULL,
	[s1CurGr] [varchar](10) NULL,
	[w1stgscr] [int] NULL,
	[r1exempt] [varchar](1) NULL,
	[m1exempt] [varchar](1) NULL,
	[s1exempt] [varchar](1) NULL,
	[w1exempt] [varchar](1) NULL,
	[r2PRS] [int] NULL,
	[r2Fluency] [int] NULL,
	[r2Accuracy] [int] NULL,
	[r2GrFP] [varchar](2) NULL,
	[r2PassNum] [int] NULL,
	[r2TarPassNum] [int] NULL,
	[r2CompExplicit] [int] NULL,
	[r2CompImplicit] [int] NULL,
	[r2SpellRawScore] [int] NULL,
	[r2SpellPercentile] [int] NULL,
	[r2RCPercentile] [int] NULL,
	[r2RCStandScore] [int] NULL,
	[r2RCAbilityScore] [int] NULL,
	[r2RCLexile] [int] NULL,
	[r2WP] [int] NULL,
	[r2MI] [int] NULL,
	[r2CC] [int] NULL,
	[r2RR] [int] NULL,
	[r2MazePercentile] [int] NULL,
	[r2MazeStandScore] [int] NULL,
	[r2AdjMazeScore] [int] NULL,
	[r2WAPercentile] [int] NULL,
	[r2WAStandScore] [int] NULL,
	[r2WAAbility] [int] NULL,
	[m2CurGr] [varchar](10) NULL,
	[s2CurGr] [varchar](10) NULL,
	[w2stgscr] [int] NULL,
	[r2exempt] [varchar](1) NULL,
	[m2exempt] [varchar](1) NULL,
	[s2exempt] [varchar](1) NULL,
	[w2exempt] [varchar](1) NULL,
	[r3PRS] [int] NULL,
	[r3Fluency] [int] NULL,
	[r3Accuracy] [int] NULL,
	[r3GrFP] [varchar](2) NULL,
	[r3PassNum] [int] NULL,
	[r3TarPassNum] [int] NULL,
	[r3CompExplicit] [int] NULL,
	[r3CompImplicit] [int] NULL,
	[r3VocabRawScore] [int] NULL,
	[r3VocabPercentile] [int] NULL,
	[r3SpellRawScore] [int] NULL,
	[r3SpellPercentile] [int] NULL,
	[r3RCPercentile] [int] NULL,
	[r3RCStandScore] [int] NULL,
	[r3RCAbilityScore] [int] NULL,
	[r3RCLexile] [int] NULL,
	[r3WP] [int] NULL,
	[r3MI] [int] NULL,
	[r3CC] [int] NULL,
	[r3RR] [int] NULL,
	[r3MazePercentile] [int] NULL,
	[r3MazeStandScore] [int] NULL,
	[r3AdjMazeScore] [int] NULL,
	[r3WAPercentile] [int] NULL,
	[r3WAStandScore] [int] NULL,
	[r3WAAbility] [int] NULL,
	[m3CurGr] [varchar](10) NULL,
	[s3CurGr] [varchar](10) NULL,
	[w3stgscr] [int] NULL,
	[r3exempt] [varchar](1) NULL,
	[m3exempt] [varchar](1) NULL,
	[s3exempt] [varchar](1) NULL,
	[w3exempt] [varchar](1) NULL,
	[g3alt1] [int] NULL,
	[g3alt2] [int] NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](1) NULL,
	[g5grade2] [varchar](1) NULL,
	[g5grade3] [varchar](1) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Shapes2D] [varchar](10) NULL,
	[m1_Shapes3D] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [int] NULL,
	[ms1_Large] [int] NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](100) NULL,
	[w1_WrtStg] [varchar](10) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes2D] [varchar](10) NULL,
	[m2_Shapes3D] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [int] NULL,
	[ms2_Large] [int] NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](100) NULL,
	[w2_WrtStg] [varchar](10) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes2D] [varchar](10) NULL,
	[m3_Shapes3D] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_JoinSets] [varchar](10) NULL,
	[ms3_Fine] [int] NULL,
	[ms3_Large] [int] NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
	[tc3_Comments] [varchar](100) NULL,
	[w3_WrtStg] [varchar](10) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[r1_Letter_Sound] [int] NULL,
	[r2_Letter_Sound] [int] NULL,
	[r3_Letter_Sound] [int] NULL,
	[r1_PhonBlend] [int] NULL,
	[r2_PhonBlend] [int] NULL,
	[r3_PhonBlend] [int] NULL,
	[r1_PhonDelete] [int] NULL,
	[r2_PhonDelete] [int] NULL,
	[r3_PhonDelete] [int] NULL,
	[r1_LetterSoundInitial] [int] NULL,
	[r2_LetterSoundInitial] [int] NULL,
	[r3_LetterSoundInitial] [int] NULL,
	[r1_LetterSoundFinal] [int] NULL,
	[r2_LetterSoundFinal] [int] NULL,
	[r3_LetterSoundFinal] [int] NULL,
	[r1_WordBldInitial] [int] NULL,
	[r2_WordBldInitial] [int] NULL,
	[r3_WordBldInitial] [int] NULL,
	[r1_WordBldFinal] [int] NULL,
	[r2_WordBldFinal] [int] NULL,
	[r3_WordBldFinal] [int] NULL,
	[r1_WordBldMedial] [int] NULL,
	[r2_WordBldMedial] [int] NULL,
	[r3_WordBldMedial] [int] NULL,
	[FMP_updated] [datetime] NULL,
 CONSTRAINT [PK_PIAP09] PRIMARY KEY CLUSTERED 
(
	[permnum] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP10]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP10](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1PRS_FSP] [int] NULL,
	[r1Fluency] [int] NULL,
	[r1Accuracy] [int] NULL,
	[r1GrFP] [varchar](2) NULL,
	[r1PassNum] [int] NULL,
	[r1FAIRpassage] [real] NULL,
	[r1TarPassNum] [int] NULL,
	[r1CompExplicit] [int] NULL,
	[r1CompImplicit] [int] NULL,
	[r1VocabRawScore] [int] NULL,
	[r1VocabPercentile] [int] NULL,
	[r1SpellRawScore] [int] NULL,
	[r1SpellPercentile] [int] NULL,
	[r1RCPercentile] [int] NULL,
	[r1RCStandScore] [int] NULL,
	[r1RCAbilityScore] [int] NULL,
	[r1RCLexile] [int] NULL,
	[r1WP] [int] NULL,
	[r1MI] [int] NULL,
	[r1CC] [int] NULL,
	[r1RR] [int] NULL,
	[r1MazePercentile] [int] NULL,
	[r1MazeStandScore] [int] NULL,
	[r1AdjMazeScore] [int] NULL,
	[r1WAPercentile] [int] NULL,
	[r1WAStandScore] [int] NULL,
	[r1WAAbility] [int] NULL,
	[m1Perf] [varchar](10) NULL,
	[s1Perf] [varchar](10) NULL,
	[w1escr] [int] NULL,
	[w1npscr] [int] NULL,
	[w1stg] [varchar](5) NULL,
	[r2PRS_FSP] [int] NULL,
	[r2Fluency] [int] NULL,
	[r2Accuracy] [int] NULL,
	[r2GrFP] [varchar](2) NULL,
	[r2PassNum] [int] NULL,
	[r2FAIRpassage] [real] NULL,
	[r2TarPassNum] [int] NULL,
	[r2CompExplicit] [int] NULL,
	[r2CompImplicit] [int] NULL,
	[r2SpellRawScore] [int] NULL,
	[r2SpellPercentile] [int] NULL,
	[r2RCPercentile] [int] NULL,
	[r2RCStandScore] [int] NULL,
	[r2RCAbilityScore] [int] NULL,
	[r2RCLexile] [int] NULL,
	[r2WP] [int] NULL,
	[r2MI] [int] NULL,
	[r2CC] [int] NULL,
	[r2RR] [int] NULL,
	[r2MazePercentile] [int] NULL,
	[r2MazeStandScore] [int] NULL,
	[r2AdjMazeScore] [int] NULL,
	[r2WAPercentile] [int] NULL,
	[r2WAStandScore] [int] NULL,
	[r2WAAbility] [int] NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[r3PRS_FSP] [int] NULL,
	[r3Fluency] [int] NULL,
	[r3Accuracy] [int] NULL,
	[r3GrFP] [varchar](2) NULL,
	[r3PassNum] [int] NULL,
	[r3FAIRpassage] [real] NULL,
	[r3TarPassNum] [int] NULL,
	[r3CompExplicit] [int] NULL,
	[r3CompImplicit] [int] NULL,
	[r3VocabRawScore] [int] NULL,
	[r3VocabPercentile] [int] NULL,
	[r3SpellRawScore] [int] NULL,
	[r3SpellPercentile] [int] NULL,
	[r3RCPercentile] [int] NULL,
	[r3RCStandScore] [int] NULL,
	[r3RCAbilityScore] [int] NULL,
	[r3RCLexile] [int] NULL,
	[r3WP] [int] NULL,
	[r3MI] [int] NULL,
	[r3CC] [int] NULL,
	[r3RR] [int] NULL,
	[r3MazePercentile] [int] NULL,
	[r3MazeStandScore] [int] NULL,
	[r3AdjMazeScore] [int] NULL,
	[r3WAPercentile] [int] NULL,
	[r3WAStandScore] [int] NULL,
	[r3WAAbility] [int] NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](1) NULL,
	[g5grade2] [varchar](1) NULL,
	[g5grade3] [varchar](1) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Shapes2D] [varchar](10) NULL,
	[m1_Shapes3D] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [int] NULL,
	[ms1_Large] [int] NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes2D] [varchar](10) NULL,
	[m2_Shapes3D] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [int] NULL,
	[ms2_Large] [int] NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes2D] [varchar](10) NULL,
	[m3_Shapes3D] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_JoinSets] [varchar](10) NULL,
	[ms3_Fine] [int] NULL,
	[ms3_Large] [int] NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[r1_Letter_Sound] [int] NULL,
	[r2_Letter_Sound] [int] NULL,
	[r3_Letter_Sound] [int] NULL,
	[r1_PhonBlend] [int] NULL,
	[r2_PhonBlend] [int] NULL,
	[r3_PhonBlend] [int] NULL,
	[r1_PhonDelete] [int] NULL,
	[r2_PhonDelete] [int] NULL,
	[r3_PhonDelete] [int] NULL,
	[r1_LetterSoundInitial] [int] NULL,
	[r2_LetterSoundInitial] [int] NULL,
	[r3_LetterSoundInitial] [int] NULL,
	[r1_LetterSoundFinal] [int] NULL,
	[r2_LetterSoundFinal] [int] NULL,
	[r3_LetterSoundFinal] [int] NULL,
	[r1_WordBldInitial] [int] NULL,
	[r2_WordBldInitial] [int] NULL,
	[r3_WordBldInitial] [int] NULL,
	[r1_WordBldFinal] [int] NULL,
	[r2_WordBldFinal] [int] NULL,
	[r3_WordBldFinal] [int] NULL,
	[r1_WordBldMedial] [int] NULL,
	[r2_WordBldMedial] [int] NULL,
	[r3_WordBldMedial] [int] NULL,
	[FMP_updated] [datetime] NULL,
 CONSTRAINT [PK_PIAP10_1] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP11]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP11](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1PRS_FSP] [int] NULL,
	[r1Fluency] [int] NULL,
	[r1Accuracy] [int] NULL,
	[r1GrFP] [varchar](2) NULL,
	[r1PassNum] [int] NULL,
	[r1FAIRpassage] [real] NULL,
	[r1TarPassNum] [int] NULL,
	[r1CompExplicit] [int] NULL,
	[r1CompImplicit] [int] NULL,
	[r1VocabRawScore] [int] NULL,
	[r1VocabPercentile] [int] NULL,
	[r1SpellRawScore] [int] NULL,
	[r1SpellPercentile] [int] NULL,
	[r1RCPercentile] [int] NULL,
	[r1RCStandScore] [int] NULL,
	[r1RCAbilityScore] [int] NULL,
	[r1RCLexile] [int] NULL,
	[r1WP] [int] NULL,
	[r1MI] [int] NULL,
	[r1CC] [int] NULL,
	[r1RR] [int] NULL,
	[r1MazePercentile] [int] NULL,
	[r1MazeStandScore] [int] NULL,
	[r1AdjMazeScore] [int] NULL,
	[r1WAPercentile] [int] NULL,
	[r1WAStandScore] [int] NULL,
	[r1WAAbility] [int] NULL,
	[m1Perf] [varchar](10) NULL,
	[s1Perf] [varchar](10) NULL,
	[w1escr] [int] NULL,
	[w1npscr] [int] NULL,
	[w1stg] [varchar](5) NULL,
	[r2PRS_FSP] [int] NULL,
	[r2Fluency] [int] NULL,
	[r2Accuracy] [int] NULL,
	[r2GrFP] [varchar](2) NULL,
	[r2PassNum] [int] NULL,
	[r2FAIRpassage] [real] NULL,
	[r2TarPassNum] [int] NULL,
	[r2CompExplicit] [int] NULL,
	[r2CompImplicit] [int] NULL,
	[r2SpellRawScore] [int] NULL,
	[r2SpellPercentile] [int] NULL,
	[r2RCPercentile] [int] NULL,
	[r2RCStandScore] [int] NULL,
	[r2RCAbilityScore] [int] NULL,
	[r2RCLexile] [int] NULL,
	[r2WP] [int] NULL,
	[r2MI] [int] NULL,
	[r2CC] [int] NULL,
	[r2RR] [int] NULL,
	[r2MazePercentile] [int] NULL,
	[r2MazeStandScore] [int] NULL,
	[r2AdjMazeScore] [int] NULL,
	[r2WAPercentile] [int] NULL,
	[r2WAStandScore] [int] NULL,
	[r2WAAbility] [int] NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[r3PRS_FSP] [int] NULL,
	[r3Fluency] [int] NULL,
	[r3Accuracy] [int] NULL,
	[r3GrFP] [varchar](2) NULL,
	[r3PassNum] [int] NULL,
	[r3FAIRpassage] [real] NULL,
	[r3TarPassNum] [int] NULL,
	[r3CompExplicit] [int] NULL,
	[r3CompImplicit] [int] NULL,
	[r3VocabRawScore] [int] NULL,
	[r3VocabPercentile] [int] NULL,
	[r3SpellRawScore] [int] NULL,
	[r3SpellPercentile] [int] NULL,
	[r3RCPercentile] [int] NULL,
	[r3RCStandScore] [int] NULL,
	[r3RCAbilityScore] [int] NULL,
	[r3RCLexile] [int] NULL,
	[r3WP] [int] NULL,
	[r3MI] [int] NULL,
	[r3CC] [int] NULL,
	[r3RR] [int] NULL,
	[r3MazePercentile] [int] NULL,
	[r3MazeStandScore] [int] NULL,
	[r3AdjMazeScore] [int] NULL,
	[r3WAPercentile] [int] NULL,
	[r3WAStandScore] [int] NULL,
	[r3WAAbility] [int] NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](1) NULL,
	[g5grade2] [varchar](1) NULL,
	[g5grade3] [varchar](1) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Pattern] [varchar](10) NULL,
	[m1_Shapes] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [int] NULL,
	[ms1_Large] [int] NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [int] NULL,
	[ms2_Large] [int] NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_AddSub] [varchar](10) NULL,
	[ms3_Fine] [int] NULL,
	[ms3_Large] [int] NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[b3_ReadingLevel] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[r1_FAIR_LetterSound] [int] NULL,
	[r2_FAIR_LetterSound] [int] NULL,
	[r3_FAIR_LetterSound] [int] NULL,
	[r1_PhonBlend] [int] NULL,
	[r2_PhonBlend] [int] NULL,
	[r3_PhonBlend] [int] NULL,
	[r1_PhonDelete] [int] NULL,
	[r2_PhonDelete] [int] NULL,
	[r3_PhonDelete] [int] NULL,
	[r1_LetterSoundInitial] [int] NULL,
	[r2_LetterSoundInitial] [int] NULL,
	[r3_LetterSoundInitial] [int] NULL,
	[r1_LetterSoundFinal] [int] NULL,
	[r2_LetterSoundFinal] [int] NULL,
	[r3_LetterSoundFinal] [int] NULL,
	[r1_WordBldInitial] [int] NULL,
	[r2_WordBldInitial] [int] NULL,
	[r3_WordBldInitial] [int] NULL,
	[r1_WordBldFinal] [int] NULL,
	[r2_WordBldFinal] [int] NULL,
	[r3_WordBldFinal] [int] NULL,
	[r1_WordBldMedial] [int] NULL,
	[r2_WordBldMedial] [int] NULL,
	[r3_WordBldMedial] [int] NULL,
	[FMP_updated] [datetime] NULL,
 CONSTRAINT [PK_PIAP11] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP12]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP12](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1PRS_FSP] [int] NULL,
	[r1Fluency] [int] NULL,
	[r1Accuracy] [int] NULL,
	[r1GrFP] [varchar](2) NULL,
	[r1PassNum] [int] NULL,
	[r1FAIRpassage] [real] NULL,
	[r1TarPassNum] [int] NULL,
	[r1CompExplicit] [int] NULL,
	[r1CompImplicit] [int] NULL,
	[r1VocabRawScore] [int] NULL,
	[r1VocabPercentile] [int] NULL,
	[r1SpellRawScore] [int] NULL,
	[r1SpellPercentile] [int] NULL,
	[r1RCPercentile] [int] NULL,
	[r1RCStandScore] [int] NULL,
	[r1RCAbilityScore] [int] NULL,
	[r1RCLexile] [int] NULL,
	[r1WP] [int] NULL,
	[r1MI] [int] NULL,
	[r1CC] [int] NULL,
	[r1RR] [int] NULL,
	[r1MazePercentile] [int] NULL,
	[r1MazeStandScore] [int] NULL,
	[r1AdjMazeScore] [int] NULL,
	[r1WAPercentile] [int] NULL,
	[r1WAStandScore] [int] NULL,
	[r1WAAbility] [int] NULL,
	[m1Perf] [varchar](10) NULL,
	[s1Perf] [varchar](10) NULL,
	[w1escr] [int] NULL,
	[w1npscr] [int] NULL,
	[w1stg] [varchar](5) NULL,
	[r2PRS_FSP] [int] NULL,
	[r2Fluency] [int] NULL,
	[r2Accuracy] [int] NULL,
	[r2GrFP] [varchar](2) NULL,
	[r2PassNum] [int] NULL,
	[r2FAIRpassage] [real] NULL,
	[r2TarPassNum] [int] NULL,
	[r2CompExplicit] [int] NULL,
	[r2CompImplicit] [int] NULL,
	[r2SpellRawScore] [int] NULL,
	[r2SpellPercentile] [int] NULL,
	[r2RCPercentile] [int] NULL,
	[r2RCStandScore] [int] NULL,
	[r2RCAbilityScore] [int] NULL,
	[r2RCLexile] [int] NULL,
	[r2WP] [int] NULL,
	[r2MI] [int] NULL,
	[r2CC] [int] NULL,
	[r2RR] [int] NULL,
	[r2MazePercentile] [int] NULL,
	[r2MazeStandScore] [int] NULL,
	[r2AdjMazeScore] [int] NULL,
	[r2WAPercentile] [int] NULL,
	[r2WAStandScore] [int] NULL,
	[r2WAAbility] [int] NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[r3PRS_FSP] [int] NULL,
	[r3Fluency] [int] NULL,
	[r3Accuracy] [int] NULL,
	[r3GrFP] [varchar](2) NULL,
	[r3PassNum] [int] NULL,
	[r3FAIRpassage] [real] NULL,
	[r3TarPassNum] [int] NULL,
	[r3CompExplicit] [int] NULL,
	[r3CompImplicit] [int] NULL,
	[r3VocabRawScore] [int] NULL,
	[r3VocabPercentile] [int] NULL,
	[r3SpellRawScore] [int] NULL,
	[r3SpellPercentile] [int] NULL,
	[r3RCPercentile] [int] NULL,
	[r3RCStandScore] [int] NULL,
	[r3RCAbilityScore] [int] NULL,
	[r3RCLexile] [int] NULL,
	[r3WP] [int] NULL,
	[r3MI] [int] NULL,
	[r3CC] [int] NULL,
	[r3RR] [int] NULL,
	[r3MazePercentile] [int] NULL,
	[r3MazeStandScore] [int] NULL,
	[r3AdjMazeScore] [int] NULL,
	[r3WAPercentile] [int] NULL,
	[r3WAStandScore] [int] NULL,
	[r3WAAbility] [int] NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](2) NULL,
	[g5grade2] [varchar](2) NULL,
	[g5grade3] [varchar](2) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Pattern] [varchar](10) NULL,
	[m1_Shapes] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [int] NULL,
	[ms1_Large] [int] NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [int] NULL,
	[ms2_Large] [int] NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_AddSub] [varchar](10) NULL,
	[ms3_Fine] [int] NULL,
	[ms3_Large] [int] NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[b3_ReadingLevel] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[r1_FAIR_LetterSound] [int] NULL,
	[r2_FAIR_LetterSound] [int] NULL,
	[r3_FAIR_LetterSound] [int] NULL,
	[r1_PhonBlend] [int] NULL,
	[r2_PhonBlend] [int] NULL,
	[r3_PhonBlend] [int] NULL,
	[r1_PhonDelete] [int] NULL,
	[r2_PhonDelete] [int] NULL,
	[r3_PhonDelete] [int] NULL,
	[r1_LetterSoundInitial] [int] NULL,
	[r2_LetterSoundInitial] [int] NULL,
	[r3_LetterSoundInitial] [int] NULL,
	[r1_LetterSoundFinal] [int] NULL,
	[r2_LetterSoundFinal] [int] NULL,
	[r3_LetterSoundFinal] [int] NULL,
	[r1_WordBldInitial] [int] NULL,
	[r2_WordBldInitial] [int] NULL,
	[r3_WordBldInitial] [int] NULL,
	[r1_WordBldFinal] [int] NULL,
	[r2_WordBldFinal] [int] NULL,
	[r3_WordBldFinal] [int] NULL,
	[r1_WordBldMedial] [int] NULL,
	[r2_WordBldMedial] [int] NULL,
	[r3_WordBldMedial] [int] NULL,
	[FMP_updated] [datetime] NULL,
	[w1Perf] [varchar](10) NULL,
	[w2Perf] [varchar](10) NULL,
	[r1_RunRec] [varchar](10) NULL,
	[r2_RunRec] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
 CONSTRAINT [PK_PIAP12] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP13]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP13](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1PRS_FSP] [int] NULL,
	[r1Fluency] [int] NULL,
	[r1Accuracy] [int] NULL,
	[r1GrFP] [varchar](2) NULL,
	[r1PassNum] [int] NULL,
	[r1FAIRpassage] [real] NULL,
	[r1TarPassNum] [int] NULL,
	[r1CompExplicit] [int] NULL,
	[r1CompImplicit] [int] NULL,
	[r1VocabRawScore] [int] NULL,
	[r1VocabPercentile] [int] NULL,
	[r1SpellRawScore] [int] NULL,
	[r1SpellPercentile] [int] NULL,
	[r1RCPercentile] [int] NULL,
	[r1RCStandScore] [int] NULL,
	[r1RCAbilityScore] [int] NULL,
	[r1RCLexile] [int] NULL,
	[r1WP] [int] NULL,
	[r1MI] [int] NULL,
	[r1CC] [int] NULL,
	[r1RR] [int] NULL,
	[r1MazePercentile] [int] NULL,
	[r1MazeStandScore] [int] NULL,
	[r1AdjMazeScore] [int] NULL,
	[r1WAPercentile] [int] NULL,
	[r1WAStandScore] [int] NULL,
	[r1WAAbility] [int] NULL,
	[m1Perf] [varchar](10) NULL,
	[s1Perf] [varchar](10) NULL,
	[w1escr] [int] NULL,
	[w1npscr] [int] NULL,
	[w1stg] [varchar](5) NULL,
	[r2PRS_FSP] [int] NULL,
	[r2Fluency] [int] NULL,
	[r2Accuracy] [int] NULL,
	[r2GrFP] [varchar](2) NULL,
	[r2PassNum] [int] NULL,
	[r2FAIRpassage] [real] NULL,
	[r2TarPassNum] [int] NULL,
	[r2CompExplicit] [int] NULL,
	[r2CompImplicit] [int] NULL,
	[r2SpellRawScore] [int] NULL,
	[r2SpellPercentile] [int] NULL,
	[r2RCPercentile] [int] NULL,
	[r2RCStandScore] [int] NULL,
	[r2RCAbilityScore] [int] NULL,
	[r2RCLexile] [int] NULL,
	[r2WP] [int] NULL,
	[r2MI] [int] NULL,
	[r2CC] [int] NULL,
	[r2RR] [int] NULL,
	[r2MazePercentile] [int] NULL,
	[r2MazeStandScore] [int] NULL,
	[r2AdjMazeScore] [int] NULL,
	[r2WAPercentile] [int] NULL,
	[r2WAStandScore] [int] NULL,
	[r2WAAbility] [int] NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[r3PRS_FSP] [int] NULL,
	[r3Fluency] [int] NULL,
	[r3Accuracy] [int] NULL,
	[r3GrFP] [varchar](2) NULL,
	[r3PassNum] [int] NULL,
	[r3FAIRpassage] [real] NULL,
	[r3TarPassNum] [int] NULL,
	[r3CompExplicit] [int] NULL,
	[r3CompImplicit] [int] NULL,
	[r3VocabRawScore] [int] NULL,
	[r3VocabPercentile] [int] NULL,
	[r3SpellRawScore] [int] NULL,
	[r3SpellPercentile] [int] NULL,
	[r3RCPercentile] [int] NULL,
	[r3RCStandScore] [int] NULL,
	[r3RCAbilityScore] [int] NULL,
	[r3RCLexile] [int] NULL,
	[r3WP] [int] NULL,
	[r3MI] [int] NULL,
	[r3CC] [int] NULL,
	[r3RR] [int] NULL,
	[r3MazePercentile] [int] NULL,
	[r3MazeStandScore] [int] NULL,
	[r3AdjMazeScore] [int] NULL,
	[r3WAPercentile] [int] NULL,
	[r3WAStandScore] [int] NULL,
	[r3WAAbility] [int] NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](2) NULL,
	[g5grade2] [varchar](2) NULL,
	[g5grade3] [varchar](2) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Pattern] [varchar](10) NULL,
	[m1_Shapes] [varchar](10) NULL,
	[m1_Comparing] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [varchar](10) NULL,
	[ms1_Large] [varchar](10) NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_Concept] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [varchar](10) NULL,
	[ms2_Large] [varchar](10) NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_Concept] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_AddSub] [varchar](10) NULL,
	[ms3_Fine] [varchar](10) NULL,
	[ms3_Large] [varchar](10) NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[b3_ReadingLevel] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[FMP_updated] [datetime] NULL,
	[w1Perf] [varchar](10) NULL,
	[w2Perf] [varchar](10) NULL,
	[r1_RunRec] [varchar](10) NULL,
	[r2_RunRec] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
	[la1_module] [int] NULL,
	[la2_module] [int] NULL,
	[la3_module] [int] NULL,
	[w3Perf] [varchar](10) NULL,
	[r1_PhonoAware] [varchar](10) NULL,
	[r2_PhonoAware] [varchar](10) NULL,
	[r3_PhonoAware] [varchar](10) NULL,
	[r1_MainTopic] [varchar](10) NULL,
	[r2_MainTopic] [varchar](10) NULL,
	[r3_MainTopic] [varchar](10) NULL,
	[r1_GrammarUsage] [varchar](10) NULL,
	[r2_GrammarUsage] [varchar](10) NULL,
	[r3_GrammarUsage] [varchar](10) NULL,
	[r1_CollabConversation] [varchar](10) NULL,
	[r2_CollabConversation] [varchar](10) NULL,
	[r3_CollabConversation] [varchar](10) NULL,
	[r2_CapPuncSpell] [varchar](10) NULL,
	[r3_CapPuncSpell] [varchar](10) NULL,
	[b2_ReadingLevel] [varchar](10) NULL,
	[r2_Characters] [varchar](10) NULL,
	[r3_Characters] [varchar](10) NULL,
	[r3_SimilarDiff] [varchar](10) NULL,
	[w1_WritingOpinion] [varchar](10) NULL,
	[w2_WritingOpinion] [varchar](10) NULL,
	[w3_WritingOpinion] [varchar](10) NULL,
	[w2_WritingNarrate] [varchar](10) NULL,
	[w3_WritingNarrate] [varchar](10) NULL,
	[w3_WritingInfoExp] [varchar](10) NULL,
	[m1_CompShapes] [varchar](10) NULL,
	[m2_CompShapes] [varchar](10) NULL,
	[m3_CompShapes] [varchar](10) NULL,
	[m1_CountForward] [varchar](10) NULL,
	[m2_CountForward] [varchar](10) NULL,
	[m3_CountForward] [varchar](10) NULL,
	[m1_ObjectsNumerals] [varchar](10) NULL,
	[m2_ObjectsNumerals] [varchar](10) NULL,
	[m3_ObjectsNumerals] [varchar](10) NULL,
	[m1_Groups] [varchar](10) NULL,
	[m2_Groups] [varchar](10) NULL,
	[m3_Groups] [varchar](10) NULL,
	[m2_Numbers] [varchar](10) NULL,
	[m3_Numbers] [varchar](10) NULL,
	[m3_Decompose] [varchar](10) NULL,
	[s1_Science] [varchar](10) NULL,
	[s2_Science] [varchar](10) NULL,
	[s3_Science] [varchar](10) NULL,
	[s1_SocialStudies] [varchar](10) NULL,
	[s2_SocialStudies] [varchar](10) NULL,
	[s3_SocialStudies] [varchar](10) NULL,
	[s1_Collaborates] [varchar](10) NULL,
	[s2_Collaborates] [varchar](10) NULL,
	[s3_Collaborates] [varchar](10) NULL,
	[s1_Senses] [varchar](10) NULL,
	[s2_Senses] [varchar](10) NULL,
	[s3_Senses] [varchar](10) NULL,
	[s1_Investigates] [varchar](10) NULL,
	[s2_Investigates] [varchar](10) NULL,
	[s3_Investigates] [varchar](10) NULL,
	[s1_VisualRep] [varchar](10) NULL,
	[s2_VisualRep] [varchar](10) NULL,
	[s3_VisualRep] [varchar](10) NULL,
	[s1_Recognizes] [varchar](10) NULL,
	[s2_Recognizes] [varchar](10) NULL,
	[s3_Recognizes] [varchar](10) NULL,
	[m1_Concept] [varchar](10) NULL,
 CONSTRAINT [PK_PIAP13] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP14]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP14](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1PLS] [real] NULL,
	[r1Fluency] [int] NULL,
	[r1Accuracy] [int] NULL,
	[r1GrFP] [varchar](2) NULL,
	[r1PassNum] [int] NULL,
	[r1FAIRpassage] [real] NULL,
	[r1TarPassNum] [int] NULL,
	[r1CompExplicit] [int] NULL,
	[r1CompImplicit] [int] NULL,
	[r1VocabRawScore] [int] NULL,
	[r1VocabPercentile] [int] NULL,
	[r1SpellRawScore] [int] NULL,
	[r1SpellPercentile] [int] NULL,
	[r1RCPercentile] [int] NULL,
	[r1RCStandScore] [int] NULL,
	[r1RCAbilityScore] [int] NULL,
	[r1RCLexile] [int] NULL,
	[r1WP] [int] NULL,
	[r1MI] [int] NULL,
	[r1CC] [int] NULL,
	[r1RR] [int] NULL,
	[r1MazePercentile] [int] NULL,
	[r1MazeStandScore] [int] NULL,
	[r1AdjMazeScore] [int] NULL,
	[r1WAPercentile] [int] NULL,
	[r1WAStandScore] [int] NULL,
	[r1WAAbility] [int] NULL,
	[m1Perf] [varchar](10) NULL,
	[s1Perf] [varchar](10) NULL,
	[w1escr] [int] NULL,
	[w1npscr] [int] NULL,
	[w1stg] [varchar](5) NULL,
	[r2PLS] [real] NULL,
	[r2Fluency] [int] NULL,
	[r2Accuracy] [int] NULL,
	[r2GrFP] [varchar](2) NULL,
	[r2PassNum] [int] NULL,
	[r2FAIRpassage] [real] NULL,
	[r2TarPassNum] [int] NULL,
	[r2CompExplicit] [int] NULL,
	[r2CompImplicit] [int] NULL,
	[r2SpellRawScore] [int] NULL,
	[r2SpellPercentile] [int] NULL,
	[r2RCPercentile] [int] NULL,
	[r2RCStandScore] [int] NULL,
	[r2RCAbilityScore] [int] NULL,
	[r2RCLexile] [int] NULL,
	[r2WP] [int] NULL,
	[r2MI] [int] NULL,
	[r2CC] [int] NULL,
	[r2RR] [int] NULL,
	[r2MazePercentile] [int] NULL,
	[r2MazeStandScore] [int] NULL,
	[r2AdjMazeScore] [int] NULL,
	[r2WAPercentile] [int] NULL,
	[r2WAStandScore] [int] NULL,
	[r2WAAbility] [int] NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[r3PLS] [real] NULL,
	[r3Fluency] [int] NULL,
	[r3Accuracy] [int] NULL,
	[r3GrFP] [varchar](2) NULL,
	[r3PassNum] [int] NULL,
	[r3FAIRpassage] [real] NULL,
	[r3TarPassNum] [int] NULL,
	[r3CompExplicit] [int] NULL,
	[r3CompImplicit] [int] NULL,
	[r3VocabRawScore] [int] NULL,
	[r3VocabPercentile] [int] NULL,
	[r3SpellRawScore] [int] NULL,
	[r3SpellPercentile] [int] NULL,
	[r3RCPercentile] [int] NULL,
	[r3RCStandScore] [int] NULL,
	[r3RCAbilityScore] [int] NULL,
	[r3RCLexile] [int] NULL,
	[r3WP] [int] NULL,
	[r3MI] [int] NULL,
	[r3CC] [int] NULL,
	[r3RR] [int] NULL,
	[r3MazePercentile] [int] NULL,
	[r3MazeStandScore] [int] NULL,
	[r3AdjMazeScore] [int] NULL,
	[r3WAPercentile] [int] NULL,
	[r3WAStandScore] [int] NULL,
	[r3WAAbility] [int] NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](2) NULL,
	[g5grade2] [varchar](2) NULL,
	[g5grade3] [varchar](2) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Pattern] [varchar](10) NULL,
	[m1_Shapes] [varchar](10) NULL,
	[m1_Comparing] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [varchar](10) NULL,
	[ms1_Large] [varchar](10) NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_Concept] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [varchar](10) NULL,
	[ms2_Large] [varchar](10) NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_Concept] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_AddSub] [varchar](10) NULL,
	[ms3_Fine] [varchar](10) NULL,
	[ms3_Large] [varchar](10) NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[b3_ReadingLevel] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[FMP_updated] [datetime] NULL,
	[w1Perf] [varchar](10) NULL,
	[w2Perf] [varchar](10) NULL,
	[r1_RunRec] [varchar](10) NULL,
	[r2_RunRec] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
	[la1_module] [int] NULL,
	[la2_module] [int] NULL,
	[la3_module] [int] NULL,
	[w3Perf] [varchar](10) NULL,
	[r1_DrawDictWri] [varchar](10) NULL,
	[r2_DrawDictWri] [varchar](10) NULL,
	[r3_DrawDictWri] [varchar](10) NULL,
	[r1_MainTopic] [varchar](10) NULL,
	[r2_MainTopic] [varchar](10) NULL,
	[r3_MainTopic] [varchar](10) NULL,
	[r1_GrammarUsage] [varchar](10) NULL,
	[r2_GrammarUsage] [varchar](10) NULL,
	[r3_GrammarUsage] [varchar](10) NULL,
	[r1_CollabConversation] [varchar](10) NULL,
	[r2_CollabConversation] [varchar](10) NULL,
	[r3_CollabConversation] [varchar](10) NULL,
	[r2_CapPuncSpell] [varchar](10) NULL,
	[r3_CapPuncSpell] [varchar](10) NULL,
	[b2_ReadingLevel] [varchar](10) NULL,
	[r2_Characters] [varchar](10) NULL,
	[r3_Characters] [varchar](10) NULL,
	[r3_SimilarDiff] [varchar](10) NULL,
	[w1_WritingOpinion] [varchar](10) NULL,
	[w2_WritingOpinion] [varchar](10) NULL,
	[w3_WritingOpinion] [varchar](10) NULL,
	[w2_WritingNarrate] [varchar](10) NULL,
	[w3_WritingNarrate] [varchar](10) NULL,
	[w3_WritingInfoExp] [varchar](10) NULL,
	[m1_CompShapes] [varchar](10) NULL,
	[m2_CompShapes] [varchar](10) NULL,
	[m3_CompShapes] [varchar](10) NULL,
	[m1_CountForward] [varchar](10) NULL,
	[m2_CountForward] [varchar](10) NULL,
	[m3_CountForward] [varchar](10) NULL,
	[m1_ObjectsNumerals] [varchar](10) NULL,
	[m2_ObjectsNumerals] [varchar](10) NULL,
	[m3_ObjectsNumerals] [varchar](10) NULL,
	[m1_Groups] [varchar](10) NULL,
	[m2_Groups] [varchar](10) NULL,
	[m3_Groups] [varchar](10) NULL,
	[m3_Numbers] [varchar](10) NULL,
	[m4_Numbers] [varchar](10) NULL,
	[m3_Decompose] [varchar](10) NULL,
	[s1_Science] [varchar](10) NULL,
	[s2_Science] [varchar](10) NULL,
	[s3_Science] [varchar](10) NULL,
	[s1_SocialStudies] [varchar](10) NULL,
	[s2_SocialStudies] [varchar](10) NULL,
	[s3_SocialStudies] [varchar](10) NULL,
	[s1_Collaborates] [varchar](10) NULL,
	[s2_Collaborates] [varchar](10) NULL,
	[s3_Collaborates] [varchar](10) NULL,
	[s1_Senses] [varchar](10) NULL,
	[s2_Senses] [varchar](10) NULL,
	[s3_Senses] [varchar](10) NULL,
	[s1_Investigates] [varchar](10) NULL,
	[s2_Investigates] [varchar](10) NULL,
	[s3_Investigates] [varchar](10) NULL,
	[s1_VisualRep] [varchar](10) NULL,
	[s2_VisualRep] [varchar](10) NULL,
	[s3_VisualRep] [varchar](10) NULL,
	[s1_Recognizes] [varchar](10) NULL,
	[s2_Recognizes] [varchar](10) NULL,
	[s3_Recognizes] [varchar](10) NULL,
	[m1_Concept] [varchar](10) NULL,
	[f1_PLS] [int] NULL,
	[f1_MTF] [int] NULL,
	[f1_WRT_AS] [int] NULL,
	[f1_WRT_P] [int] NULL,
	[f1_VKT_AS] [int] NULL,
	[f1_VKT_P] [int] NULL,
	[f1_RCT_AS] [int] NULL,
	[f1_RCT_P] [int] NULL,
	[f1_SKT_AS] [int] NULL,
	[f1_SKT_P] [int] NULL,
	[f2_PLS] [int] NULL,
	[f2_MTF] [int] NULL,
	[f2_WRT_AS] [int] NULL,
	[f2_WRT_P] [int] NULL,
	[f2_VKT_AS] [int] NULL,
	[f2_VKT_P] [int] NULL,
	[f2_RCT_AS] [int] NULL,
	[f2_RCT_P] [int] NULL,
	[f2_SKT_AS] [int] NULL,
	[f2_SKT_P] [int] NULL,
	[f3_PLS] [int] NULL,
	[f3_MTF] [int] NULL,
	[f3_WRT_AS] [int] NULL,
	[f3_WRT_P] [int] NULL,
	[f3_VKT_AS] [int] NULL,
	[f3_VKT_P] [int] NULL,
	[f3_RCT_AS] [int] NULL,
	[f3_RCT_P] [int] NULL,
	[f3_SKT_AS] [int] NULL,
	[f3_SKT_P] [int] NULL,
	[r4_Story] [int] NULL,
	[r4_Print] [int] NULL,
	[r4_MainTopic] [int] NULL,
	[r4_LetterNaming] [int] NULL,
	[r4_LetterSounds] [int] NULL,
	[r4_SightWords] [int] NULL,
	[b4_ReadingLevel] [int] NULL,
	[r4_DrawDictWri] [int] NULL,
	[r4_CollabConversation] [int] NULL,
	[m4_Shapes] [int] NULL,
	[m4_CompShapes] [int] NULL,
	[m4_CountForward] [int] NULL,
	[m4_ObjectsNumerals] [int] NULL,
	[m4_Concept] [int] NULL,
	[m4_Groups] [int] NULL,
	[m4_AddSub] [int] NULL,
	[s4_Science] [varchar](10) NULL,
	[s4_SocialStudies] [varchar](10) NULL,
 CONSTRAINT [PK_PIAP14] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP15]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP15](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1PLS] [real] NULL,
	[r1Fluency] [int] NULL,
	[r1Accuracy] [int] NULL,
	[r1GrFP] [varchar](2) NULL,
	[r1PassNum] [int] NULL,
	[r1FAIRpassage] [real] NULL,
	[r1TarPassNum] [int] NULL,
	[r1CompExplicit] [int] NULL,
	[r1CompImplicit] [int] NULL,
	[r1VocabRawScore] [int] NULL,
	[r1VocabPercentile] [int] NULL,
	[r1SpellRawScore] [int] NULL,
	[r1SpellPercentile] [int] NULL,
	[r1RCPercentile] [int] NULL,
	[r1RCStandScore] [int] NULL,
	[r1RCAbilityScore] [int] NULL,
	[r1RCLexile] [int] NULL,
	[r1WP] [int] NULL,
	[r1MI] [int] NULL,
	[r1CC] [int] NULL,
	[r1RR] [int] NULL,
	[r1MazePercentile] [int] NULL,
	[r1MazeStandScore] [int] NULL,
	[r1AdjMazeScore] [int] NULL,
	[r1WAPercentile] [int] NULL,
	[r1WAStandScore] [int] NULL,
	[r1WAAbility] [int] NULL,
	[m1Perf] [varchar](10) NULL,
	[s1Perf] [varchar](10) NULL,
	[w1escr] [int] NULL,
	[w1npscr] [int] NULL,
	[w1stg] [varchar](5) NULL,
	[r2PLS] [real] NULL,
	[r2Fluency] [int] NULL,
	[r2Accuracy] [int] NULL,
	[r2GrFP] [varchar](2) NULL,
	[r2PassNum] [int] NULL,
	[r2FAIRpassage] [real] NULL,
	[r2TarPassNum] [int] NULL,
	[r2CompExplicit] [int] NULL,
	[r2CompImplicit] [int] NULL,
	[r2SpellRawScore] [int] NULL,
	[r2SpellPercentile] [int] NULL,
	[r2RCPercentile] [int] NULL,
	[r2RCStandScore] [int] NULL,
	[r2RCAbilityScore] [int] NULL,
	[r2RCLexile] [int] NULL,
	[r2WP] [int] NULL,
	[r2MI] [int] NULL,
	[r2CC] [int] NULL,
	[r2RR] [int] NULL,
	[r2MazePercentile] [int] NULL,
	[r2MazeStandScore] [int] NULL,
	[r2AdjMazeScore] [int] NULL,
	[r2WAPercentile] [int] NULL,
	[r2WAStandScore] [int] NULL,
	[r2WAAbility] [int] NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[r3PLS] [real] NULL,
	[r3Fluency] [int] NULL,
	[r3Accuracy] [int] NULL,
	[r3GrFP] [varchar](2) NULL,
	[r3PassNum] [int] NULL,
	[r3FAIRpassage] [real] NULL,
	[r3TarPassNum] [int] NULL,
	[r3CompExplicit] [int] NULL,
	[r3CompImplicit] [int] NULL,
	[r3VocabRawScore] [int] NULL,
	[r3VocabPercentile] [int] NULL,
	[r3SpellRawScore] [int] NULL,
	[r3SpellPercentile] [int] NULL,
	[r3RCPercentile] [int] NULL,
	[r3RCStandScore] [int] NULL,
	[r3RCAbilityScore] [int] NULL,
	[r3RCLexile] [int] NULL,
	[r3WP] [int] NULL,
	[r3MI] [int] NULL,
	[r3CC] [int] NULL,
	[r3RR] [int] NULL,
	[r3MazePercentile] [int] NULL,
	[r3MazeStandScore] [int] NULL,
	[r3AdjMazeScore] [int] NULL,
	[r3WAPercentile] [int] NULL,
	[r3WAStandScore] [int] NULL,
	[r3WAAbility] [int] NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](2) NULL,
	[g5grade2] [varchar](2) NULL,
	[g5grade3] [varchar](2) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Pattern] [varchar](10) NULL,
	[m1_Shapes] [varchar](10) NULL,
	[m1_Comparing] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [varchar](10) NULL,
	[ms1_Large] [varchar](10) NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_Concept] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [varchar](10) NULL,
	[ms2_Large] [varchar](10) NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_Concept] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_AddSub] [varchar](10) NULL,
	[ms3_Fine] [varchar](10) NULL,
	[ms3_Large] [varchar](10) NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[b3_ReadingLevel] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[FMP_updated] [datetime] NULL,
	[w1Perf] [varchar](10) NULL,
	[w2Perf] [varchar](10) NULL,
	[r1_RunRec] [varchar](10) NULL,
	[r2_RunRec] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
	[la1_module] [int] NULL,
	[la2_module] [int] NULL,
	[la3_module] [int] NULL,
	[w3Perf] [varchar](10) NULL,
	[r1_DrawDictWri] [varchar](10) NULL,
	[r2_DrawDictWri] [varchar](10) NULL,
	[r3_DrawDictWri] [varchar](10) NULL,
	[r1_MainTopic] [varchar](10) NULL,
	[r2_MainTopic] [varchar](10) NULL,
	[r3_MainTopic] [varchar](10) NULL,
	[r1_GrammarUsage] [varchar](10) NULL,
	[r2_GrammarUsage] [varchar](10) NULL,
	[r3_GrammarUsage] [varchar](10) NULL,
	[r1_CollabConversation] [varchar](10) NULL,
	[r2_CollabConversation] [varchar](10) NULL,
	[r3_CollabConversation] [varchar](10) NULL,
	[r2_CapPuncSpell] [varchar](10) NULL,
	[r3_CapPuncSpell] [varchar](10) NULL,
	[b2_ReadingLevel] [varchar](10) NULL,
	[r2_Characters] [varchar](10) NULL,
	[r3_Characters] [varchar](10) NULL,
	[r3_SimilarDiff] [varchar](10) NULL,
	[w1_WritingOpinion] [varchar](10) NULL,
	[w2_WritingOpinion] [varchar](10) NULL,
	[w3_WritingOpinion] [varchar](10) NULL,
	[w2_WritingNarrate] [varchar](10) NULL,
	[w3_WritingNarrate] [varchar](10) NULL,
	[w3_WritingInfoExp] [varchar](10) NULL,
	[m1_CompShapes] [varchar](10) NULL,
	[m2_CompShapes] [varchar](10) NULL,
	[m3_CompShapes] [varchar](10) NULL,
	[m1_CountForward] [varchar](10) NULL,
	[m2_CountForward] [varchar](10) NULL,
	[m3_CountForward] [varchar](10) NULL,
	[m1_ObjectsNumerals] [varchar](10) NULL,
	[m2_ObjectsNumerals] [varchar](10) NULL,
	[m3_ObjectsNumerals] [varchar](10) NULL,
	[m1_Groups] [varchar](10) NULL,
	[m2_Groups] [varchar](10) NULL,
	[m3_Groups] [varchar](10) NULL,
	[m3_Numbers] [varchar](10) NULL,
	[m4_Numbers] [varchar](10) NULL,
	[m3_Decompose] [varchar](10) NULL,
	[s1_Science] [varchar](10) NULL,
	[s2_Science] [varchar](10) NULL,
	[s3_Science] [varchar](10) NULL,
	[s1_SocialStudies] [varchar](10) NULL,
	[s2_SocialStudies] [varchar](10) NULL,
	[s3_SocialStudies] [varchar](10) NULL,
	[s1_Collaborates] [varchar](10) NULL,
	[s2_Collaborates] [varchar](10) NULL,
	[s3_Collaborates] [varchar](10) NULL,
	[s1_Senses] [varchar](10) NULL,
	[s2_Senses] [varchar](10) NULL,
	[s3_Senses] [varchar](10) NULL,
	[s1_Investigates] [varchar](10) NULL,
	[s2_Investigates] [varchar](10) NULL,
	[s3_Investigates] [varchar](10) NULL,
	[s1_VisualRep] [varchar](10) NULL,
	[s2_VisualRep] [varchar](10) NULL,
	[s3_VisualRep] [varchar](10) NULL,
	[s1_Recognizes] [varchar](10) NULL,
	[s2_Recognizes] [varchar](10) NULL,
	[s3_Recognizes] [varchar](10) NULL,
	[m1_Concept] [varchar](10) NULL,
	[f1_PLS] [int] NULL,
	[f1_MTF] [int] NULL,
	[f1_WRT_AS] [int] NULL,
	[f1_WRT_P] [int] NULL,
	[f1_VKT_AS] [int] NULL,
	[f1_VKT_P] [int] NULL,
	[f1_RCT_AS] [int] NULL,
	[f1_RCT_P] [int] NULL,
	[f1_SKT_AS] [int] NULL,
	[f1_SKT_P] [int] NULL,
	[f2_PLS] [int] NULL,
	[f2_MTF] [int] NULL,
	[f2_WRT_AS] [int] NULL,
	[f2_WRT_P] [int] NULL,
	[f2_VKT_AS] [int] NULL,
	[f2_VKT_P] [int] NULL,
	[f2_RCT_AS] [int] NULL,
	[f2_RCT_P] [int] NULL,
	[f2_SKT_AS] [int] NULL,
	[f2_SKT_P] [int] NULL,
	[f3_PLS] [int] NULL,
	[f3_MTF] [int] NULL,
	[f3_WRT_AS] [int] NULL,
	[f3_WRT_P] [int] NULL,
	[f3_VKT_AS] [int] NULL,
	[f3_VKT_P] [int] NULL,
	[f3_RCT_AS] [int] NULL,
	[f3_RCT_P] [int] NULL,
	[f3_SKT_AS] [int] NULL,
	[f3_SKT_P] [int] NULL,
	[r4_Story] [varchar](10) NULL,
	[r4_Print] [varchar](10) NULL,
	[r4_MainTopic] [varchar](10) NULL,
	[r4_LetterNaming] [varchar](10) NULL,
	[r4_LetterSounds] [varchar](10) NULL,
	[r4_SightWords] [varchar](10) NULL,
	[b4_ReadingLevel] [varchar](10) NULL,
	[r4_DrawDictWri] [varchar](10) NULL,
	[r4_CollabConversation] [varchar](10) NULL,
	[m4_Shapes] [varchar](10) NULL,
	[m4_CompShapes] [varchar](10) NULL,
	[m4_CountForward] [varchar](10) NULL,
	[m4_ObjectsNumerals] [varchar](10) NULL,
	[m4_Concept] [varchar](10) NULL,
	[m4_Groups] [varchar](10) NULL,
	[m4_AddSub] [varchar](10) NULL,
	[s4_Science] [varchar](10) NULL,
	[s4_SocialStudies] [varchar](10) NULL,
	[ss1Perf] [varchar](10) NULL,
	[ss2Perf] [varchar](10) NULL,
	[ss3Perf] [varchar](10) NULL,
 CONSTRAINT [PK_PIAP_1] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP16]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP16](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](3) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](2) NULL,
	[g5grade2] [varchar](2) NULL,
	[g5grade3] [varchar](2) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Pattern] [varchar](10) NULL,
	[m1_Shapes] [varchar](10) NULL,
	[m1_Comparing] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [varchar](10) NULL,
	[ms1_Large] [varchar](10) NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_Concept] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [varchar](10) NULL,
	[ms2_Large] [varchar](10) NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_Concept] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_AddSub] [varchar](10) NULL,
	[ms3_Fine] [varchar](10) NULL,
	[ms3_Large] [varchar](10) NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[b3_ReadingLevel] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[FMP_updated] [datetime] NULL,
	[w1Perf] [varchar](10) NULL,
	[w2Perf] [varchar](10) NULL,
	[r1_RunRec] [varchar](10) NULL,
	[r2_RunRec] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
	[la1_module] [int] NULL,
	[la2_module] [int] NULL,
	[la3_module] [int] NULL,
	[w3Perf] [varchar](10) NULL,
	[r1_DrawDictWri] [varchar](10) NULL,
	[r2_DrawDictWri] [varchar](10) NULL,
	[r3_DrawDictWri] [varchar](10) NULL,
	[r1_MainTopic] [varchar](10) NULL,
	[r2_MainTopic] [varchar](10) NULL,
	[r3_MainTopic] [varchar](10) NULL,
	[r1_GrammarUsage] [varchar](10) NULL,
	[r2_GrammarUsage] [varchar](10) NULL,
	[r3_GrammarUsage] [varchar](10) NULL,
	[r1_CollabConversation] [varchar](10) NULL,
	[r2_CollabConversation] [varchar](10) NULL,
	[r3_CollabConversation] [varchar](10) NULL,
	[r2_CapPuncSpell] [varchar](10) NULL,
	[r3_CapPuncSpell] [varchar](10) NULL,
	[b2_ReadingLevel] [varchar](10) NULL,
	[r2_Characters] [varchar](10) NULL,
	[r3_Characters] [varchar](10) NULL,
	[r3_SimilarDiff] [varchar](10) NULL,
	[w1_WritingOpinion] [varchar](10) NULL,
	[w2_WritingOpinion] [varchar](10) NULL,
	[w3_WritingOpinion] [varchar](10) NULL,
	[w2_WritingNarrate] [varchar](10) NULL,
	[w3_WritingNarrate] [varchar](10) NULL,
	[w3_WritingInfoExp] [varchar](10) NULL,
	[m1_CompShapes] [varchar](10) NULL,
	[m2_CompShapes] [varchar](10) NULL,
	[m3_CompShapes] [varchar](10) NULL,
	[m1_CountForward] [varchar](10) NULL,
	[m2_CountForward] [varchar](10) NULL,
	[m3_CountForward] [varchar](10) NULL,
	[m1_ObjectsNumerals] [varchar](10) NULL,
	[m2_ObjectsNumerals] [varchar](10) NULL,
	[m3_ObjectsNumerals] [varchar](10) NULL,
	[m1_Groups] [varchar](10) NULL,
	[m2_Groups] [varchar](10) NULL,
	[m3_Groups] [varchar](10) NULL,
	[m3_Numbers] [varchar](10) NULL,
	[m4_Numbers] [varchar](10) NULL,
	[m3_Decompose] [varchar](10) NULL,
	[s1_Science] [varchar](10) NULL,
	[s2_Science] [varchar](10) NULL,
	[s3_Science] [varchar](10) NULL,
	[s1_SocialStudies] [varchar](10) NULL,
	[s2_SocialStudies] [varchar](10) NULL,
	[s3_SocialStudies] [varchar](10) NULL,
	[s1_Collaborates] [varchar](10) NULL,
	[s2_Collaborates] [varchar](10) NULL,
	[s3_Collaborates] [varchar](10) NULL,
	[s1_Senses] [varchar](10) NULL,
	[s2_Senses] [varchar](10) NULL,
	[s3_Senses] [varchar](10) NULL,
	[s1_Investigates] [varchar](10) NULL,
	[s2_Investigates] [varchar](10) NULL,
	[s3_Investigates] [varchar](10) NULL,
	[s1_VisualRep] [varchar](10) NULL,
	[s2_VisualRep] [varchar](10) NULL,
	[s3_VisualRep] [varchar](10) NULL,
	[s1_Recognizes] [varchar](10) NULL,
	[s2_Recognizes] [varchar](10) NULL,
	[s3_Recognizes] [varchar](10) NULL,
	[m1_Concept] [varchar](10) NULL,
	[r4_Story] [varchar](10) NULL,
	[r4_Print] [varchar](10) NULL,
	[r4_MainTopic] [varchar](10) NULL,
	[r4_LetterNaming] [varchar](10) NULL,
	[r4_LetterSounds] [varchar](10) NULL,
	[r4_SightWords] [varchar](10) NULL,
	[b4_ReadingLevel] [varchar](10) NULL,
	[r4_DrawDictWri] [varchar](10) NULL,
	[r4_CollabConversation] [varchar](10) NULL,
	[m4_Shapes] [varchar](10) NULL,
	[m4_CompShapes] [varchar](10) NULL,
	[m4_CountForward] [varchar](10) NULL,
	[m4_ObjectsNumerals] [varchar](10) NULL,
	[m4_Concept] [varchar](10) NULL,
	[m4_Groups] [varchar](10) NULL,
	[m4_AddSub] [varchar](10) NULL,
	[s4_Science] [varchar](10) NULL,
	[s4_SocialStudies] [varchar](10) NULL,
	[ss1Perf] [varchar](10) NULL,
	[ss2Perf] [varchar](10) NULL,
	[ss3Perf] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[iStation_isip_april] [int] NULL,
	[iStation_overall_april] [varchar](50) NULL,
 CONSTRAINT [PK_PIAP16] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP17]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP17](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](2) NULL,
	[g5grade2] [varchar](2) NULL,
	[g5grade3] [varchar](2) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Pattern] [varchar](10) NULL,
	[m1_Shapes] [varchar](10) NULL,
	[m1_Comparing] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [varchar](10) NULL,
	[ms1_Large] [varchar](10) NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_Concept] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[ms2_Fine] [varchar](10) NULL,
	[ms2_Large] [varchar](10) NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_Concept] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_AddSub] [varchar](10) NULL,
	[ms3_Fine] [varchar](10) NULL,
	[ms3_Large] [varchar](10) NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[b3_ReadingLevel] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[FMP_updated] [datetime] NULL,
	[w1Perf] [varchar](10) NULL,
	[w2Perf] [varchar](10) NULL,
	[r1_RunRec] [varchar](10) NULL,
	[r2_RunRec] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
	[la1_module] [int] NULL,
	[la2_module] [int] NULL,
	[la3_module] [int] NULL,
	[w3Perf] [varchar](10) NULL,
	[r1_DrawDictWri] [varchar](10) NULL,
	[r2_DrawDictWri] [varchar](10) NULL,
	[r3_DrawDictWri] [varchar](10) NULL,
	[r1_MainTopic] [varchar](10) NULL,
	[r2_MainTopic] [varchar](10) NULL,
	[r3_MainTopic] [varchar](10) NULL,
	[r1_GrammarUsage] [varchar](10) NULL,
	[r2_GrammarUsage] [varchar](10) NULL,
	[r3_GrammarUsage] [varchar](10) NULL,
	[r1_CollabConversation] [varchar](10) NULL,
	[r2_CollabConversation] [varchar](10) NULL,
	[r3_CollabConversation] [varchar](10) NULL,
	[r2_CapPuncSpell] [varchar](10) NULL,
	[r3_CapPuncSpell] [varchar](10) NULL,
	[b2_ReadingLevel] [varchar](10) NULL,
	[r2_Characters] [varchar](10) NULL,
	[r3_Characters] [varchar](10) NULL,
	[r3_SimilarDiff] [varchar](10) NULL,
	[w1_WritingOpinion] [varchar](10) NULL,
	[w2_WritingOpinion] [varchar](10) NULL,
	[w3_WritingOpinion] [varchar](10) NULL,
	[w2_WritingNarrate] [varchar](10) NULL,
	[w3_WritingNarrate] [varchar](10) NULL,
	[w3_WritingInfoExp] [varchar](10) NULL,
	[m1_CompShapes] [varchar](10) NULL,
	[m2_CompShapes] [varchar](10) NULL,
	[m3_CompShapes] [varchar](10) NULL,
	[m1_CountForward] [varchar](10) NULL,
	[m2_CountForward] [varchar](10) NULL,
	[m3_CountForward] [varchar](10) NULL,
	[m1_ObjectsNumerals] [varchar](10) NULL,
	[m2_ObjectsNumerals] [varchar](10) NULL,
	[m3_ObjectsNumerals] [varchar](10) NULL,
	[m1_Groups] [varchar](10) NULL,
	[m2_Groups] [varchar](10) NULL,
	[m3_Groups] [varchar](10) NULL,
	[m3_Numbers] [varchar](10) NULL,
	[m4_Numbers] [varchar](10) NULL,
	[m3_Decompose] [varchar](10) NULL,
	[s1_Science] [varchar](10) NULL,
	[s2_Science] [varchar](10) NULL,
	[s3_Science] [varchar](10) NULL,
	[s1_SocialStudies] [varchar](10) NULL,
	[s2_SocialStudies] [varchar](10) NULL,
	[s3_SocialStudies] [varchar](10) NULL,
	[s1_Collaborates] [varchar](10) NULL,
	[s2_Collaborates] [varchar](10) NULL,
	[s3_Collaborates] [varchar](10) NULL,
	[s1_Senses] [varchar](10) NULL,
	[s2_Senses] [varchar](10) NULL,
	[s3_Senses] [varchar](10) NULL,
	[s1_Investigates] [varchar](10) NULL,
	[s2_Investigates] [varchar](10) NULL,
	[s3_Investigates] [varchar](10) NULL,
	[s1_VisualRep] [varchar](10) NULL,
	[s2_VisualRep] [varchar](10) NULL,
	[s3_VisualRep] [varchar](10) NULL,
	[s1_Recognizes] [varchar](10) NULL,
	[s2_Recognizes] [varchar](10) NULL,
	[s3_Recognizes] [varchar](10) NULL,
	[m1_Concept] [varchar](10) NULL,
	[r4_Story] [varchar](10) NULL,
	[r4_Print] [varchar](10) NULL,
	[r4_MainTopic] [varchar](10) NULL,
	[r4_LetterNaming] [varchar](10) NULL,
	[r4_LetterSounds] [varchar](10) NULL,
	[r4_SightWords] [varchar](10) NULL,
	[b4_ReadingLevel] [varchar](10) NULL,
	[r4_DrawDictWri] [varchar](10) NULL,
	[r4_CollabConversation] [varchar](10) NULL,
	[m4_Shapes] [varchar](10) NULL,
	[m4_CompShapes] [varchar](10) NULL,
	[m4_CountForward] [varchar](10) NULL,
	[m4_ObjectsNumerals] [varchar](10) NULL,
	[m4_Concept] [varchar](10) NULL,
	[m4_Groups] [varchar](10) NULL,
	[m4_AddSub] [varchar](10) NULL,
	[s4_Science] [varchar](10) NULL,
	[s4_SocialStudies] [varchar](10) NULL,
	[ss1Perf] [varchar](10) NULL,
	[ss2Perf] [varchar](10) NULL,
	[ss3Perf] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[iStation_isip_april] [int] NULL,
	[iStation_overall_april] [varchar](50) NULL,
	[r1isip] [varchar](50) NULL,
	[r2isip] [varchar](50) NULL,
	[r3isip] [varchar](50) NULL,
	[m1isip] [varchar](50) NULL,
	[m2isip] [varchar](50) NULL,
	[m3isip] [varchar](50) NULL,
	[s1isip] [varchar](50) NULL,
	[s2isip] [varchar](50) NULL,
	[s3isip] [varchar](50) NULL,
 CONSTRAINT [PK_PIAP17] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP18]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP18](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[m2Perf] [varchar](10) NULL,
	[s2Perf] [varchar](10) NULL,
	[w2escr] [int] NULL,
	[w2npscr] [int] NULL,
	[w2stg] [varchar](8) NULL,
	[m3Perf] [varchar](10) NULL,
	[s3Perf] [varchar](10) NULL,
	[w3escr] [int] NULL,
	[w3npscr] [int] NULL,
	[w3stg] [varchar](8) NULL,
	[g3SumBench] [int] NULL,
	[g3Code1] [varchar](1) NULL,
	[g3Code2] [varchar](1) NULL,
	[g3Code3] [varchar](1) NULL,
	[g3Code4] [varchar](1) NULL,
	[g3Code5] [varchar](1) NULL,
	[g3Code6] [varchar](1) NULL,
	[g3Except] [varchar](1) NULL,
	[g3Except_desc] [varchar](50) NULL,
	[g3pa7] [int] NULL,
	[g3pa8] [int] NULL,
	[g5paC] [int] NULL,
	[g5paD] [int] NULL,
	[g5paE] [int] NULL,
	[g5paF] [int] NULL,
	[g5paG] [int] NULL,
	[g5grade1] [varchar](2) NULL,
	[g5grade2] [varchar](2) NULL,
	[g5grade3] [varchar](2) NULL,
	[g5DevScr_fail] [varchar](1) NULL,
	[g5DevScr_pass] [varchar](1) NULL,
	[ab1_Mth] [varchar](10) NULL,
	[ab1_Rdg] [varchar](10) NULL,
	[ab1_Wrt] [varchar](10) NULL,
	[b1_Copes] [varchar](10) NULL,
	[b1_FollowRules] [varchar](10) NULL,
	[b1_ListDir] [varchar](10) NULL,
	[b1_Moves] [varchar](10) NULL,
	[b1_Participates] [varchar](10) NULL,
	[b1_Respects] [varchar](10) NULL,
	[b1_Responsibility] [varchar](10) NULL,
	[b1_SciSocStdHealth] [varchar](10) NULL,
	[b1_SelfConf] [varchar](10) NULL,
	[b1_Selects] [varchar](10) NULL,
	[b1_Shares] [varchar](10) NULL,
	[b1_UseOfTime] [varchar](10) NULL,
	[c1_Held] [varchar](3) NULL,
	[c1_Requested] [varchar](3) NULL,
	[ep1_IEP] [varchar](3) NULL,
	[ep1_PMP] [varchar](3) NULL,
	[lit1_AbsTardy] [varchar](3) NULL,
	[lit1_BehCond] [varchar](3) NULL,
	[m1_Pattern] [varchar](10) NULL,
	[m1_Shapes] [varchar](10) NULL,
	[m1_Comparing] [varchar](10) NULL,
	[m1_SortClass] [varchar](10) NULL,
	[ms1_Fine] [varchar](10) NULL,
	[ms1_Large] [varchar](10) NULL,
	[r1_LetterNaming] [varchar](10) NULL,
	[r1_Print] [varchar](10) NULL,
	[r1_Story] [varchar](10) NULL,
	[tc1_Comments] [varchar](800) NULL,
	[ab2_Mth] [varchar](10) NULL,
	[ab2_Rdg] [varchar](10) NULL,
	[ab2_Wrt] [varchar](10) NULL,
	[b2_Copes] [varchar](10) NULL,
	[b2_FollowRules] [varchar](10) NULL,
	[b2_ListDir] [varchar](10) NULL,
	[b2_Moves] [varchar](10) NULL,
	[b2_Participates] [varchar](10) NULL,
	[b2_Respects] [varchar](10) NULL,
	[b2_Responsibility] [varchar](10) NULL,
	[b2_SciSocStdHealth] [varchar](10) NULL,
	[b2_SelfConf] [varchar](10) NULL,
	[b2_Selects] [varchar](10) NULL,
	[b2_Shares] [varchar](10) NULL,
	[b2_UseOfTime] [varchar](10) NULL,
	[c2_Held] [varchar](3) NULL,
	[c2_Requested] [varchar](3) NULL,
	[ep2_IEP] [varchar](3) NULL,
	[ep2_PMP] [varchar](3) NULL,
	[lit2_AbsTardy] [varchar](3) NULL,
	[lit2_BehCond] [varchar](3) NULL,
	[m2_Shapes] [varchar](10) NULL,
	[m2_SortClass] [varchar](10) NULL,
	[m2_Pattern] [varchar](10) NULL,
	[m2_Measure] [varchar](10) NULL,
	[m2_Comparing] [varchar](10) NULL,
	[m2_Concept] [varchar](10) NULL,
	[m2_CountSets] [varchar](10) NULL,
	[m2_Match] [varchar](10) NULL,
	[m2_WrtNum] [varchar](10) NULL,
	[m2_AddSub] [varchar](10) NULL,
	[ms2_Fine] [varchar](10) NULL,
	[ms2_Large] [varchar](10) NULL,
	[r2_LetterNaming] [varchar](10) NULL,
	[r2_LetterSounds] [varchar](10) NULL,
	[r2_Print] [varchar](10) NULL,
	[r2_Story] [varchar](10) NULL,
	[r2_SightWords] [varchar](10) NULL,
	[tc2_Comments] [varchar](800) NULL,
	[ab3_Mth] [varchar](10) NULL,
	[ab3_Rdg] [varchar](10) NULL,
	[ab3_Wrt] [varchar](10) NULL,
	[b3_Copes] [varchar](10) NULL,
	[b3_FollowRules] [varchar](10) NULL,
	[b3_ListDir] [varchar](10) NULL,
	[b3_Moves] [varchar](10) NULL,
	[b3_Participates] [varchar](10) NULL,
	[b3_Respects] [varchar](10) NULL,
	[b3_Responsibility] [varchar](10) NULL,
	[b3_SciSocStdHealth] [varchar](10) NULL,
	[b3_SelfConf] [varchar](10) NULL,
	[b3_Selects] [varchar](10) NULL,
	[b3_Shares] [varchar](10) NULL,
	[b3_UseOfTime] [varchar](10) NULL,
	[c3_Held] [varchar](3) NULL,
	[c3_Requested] [varchar](3) NULL,
	[ep3_IEP] [varchar](3) NULL,
	[ep3_PMP] [varchar](3) NULL,
	[lit3_AbsTardy] [varchar](3) NULL,
	[lit3_BehCond] [varchar](3) NULL,
	[m3_Shapes] [varchar](10) NULL,
	[m3_SortClass] [varchar](10) NULL,
	[m3_Pattern] [varchar](10) NULL,
	[m3_Measure] [varchar](10) NULL,
	[m3_Comparing] [varchar](10) NULL,
	[m3_Concept] [varchar](10) NULL,
	[m3_CountSets] [varchar](10) NULL,
	[m3_Match] [varchar](10) NULL,
	[m3_WrtNum] [varchar](10) NULL,
	[m3_AddSub] [varchar](10) NULL,
	[ms3_Fine] [varchar](10) NULL,
	[ms3_Large] [varchar](10) NULL,
	[r3_LetterNaming] [varchar](10) NULL,
	[r3_LetterSounds] [varchar](10) NULL,
	[r3_Print] [varchar](10) NULL,
	[r3_Story] [varchar](10) NULL,
	[r3_SightWords] [varchar](10) NULL,
	[b3_ReadingLevel] [varchar](10) NULL,
	[tc3_Comments] [varchar](800) NULL,
	[r1_ListComp] [int] NULL,
	[r2_ListComp] [int] NULL,
	[r3_ListComp] [int] NULL,
	[r1_KgVocab] [int] NULL,
	[r3_KgVocab] [int] NULL,
	[FMP_updated] [datetime] NULL,
	[w1Perf] [varchar](10) NULL,
	[w2Perf] [varchar](10) NULL,
	[r1_RunRec] [varchar](10) NULL,
	[r2_RunRec] [varchar](10) NULL,
	[r3_RunRec] [varchar](10) NULL,
	[la1_module] [int] NULL,
	[la2_module] [int] NULL,
	[la3_module] [int] NULL,
	[w3Perf] [varchar](10) NULL,
	[r1_DrawDictWri] [varchar](10) NULL,
	[r2_DrawDictWri] [varchar](10) NULL,
	[r3_DrawDictWri] [varchar](10) NULL,
	[r1_MainTopic] [varchar](10) NULL,
	[r2_MainTopic] [varchar](10) NULL,
	[r3_MainTopic] [varchar](10) NULL,
	[r1_GrammarUsage] [varchar](10) NULL,
	[r2_GrammarUsage] [varchar](10) NULL,
	[r3_GrammarUsage] [varchar](10) NULL,
	[r1_CollabConversation] [varchar](10) NULL,
	[r2_CollabConversation] [varchar](10) NULL,
	[r3_CollabConversation] [varchar](10) NULL,
	[r2_CapPuncSpell] [varchar](10) NULL,
	[r3_CapPuncSpell] [varchar](10) NULL,
	[b2_ReadingLevel] [varchar](10) NULL,
	[r2_Characters] [varchar](10) NULL,
	[r3_Characters] [varchar](10) NULL,
	[r3_SimilarDiff] [varchar](10) NULL,
	[w1_WritingOpinion] [varchar](10) NULL,
	[w2_WritingOpinion] [varchar](10) NULL,
	[w3_WritingOpinion] [varchar](10) NULL,
	[w2_WritingNarrate] [varchar](10) NULL,
	[w3_WritingNarrate] [varchar](10) NULL,
	[w3_WritingInfoExp] [varchar](10) NULL,
	[m1_CompShapes] [varchar](10) NULL,
	[m2_CompShapes] [varchar](10) NULL,
	[m3_CompShapes] [varchar](10) NULL,
	[m1_CountForward] [varchar](10) NULL,
	[m2_CountForward] [varchar](10) NULL,
	[m3_CountForward] [varchar](10) NULL,
	[m1_ObjectsNumerals] [varchar](10) NULL,
	[m2_ObjectsNumerals] [varchar](10) NULL,
	[m3_ObjectsNumerals] [varchar](10) NULL,
	[m1_Groups] [varchar](10) NULL,
	[m2_Groups] [varchar](10) NULL,
	[m3_Groups] [varchar](10) NULL,
	[m3_Numbers] [varchar](10) NULL,
	[m4_Numbers] [varchar](10) NULL,
	[m3_Decompose] [varchar](10) NULL,
	[s1_Science] [varchar](10) NULL,
	[s2_Science] [varchar](10) NULL,
	[s3_Science] [varchar](10) NULL,
	[s1_SocialStudies] [varchar](10) NULL,
	[s2_SocialStudies] [varchar](10) NULL,
	[s3_SocialStudies] [varchar](10) NULL,
	[s1_Collaborates] [varchar](10) NULL,
	[s2_Collaborates] [varchar](10) NULL,
	[s3_Collaborates] [varchar](10) NULL,
	[s1_Senses] [varchar](10) NULL,
	[s2_Senses] [varchar](10) NULL,
	[s3_Senses] [varchar](10) NULL,
	[s1_Investigates] [varchar](10) NULL,
	[s2_Investigates] [varchar](10) NULL,
	[s3_Investigates] [varchar](10) NULL,
	[s1_VisualRep] [varchar](10) NULL,
	[s2_VisualRep] [varchar](10) NULL,
	[s3_VisualRep] [varchar](10) NULL,
	[s1_Recognizes] [varchar](10) NULL,
	[s2_Recognizes] [varchar](10) NULL,
	[s3_Recognizes] [varchar](10) NULL,
	[m1_Concept] [varchar](10) NULL,
	[r4_Story] [varchar](10) NULL,
	[r4_Print] [varchar](10) NULL,
	[r4_MainTopic] [varchar](10) NULL,
	[r4_LetterNaming] [varchar](10) NULL,
	[r4_LetterSounds] [varchar](10) NULL,
	[r4_SightWords] [varchar](10) NULL,
	[b4_ReadingLevel] [varchar](10) NULL,
	[r4_DrawDictWri] [varchar](10) NULL,
	[r4_CollabConversation] [varchar](10) NULL,
	[m4_Shapes] [varchar](10) NULL,
	[m4_CompShapes] [varchar](10) NULL,
	[m4_CountForward] [varchar](10) NULL,
	[m4_ObjectsNumerals] [varchar](10) NULL,
	[m4_Concept] [varchar](10) NULL,
	[m4_Groups] [varchar](10) NULL,
	[m4_AddSub] [varchar](10) NULL,
	[m2_ObjectsMeasure] [varchar](10) NULL,
	[m3_ObjectsMeasure] [varchar](10) NULL,
	[m4_ObjectsMeasure] [varchar](10) NULL,
	[s4_Science] [varchar](10) NULL,
	[s4_SocialStudies] [varchar](10) NULL,
	[ss1Perf] [varchar](10) NULL,
	[ss2Perf] [varchar](10) NULL,
	[ss3Perf] [varchar](10) NULL,
	[r1map_percentile] [int] NULL,
	[r2map_percentile] [int] NULL,
	[r3map_percentile] [int] NULL,
	[m1map_percentile] [int] NULL,
	[m2map_percentile] [int] NULL,
	[m3map_percentile] [int] NULL,
	[iStation_isip_april] [int] NULL,
	[iStation_overall_april] [varchar](50) NULL,
	[r1isip] [varchar](50) NULL,
	[r2isip] [varchar](50) NULL,
	[r3isip] [varchar](50) NULL,
	[m1isip] [varchar](50) NULL,
	[m2isip] [varchar](50) NULL,
	[m3isip] [varchar](50) NULL,
	[s1isip] [varchar](50) NULL,
	[s2isip] [varchar](50) NULL,
	[s3isip] [varchar](50) NULL,
 CONSTRAINT [PK_PIAP18] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP19]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP19](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1_CollabConversation] [nvarchar](10) NULL,
	[r2_CollabConversation] [nvarchar](10) NULL,
	[r3_CollabConversation] [nvarchar](10) NULL,
	[r4_CollabConversation] [nvarchar](10) NULL,
	[r1_DecodeWords] [nvarchar](10) NULL,
	[r2_DecodeWords] [nvarchar](10) NULL,
	[r3_DecodeWords] [nvarchar](10) NULL,
	[r4_DecodeWords] [nvarchar](10) NULL,
	[r1_DrawDictWri] [nvarchar](10) NULL,
	[r2_DrawDictWri] [nvarchar](10) NULL,
	[r3_DrawDictWri] [nvarchar](10) NULL,
	[r4_DrawDictWri] [nvarchar](10) NULL,
	[r1_LetterNaming] [nvarchar](10) NULL,
	[r2_LetterNaming] [nvarchar](10) NULL,
	[r3_LetterNaming] [nvarchar](10) NULL,
	[r4_LetterNaming] [nvarchar](10) NULL,
	[r1_LetterSounds] [nvarchar](10) NULL,
	[r2_LetterSounds] [nvarchar](10) NULL,
	[r3_LetterSounds] [nvarchar](10) NULL,
	[r4_LetterSounds] [nvarchar](10) NULL,
	[r1_MainTopic] [nvarchar](10) NULL,
	[r2_MainTopic] [nvarchar](10) NULL,
	[r3_MainTopic] [nvarchar](10) NULL,
	[r4_MainTopic] [nvarchar](10) NULL,
	[r1_PhonoAware] [nvarchar](10) NULL,
	[r2_PhonoAware] [nvarchar](10) NULL,
	[r3_PhonoAware] [nvarchar](10) NULL,
	[r4_PhonoAware] [nvarchar](10) NULL,
	[r1_Print] [nvarchar](10) NULL,
	[r2_Print] [nvarchar](10) NULL,
	[r3_Print] [nvarchar](10) NULL,
	[r4_Print] [nvarchar](10) NULL,
	[r1_ReadEmerg] [nvarchar](10) NULL,
	[r2_ReadEmerg] [nvarchar](10) NULL,
	[r3_ReadEmerg] [nvarchar](10) NULL,
	[r4_ReadEmerg] [nvarchar](10) NULL,
	[r1_SightWords] [nvarchar](10) NULL,
	[r2_SightWords] [nvarchar](10) NULL,
	[r3_SightWords] [nvarchar](10) NULL,
	[r4_SightWords] [nvarchar](10) NULL,
	[r1_Story] [nvarchar](10) NULL,
	[r2_Story] [nvarchar](10) NULL,
	[r3_Story] [nvarchar](10) NULL,
	[r4_Story] [nvarchar](10) NULL,
	[m1_AddSub] [nvarchar](10) NULL,
	[m2_AddSub] [nvarchar](10) NULL,
	[m3_AddSub] [nvarchar](10) NULL,
	[m4_AddSub] [nvarchar](10) NULL,
	[m1_CompShapes] [nvarchar](10) NULL,
	[m2_CompShapes] [nvarchar](10) NULL,
	[m3_CompShapes] [nvarchar](10) NULL,
	[m4_CompShapes] [nvarchar](10) NULL,
	[m1_Concept] [nvarchar](10) NULL,
	[m2_Concept] [nvarchar](10) NULL,
	[m3_Concept] [nvarchar](10) NULL,
	[m4_Concept] [nvarchar](10) NULL,
	[m1_CountForward] [nvarchar](10) NULL,
	[m2_CountForward] [nvarchar](10) NULL,
	[m3_CountForward] [nvarchar](10) NULL,
	[m4_CountForward] [nvarchar](10) NULL,
	[m1_Groups] [nvarchar](10) NULL,
	[m2_Groups] [nvarchar](10) NULL,
	[m3_Groups] [nvarchar](10) NULL,
	[m4_Groups] [nvarchar](10) NULL,
	[m1_Numbers] [nvarchar](10) NULL,
	[m2_Numbers] [nvarchar](10) NULL,
	[m3_Numbers] [nvarchar](10) NULL,
	[m4_Numbers] [nvarchar](10) NULL,
	[m1_ObjectsMeasure] [nvarchar](10) NULL,
	[m2_ObjectsMeasure] [nvarchar](10) NULL,
	[m3_ObjectsMeasure] [nvarchar](10) NULL,
	[m4_ObjectsMeasure] [nvarchar](10) NULL,
	[m1_ObjectsNumerals] [nvarchar](10) NULL,
	[m2_ObjectsNumerals] [nvarchar](10) NULL,
	[m3_ObjectsNumerals] [nvarchar](10) NULL,
	[m4_ObjectsNumerals] [nvarchar](10) NULL,
	[m1_Shapes] [nvarchar](10) NULL,
	[m2_Shapes] [nvarchar](10) NULL,
	[m3_Shapes] [nvarchar](10) NULL,
	[m4_Shapes] [nvarchar](10) NULL,
	[b1_Copes] [nvarchar](10) NULL,
	[b2_Copes] [nvarchar](10) NULL,
	[b3_Copes] [nvarchar](10) NULL,
	[b4_Copes] [nvarchar](10) NULL,
	[b1_FollowRules] [nvarchar](10) NULL,
	[b2_FollowRules] [nvarchar](10) NULL,
	[b3_FollowRules] [nvarchar](10) NULL,
	[b4_FollowRules] [nvarchar](10) NULL,
	[b1_ListDir] [nvarchar](10) NULL,
	[b2_ListDir] [nvarchar](10) NULL,
	[b3_ListDir] [nvarchar](10) NULL,
	[b4_ListDir] [nvarchar](10) NULL,
	[b1_Moves] [nvarchar](10) NULL,
	[b2_Moves] [nvarchar](10) NULL,
	[b3_Moves] [nvarchar](10) NULL,
	[b4_Moves] [nvarchar](10) NULL,
	[b1_Participates] [nvarchar](10) NULL,
	[b2_Participates] [nvarchar](10) NULL,
	[b3_Participates] [nvarchar](10) NULL,
	[b4_Participates] [nvarchar](10) NULL,
	[b2_ReadingLevel] [nvarchar](10) NULL,
	[b3_ReadingLevel] [nvarchar](10) NULL,
	[b4_ReadingLevel] [nvarchar](10) NULL,
	[b1_Respects] [nvarchar](10) NULL,
	[b2_Respects] [nvarchar](10) NULL,
	[b3_Respects] [nvarchar](10) NULL,
	[b4_Respects] [nvarchar](10) NULL,
	[b1_Responsibility] [nvarchar](10) NULL,
	[b2_Responsibility] [nvarchar](10) NULL,
	[b3_Responsibility] [nvarchar](10) NULL,
	[b4_Responsibility] [nvarchar](10) NULL,
	[b1_Selects] [nvarchar](10) NULL,
	[b2_Selects] [nvarchar](10) NULL,
	[b3_Selects] [nvarchar](10) NULL,
	[b4_Selects] [nvarchar](10) NULL,
	[b1_SelfConf] [nvarchar](10) NULL,
	[b2_SelfConf] [nvarchar](10) NULL,
	[b3_SelfConf] [nvarchar](10) NULL,
	[b4_SelfConf] [nvarchar](10) NULL,
	[b1_Shares] [nvarchar](10) NULL,
	[b2_Shares] [nvarchar](10) NULL,
	[b3_Shares] [nvarchar](10) NULL,
	[b4_Shares] [nvarchar](10) NULL,
	[b1_UseOfTime] [nvarchar](10) NULL,
	[b2_UseOfTime] [nvarchar](10) NULL,
	[b3_UseOfTime] [nvarchar](10) NULL,
	[b4_UseOfTime] [nvarchar](10) NULL,
	[s1_Collaborates] [nvarchar](10) NULL,
	[s2_Collaborates] [nvarchar](10) NULL,
	[s3_Collaborates] [nvarchar](10) NULL,
	[s1_Investigates] [nvarchar](10) NULL,
	[s2_Investigates] [nvarchar](10) NULL,
	[s3_Investigates] [nvarchar](10) NULL,
	[s1_Recognizes] [nvarchar](10) NULL,
	[s2_Recognizes] [nvarchar](10) NULL,
	[s3_Recognizes] [nvarchar](10) NULL,
	[s1_Science] [nvarchar](10) NULL,
	[s2_Science] [nvarchar](10) NULL,
	[s3_Science] [nvarchar](10) NULL,
	[s4_Science] [nvarchar](10) NULL,
	[s1_Senses] [nvarchar](10) NULL,
	[s2_Senses] [nvarchar](10) NULL,
	[s3_Senses] [nvarchar](10) NULL,
	[s1_SocialStudies] [nvarchar](10) NULL,
	[s2_SocialStudies] [nvarchar](10) NULL,
	[s3_SocialStudies] [nvarchar](10) NULL,
	[s1_VisualRep] [nvarchar](10) NULL,
	[s2_VisualRep] [nvarchar](10) NULL,
	[s3_VisualRep] [nvarchar](10) NULL,
	[ms1_Fine] [nvarchar](10) NULL,
	[ms2_Fine] [nvarchar](10) NULL,
	[ms3_Fine] [nvarchar](10) NULL,
	[ms4_Fine] [nvarchar](10) NULL,
	[ms1_Large] [nvarchar](10) NULL,
	[ms2_Large] [nvarchar](10) NULL,
	[ms3_Large] [nvarchar](10) NULL,
	[ms4_Large] [nvarchar](10) NULL,
 CONSTRAINT [PK_PIAP19] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP20]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP20](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1_CollabConversation] [nvarchar](10) NULL,
	[r2_CollabConversation] [nvarchar](10) NULL,
	[r3_CollabConversation] [nvarchar](10) NULL,
	[r4_CollabConversation] [nvarchar](10) NULL,
	[r1_DecodeWords] [nvarchar](10) NULL,
	[r2_DecodeWords] [nvarchar](10) NULL,
	[r3_DecodeWords] [nvarchar](10) NULL,
	[r4_DecodeWords] [nvarchar](10) NULL,
	[r1_DrawDictWri] [nvarchar](10) NULL,
	[r2_DrawDictWri] [nvarchar](10) NULL,
	[r3_DrawDictWri] [nvarchar](10) NULL,
	[r4_DrawDictWri] [nvarchar](10) NULL,
	[r1_LetterNaming] [nvarchar](10) NULL,
	[r2_LetterNaming] [nvarchar](10) NULL,
	[r3_LetterNaming] [nvarchar](10) NULL,
	[r4_LetterNaming] [nvarchar](10) NULL,
	[r1_LetterSounds] [nvarchar](10) NULL,
	[r2_LetterSounds] [nvarchar](10) NULL,
	[r3_LetterSounds] [nvarchar](10) NULL,
	[r4_LetterSounds] [nvarchar](10) NULL,
	[r1_MainTopic] [nvarchar](10) NULL,
	[r2_MainTopic] [nvarchar](10) NULL,
	[r3_MainTopic] [nvarchar](10) NULL,
	[r4_MainTopic] [nvarchar](10) NULL,
	[r1_PhonoAware] [nvarchar](10) NULL,
	[r2_PhonoAware] [nvarchar](10) NULL,
	[r3_PhonoAware] [nvarchar](10) NULL,
	[r4_PhonoAware] [nvarchar](10) NULL,
	[r1_Print] [nvarchar](10) NULL,
	[r2_Print] [nvarchar](10) NULL,
	[r3_Print] [nvarchar](10) NULL,
	[r4_Print] [nvarchar](10) NULL,
	[r1_ReadEmerg] [nvarchar](10) NULL,
	[r2_ReadEmerg] [nvarchar](10) NULL,
	[r3_ReadEmerg] [nvarchar](10) NULL,
	[r4_ReadEmerg] [nvarchar](10) NULL,
	[r1_SightWords] [nvarchar](10) NULL,
	[r2_SightWords] [nvarchar](10) NULL,
	[r3_SightWords] [nvarchar](10) NULL,
	[r4_SightWords] [nvarchar](10) NULL,
	[r1_Story] [nvarchar](10) NULL,
	[r2_Story] [nvarchar](10) NULL,
	[r3_Story] [nvarchar](10) NULL,
	[r4_Story] [nvarchar](10) NULL,
	[m1_AddSub] [nvarchar](10) NULL,
	[m2_AddSub] [nvarchar](10) NULL,
	[m3_AddSub] [nvarchar](10) NULL,
	[m4_AddSub] [nvarchar](10) NULL,
	[m1_CompShapes] [nvarchar](10) NULL,
	[m2_CompShapes] [nvarchar](10) NULL,
	[m3_CompShapes] [nvarchar](10) NULL,
	[m4_CompShapes] [nvarchar](10) NULL,
	[m1_Concept] [nvarchar](10) NULL,
	[m2_Concept] [nvarchar](10) NULL,
	[m3_Concept] [nvarchar](10) NULL,
	[m4_Concept] [nvarchar](10) NULL,
	[m1_CountForward] [nvarchar](10) NULL,
	[m2_CountForward] [nvarchar](10) NULL,
	[m3_CountForward] [nvarchar](10) NULL,
	[m4_CountForward] [nvarchar](10) NULL,
	[m1_Groups] [nvarchar](10) NULL,
	[m2_Groups] [nvarchar](10) NULL,
	[m3_Groups] [nvarchar](10) NULL,
	[m4_Groups] [nvarchar](10) NULL,
	[m1_Numbers] [nvarchar](10) NULL,
	[m2_Numbers] [nvarchar](10) NULL,
	[m3_Numbers] [nvarchar](10) NULL,
	[m4_Numbers] [nvarchar](10) NULL,
	[m1_ObjectsMeasure] [nvarchar](10) NULL,
	[m2_ObjectsMeasure] [nvarchar](10) NULL,
	[m3_ObjectsMeasure] [nvarchar](10) NULL,
	[m4_ObjectsMeasure] [nvarchar](10) NULL,
	[m1_ObjectsNumerals] [nvarchar](10) NULL,
	[m2_ObjectsNumerals] [nvarchar](10) NULL,
	[m3_ObjectsNumerals] [nvarchar](10) NULL,
	[m4_ObjectsNumerals] [nvarchar](10) NULL,
	[m1_Shapes] [nvarchar](10) NULL,
	[m2_Shapes] [nvarchar](10) NULL,
	[m3_Shapes] [nvarchar](10) NULL,
	[m4_Shapes] [nvarchar](10) NULL,
	[b1_Copes] [nvarchar](10) NULL,
	[b2_Copes] [nvarchar](10) NULL,
	[b3_Copes] [nvarchar](10) NULL,
	[b4_Copes] [nvarchar](10) NULL,
	[b1_FollowRules] [nvarchar](10) NULL,
	[b2_FollowRules] [nvarchar](10) NULL,
	[b3_FollowRules] [nvarchar](10) NULL,
	[b4_FollowRules] [nvarchar](10) NULL,
	[b1_ListDir] [nvarchar](10) NULL,
	[b2_ListDir] [nvarchar](10) NULL,
	[b3_ListDir] [nvarchar](10) NULL,
	[b4_ListDir] [nvarchar](10) NULL,
	[b1_Moves] [nvarchar](10) NULL,
	[b2_Moves] [nvarchar](10) NULL,
	[b3_Moves] [nvarchar](10) NULL,
	[b4_Moves] [nvarchar](10) NULL,
	[b1_Participates] [nvarchar](10) NULL,
	[b2_Participates] [nvarchar](10) NULL,
	[b3_Participates] [nvarchar](10) NULL,
	[b4_Participates] [nvarchar](10) NULL,
	[b2_ReadingLevel] [nvarchar](10) NULL,
	[b3_ReadingLevel] [nvarchar](10) NULL,
	[b4_ReadingLevel] [nvarchar](10) NULL,
	[b1_Respects] [nvarchar](10) NULL,
	[b2_Respects] [nvarchar](10) NULL,
	[b3_Respects] [nvarchar](10) NULL,
	[b4_Respects] [nvarchar](10) NULL,
	[b1_Responsibility] [nvarchar](10) NULL,
	[b2_Responsibility] [nvarchar](10) NULL,
	[b3_Responsibility] [nvarchar](10) NULL,
	[b4_Responsibility] [nvarchar](10) NULL,
	[b1_Selects] [nvarchar](10) NULL,
	[b2_Selects] [nvarchar](10) NULL,
	[b3_Selects] [nvarchar](10) NULL,
	[b4_Selects] [nvarchar](10) NULL,
	[b1_SelfConf] [nvarchar](10) NULL,
	[b2_SelfConf] [nvarchar](10) NULL,
	[b3_SelfConf] [nvarchar](10) NULL,
	[b4_SelfConf] [nvarchar](10) NULL,
	[b1_Shares] [nvarchar](10) NULL,
	[b2_Shares] [nvarchar](10) NULL,
	[b3_Shares] [nvarchar](10) NULL,
	[b4_Shares] [nvarchar](10) NULL,
	[b1_UseOfTime] [nvarchar](10) NULL,
	[b2_UseOfTime] [nvarchar](10) NULL,
	[b3_UseOfTime] [nvarchar](10) NULL,
	[b4_UseOfTime] [nvarchar](10) NULL,
	[s1_Collaborates] [nvarchar](10) NULL,
	[s2_Collaborates] [nvarchar](10) NULL,
	[s3_Collaborates] [nvarchar](10) NULL,
	[s1_Investigates] [nvarchar](10) NULL,
	[s2_Investigates] [nvarchar](10) NULL,
	[s3_Investigates] [nvarchar](10) NULL,
	[s1_Recognizes] [nvarchar](10) NULL,
	[s2_Recognizes] [nvarchar](10) NULL,
	[s3_Recognizes] [nvarchar](10) NULL,
	[s1_Science] [nvarchar](10) NULL,
	[s2_Science] [nvarchar](10) NULL,
	[s3_Science] [nvarchar](10) NULL,
	[s4_Science] [nvarchar](10) NULL,
	[s1_Senses] [nvarchar](10) NULL,
	[s2_Senses] [nvarchar](10) NULL,
	[s3_Senses] [nvarchar](10) NULL,
	[s1_SocialStudies] [nvarchar](10) NULL,
	[s2_SocialStudies] [nvarchar](10) NULL,
	[s3_SocialStudies] [nvarchar](10) NULL,
	[s1_VisualRep] [nvarchar](10) NULL,
	[s2_VisualRep] [nvarchar](10) NULL,
	[s3_VisualRep] [nvarchar](10) NULL,
	[ms1_Fine] [nvarchar](10) NULL,
	[ms2_Fine] [nvarchar](10) NULL,
	[ms3_Fine] [nvarchar](10) NULL,
	[ms4_Fine] [nvarchar](10) NULL,
	[ms1_Large] [nvarchar](10) NULL,
	[ms2_Large] [nvarchar](10) NULL,
	[ms3_Large] [nvarchar](10) NULL,
	[ms4_Large] [nvarchar](10) NULL,
 CONSTRAINT [PK_PIAP20] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PIAP21]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PIAP21](
	[student_id] [int] NOT NULL,
	[permnum] [varchar](50) NULL,
	[school_id] [int] NULL,
	[schoolnum] [varchar](4) NULL,
	[grade] [varchar](2) NULL,
	[teacher_id] [int] NULL,
	[abbrevname] [varchar](50) NULL,
	[end_date] [datetime] NULL,
	[PotRetain] [varchar](3) NULL,
	[r1_CollabConversation] [nvarchar](10) NULL,
	[r2_CollabConversation] [nvarchar](10) NULL,
	[r3_CollabConversation] [nvarchar](10) NULL,
	[r4_CollabConversation] [nvarchar](10) NULL,
	[r1_DecodeWords] [nvarchar](10) NULL,
	[r2_DecodeWords] [nvarchar](10) NULL,
	[r3_DecodeWords] [nvarchar](10) NULL,
	[r4_DecodeWords] [nvarchar](10) NULL,
	[r1_DrawDictWri] [nvarchar](10) NULL,
	[r2_DrawDictWri] [nvarchar](10) NULL,
	[r3_DrawDictWri] [nvarchar](10) NULL,
	[r4_DrawDictWri] [nvarchar](10) NULL,
	[r1_LetterNaming] [nvarchar](10) NULL,
	[r2_LetterNaming] [nvarchar](10) NULL,
	[r3_LetterNaming] [nvarchar](10) NULL,
	[r4_LetterNaming] [nvarchar](10) NULL,
	[r1_LetterSounds] [nvarchar](10) NULL,
	[r2_LetterSounds] [nvarchar](10) NULL,
	[r3_LetterSounds] [nvarchar](10) NULL,
	[r4_LetterSounds] [nvarchar](10) NULL,
	[r1_MainTopic] [nvarchar](10) NULL,
	[r2_MainTopic] [nvarchar](10) NULL,
	[r3_MainTopic] [nvarchar](10) NULL,
	[r4_MainTopic] [nvarchar](10) NULL,
	[r1_PhonoAware] [nvarchar](10) NULL,
	[r2_PhonoAware] [nvarchar](10) NULL,
	[r3_PhonoAware] [nvarchar](10) NULL,
	[r4_PhonoAware] [nvarchar](10) NULL,
	[r1_Print] [nvarchar](10) NULL,
	[r2_Print] [nvarchar](10) NULL,
	[r3_Print] [nvarchar](10) NULL,
	[r4_Print] [nvarchar](10) NULL,
	[r1_ReadEmerg] [nvarchar](10) NULL,
	[r2_ReadEmerg] [nvarchar](10) NULL,
	[r3_ReadEmerg] [nvarchar](10) NULL,
	[r4_ReadEmerg] [nvarchar](10) NULL,
	[r1_SightWords] [nvarchar](10) NULL,
	[r2_SightWords] [nvarchar](10) NULL,
	[r3_SightWords] [nvarchar](10) NULL,
	[r4_SightWords] [nvarchar](10) NULL,
	[r1_Story] [nvarchar](10) NULL,
	[r2_Story] [nvarchar](10) NULL,
	[r3_Story] [nvarchar](10) NULL,
	[r4_Story] [nvarchar](10) NULL,
	[m1_AddSub] [nvarchar](10) NULL,
	[m2_AddSub] [nvarchar](10) NULL,
	[m3_AddSub] [nvarchar](10) NULL,
	[m4_AddSub] [nvarchar](10) NULL,
	[m1_CompShapes] [nvarchar](10) NULL,
	[m2_CompShapes] [nvarchar](10) NULL,
	[m3_CompShapes] [nvarchar](10) NULL,
	[m4_CompShapes] [nvarchar](10) NULL,
	[m1_Concept] [nvarchar](10) NULL,
	[m2_Concept] [nvarchar](10) NULL,
	[m3_Concept] [nvarchar](10) NULL,
	[m4_Concept] [nvarchar](10) NULL,
	[m1_CountForward] [nvarchar](10) NULL,
	[m2_CountForward] [nvarchar](10) NULL,
	[m3_CountForward] [nvarchar](10) NULL,
	[m4_CountForward] [nvarchar](10) NULL,
	[m1_Groups] [nvarchar](10) NULL,
	[m2_Groups] [nvarchar](10) NULL,
	[m3_Groups] [nvarchar](10) NULL,
	[m4_Groups] [nvarchar](10) NULL,
	[m1_Numbers] [nvarchar](10) NULL,
	[m2_Numbers] [nvarchar](10) NULL,
	[m3_Numbers] [nvarchar](10) NULL,
	[m4_Numbers] [nvarchar](10) NULL,
	[m1_ObjectsMeasure] [nvarchar](10) NULL,
	[m2_ObjectsMeasure] [nvarchar](10) NULL,
	[m3_ObjectsMeasure] [nvarchar](10) NULL,
	[m4_ObjectsMeasure] [nvarchar](10) NULL,
	[m1_ObjectsNumerals] [nvarchar](10) NULL,
	[m2_ObjectsNumerals] [nvarchar](10) NULL,
	[m3_ObjectsNumerals] [nvarchar](10) NULL,
	[m4_ObjectsNumerals] [nvarchar](10) NULL,
	[m1_Shapes] [nvarchar](10) NULL,
	[m2_Shapes] [nvarchar](10) NULL,
	[m3_Shapes] [nvarchar](10) NULL,
	[m4_Shapes] [nvarchar](10) NULL,
	[b1_Copes] [nvarchar](10) NULL,
	[b2_Copes] [nvarchar](10) NULL,
	[b3_Copes] [nvarchar](10) NULL,
	[b4_Copes] [nvarchar](10) NULL,
	[b1_FollowRules] [nvarchar](10) NULL,
	[b2_FollowRules] [nvarchar](10) NULL,
	[b3_FollowRules] [nvarchar](10) NULL,
	[b4_FollowRules] [nvarchar](10) NULL,
	[b1_ListDir] [nvarchar](10) NULL,
	[b2_ListDir] [nvarchar](10) NULL,
	[b3_ListDir] [nvarchar](10) NULL,
	[b4_ListDir] [nvarchar](10) NULL,
	[b1_Moves] [nvarchar](10) NULL,
	[b2_Moves] [nvarchar](10) NULL,
	[b3_Moves] [nvarchar](10) NULL,
	[b4_Moves] [nvarchar](10) NULL,
	[b1_Participates] [nvarchar](10) NULL,
	[b2_Participates] [nvarchar](10) NULL,
	[b3_Participates] [nvarchar](10) NULL,
	[b4_Participates] [nvarchar](10) NULL,
	[b2_ReadingLevel] [nvarchar](10) NULL,
	[b3_ReadingLevel] [nvarchar](10) NULL,
	[b4_ReadingLevel] [nvarchar](10) NULL,
	[b1_Respects] [nvarchar](10) NULL,
	[b2_Respects] [nvarchar](10) NULL,
	[b3_Respects] [nvarchar](10) NULL,
	[b4_Respects] [nvarchar](10) NULL,
	[b1_Responsibility] [nvarchar](10) NULL,
	[b2_Responsibility] [nvarchar](10) NULL,
	[b3_Responsibility] [nvarchar](10) NULL,
	[b4_Responsibility] [nvarchar](10) NULL,
	[b1_Selects] [nvarchar](10) NULL,
	[b2_Selects] [nvarchar](10) NULL,
	[b3_Selects] [nvarchar](10) NULL,
	[b4_Selects] [nvarchar](10) NULL,
	[b1_SelfConf] [nvarchar](10) NULL,
	[b2_SelfConf] [nvarchar](10) NULL,
	[b3_SelfConf] [nvarchar](10) NULL,
	[b4_SelfConf] [nvarchar](10) NULL,
	[b1_Shares] [nvarchar](10) NULL,
	[b2_Shares] [nvarchar](10) NULL,
	[b3_Shares] [nvarchar](10) NULL,
	[b4_Shares] [nvarchar](10) NULL,
	[b1_UseOfTime] [nvarchar](10) NULL,
	[b2_UseOfTime] [nvarchar](10) NULL,
	[b3_UseOfTime] [nvarchar](10) NULL,
	[b4_UseOfTime] [nvarchar](10) NULL,
	[s1_Collaborates] [nvarchar](10) NULL,
	[s2_Collaborates] [nvarchar](10) NULL,
	[s3_Collaborates] [nvarchar](10) NULL,
	[s1_Investigates] [nvarchar](10) NULL,
	[s2_Investigates] [nvarchar](10) NULL,
	[s3_Investigates] [nvarchar](10) NULL,
	[s1_Recognizes] [nvarchar](10) NULL,
	[s2_Recognizes] [nvarchar](10) NULL,
	[s3_Recognizes] [nvarchar](10) NULL,
	[s1_Science] [nvarchar](10) NULL,
	[s2_Science] [nvarchar](10) NULL,
	[s3_Science] [nvarchar](10) NULL,
	[s4_Science] [nvarchar](10) NULL,
	[s1_Senses] [nvarchar](10) NULL,
	[s2_Senses] [nvarchar](10) NULL,
	[s3_Senses] [nvarchar](10) NULL,
	[s1_SocialStudies] [nvarchar](10) NULL,
	[s2_SocialStudies] [nvarchar](10) NULL,
	[s3_SocialStudies] [nvarchar](10) NULL,
	[s1_VisualRep] [nvarchar](10) NULL,
	[s2_VisualRep] [nvarchar](10) NULL,
	[s3_VisualRep] [nvarchar](10) NULL,
	[ms1_Fine] [nvarchar](10) NULL,
	[ms2_Fine] [nvarchar](10) NULL,
	[ms3_Fine] [nvarchar](10) NULL,
	[ms4_Fine] [nvarchar](10) NULL,
	[ms1_Large] [nvarchar](10) NULL,
	[ms2_Large] [nvarchar](10) NULL,
	[ms3_Large] [nvarchar](10) NULL,
	[ms4_Large] [nvarchar](10) NULL,
 CONSTRAINT [PK_PIAP_21] PRIMARY KEY CLUSTERED 
(
	[student_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PinellasLeaveOfAbsence]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PinellasLeaveOfAbsence](
	[request_id] [nvarchar](50) NULL,
	[Dist] [varchar](2) NOT NULL,
	[SSN] [varchar](10) NOT NULL,
	[FY] [numeric](3, 0) NOT NULL,
	[JobId] [varchar](2) NOT NULL,
	[LeaveStartYear] [varchar](2) NULL,
	[LeaveStartMonth] [varchar](2) NULL,
	[LeaveStartDay] [varchar](2) NULL,
	[FY9] [varchar](2) NULL,
	[RsnCode] [varchar](2) NULL,
	[LvType] [varchar](2) NULL,
	[LeaveEndYear] [varchar](2) NULL,
	[LeaveEndMonth] [varchar](2) NULL,
	[LeaveEndDay] [varchar](2) NULL,
	[LeaveDays] [numeric](3, 0) NULL,
	[LastPaidYear] [varchar](2) NULL,
	[LastPaidMonth] [varchar](2) NULL,
	[LastPaidDay] [varchar](2) NULL,
	[PaidDays] [numeric](3, 0) NULL,
	[UnpaidDays] [numeric](3, 0) NULL,
	[FMLA] [varchar](1) NULL,
	[FMLAEndYear] [varchar](2) NULL,
	[FMLAEndMonth] [varchar](2) NULL,
	[FMLAEndDay] [varchar](2) NULL,
	[FMLADays] [numeric](3, 0) NULL,
	[ReturnToWorkYear] [varchar](2) NULL,
	[ReturnToWorkMonth] [varchar](2) NULL,
	[ReturnToWorkDay] [varchar](2) NULL,
	[ReturnToWorkCode] [varchar](2) NULL,
	[LoadDate] [datetime] NULL,
	[UpdateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PLP_ncaa_courses]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PLP_ncaa_courses](
	[courses] [nvarchar](255) NULL,
	[course_number] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PM_Clever_Goals]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PM_Clever_Goals](
	[Student ID] [nvarchar](50) NULL,
	[Test Date] [nvarchar](50) NULL,
	[Folder 1 Desc] [nvarchar](100) NULL,
	[Folder 1 Score] [nvarchar](50) NULL,
	[Folder 2 Desc] [nvarchar](100) NULL,
	[Folder 2 Score] [nvarchar](50) NULL,
	[Folder 3 Desc] [nvarchar](100) NULL,
	[Folder 3 Score] [nvarchar](50) NULL,
	[Folder 4 Desc] [nvarchar](100) NULL,
	[Folder 4 Score] [nvarchar](50) NULL,
	[Folder 5 Desc] [nvarchar](100) NULL,
	[Folder 5 Score] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ProDev_certification]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ProDev_certification](
	[emp_local_id] [int] NULL,
	[Code] [nvarchar](2) NOT NULL,
	[Nbr] [nvarchar](15) NOT NULL,
	[Type] [nvarchar](2) NULL,
	[Misc1] [nvarchar](2) NULL,
	[Misc2] [nvarchar](2) NULL,
	[Misc3] [nvarchar](2) NULL,
	[Misc4] [nvarchar](2) NULL,
	[Misc5] [nvarchar](2) NULL,
	[Misc6] [nvarchar](2) NULL,
	[Misc7] [nvarchar](2) NULL,
	[Issued] [date] NULL,
	[Expires] [date] NULL,
	[SubjArea] [nvarchar](5) NULL,
	[Description] [nvarchar](30) NULL,
	[ttt_elig] [nvarchar](1) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ProDev_classes]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ProDev_classes](
	[emp_local_id] [numeric](18, 0) NULL,
	[school] [varchar](100) NULL,
	[course_num] [varchar](10) NULL,
	[course] [varchar](100) NULL,
	[subject_group] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ProDev_components]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ProDev_components](
	[emp_local_id] [int] NULL,
	[coursenum] [varchar](500) NULL,
	[section] [varchar](100) NOT NULL,
	[title] [varchar](500) NULL,
	[GeneralCertHours] [varchar](500) NULL,
	[ESEHours] [varchar](500) NULL,
	[NonCertHours] [varchar](500) NULL,
	[ReadingHours] [varchar](500) NULL,
	[ESOLHours] [varchar](500) NULL,
	[Begin_Date] [varchar](500) NULL,
	[End_Date] [varchar](500) NULL,
	[CompleteStatID] [nvarchar](1) NULL,
	[status] [varchar](13) NULL,
	[credits_earned] [varchar](500) NULL,
	[type] [varchar](27) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ProDev_Embrace_0_components]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ProDev_Embrace_0_components](
	[emp_local_id] [int] NULL,
	[coursenum] [varchar](500) NULL,
	[section] [varchar](100) NOT NULL,
	[title] [varchar](500) NULL,
	[category] [varchar](500) NOT NULL,
	[GeneralCertHours] [varchar](500) NULL,
	[ESEHours] [varchar](500) NULL,
	[NonCertHours] [varchar](500) NULL,
	[ReadingHours] [varchar](500) NULL,
	[ESOLHours] [varchar](500) NULL,
	[Begin_Date] [varchar](500) NULL,
	[End_Date] [varchar](500) NULL,
	[CompleteStatID] [nvarchar](1) NULL,
	[status] [varchar](13) NULL,
	[credits_earned] [varchar](500) NULL,
	[type] [varchar](27) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ProDev_Embrace_0_teachers]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ProDev_Embrace_0_teachers](
	[emp_local_id] [int] NULL,
	[ssn] [nvarchar](50) NULL,
	[last_name] [nvarchar](100) NULL,
	[first_name] [nvarchar](100) NULL,
	[email] [nvarchar](100) NULL,
	[sch_state_id] [varchar](10) NULL,
	[school] [varchar](100) NULL,
	[cohort] [varchar](18) NULL,
	[jobtitle] [nvarchar](100) NULL,
	[job_pos_num] [nvarchar](10) NULL,
	[hiredate] [date] NULL,
	[termdate] [date] NULL,
	[termreason] [nvarchar](30) NULL,
	[TchgDistrict] [numeric](3, 0) NULL,
	[AdminYrs] [numeric](3, 0) NULL,
	[MilitaryExper] [numeric](3, 0) NULL,
	[TchgPublicSch] [numeric](3, 0) NULL,
	[TchgNonPub] [numeric](3, 0) NULL,
	[TchgOSP] [numeric](3, 0) NULL,
	[TchgOSN] [numeric](3, 0) NULL,
	[Out] [numeric](3, 0) NULL,
	[Mil] [numeric](3, 0) NULL,
	[Voc] [numeric](3, 0) NULL,
	[PFLV] [numeric](3, 0) NULL,
	[FL] [numeric](3, 0) NULL,
	[Pnon] [numeric](3, 0) NULL,
	[Pcon] [numeric](3, 0) NULL,
	[TotYrsExp] [numeric](3, 0) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ProDev_TTT_components]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ProDev_TTT_components](
	[emp_local_id] [int] NULL,
	[Sort] [int] NULL,
	[Title] [varchar](500) NULL,
	[Status] [nchar](10) NULL,
	[Date] [varchar](500) NULL,
	[Remarks] [varchar](500) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ProDev_TTT_degrees]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ProDev_TTT_degrees](
	[emp_local_id] [int] NULL,
	[Yr] [nvarchar](2) NULL,
	[Dg] [nvarchar](1) NULL,
	[Maj] [nvarchar](3) NULL,
	[MajDesc] [nvarchar](30) NULL,
	[Schl] [nvarchar](5) NULL,
	[SchlDesc] [nvarchar](30) NULL,
	[sort] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ProDev_TTT_status]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ProDev_TTT_status](
	[emp_local_id] [int] NULL,
	[last_name] [nvarchar](100) NULL,
	[first_name] [nvarchar](100) NULL,
	[Code] [nvarchar](50) NULL,
	[Type] [nvarchar](50) NULL,
	[ExDate] [date] NULL,
	[TLE_1] [int] NULL,
	[TLE_1_Date] [date] NULL,
	[TLE_2] [int] NULL,
	[TLE_2_Date] [date] NULL,
	[TLE_3] [int] NULL,
	[TLE_3_Date] [date] NULL,
	[AP_1] [int] NULL,
	[AP_1_Date] [date] NULL,
	[AP_2] [int] NULL,
	[AP_2_Date] [date] NULL,
	[AP_3] [int] NULL,
	[AP_3_Date] [date] NULL,
	[IFS_1] [int] NULL,
	[IFS_1_Date] [date] NULL,
	[IFS_2] [int] NULL,
	[IFS_2_Date] [date] NULL,
	[IFS_3] [int] NULL,
	[IFS_3_Date] [date] NULL,
	[PT_1] [int] NULL,
	[PT_1_Date] [date] NULL,
	[PT_2] [int] NULL,
	[PT_2_Date] [date] NULL,
	[PT_3] [int] NULL,
	[PT_3_Date] [date] NULL,
	[SS] [int] NULL,
	[SS_Date] [date] NULL,
	[RDG] [float] NULL,
	[ESOL] [float] NULL,
	[PECStat] [char](1) NULL,
	[PECDate] [date] NULL,
	[PECRemarks] [varchar](30) NULL,
	[ProfEdExSt] [char](1) NULL,
	[ProfEdExDate] [date] NULL,
	[ProfEdExRemarks] [varchar](30) NULL,
	[GenKnowEssaySt] [char](1) NULL,
	[GenKnowEssayDate] [date] NULL,
	[GenKnowEssayRemarks] [varchar](30) NULL,
	[GenKnowELSSt] [char](1) NULL,
	[GenKnowELSDate] [date] NULL,
	[GenKnowELSRemarks] [varchar](30) NULL,
	[GenKnowReadingSt] [char](1) NULL,
	[GenKnowReadingDate] [date] NULL,
	[GenKnowReadRemarks] [varchar](30) NULL,
	[GenKnowMathSt] [char](1) NULL,
	[GenKnowMathDate] [date] NULL,
	[GenKnowMathRemarks] [varchar](30) NULL,
	[ProfPrepSt] [char](1) NULL,
	[ProfPrepDate] [date] NULL,
	[ProfPrepRemarks] [varchar](30) NULL,
	[SubjArea1] [varchar](5) NULL,
	[SubjArea1Desc] [nvarchar](30) NULL,
	[SubjArea1St] [char](1) NULL,
	[SubjArea1Date] [date] NULL,
	[SubjArea1Remarks] [varchar](30) NULL,
	[SubjArea2] [varchar](5) NULL,
	[SubjArea2Desc] [nvarchar](30) NULL,
	[SubjArea2St] [char](1) NULL,
	[SubjArea2Date] [date] NULL,
	[SubjArea2Remarks] [varchar](30) NULL,
	[SubjArea3] [varchar](5) NULL,
	[SubjArea3Desc] [nvarchar](30) NULL,
	[SubjArea3St] [char](1) NULL,
	[SubjArea3Date] [date] NULL,
	[SubjArea3Remarks] [varchar](30) NULL,
	[SubjArea4] [varchar](5) NULL,
	[SubjArea4Desc] [nvarchar](30) NULL,
	[SubjArea4St] [char](1) NULL,
	[SubjArea4Date] [date] NULL,
	[SubjArea4Remarks] [varchar](30) NULL,
	[SubjArea5] [varchar](5) NULL,
	[SubjArea5Desc] [nvarchar](30) NULL,
	[SubjArea5St] [char](1) NULL,
	[SubjArea5Date] [date] NULL,
	[SubjArea5Remarks] [varchar](30) NULL,
	[SubjArea6] [varchar](5) NULL,
	[SubjArea6Desc] [nvarchar](30) NULL,
	[SubjArea6St] [char](1) NULL,
	[SubjArea6Date] [date] NULL,
	[SubjArea6Remarks] [varchar](30) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Advanced_Students]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Advanced_Students](
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[stu_id] [int] NULL,
	[timeframe] [varchar](20) NULL,
	[timeframe_id] [varchar](20) NULL,
	[timeframe_days] [int] NULL,
	[group] [varchar](50) NULL,
	[subgroup] [varchar](50) NULL,
	[color] [int] NULL,
	[series] [int] NULL,
	[enr_days] [int] NULL,
	[enr] [int] NULL,
	[gft_enr] [int] NULL,
	[hon_enr] [int] NULL,
	[adv_enr] [int] NULL,
	[acc_enr] [int] NULL,
	[ap_enr] [int] NULL,
	[ib_enr] [int] NULL,
	[dual_enr] [int] NULL,
	[aice_enr] [int] NULL,
	[cte_enr] [int] NULL,
	[hon_perf] [int] NULL,
	[adv_perf] [int] NULL,
	[acc_perf] [int] NULL,
	[ap_perf] [int] NULL,
	[ib_perf] [int] NULL,
	[aice_perf] [int] NULL,
	[dual_perf] [int] NULL,
	[cte_perf] [int] NULL,
	[hon_pot] [int] NULL,
	[adv_pot] [int] NULL,
	[acc_pot] [int] NULL,
	[ap_pot] [int] NULL,
	[ib_pot] [int] NULL,
	[aice_pot] [int] NULL,
	[dual_pot] [int] NULL,
	[cte_pot] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Advanced_Students_Display]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Advanced_Students_Display](
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[stu_id] [int] NULL,
	[Ethnicity] [varchar](50) NULL,
	[Gender] [varchar](50) NULL,
	[Grade] [varchar](50) NULL,
	[Blk_NonBlk] [varchar](50) NULL,
	[ELL] [varchar](50) NULL,
	[SWD] [varchar](50) NULL,
	[hon_pot] [int] NULL,
	[adv_pot] [int] NULL,
	[acc_pot] [int] NULL,
	[ap_pot] [int] NULL,
	[ib_pot] [int] NULL,
	[aice_pot] [int] NULL,
	[dual_pot] [int] NULL,
	[cte_pot] [int] NULL,
	[gpa_unwtd] [decimal](9, 4) NULL,
	[FSA_ELA_Rdg] [int] NULL,
	[PSAT_NMSQT_Rdg] [int] NULL,
	[PSAT_NMSQT_Mth] [int] NULL,
	[last_name] [varchar](255) NULL,
	[first_name] [varchar](255) NULL,
	[state_id] [varchar](255) NULL,
	[focus_id] [varchar](255) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Advanced_Trend]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Advanced_Trend](
	[syear] [int] NULL,
	[timeframe] [varchar](8) NULL,
	[timeframe_id] [varchar](20) NULL,
	[sch_id] [int] NULL,
	[subgroup] [varchar](50) NULL,
	[group] [varchar](50) NULL,
	[color] [int] NULL,
	[series] [int] NULL,
	[as_of_date] [date] NULL,
	[school_days_elapsed] [int] NULL,
	[enrolled] [int] NULL,
	[enrolled_per] [decimal](10, 3) NULL,
	[enr] [int] NOT NULL,
	[gft_enr_stu] [int] NOT NULL,
	[gft_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[gft_gap] [decimal](10, 3) NULL,
	[hon_enr_stu] [int] NOT NULL,
	[hon_enr] [int] NOT NULL,
	[hon_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[hon_enr_composition] [decimal](10, 3) NOT NULL,
	[hon_perf_stu] [int] NOT NULL,
	[hon_perf] [int] NOT NULL,
	[hon_perf_stu_composition] [decimal](10, 3) NOT NULL,
	[hon_perf_composition] [decimal](10, 3) NOT NULL,
	[hon_gap] [decimal](10, 3) NULL,
	[adv_enr_stu] [int] NOT NULL,
	[adv_enr] [int] NOT NULL,
	[adv_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[adv_enr_composition] [decimal](10, 3) NOT NULL,
	[adv_perf_stu] [int] NOT NULL,
	[adv_perf] [int] NOT NULL,
	[adv_perf_stu_composition] [decimal](10, 3) NOT NULL,
	[adv_perf_composition] [decimal](10, 3) NOT NULL,
	[adv_gap] [decimal](10, 3) NULL,
	[acc_enr_stu] [int] NOT NULL,
	[acc_enr] [int] NOT NULL,
	[acc_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[acc_enr_composition] [decimal](10, 3) NOT NULL,
	[acc_perf_stu] [int] NOT NULL,
	[acc_perf] [int] NOT NULL,
	[acc_perf_stu_composition] [decimal](10, 3) NOT NULL,
	[acc_perf_composition] [decimal](10, 3) NOT NULL,
	[acc_gap] [decimal](10, 3) NULL,
	[ap_enr_stu] [int] NOT NULL,
	[ap_enr] [int] NOT NULL,
	[ap_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[ap_enr_composition] [decimal](10, 3) NOT NULL,
	[ap_perf_stu] [int] NOT NULL,
	[ap_perf] [int] NOT NULL,
	[ap_perf_stu_composition] [decimal](10, 3) NOT NULL,
	[ap_perf_composition] [decimal](10, 3) NOT NULL,
	[ap_gap] [decimal](10, 3) NULL,
	[ib_enr_stu] [int] NOT NULL,
	[ib_enr] [int] NOT NULL,
	[ib_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[ib_enr_composition] [decimal](10, 3) NOT NULL,
	[ib_perf_stu] [int] NOT NULL,
	[ib_perf] [int] NOT NULL,
	[ib_perf_stu_composition] [decimal](10, 3) NOT NULL,
	[ib_perf_composition] [decimal](10, 3) NOT NULL,
	[ib_gap] [decimal](10, 3) NULL,
	[aice_enr_stu] [int] NOT NULL,
	[aice_enr] [int] NOT NULL,
	[aice_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[aice_enr_composition] [decimal](10, 3) NOT NULL,
	[aice_perf_stu] [int] NOT NULL,
	[aice_perf] [int] NOT NULL,
	[aice_perf_stu_composition] [decimal](10, 3) NOT NULL,
	[aice_perf_composition] [decimal](10, 3) NOT NULL,
	[aice_gap] [decimal](10, 3) NULL,
	[dual_enr_stu] [int] NOT NULL,
	[dual_enr] [int] NOT NULL,
	[dual_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[dual_enr_composition] [decimal](10, 3) NOT NULL,
	[dual_perf_stu] [int] NOT NULL,
	[dual_perf] [int] NOT NULL,
	[dual_perf_stu_composition] [decimal](10, 3) NOT NULL,
	[dual_perf_composition] [decimal](10, 3) NOT NULL,
	[dual_gap] [decimal](10, 3) NULL,
	[cte_enr_stu] [int] NOT NULL,
	[cte_enr] [int] NOT NULL,
	[cte_enr_stu_composition] [decimal](10, 3) NOT NULL,
	[cte_enr_composition] [decimal](10, 3) NOT NULL,
	[cte_perf_stu] [int] NOT NULL,
	[cte_perf] [int] NOT NULL,
	[cte_perf_stu_composition] [decimal](10, 3) NOT NULL,
	[cte_perf_composition] [decimal](10, 3) NOT NULL,
	[cte_gap] [decimal](10, 3) NULL,
	[hon_pot_stu] [int] NULL,
	[hon_pot_stu_composition] [decimal](10, 3) NULL,
	[adv_pot_stu] [int] NULL,
	[adv_pot_stu_composition] [decimal](10, 3) NULL,
	[acc_pot_stu] [int] NULL,
	[acc_pot_stu_composition] [decimal](10, 3) NULL,
	[ap_pot_stu] [int] NULL,
	[ap_pot_stu_composition] [decimal](10, 3) NULL,
	[ib_pot_stu] [int] NULL,
	[ib_pot_stu_composition] [decimal](10, 3) NULL,
	[aice_pot_stu] [int] NULL,
	[aice_pot_stu_composition] [decimal](10, 3) NULL,
	[dual_pot_stu] [int] NULL,
	[dual_pot_stu_composition] [decimal](10, 3) NULL,
	[cte_pot_stu] [int] NULL,
	[cte_pot_stu_composition] [decimal](10, 3) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Assessment_Cycle_District]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Assessment_Cycle_District](
	[school_year] [varchar](50) NULL,
	[test_name] [varchar](500) NULL,
	[test_id] [varchar](50) NULL,
	[cycle] [varchar](50) NULL,
	[test] [varchar](50) NULL,
	[Red_Count] [int] NULL,
	[Red_Percent] [decimal](18, 2) NULL,
	[Yellow_Count] [int] NULL,
	[Yellow_Percent] [decimal](18, 2) NULL,
	[Green_Count] [int] NULL,
	[Green_Percent] [decimal](18, 2) NULL,
	[Total_Count] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Assessment_Cycle_Region]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Assessment_Cycle_Region](
	[school_year] [varchar](4) NULL,
	[region] [varchar](1) NULL,
	[test_name] [varchar](500) NULL,
	[test_id] [varchar](50) NULL,
	[cycle] [varchar](1) NULL,
	[test] [varchar](500) NULL,
	[Red_Count] [int] NULL,
	[Red_Percent] [decimal](18, 2) NULL,
	[Yellow_Count] [int] NULL,
	[Yellow_Percent] [decimal](18, 2) NULL,
	[Green_Count] [int] NULL,
	[Green_Percent] [decimal](18, 2) NULL,
	[Total_Count] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Assessment_Cycle_School]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Assessment_Cycle_School](
	[school_year] [varchar](50) NULL,
	[region] [varchar](1) NULL,
	[StateSchoolID] [varchar](4) NULL,
	[FOCUS_SCHOOL_ID] [numeric](18, 0) NULL,
	[SCHOOL_NAME] [varchar](100) NULL,
	[test_name] [varchar](500) NULL,
	[test_id] [varchar](50) NULL,
	[cycle] [varchar](50) NULL,
	[test] [varchar](50) NULL,
	[Red_Count] [int] NULL,
	[Red_Percent] [decimal](18, 2) NULL,
	[Yellow_Count] [int] NULL,
	[Yellow_Percent] [decimal](18, 2) NULL,
	[Green_Count] [int] NULL,
	[Green_Percent] [decimal](18, 2) NULL,
	[Total_Count] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Assessment_Cycle_Students]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Assessment_Cycle_Students](
	[unique_id] [varchar](150) NULL,
	[student_code] [int] NULL,
	[test_id] [varchar](50) NULL,
	[test_name] [varchar](500) NULL,
	[test_event_id] [varchar](50) NULL,
	[score] [decimal](18, 0) NULL,
	[last_edit_dt] [varchar](50) NULL,
	[insert_date] [datetime] NULL,
	[update_date] [datetime] NULL,
	[school_year] [varchar](50) NULL,
	[school] [varchar](4) NULL,
	[YellowCut] [varchar](50) NULL,
	[GreenCut] [varchar](50) NULL,
	[StopLightColor] [char](30) NULL,
	[cycle] [varchar](50) NULL,
	[test] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Attendance_Schools]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Attendance_Schools](
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[timeframe] [varchar](20) NULL,
	[timeframe_id] [varchar](50) NULL,
	[group] [varchar](50) NULL,
	[subgroup] [varchar](50) NULL,
	[type] [varchar](20) NULL,
	[abs_code] [varchar](20) NULL,
	[abs_desc] [varchar](50) NULL,
	[total] [int] NULL,
	[abs_per] [float] NULL,
	[sort] [int] NULL,
	[series] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Attendance_Trend]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Attendance_Trend](
	[syear] [int] NULL,
	[timeframe] [varchar](8) NULL,
	[timeframe_id] [varchar](20) NULL,
	[group] [varchar](50) NULL,
	[sch_id] [int] NULL,
	[subgroup] [varchar](50) NULL,
	[color] [int] NULL,
	[series] [int] NULL,
	[enrolled] [int] NULL,
	[enrolled_per] [decimal](10, 3) NULL,
	[att_rate] [numeric](24, 12) NULL,
	[abs20_stu] [int] NULL,
	[abs20_stu_composition] [decimal](10, 3) NULL,
	[abs20_per] [decimal](10, 0) NULL,
	[abs10_stu] [int] NULL,
	[abs10_stu_composition] [decimal](10, 3) NULL,
	[abs10_per] [decimal](10, 0) NULL,
	[abs0_stu] [int] NULL,
	[abs0_stu_composition] [decimal](10, 3) NULL,
	[abs0_per] [decimal](10, 0) NULL,
	[abs_num] [int] NULL,
	[abs_unx] [int] NULL,
	[abs_exc] [int] NULL,
	[QP] [int] NULL,
	[PND_unx] [int] NULL,
	[SKP_unx] [int] NULL,
	[FAM_unx] [int] NULL,
	[EMP_unx] [int] NULL,
	[TRA_unx] [int] NULL,
	[DIS_unx] [int] NULL,
	[MDU_unx] [int] NULL,
	[QA_unx] [int] NULL,
	[UNX_unx] [int] NULL,
	[MDE_exc] [int] NULL,
	[EME_exc] [int] NULL,
	[LEG_exc] [int] NULL,
	[ACE_exc] [int] NULL,
	[REL_exc] [int] NULL,
	[EXC_exc] [int] NULL,
	[as_of_date] [date] NULL,
	[school_days] [int] NULL,
	[category] [varchar](8) NOT NULL,
	[category_id] [int] NULL,
	[value_list] [varchar](50) NULL,
	[toggle] [varchar](12) NULL,
	[green] [int] NOT NULL,
	[gold] [int] NOT NULL,
	[red] [int] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Behavior_Incidents]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Behavior_Incidents](
	[referral_id] [numeric](18, 0) NULL,
	[syear] [numeric](18, 0) NULL,
	[timeframe] [varchar](10) NULL,
	[timeframe_id] [varchar](10) NULL,
	[toggle] [varchar](10) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[emp_username] [varchar](50) NULL,
	[incident_date] [date] NULL,
	[incident] [varchar](1000) NULL,
	[incident_location] [varchar](1000) NULL,
	[response_date] [date] NULL,
	[response_id] [numeric](18, 0) NULL,
	[response] [varchar](max) NULL,
	[response_code] [varchar](max) NULL,
	[stu_sch_id] [numeric](18, 0) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[last_first] [varchar](153) NULL,
	[GRD] [varchar](2) NULL,
	[ETH] [varchar](1) NULL,
	[BNB] [varchar](2) NULL,
	[GND] [varchar](1) NULL,
	[ELL] [varchar](1) NOT NULL,
	[SWD] [varchar](1) NOT NULL,
	[FRL] [varchar](1) NOT NULL,
	[L35M] [varchar](1) NOT NULL,
	[L35R] [varchar](1) NOT NULL,
	[color_GRD_EL] [int] NULL,
	[color_GRD_MS] [int] NULL,
	[color_GRD_HS] [int] NULL,
	[color_ETH] [int] NULL,
	[color_BNB] [int] NULL,
	[color_GND] [int] NULL,
	[color_ELL] [int] NOT NULL,
	[color_SWD] [int] NOT NULL,
	[color_FRL] [int] NOT NULL,
	[color_L35M] [int] NOT NULL,
	[color_L35R] [int] NOT NULL,
	[generic_info] [varchar](22) NOT NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_CA_scores_school]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_CA_scores_school](
	[syear] [int] NULL,
	[school_id] [numeric](18, 0) NOT NULL,
	[title] [varchar](100) NULL,
	[subj] [varchar](50) NULL,
	[testid] [varchar](50) NULL,
	[test_name] [varchar](500) NULL,
	[students] [int] NULL,
	[mean] [numeric](38, 6) NULL,
	[proficiency] [numeric](5, 2) NULL,
	[advanced] [numeric](5, 2) NULL,
	[low_proficiency] [int] NULL,
	[mid_proficiency] [int] NULL,
	[high_proficiency] [int] NULL,
	[low_proficency_ratio] [numeric](24, 12) NULL,
	[mid_proficency_ratio] [numeric](24, 12) NULL,
	[high_proficency_ratio] [numeric](24, 12) NULL,
	[below_stdev] [int] NULL,
	[within_stdev] [int] NULL,
	[above_stdev] [int] NULL,
	[below_stdev_ratio] [numeric](24, 12) NULL,
	[within_stdev_ratio] [numeric](24, 12) NULL,
	[above_stdev_ratio] [numeric](24, 12) NULL,
	[flagged] [int] NULL,
	[flagged_ratio] [numeric](24, 12) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Constants]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Constants](
	[relative_year] [int] NULL,
	[syear] [int] NOT NULL,
	[syear_long] [varchar](10) NULL,
	[grad_year] [int] NULL,
	[start_yr] [date] NULL,
	[end_yr] [date] NULL,
	[start_s1] [date] NULL,
	[lastday_s1] [date] NULL,
	[end_s1] [date] NULL,
	[start_s2] [date] NULL,
	[end_s2] [date] NULL,
	[start_mp1] [date] NULL,
	[lastday_mp1] [date] NULL,
	[end_mp1] [date] NULL,
	[start_mp2] [date] NULL,
	[lastday_mp2] [date] NULL,
	[end_mp2] [date] NULL,
	[start_mp3] [date] NULL,
	[lastday_mp3] [date] NULL,
	[end_mp3] [date] NULL,
	[start_mp4] [date] NULL,
	[end_mp4] [date] NULL,
	[start_ss] [date] NULL,
	[end_ss] [date] NULL,
	[days_yr] [int] NULL,
	[days_S1] [int] NULL,
	[days_S2] [int] NULL,
	[days_Q1] [int] NULL,
	[days_Q2] [int] NULL,
	[days_Q3] [int] NULL,
	[days_Q4] [int] NULL,
	[days_SS] [int] NULL,
	[days_m01] [int] NULL,
	[days_m02] [int] NULL,
	[days_m03] [int] NULL,
	[days_m04] [int] NULL,
	[days_m05] [int] NULL,
	[days_m06] [int] NULL,
	[days_m07] [int] NULL,
	[days_m08] [int] NULL,
	[days_m09] [int] NULL,
	[days_m10] [int] NULL,
	[days_m11] [int] NULL,
	[days_m12] [int] NULL,
	[school_days_elapsed] [int] NULL,
	[school_date] [date] NULL,
	[next_school_date] [date] NULL,
	[today] [date] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Discipline_Students]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Discipline_Students](
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[stu_id] [int] NULL,
	[timeframe] [varchar](50) NULL,
	[timeframe_id] [varchar](50) NULL,
	[timeframe_days] [int] NULL,
	[group] [varchar](50) NULL,
	[subgroup] [varchar](50) NULL,
	[color] [int] NULL,
	[series] [int] NULL,
	[ref] [int] NULL,
	[iss] [int] NULL,
	[oss] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_EWS]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_EWS](
	[syear] [int] NULL,
	[category] [varchar](8) NOT NULL,
	[category_id] [int] NOT NULL,
	[subgroup] [varchar](26) NOT NULL,
	[value_list] [varchar](15) NULL,
	[color] [int] NOT NULL,
	[green] [int] NOT NULL,
	[gold] [int] NOT NULL,
	[red] [int] NOT NULL,
	[enrolled] [int] NULL,
	[enrolled_per] [decimal](10, 3) NULL,
	[abs_stu] [int] NULL,
	[abs_stu_composition] [decimal](10, 3) NULL,
	[abs_per] [decimal](10, 0) NULL,
	[bhv_stu] [int] NULL,
	[bhv_stu_composition] [decimal](10, 3) NULL,
	[bhv_per] [decimal](10, 0) NULL,
	[f_stu] [int] NULL,
	[f_stu_composition] [decimal](10, 3) NULL,
	[f_per] [decimal](10, 0) NULL,
	[gpa_stu] [int] NULL,
	[gpa_stu_composition] [decimal](10, 3) NULL,
	[gpa_per] [decimal](10, 0) NULL,
	[tsts_stu] [int] NULL,
	[tsts_stu_composition] [decimal](10, 3) NULL,
	[tsts_per] [decimal](10, 0) NULL,
	[mtpl_stu] [int] NULL,
	[mtpl_stu_composition] [decimal](10, 3) NULL,
	[mtpl_per] [decimal](10, 0) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[profile_fsa_2016]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[profile_fsa_2016](
	[syear] [int] NOT NULL,
	[sch_state_id] [varchar](4) NULL,
	[School] [nvarchar](255) NULL,
	[group] [nvarchar](255) NULL,
	[subgroup] [nvarchar](255) NULL,
	[subj] [varchar](14) NOT NULL,
	[Mean] [float] NULL,
	[level1] [float] NULL,
	[level2] [float] NULL,
	[level3] [float] NULL,
	[level4] [float] NULL,
	[level5] [float] NULL,
	[Students] [float] NULL,
	[prof_per] [float] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_FSA_History]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_FSA_History](
	[syear] [varchar](4) NULL,
	[sch_id] [int] NOT NULL,
	[region] [int] NOT NULL,
	[demo] [varchar](26) NOT NULL,
	[value_list] [varchar](15) NOT NULL,
	[color] [int] NOT NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[GRADE] [varchar](10) NULL,
	[PartName] [varchar](14) NOT NULL,
	[Achievement_Level] [varchar](10) NULL,
	[Scale_Score] [varchar](10) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_FSA_Trend]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_FSA_Trend](
	[syear] [int] NULL,
	[category] [varchar](100) NOT NULL,
	[category_id] [int] NOT NULL,
	[subgroup] [varchar](100) NOT NULL,
	[value_list] [varchar](100) NOT NULL,
	[color] [int] NOT NULL,
	[subj] [varchar](8000) NULL,
	[stu] [int] NULL,
	[mean_score] [decimal](10, 0) NULL,
	[level1_per] [decimal](10, 0) NULL,
	[level2_per] [decimal](10, 0) NULL,
	[level3_per] [decimal](10, 0) NULL,
	[level4_per] [decimal](10, 0) NULL,
	[level5_per] [decimal](10, 0) NULL,
	[prof_per] [decimal](10, 0) NULL,
	[l2_start] [decimal](10, 0) NULL,
	[l3_start] [decimal](10, 0) NULL,
	[l4_start] [decimal](10, 0) NULL,
	[l5_start] [decimal](10, 0) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[profile_ncaa_gpa_sat_act]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[profile_ncaa_gpa_sat_act](
	[gpa] [float] NOT NULL,
	[sat] [int] NOT NULL,
	[act] [int] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Schools]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Schools](
	[sch_id] [int] NOT NULL,
	[sch_state_id] [varchar](50) NULL,
	[school] [varchar](100) NULL,
	[name] [varchar](100) NULL,
	[category] [varchar](50) NULL,
	[region] [int] NULL,
	[school_level] [varchar](100) NULL,
 CONSTRAINT [PK_Profile_Schools] PRIMARY KEY CLUSTERED 
(
	[sch_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Student_Grad_Assessment_Requirements]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Grad_Assessment_Requirements](
	[syear] [int] NOT NULL,
	[grd10_fcat_read] [int] NULL,
	[grd10_fcat_math] [int] NULL,
	[grd10_fcat2_read] [int] NULL,
	[grd10_fsa_read] [int] NULL,
	[act_read] [int] NULL,
	[act_eng_read] [int] NULL,
	[act_math] [int] NULL,
	[sat3_read] [int] NULL,
	[sat3_math] [int] NULL,
	[sat4_read] [int] NULL,
	[sat4_ebrw] [int] NULL,
	[sat4_math] [int] NULL,
	[pert_math] [int] NULL,
	[alg1_eoc_ngsss] [int] NULL,
	[alg1_eoc_fsa] [int] NULL,
	[alg2_eoc] [int] NULL,
	[geo_eoc_ngsss] [int] NULL,
	[geo_eoc_fsa] [int] NULL,
	[bio_eoc] [int] NULL,
	[us_hist_eoc] [int] NULL,
	[psa_math] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Student_Grad_Requirements_old]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Grad_Requirements_old](
	[syear] [numeric](18, 0) NOT NULL,
	[short_name] [varchar](50) NULL,
	[grad_req_prgm] [varchar](50) NOT NULL,
	[total_ela_credits] [int] NOT NULL,
	[alg1_credits] [int] NOT NULL,
	[alg2_credits] [int] NOT NULL,
	[geo_credits] [int] NOT NULL,
	[stats_credits] [int] NOT NULL,
	[other_math_credits] [int] NOT NULL,
	[total_math_credits] [int] NOT NULL,
	[bio_credits] [int] NOT NULL,
	[chem_phys_credits] [int] NOT NULL,
	[sci_eq_credits] [int] NOT NULL,
	[other_sci_credits] [int] NOT NULL,
	[total_sci_credits] [int] NOT NULL,
	[world_hist_credits] [int] NOT NULL,
	[us_hist_credits] [int] NOT NULL,
	[govt_credits] [numeric](1, 1) NOT NULL,
	[econ_credits] [numeric](1, 1) NOT NULL,
	[total_ss_credits] [int] NOT NULL,
	[f_lang_credits] [int] NOT NULL,
	[total_arts_credits] [int] NOT NULL,
	[hope_credits] [int] NOT NULL,
	[total_pe_credits] [int] NOT NULL,
	[total_elective_credits] [int] NOT NULL,
	[online_class] [int] NOT NULL,
	[college_credits] [int] NOT NULL,
	[total_credits] [int] NOT NULL,
	[industry_cert] [int] NULL,
	[grd10_fcat_read] [int] NOT NULL,
	[grd10_fcat_math] [int] NOT NULL,
	[grd10_fcat2_read] [int] NOT NULL,
	[grd10_fsa_read] [int] NOT NULL,
	[act_read] [int] NOT NULL,
	[sat3_read] [int] NOT NULL,
	[sat4_read] [int] NOT NULL,
	[pert_math] [int] NULL,
	[alg1_eoc] [int] NOT NULL,
	[alg2_eoc] [int] NOT NULL,
	[geo_eoc] [int] NOT NULL,
	[bio_eoc] [int] NOT NULL,
	[us_hist_eoc] [int] NOT NULL,
	[unwtd_cum_gpa] [numeric](2, 1) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Student_Grad_Status_Totals]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_Grad_Status_Totals](
	[syear] [numeric](18, 0) NULL,
	[sch_id] [int] NOT NULL,
	[school] [varchar](255) NOT NULL,
	[group] [varchar](255) NOT NULL,
	[subgroup] [varchar](255) NOT NULL,
	[students] [int] NULL,
	[num_on_track] [int] NULL,
	[per_on_track] [float] NULL,
	[num_off_track] [int] NULL,
	[per_off_track] [float] NULL,
	[num_severely_off_track] [int] NULL,
	[per_severely_off_track] [float] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_Student_NCAA_Requirements]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_Student_NCAA_Requirements](
	[syear] [int] NOT NULL,
	[total_en_credits] [int] NOT NULL,
	[total_ma_credits] [int] NOT NULL,
	[total_sc_credits] [int] NOT NULL,
	[total_addl_enmasc_credits] [int] NOT NULL,
	[total_ss_credits] [int] NOT NULL,
	[total_addl_credits] [int] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Profile_students]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Profile_students](
	[sch_state_id] [varchar](4) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[school] [varchar](100) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[stu_local_id] [varchar](50) NULL,
	[last_first] [varchar](153) NULL,
	[birthdate] [date] NULL,
	[age] [int] NULL,
	[grade] [varchar](2) NULL,
	[local_ethnic_code] [varchar](1) NULL,
	[primary_exc] [varchar](255) NULL,
	[ell_status] [varchar](255) NULL,
	[gpa_unwtd] [decimal](9, 4) NULL,
	[ela_level] [varchar](50) NULL,
	[mth_level] [varchar](50) NULL,
	[beh_iss] [int] NULL,
	[beh_oss] [int] NULL,
	[beh_ref] [int] NULL,
	[att_days] [int] NULL,
	[abs_exc] [int] NULL,
	[abs_unx] [int] NULL,
	[abs_all] [int] NULL,
	[abs_exc_per] [numeric](9, 3) NULL,
	[abs_unx_per] [numeric](9, 3) NULL,
	[abs_all_per] [numeric](9, 3) NULL,
	[tar_all] [int] NULL,
	[tar_all_per] [numeric](9, 3) NULL,
	[retained] [int] NULL,
	[expected_grade_by_age] [int] NULL,
	[grade_difference] [int] NULL,
	[F_rptcard] [int] NULL,
	[F_rptcard_lastyr] [int] NULL,
	[F_rptcard_all] [int] NULL,
	[F_gradebook] [int] NULL,
	[last_updated] [date] NULL,
	[flag_absences] [int] NULL,
	[flag_behavior] [int] NULL,
	[flag_Fs] [int] NULL,
	[flag_GPA] [int] NULL,
	[flag_tests] [int] NULL,
	[flag_multiple] [int] NULL,
	[adv_enr] [int] NULL,
	[adv_pot] [int] NULL,
	[ctae_ref] [varchar](10) NULL,
	[grad_stat] [nvarchar](255) NULL,
	[xmchart_code] [nvarchar](4000) NOT NULL,
	[SWD] [varchar](50) NULL,
	[ELL] [varchar](50) NULL,
	[counselor] [varchar](255) NULL,
	[ADV] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[RAR_Enter_Leave]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[RAR_Enter_Leave](
	[EnterNum] [int] NULL,
	[LeaveNum] [int] NULL,
	[SCHOOLNUM_DISTR] [varchar](255) NULL,
	[FOCUS_STUDENT_ID] [bigint] NOT NULL,
	[START_DATE] [date] NULL,
	[END_DATE] [date] NULL,
	[SchoolName] [varchar](255) NULL,
	[Level] [varchar](5) NULL,
	[EnterCode] [varchar](10) NULL,
	[LeaveCode] [varchar](10) NULL,
	[LastName] [varchar](255) NULL,
	[FirstName] [varchar](255) NULL,
	[Gender] [varchar](255) NULL,
	[Grade] [varchar](2) NULL,
	[EthnicCode] [varchar](1) NULL,
	[InstrSet] [varchar](255) NULL,
	[AssignCode] [varchar](255) NULL,
	[StudentLng] [varchar](255) NULL,
	[LEP] [varchar](255) NULL,
	[PriExc] [varchar](100) NULL,
	[MyPCSOnline] [char](1) NULL,
	[LearningOptionInterventionPlan] [char](1) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[records_request_orhpan_costcenters]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[records_request_orhpan_costcenters](
	[Dist] [nvarchar](2) NULL,
	[FY] [nvarchar](2) NULL,
	[Cntr] [nvarchar](14) NULL,
	[Description] [nvarchar](100) NULL,
	[TypeLvl] [nvarchar](2) NULL,
	[CntrAddress1] [nvarchar](32) NULL,
	[CntrAddress2] [nvarchar](36) NULL,
	[CntrCity] [nvarchar](20) NULL,
	[CntrState] [nvarchar](2) NULL,
	[CntrZip5] [nvarchar](5) NULL,
	[CntrZip4] [nvarchar](4) NULL,
	[CntrHead] [nvarchar](36) NULL,
	[CntrPhAreaCode] [nvarchar](3) NULL,
	[CntrPhExc] [nvarchar](3) NULL,
	[CntrPhNbr] [nvarchar](4) NULL,
	[CntrPhExt] [nvarchar](4) NULL,
	[CntrPhoneNbr] [nvarchar](14) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[RS_Graduation_Cohort_Report]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[RS_Graduation_Cohort_Report](
	[Yr Ent HS] [int] NULL,
	[SchlNum] [varchar](10) NULL,
	[Student ID] [varchar](20) NULL,
	[Student Name] [nvarchar](200) NULL,
	[Gnd] [varchar](10) NULL,
	[R] [varchar](10) NULL,
	[Meets Accel] [varchar](10) NULL,
	[WD Code] [varchar](20) NULL,
	[Inst] [varchar](20) NULL,
	[9th ESE] [varchar](10) NULL,
	[FTE ELL Status] [varchar](10) NULL,
	[Curr ELL Status] [varchar](10) NULL,
	[SLC] [varchar](50) NULL,
	[Gr] [varchar](10) NULL,
	[FSA Rd] [varchar](20) NULL,
	[AlgEOC] [varchar](10) NULL,
	[GPA] [numeric](9, 4) NULL,
	[Read Admin Gr] [varchar](10) NULL,
	[ACCESS RD/OA] [varchar](20) NULL,
	[Tot Ct Att] [numeric](9, 2) NULL,
	[Tot Cr Ern] [numeric](9, 2) NULL,
	[At Risk] [varchar](10) NULL,
	[Grad On Track] [varchar](10) NULL,
	[Con. Sc R] [varchar](10) NULL,
	[Con. Sc M] [varchar](10) NULL,
	[last_updated] [datetime] NULL,
	[imported] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[SB_ms_students_target]    Script Date: 3/27/2023 10:28:48 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SB_ms_students_target](
	[f001] [varchar](max) NULL,
	[f002] [varchar](max) NULL,
	[f003] [varchar](max) NULL,
	[f004] [varchar](max) NULL,
	[f005] [varchar](max) NULL,
	[f006] [varchar](max) NULL,
	[f007] [varchar](max) NULL,
	[f008] [varchar](max) NULL,
	[f009] [varchar](max) NULL,
	[f010] [varchar](max) NULL,
	[f011] [varchar](max) NULL,
	[f012] [varchar](max) NULL,
	[f013] [varchar](max) NULL,
	[f014] [varchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[sbInviteList]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[sbInviteList](
	[sch_state_id] [varchar](50) NULL,
	[school] [varchar](255) NULL,
	[stu_local_id] [varchar](50) NULL,
	[stu_id] [varchar](50) NULL,
	[last_name] [varchar](50) NULL,
	[first_name] [varchar](50) NULL,
	[Grade] [varchar](50) NULL,
	[local_ethnic_code] [varchar](max) NULL,
	[gender] [varchar](max) NULL,
	[SB_school] [varchar](255) NULL,
	[ell_status] [varchar](max) NULL,
	[primary_exc] [varchar](255) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[sp_time_effort]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[sp_time_effort](
	[FY] [numeric](3, 0) NOT NULL,
	[SSN] [nvarchar](10) NOT NULL,
	[LASTNAME] [nvarchar](17) NULL,
	[FIRSTNAME] [nvarchar](12) NULL,
	[Job] [nvarchar](2) NOT NULL,
	[ACCTPCT] [varchar](31) NULL,
	[Fund] [nvarchar](4) NULL,
	[Func] [nvarchar](4) NULL,
	[Obj] [nvarchar](4) NULL,
	[Cntr] [nvarchar](4) NULL,
	[Proj] [nvarchar](4) NULL,
	[Subp] [nvarchar](4) NULL,
	[Prog] [nvarchar](4) NULL,
	[TITLE] [nvarchar](5) NULL,
	[Description] [nvarchar](30) NULL,
	[Start] [varchar](30) NULL,
	[Term] [varchar](30) NOT NULL,
	[RecordNbr] [nvarchar](1) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[SPL_ThreatReport]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SPL_ThreatReport](
	[ID_THRPT] [float] NULL,
	[Title] [nvarchar](max) NULL,
	[Tht_rpt_rept_tht_firstname] [nvarchar](max) NULL,
	[Tht_rpt_rept_tht_lastname] [nvarchar](max) NULL,
	[Tht_rpt_person_receiving_rptId] [int] NULL,
	[Tht_rpt_date_rptd] [datetime] NULL,
	[Tht_rpt_person_affiliationValue] [nvarchar](max) NULL,
	[Tht_rpt_school] [nvarchar](max) NULL,
	[Tht_rpt_principal] [nvarchar](max) NULL,
	[Tht_rpt_stu_making_tht] [nvarchar](max) NULL,
	[Tht_rpt_summary] [nvarchar](max) NULL,
	[Asmt_findings_Prior_thtsValue] [nvarchar](max) NULL,
	[Asmt_findings_Prior_disc_incidentsValue] [nvarchar](max) NULL,
	[Asmt_findings_Acad_recValue] [nvarchar](max) NULL,
	[Asmt_findings_Spec_edu_recValue] [nvarchar](max) NULL,
	[Asmt_findings_other_recValue] [nvarchar](max) NULL,
	[Asmt_findings_rec_from_oth_schsValue] [nvarchar](max) NULL,
	[Asmt_findings_rec_from_outside_agencyValue] [nvarchar](max) NULL,
	[Asmt_findings_law_enforcement_recValue] [nvarchar](max) NULL,
	[Asmt_findings_emp_recValue] [nvarchar](max) NULL,
	[Asmt_findings_prior_thts_RF] [nvarchar](max) NULL,
	[Asmt_findings_Prior_disc_incidents_RF] [nvarchar](max) NULL,
	[Asmt_findings_Acad_rec_RF] [nvarchar](max) NULL,
	[Asmt_findings_Spec_edu_rec_RF] [nvarchar](max) NULL,
	[Asmt_findings_other_rec_RF] [nvarchar](max) NULL,
	[Asmt_findings_rec_from_oth_schs_RF] [nvarchar](max) NULL,
	[Asmt_findings_rec_from_outside_agency_RF] [nvarchar](max) NULL,
	[Asmt_findings_law_enforcement_rec_RF] [nvarchar](max) NULL,
	[Asmt_findings_emp_rec_RF] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made] [datetime] NULL,
	[Tht_rpt_made_school] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_stu_local_id] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_gender] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_age] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_grade] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_ESE] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_504] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_emerg_contact] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_relationship] [nvarchar](max) NULL,
	[Ht_rpt_date_tht_made_address] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_phone] [nvarchar](max) NULL,
	[Tht_rpt_location_occurred_other] [nvarchar](max) NULL,
	[Tht_rpt_date_tht_made_ethnicity] [nvarchar](max) NULL,
	[StatusValue] [nvarchar](max) NULL,
	[ContentTypeID] [nvarchar](max) NULL,
	[ComplianceAssetId] [nvarchar](max) NULL,
	[CreatedById] [int] NULL,
	[Thrt_rpt_stu_id] [nvarchar](max) NULL,
	[Tht_rpt_DOB] [nvarchar](max) NULL,
	[Id] [int] NULL,
	[ContentType] [nvarchar](max) NULL,
	[Modified] [datetime] NULL,
	[Created] [datetime] NULL,
	[ModifiedById] [int] NULL,
	[Owshiddenversion] [int] NULL,
	[Version] [nvarchar](max) NULL,
	[Path] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[SPL_Transp_HelpDesk]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SPL_Transp_HelpDesk](
	[ContentTypeID] [nvarchar](max) NULL,
	[Title] [nvarchar](max) NULL,
	[ComplianceAssetId] [nvarchar](max) NULL,
	[Description] [nvarchar](max) NULL,
	[AssignedToId] [int] NULL,
	[Student] [nvarchar](max) NULL,
	[Category] [nvarchar](max) NULL,
	[SubCategory1] [nvarchar](max) NULL,
	[SubCategory2] [nvarchar](max) NULL,
	[Investigator] [nvarchar](max) NULL,
	[Priority] [nvarchar](max) NULL,
	[AssignedInvestigator] [nvarchar](max) NULL,
	[Stu_costCenter] [nvarchar](max) NULL,
	[TaskStatus] [nvarchar](max) NULL,
	[AssignedInvestigator_2] [nvarchar](max) NULL,
	[ReportedBy] [nvarchar](max) NULL,
	[ReportedByNumber] [nvarchar](max) NULL,
	[Route_number] [nvarchar](max) NULL,
	[School] [nvarchar](max) NULL,
	[Citizen] [nvarchar](max) NULL,
	[Parent_Notified] [nvarchar](max) NULL,
	[Stu_local_id] [nvarchar](max) NULL,
	[Citizen_Last] [nvarchar](max) NULL,
	[Created] [datetime] NULL,
	[Am_pm_route] [nvarchar](max) NULL,
	[CreatedById] [int] NULL,
	[CreatedByAdded] [nvarchar](max) NULL,
	[Id] [int] NULL,
	[ContentType] [nvarchar](max) NULL,
	[Modified] [datetime] NULL,
	[ModifiedById] [int] NULL,
	[Owshiddenversion] [int] NULL,
	[Version] [nvarchar](max) NULL,
	[Path] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[SRS_Dist_App_Prog_Monitor]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SRS_Dist_App_Prog_Monitor](
	[SchoolYear] [varchar](9) NOT NULL,
	[Date_Time] [char](19) NULL,
	[Student] [varchar](64) NULL,
	[Action_User] [varchar](50) NULL,
	[Birth_Date] [char](10) NULL,
	[Action] [varchar](120) NULL,
	[Action_type] [varchar](5) NULL,
	[Prog_Rank] [varchar](4) NULL,
	[Program] [varchar](120) NULL,
	[Program_number] [varchar](20) NULL,
	[Student_ID] [varchar](50) NULL,
	[Appl_ID] [varchar](50) NOT NULL,
	[Grade_ap] [varchar](2) NULL,
	[num_date] [char](19) NULL,
	[num_date_2] [char](19) NULL,
	[ethnicity] [varchar](1) NULL,
	[RaceIndianAlaskan] [varchar](1) NULL,
	[RaceAsian] [varchar](1) NULL,
	[RaceBlack] [varchar](1) NULL,
	[RaceHawaiianPacific] [varchar](1) NULL,
	[RaceWhite] [varchar](1) NULL,
	[DAP_BradleyCode] [varchar](1) NOT NULL,
	[DAP_LocalEthnicCode] [varchar](1) NULL,
	[Mailing_Addr1] [varchar](50) NULL,
	[Mailing_Addr2] [varchar](50) NULL,
	[Mailing_City] [varchar](24) NULL,
	[Mailing_State] [varchar](24) NULL,
	[Mailing_Zip] [varchar](10) NULL,
	[Parent_Name] [varchar](max) NULL,
	[bradley_ethniccode] [varchar](1) NULL,
	[LocalEthnicCode] [varchar](1) NULL,
	[FREEMEALS_code] [varchar](1) NULL,
	[FREEMEALS] [varchar](1) NOT NULL,
	[CurrSchool] [varchar](100) NULL,
	[CYZoneSchoolElem] [varchar](255) NULL,
	[CYZoneSchoolMiddle] [varchar](255) NULL,
	[CYZoneSchoolHigh] [varchar](255) NULL,
	[FTSVCCD] [varchar](8) NULL,
	[DEL_Student] [varchar](1) NOT NULL,
	[PriPhone] [varchar](30) NULL,
	[Email] [varchar](255) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Star_Assessments]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Star_Assessments](
	[assessment] [varchar](50) NULL,
	[assessment_code] [varchar](10) NULL,
	[syear] [int] NULL,
	[sch_state_id] [numeric](4, 0) NULL,
	[class_id] [numeric](18, 0) NULL,
	[emp_id] [numeric](18, 0) NULL,
	[emp_username] [nvarchar](50) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[stu_lastname] [nvarchar](50) NULL,
	[stu_firstname] [nvarchar](50) NULL,
	[stu_grade] [nvarchar](2) NULL,
	[ScreeningPeriodWindowName] [nvarchar](50) NULL,
	[ScreeningWindowStartDate] [date] NULL,
	[ScreeningWindowEndDate] [date] NULL,
	[earliest_test] [smallint] NULL,
	[CompletedDateLocal] [datetime] NULL,
	[TeacherIdentifier] [nvarchar](50) NULL,
	[AssessmentID] [nvarchar](50) NOT NULL,
	[AssessmentNumber] [int] NULL,
	[Grade] [nvarchar](10) NULL,
	[highest_score] [smallint] NULL,
	[UnifiedScore] [numeric](9, 0) NULL,
	[PercentileRank] [numeric](9, 0) NULL,
	[DistrictBenchmarkCategoryName] [nvarchar](50) NULL,
	[DistrictBenchmarkProficient] [nvarchar](10) NULL,
	[DistrictBenchmarkCategoryLevel] [smallint] NULL,
	[DistrictBenchmarkNumberOfCategoryLevels] [smallint] NULL,
	[Lexile] [nvarchar](10) NULL,
	[source_file] [nvarchar](50) NULL,
	[source_file_date] [datetime] NULL,
	[last_updated] [datetime] NULL,
 CONSTRAINT [PK_Star_Assessments] PRIMARY KEY CLUSTERED 
(
	[AssessmentID] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[StudentTracker_Students]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentTracker_Students](
	[source] [varchar](50) NULL,
	[date_inserted] [date] NULL,
	[sch_year] [varchar](4) NULL,
	[grad_date] [varchar](8) NULL,
	[sch_state_id] [varchar](4) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[stu_local_id] [varchar](50) NULL,
	[ssn] [varchar](50) NULL,
	[grade] [varchar](2) NULL,
	[race] [varchar](1) NULL,
	[gender] [varchar](1) NULL,
	[disabilities] [varchar](1) NULL,
	[econ_dis] [varchar](1) NULL,
	[ell] [varchar](1) NULL,
	[homeless] [varchar](1) NULL,
	[date_uploaded] [date] NULL,
	[notes] [varchar](8000) NULL,
 CONSTRAINT [PK_StudentTracker_Students] PRIMARY KEY CLUSTERED 
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[summer_bridge]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[summer_bridge](
	[student_id] [int] NULL,
	[permnum] [varchar](10) NULL,
	[statenum] [varchar](4) NULL,
	[sch_id] [numeric](9, 0) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[summer_bridge_attendance]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[summer_bridge_attendance](
	[courselink] [varchar](255) NULL,
	[course_id] [bigint] NOT NULL,
	[course_period_id] [bigint] NOT NULL,
	[school_id] [bigint] NOT NULL,
	[SB_level] [varchar](1) NULL,
	[sort_level] [int] NULL,
	[sch_name] [varchar](255) NULL,
	[sectionid] [varchar](255) NULL,
	[title] [varchar](100) NULL,
	[LAST_NAME] [varchar](255) NOT NULL,
	[FIRST_NAME] [varchar](255) NOT NULL,
	[period] [varchar](2) NOT NULL,
	[end_period] [varchar](2) NOT NULL,
	[stdt_count] [int] NULL,
	[pres_count] [int] NULL,
	[abs_count] [int] NULL,
	[max_grade_level] [varchar](5) NULL,
	[lvl_stdt_count] [int] NULL,
	[lvl_pres_count] [int] NULL,
	[lvl_abs_count] [int] NULL,
	[schl_stdt_count] [int] NULL,
	[schl_pres_count] [int] NULL,
	[schl_abs_count] [int] NULL,
	[schl_ADA_stdt_count] [numeric](38, 6) NULL,
	[schl_ADA_stdt_percent] [numeric](38, 6) NULL,
	[total_level_school_count] [int] NULL,
	[total_level_stdt_count] [int] NULL,
	[total_level_pres_count] [int] NULL,
	[total_level_abs_count] [int] NULL,
	[total_level_ADA_stdt_count] [numeric](18, 0) NULL,
	[total_level_ADA_stdt_percent] [numeric](38, 6) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[summer_bridge_stu_list_updated]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[summer_bridge_stu_list_updated](
	[school] [bigint] NULL,
	[PCSB_ID] [varchar](255) NULL,
	[SchlName] [varchar](255) NULL,
	[student_id] [bigint] NOT NULL,
	[permnum] [varchar](255) NULL,
	[Grade] [varchar](5) NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL,
	[SchlArea] [varchar](255) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[terms_FA_costcenters]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[terms_FA_costcenters](
	[Dist] [nvarchar](2) NULL,
	[FY] [nvarchar](2) NULL,
	[Cntr] [nvarchar](14) NULL,
	[Description] [nvarchar](30) NULL,
	[TypeLvl] [nvarchar](2) NULL,
	[CntrAddress1] [nvarchar](32) NULL,
	[CntrAddress2] [nvarchar](36) NULL,
	[CntrCity] [nvarchar](20) NULL,
	[CntrState] [nvarchar](2) NULL,
	[CntrZip5] [nvarchar](5) NULL,
	[CntrZip4] [nvarchar](4) NULL,
	[CntrHead] [nvarchar](36) NULL,
	[CntrPhAreaCode] [nvarchar](3) NULL,
	[CntrPhExc] [nvarchar](3) NULL,
	[CntrPhNbr] [nvarchar](4) NULL,
	[CntrPhExt] [nvarchar](4) NULL,
	[CntrPhoneNbr] [nvarchar](14) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[terms_property]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[terms_property](
	[TagNumber] [nvarchar](8) NOT NULL,
	[Own] [nvarchar](1) NULL,
	[Cl] [nvarchar](7) NULL,
	[Serial] [nvarchar](20) NULL,
	[Descr1] [nvarchar](4000) NULL,
	[Descr2] [nvarchar](4000) NULL,
	[CostCenter] [nvarchar](35) NULL,
	[OffSite] [nvarchar](35) NULL,
	[Bldg] [nvarchar](2) NULL,
	[Room] [nvarchar](4) NULL,
	[Dept] [nvarchar](2) NULL,
	[AcquisitionDate] [datetime] NULL,
	[Fin] [nvarchar](1) NULL,
	[PONum] [nvarchar](6) NULL,
	[CheckNum] [nvarchar](6) NULL,
	[Life] [numeric](3, 0) NULL,
	[OrigCost] [numeric](38, 2) NULL,
	[Tag] [nvarchar](1) NULL,
	[Cond] [nvarchar](1) NULL,
	[Disp] [nvarchar](2) NULL,
	[Vendor] [nvarchar](10) NULL,
	[Model] [nvarchar](20) NULL,
	[search_calc] [nvarchar](4000) NULL,
 CONSTRAINT [PK_terms_property] PRIMARY KEY CLUSTERED 
(
	[TagNumber] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[trans_cases_test]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[trans_cases_test](
	[case_number] [numeric](9, 0) NULL,
	[sharepoint_case_id] [numeric](9, 0) NULL,
	[Priority] [varchar](25) NULL,
	[TaskStatus] [varchar](25) NULL,
	[AssignedTo] [varchar](60) NOT NULL,
	[AssignedInvestigator] [varchar](255) NULL,
	[category_summary] [varchar](255) NULL,
	[description] [text] NULL,
	[resolution] [text] NULL,
	[modified_date] [smalldatetime] NULL,
	[modified_by] [varchar](60) NULL,
	[Created_year] [int] NULL,
	[Created] [smalldatetime] NULL,
	[Created By] [varchar](60) NULL,
	[case_id] [varchar](50) NULL,
	[Category] [varchar](100) NULL,
	[Subcategory1] [varchar](100) NULL,
	[Subcategory2] [varchar](100) NULL,
	[Subcategory3] [varchar](100) NULL,
	[Grade] [varchar](25) NULL,
	[am_dist_stop] [varchar](25) NULL,
	[am_dist_school] [varchar](25) NULL,
	[assigned_role] [varchar](50) NOT NULL,
	[Investigator] [varchar](5) NOT NULL,
	[stu_local_id] [varchar](25) NULL,
	[Student] [varchar](255) NULL,
	[stu_costCenter] [varchar](25) NULL,
	[School] [varchar](100) NULL,
	[ft_sdc] [varchar](25) NULL,
	[equipment_code] [varchar](25) NULL,
	[assignment_code] [varchar](25) NULL,
	[primary_exc] [varchar](25) NULL,
	[dop_code] [varchar](25) NULL,
	[route_number] [varchar](100) NOT NULL,
	[route_desc] [varchar](100) NULL,
	[am_desc] [varchar](100) NULL,
	[am_bus_driver] [varchar](50) NULL,
	[am_bus_num] [varchar](25) NULL,
	[am_run_id] [varchar](25) NULL,
	[am_stop_id] [varchar](25) NULL,
	[pm_desc] [varchar](100) NULL,
	[pm_bus_driver] [varchar](50) NULL,
	[pm_bus_num] [varchar](25) NULL,
	[pm_run_id] [varchar](25) NULL,
	[pm_stop_id] [varchar](25) NULL,
	[pm_dist_home] [varchar](25) NULL,
	[Citizen_Last] [varchar](25) NULL,
	[Citizen] [varchar](25) NULL,
	[ReportedByNumber] [varchar](25) NULL,
	[ReportedBy] [varchar](100) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[work_Clever_Goals_Import]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[work_Clever_Goals_Import](
	[date] [nvarchar](500) NULL,
	[student_clever_id] [nvarchar](500) NULL,
	[student_number] [nvarchar](500) NULL,
	[first_name] [nvarchar](500) NULL,
	[last_name] [nvarchar](500) NULL,
	[grade] [nvarchar](500) NULL,
	[school_clever_id] [nvarchar](500) NULL,
	[school_number] [nvarchar](500) NULL,
	[school_name] [nvarchar](500) NULL,
	[app_id] [nvarchar](500) NULL,
	[app_name] [nvarchar](500) NULL,
	[cumulative_minutes_completed] [nvarchar](500) NULL,
	[cumulative_progress_completed] [nvarchar](500) NULL,
	[progress_metric] [nvarchar](500) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[work_Clever_IDs]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[work_Clever_IDs](
	[date] [nvarchar](max) NULL,
	[sis_id] [nvarchar](max) NULL,
	[clever_user_id] [nvarchar](max) NULL,
	[clever_school_id] [nvarchar](max) NULL,
	[school_name] [nvarchar](max) NULL,
	[active] [nvarchar](max) NULL,
	[num_logins] [nvarchar](max) NULL,
	[num_resources_accessed] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[work_clever_reports_resources]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[work_clever_reports_resources](
	[logdate] [varchar](max) NULL,
	[sis_id] [varchar](max) NULL,
	[clever_user_id] [varchar](max) NULL,
	[clever_school_id] [varchar](max) NULL,
	[school_name] [varchar](max) NULL,
	[resource_type] [varchar](max) NULL,
	[resource_name] [varchar](max) NULL,
	[resource_id] [varchar](max) NULL,
	[num_access] [varchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_Demographics_Students]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_Demographics_Students](
	[pk] [varchar](265) NULL,
	[active] [int] NULL,
	[syear] [numeric](18, 0) NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[stu_local_id] [varchar](255) NULL,
	[stu_username] [varchar](100) NULL,
	[region] [varchar](10) NULL,
	[category] [varchar](50) NULL,
	[school_level] [varchar](50) NULL,
	[sch_id] [numeric](18, 0) NOT NULL,
	[sch_state_id] [varchar](10) NULL,
	[school] [varchar](100) NULL,
	[grade] [varchar](10) NULL,
	[enrollment_code] [varchar](100) NULL,
	[drop_code] [varchar](100) NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL,
	[Nth_date] [date] NULL,
	[enrToday] [int] NULL,
	[enrNth] [int] NULL,
	[enrQ1] [int] NULL,
	[enrQ2] [int] NULL,
	[enrQ3] [int] NULL,
	[enrQ4] [int] NULL,
	[enrS1] [int] NULL,
	[enrS2] [int] NULL,
	[enrYR] [int] NULL,
	[enr08] [int] NULL,
	[enr09] [int] NULL,
	[enr10] [int] NULL,
	[enr11] [int] NULL,
	[enr12] [int] NULL,
	[enr01] [int] NULL,
	[enr02] [int] NULL,
	[enr03] [int] NULL,
	[enr04] [int] NULL,
	[enr05] [int] NULL,
	[enr06] [int] NULL,
	[enr07] [int] NULL,
	[gPK] [int] NULL,
	[gKG] [int] NULL,
	[g01] [int] NULL,
	[g02] [int] NULL,
	[g03] [int] NULL,
	[g04] [int] NULL,
	[g05] [int] NULL,
	[g06] [int] NULL,
	[g07] [int] NULL,
	[g08] [int] NULL,
	[g09] [int] NULL,
	[g10] [int] NULL,
	[g11] [int] NULL,
	[g12] [int] NULL,
	[male] [int] NULL,
	[female] [int] NULL,
	[group_hispanic] [int] NULL,
	[group_native] [int] NULL,
	[group_asian] [int] NULL,
	[group_pacific] [int] NULL,
	[group_white] [int] NULL,
	[group_black] [int] NULL,
	[group_nonblack] [int] NULL,
	[local_multi] [int] NULL,
	[local_hispanic] [int] NULL,
	[local_native] [int] NULL,
	[local_asian] [int] NULL,
	[local_white] [int] NULL,
	[local_unknown] [int] NULL,
	[local_black] [int] NULL,
	[local_nonblack] [int] NULL,
	[econ_dis] [int] NULL,
	[ell] [int] NULL,
	[disabilities] [int] NULL,
	[migrant] [int] NULL,
	[homeless] [int] NULL,
	[foster] [int] NULL,
	[L1read] [int] NULL,
	[L2read] [int] NULL,
	[L12read] [int] NULL,
	[L1math] [int] NULL,
	[L2math] [int] NULL,
	[L12math] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_DS_Attendance]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_DS_Attendance](
	[syear] [int] NULL,
	[sch_id] [int] NULL,
	[sch_state_id] [varchar](8) NULL,
	[school] [varchar](100) NULL,
	[stu_id] [int] NULL,
	[stu_local_id] [varchar](50) NULL,
	[stu_username] [varchar](50) NULL,
	[grade] [varchar](4) NULL,
	[ttl_enrolled] [int] NULL,
	[ttl_present] [int] NULL,
	[ttl_absences] [int] NULL,
	[ttl_tardies] [int] NULL,
	[ttl_abs_rate] [decimal](9, 3) NULL,
	[ttl_tar_rate] [decimal](9, 3) NULL,
	[ytd_days] [int] NULL,
	[ytd_enrolled] [int] NULL,
	[ytd_present] [int] NULL,
	[ytd_absences] [int] NULL,
	[ytd_tardies] [int] NULL,
	[ytd_abs_rate] [decimal](9, 3) NULL,
	[ytd_tar_rate] [decimal](9, 3) NULL,
	[prj_abs_rate] [decimal](9, 3) NULL,
	[prj_tar_rate] [decimal](9, 3) NULL,
	[m08_enrolled] [int] NULL,
	[m08_present] [int] NULL,
	[m08_absences] [int] NULL,
	[m08_tardies] [int] NULL,
	[m08_abs_rate] [decimal](9, 3) NULL,
	[m08_tar_rate] [decimal](9, 3) NULL,
	[m09_enrolled] [int] NULL,
	[m09_present] [int] NULL,
	[m09_absences] [int] NULL,
	[m09_tardies] [int] NULL,
	[m09_abs_rate] [decimal](9, 3) NULL,
	[m09_tar_rate] [decimal](9, 3) NULL,
	[m10_enrolled] [int] NULL,
	[m10_present] [int] NULL,
	[m10_absences] [int] NULL,
	[m10_tardies] [int] NULL,
	[m10_abs_rate] [decimal](9, 3) NULL,
	[m10_tar_rate] [decimal](9, 3) NULL,
	[m11_enrolled] [int] NULL,
	[m11_present] [int] NULL,
	[m11_absences] [int] NULL,
	[m11_tardies] [int] NULL,
	[m11_abs_rate] [decimal](9, 3) NULL,
	[m11_tar_rate] [decimal](9, 3) NULL,
	[m12_enrolled] [int] NULL,
	[m12_present] [int] NULL,
	[m12_absences] [int] NULL,
	[m12_tardies] [int] NULL,
	[m12_abs_rate] [decimal](9, 3) NULL,
	[m12_tar_rate] [decimal](9, 3) NULL,
	[m01_enrolled] [int] NULL,
	[m01_present] [int] NULL,
	[m01_absences] [int] NULL,
	[m01_tardies] [int] NULL,
	[m01_abs_rate] [decimal](9, 3) NULL,
	[m01_tar_rate] [decimal](9, 3) NULL,
	[m02_enrolled] [int] NULL,
	[m02_present] [int] NULL,
	[m02_absences] [int] NULL,
	[m02_tardies] [int] NULL,
	[m02_abs_rate] [decimal](9, 3) NULL,
	[m02_tar_rate] [decimal](9, 3) NULL,
	[m03_enrolled] [int] NULL,
	[m03_present] [int] NULL,
	[m03_absences] [int] NULL,
	[m03_tardies] [int] NULL,
	[m03_abs_rate] [decimal](9, 3) NULL,
	[m03_tar_rate] [decimal](9, 3) NULL,
	[m04_enrolled] [int] NULL,
	[m04_present] [int] NULL,
	[m04_absences] [int] NULL,
	[m04_tardies] [int] NULL,
	[m04_abs_rate] [decimal](9, 3) NULL,
	[m04_tar_rate] [decimal](9, 3) NULL,
	[m05_enrolled] [int] NULL,
	[m05_present] [int] NULL,
	[m05_absences] [int] NULL,
	[m05_tardies] [int] NULL,
	[m05_abs_rate] [decimal](9, 3) NULL,
	[m05_tar_rate] [decimal](9, 3) NULL,
	[m06_enrolled] [int] NULL,
	[m06_present] [int] NULL,
	[m06_absences] [int] NULL,
	[m06_tardies] [int] NULL,
	[m06_abs_rate] [decimal](9, 3) NULL,
	[m06_tar_rate] [decimal](9, 3) NULL,
	[m07_enrolled] [int] NULL,
	[m07_present] [int] NULL,
	[m07_absences] [int] NULL,
	[m07_tardies] [int] NULL,
	[m07_abs_rate] [decimal](9, 3) NULL,
	[m07_tar_rate] [decimal](9, 3) NULL,
	[S1_enrolled] [int] NULL,
	[S1_present] [int] NULL,
	[S1_absences] [int] NULL,
	[S1_tardies] [int] NULL,
	[S1_abs_rate] [decimal](9, 3) NULL,
	[S1_tar_rate] [decimal](9, 3) NULL,
	[S2_enrolled] [int] NULL,
	[S2_present] [int] NULL,
	[S2_absences] [int] NULL,
	[S2_tardies] [int] NULL,
	[S2_abs_rate] [decimal](9, 3) NULL,
	[S2_tar_rate] [decimal](9, 3) NULL,
	[Q1_enrolled] [int] NULL,
	[Q1_present] [int] NULL,
	[Q1_absences] [int] NULL,
	[Q1_tardies] [int] NULL,
	[Q1_abs_rate] [decimal](9, 3) NULL,
	[Q1_tar_rate] [decimal](9, 3) NULL,
	[Q2_enrolled] [int] NULL,
	[Q2_present] [int] NULL,
	[Q2_absences] [int] NULL,
	[Q2_tardies] [int] NULL,
	[Q2_abs_rate] [decimal](9, 3) NULL,
	[Q2_tar_rate] [decimal](9, 3) NULL,
	[Q3_enrolled] [int] NULL,
	[Q3_present] [int] NULL,
	[Q3_absences] [int] NULL,
	[Q3_tardies] [int] NULL,
	[Q3_abs_rate] [decimal](9, 3) NULL,
	[Q3_tar_rate] [decimal](9, 3) NULL,
	[Q4_enrolled] [int] NULL,
	[Q4_present] [int] NULL,
	[Q4_absences] [int] NULL,
	[Q4_tardies] [int] NULL,
	[Q4_abs_rate] [decimal](9, 3) NULL,
	[Q4_tar_rate] [decimal](9, 3) NULL,
	[last_updated] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_DS_Classes]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_DS_Classes](
	[schedule_id] [numeric](18, 0) NOT NULL,
	[syear] [numeric](18, 0) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[sch_state_id] [varchar](4) NULL,
	[school] [varchar](100) NULL,
	[emp_id] [numeric](18, 0) NULL,
	[emp_local_id] [numeric](18, 0) NULL,
	[emp_username] [varchar](100) NULL,
	[emp_lastname] [varchar](100) NULL,
	[emp_firstname] [varchar](100) NULL,
	[stu_id] [numeric](18, 0) NULL,
	[stu_local_id] [varchar](255) NULL,
	[stu_username] [varchar](100) NULL,
	[stu_lastname] [varchar](100) NULL,
	[stu_firstname] [varchar](100) NULL,
	[stu_grade] [varchar](2) NULL,
	[class_id] [numeric](18, 0) NULL,
	[course_id] [numeric](18, 0) NULL,
	[course_num_sch] [varchar](50) NULL,
	[course_num] [varchar](10) NULL,
	[course_weight] [varchar](50) NULL,
	[course_short] [varchar](100) NULL,
	[course] [varchar](100) NULL,
	[course_long] [varchar](265) NULL,
	[subject_area] [varchar](10) NULL,
	[subject_group] [varchar](100) NULL,
	[subject] [varchar](100) NULL,
	[marking_period_id] [numeric](18, 0) NULL,
	[active] [varchar](10) NULL,
	[term] [varchar](10) NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL,
	[stu_term] [varchar](10) NULL,
	[stu_start_date] [date] NULL,
	[stu_end_date] [date] NULL,
	[days] [varchar](7) NULL,
	[period] [varchar](10) NULL,
	[room] [varchar](10) NULL,
	[display_room] [varchar](20) NULL,
	[total_seats] [numeric](18, 0) NULL,
	[filled_seats] [numeric](18, 0) NULL,
	[avg_grade] [varchar](10) NULL,
	[ELL_model] [varchar](255) NULL,
	[read_interv] [varchar](255) NULL,
	[reading_certification] [varchar](10) NULL,
	[online_course] [varchar](10) NULL,
	[VAM_course] [varchar](1) NULL,
	[does_grades] [varchar](10) NULL,
	[emp2_id] [numeric](18, 0) NULL,
	[emp2_local_id] [numeric](18, 0) NULL,
	[emp2_username] [varchar](100) NULL,
	[emp3_id] [numeric](18, 0) NULL,
	[emp3_local_id] [numeric](18, 0) NULL,
	[emp3_username] [varchar](100) NULL,
	[emp4_id] [numeric](18, 0) NULL,
	[emp4_local_id] [numeric](18, 0) NULL,
	[emp4_username] [varchar](100) NULL,
	[emp5_id] [numeric](18, 0) NULL,
	[emp5_local_id] [numeric](18, 0) NULL,
	[emp5_username] [varchar](100) NULL,
	[emp6_id] [numeric](18, 0) NULL,
	[emp6_local_id] [numeric](18, 0) NULL,
	[emp6_username] [varchar](100) NULL,
	[emp7_id] [numeric](18, 0) NULL,
	[emp7_local_id] [numeric](18, 0) NULL,
	[emp7_username] [varchar](100) NULL,
	[emp8_id] [numeric](18, 0) NULL,
	[emp8_local_id] [numeric](18, 0) NULL,
	[emp8_username] [varchar](100) NULL,
	[gradebook_term] [varchar](10) NULL,
	[gradebook_grade] [numeric](18, 4) NULL,
	[alt_sch_id] [numeric](18, 0) NULL,
	[alt_sch_state_id] [varchar](4) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_DS_Students]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_DS_Students](
	[active] [int] NULL,
	[last_syear] [int] NULL,
	[stu_id] [numeric](18, 0) NOT NULL,
	[stu_local_id] [varchar](255) NULL,
	[stu_state_id] [varchar](50) NULL,
	[stu_username] [varchar](100) NULL,
	[samAccountName] [nvarchar](50) NULL,
	[Account] [nvarchar](50) NULL,
	[sch_id] [numeric](18, 0) NULL,
	[sch_state_id] [varchar](4) NULL,
	[school] [varchar](100) NULL,
	[grade] [varchar](2) NULL,
	[grade_simple] [varchar](2) NULL,
	[last_first] [varchar](8000) NULL,
	[first_name] [varchar](255) NULL,
	[first_initial] [varchar](1) NULL,
	[last_name] [varchar](255) NULL,
	[middle_name] [varchar](8000) NULL,
	[suffix] [varchar](3) NULL,
	[rolling_ret] [int] NULL,
	[locker] [varchar](255) NULL,
	[gender] [varchar](max) NULL,
	[other_name] [varchar](255) NULL,
	[special_code] [varchar](max) NULL,
	[nickname] [varchar](8000) NULL,
	[pe_waiver] [varchar](255) NULL,
	[hmroom] [varchar](255) NULL,
	[hmroom_emp_id] [int] NULL,
	[hmroom_emp_name] [varchar](255) NULL,
	[advisor] [varchar](255) NULL,
	[counselor] [varchar](255) NULL,
	[internet_perm] [varchar](255) NULL,
	[media_release] [varchar](255) NULL,
	[groups] [varchar](max) NULL,
	[instructional_setting] [varchar](max) NULL,
	[alt_assessment] [varchar](max) NULL,
	[elig_504] [varchar](max) NULL,
	[qual_504] [varchar](max) NULL,
	[disabled] [varchar](max) NULL,
	[extra_curr_elig] [varchar](max) NULL,
	[grade_at_entry] [varchar](255) NULL,
	[lang_student] [varchar](max) NULL,
	[english_prof] [varchar](max) NULL,
	[lang_parent] [varchar](max) NULL,
	[birthdate] [date] NULL,
	[age] [int] NULL,
	[citizenship] [varchar](max) NULL,
	[migrant] [varchar](max) NULL,
	[homeless] [varchar](10) NULL,
	[foster] [varchar](10) NULL,
	[foster_type] [varchar](255) NULL,
	[military] [varchar](max) NULL,
	[directory_opt_out] [varchar](10) NULL,
	[college_military_info] [varchar](max) NULL,
	[enr_sch] [varchar](255) NULL,
	[enr_mulitple] [varchar](255) NULL,
	[email] [varchar](255) NULL,
	[sch_previous] [varchar](255) NULL,
	[sch_next] [varchar](255) NULL,
	[grd_next] [varchar](255) NULL,
	[retained] [varchar](10) NULL,
	[end_year_status] [varchar](max) NULL,
	[grd_prom_exmp] [varchar](max) NULL,
	[yr_grad] [varchar](max) NULL,
	[grad_date] [date] NULL,
	[planned_early_grad] [varchar](max) NULL,
	[pathway] [varchar](255) NULL,
	[gpa] [decimal](9, 4) NULL,
	[gpa_unwtd] [decimal](9, 4) NULL,
	[gpa_unwtd_prev_qtr] [decimal](9, 4) NULL,
	[class_rank] [int] NULL,
	[class_size] [int] NULL,
	[credits_earned] [decimal](9, 2) NULL,
	[rank_last_modified] [date] NULL,
	[l35_read] [varchar](255) NULL,
	[plcmt_read] [varchar](255) NULL,
	[plcmt_mth] [varchar](255) NULL,
	[read_fluency] [varchar](255) NULL,
	[year_entered] [varchar](max) NULL,
	[year_entered_us] [date] NULL,
	[l35_mth] [varchar](255) NULL,
	[math_rem] [varchar](max) NULL,
	[fdle_alert] [varchar](10) NULL,
	[team_flag1] [varchar](max) NULL,
	[team_flag2] [varchar](max) NULL,
	[application_program] [varchar](100) NULL,
	[summer_sch] [varchar](max) NULL,
	[shielded_student] [varchar](10) NULL,
	[eoc_credit_recovery] [varchar](max) NULL,
	[local_ethnic_code] [varchar](max) NULL,
	[ell_status] [varchar](max) NULL,
	[fte_elg2] [varchar](max) NULL,
	[test_acmdt] [varchar](max) NULL,
	[home_lang_survey_date] [date] NULL,
	[classification_date] [date] NULL,
	[entry_date] [date] NULL,
	[lep_basis_entry] [varchar](255) NULL,
	[stu_plan_date] [date] NULL,
	[ell_reeval_date] [date] NULL,
	[extension_instr] [varchar](255) NULL,
	[exit_date] [date] NULL,
	[lep_basis_exit] [varchar](255) NULL,
	[lep_basis_exit2] [varchar](255) NULL,
	[monitor_date1] [date] NULL,
	[monitor_date2] [date] NULL,
	[monitor_date3] [date] NULL,
	[monitor_date4] [date] NULL,
	[reclass_entry_date] [date] NULL,
	[reclass_exit_date] [date] NULL,
	[immigrant_stu] [varchar](255) NULL,
	[country_birth] [varchar](255) NULL,
	[ell_prog_participant] [varchar](255) NULL,
	[ell_tier] [varchar](255) NULL,
	[ft_sdc] [varchar](max) NULL,
	[pt_sdc1] [varchar](max) NULL,
	[pt_sdc2] [varchar](max) NULL,
	[pt_sdc3] [varchar](max) NULL,
	[case_manager] [varchar](255) NULL,
	[iep_date] [date] NULL,
	[iep_reevaldate] [date] NULL,
	[iep_resch] [varchar](255) NULL,
	[primary_exc] [varchar](255) NULL,
	[ese_totdis_minswkly] [numeric](18, 0) NULL,
	[ese_totnondis_minswkly] [numeric](18, 0) NULL,
	[ese_earlyint] [varchar](255) NULL,
	[ese_fefpcode] [varchar](max) NULL,
	[ese_extschyrsv] [varchar](max) NULL,
	[hearing_screening_date] [date] NULL,
	[hearing_screening_status] [varchar](max) NULL,
	[vision_screening_date] [date] NULL,
	[vision_screening_status] [varchar](max) NULL,
	[take_stock] [varchar](max) NULL,
	[race] [varchar](10) NULL,
	[race_long] [varchar](255) NULL,
	[group_hispanic] [varchar](max) NULL,
	[group_asian] [varchar](max) NULL,
	[group_native] [varchar](max) NULL,
	[group_pacific] [varchar](max) NULL,
	[group_black] [varchar](max) NULL,
	[group_white] [varchar](max) NULL,
	[ethnic_code] [varchar](max) NULL,
	[spec_rpt_ethnic_code] [varchar](10) NULL,
	[census_tract] [varchar](255) NULL,
	[res_status] [varchar](max) NULL,
	[alg_ese_eoc_waiver] [varchar](10) NULL,
	[alg_i_asmt_pass] [varchar](max) NULL,
	[biology_asmt_pass] [varchar](max) NULL,
	[geom_asmt_pass] [varchar](max) NULL,
	[us_hstry_asmt_pass] [varchar](max) NULL,
	[spc_student_id] [varchar](255) NULL,
	[assignment_code] [varchar](max) NULL,
	[zone_sch_elem] [varchar](255) NULL,
	[zone_sch_middle] [varchar](255) NULL,
	[zone_sch_high] [varchar](255) NULL,
	[zone_school] [varchar](255) NULL,
	[next_year_assign_code] [varchar](max) NULL,
	[equipment_code] [varchar](max) NULL,
	[iep_stop_location] [varchar](max) NULL,
	[elig_det_purp] [varchar](max) NULL,
	[impairment_code] [varchar](max) NULL,
	[intl_det_date] [date] NULL,
	[impaired_maj_lfe_act] [varchar](max) NULL,
	[rel_services] [varchar](max) NULL,
	[reeval_date] [date] NULL,
	[nxt_reeval_date] [date] NULL,
	[current_acmdt_plan_date] [date] NULL,
	[disc_acmdt_plan_date] [date] NULL,
	[temp_dis_exp] [date] NULL,
	[freereduced_meals] [varchar](max) NULL,
	[econ_dis] [varchar](10) NULL,
	[foodservicesPIN] [numeric](18, 0) NULL,
	[ssn] [varchar](255) NULL,
	[altid1] [varchar](300) NULL,
	[altid2] [varchar](300) NULL,
	[edal_choice] [varchar](max) NULL,
	[ceis] [varchar](max) NULL,
	[med_letter_physical] [date] NULL,
	[med_letter_speech] [date] NULL,
	[med_letter_psych] [date] NULL,
	[med_letter_nursing] [date] NULL,
	[med_letter_social] [date] NULL,
	[med_packet_signed] [date] NULL,
	[med_auth_ack] [varchar](50) NULL,
	[med_parent_auth] [varchar](10) NULL,
	[enr_date] [date] NULL,
	[enr_code] [varchar](100) NULL,
	[drop_date] [date] NULL,
	[drop_code] [varchar](100) NULL,
	[prior_district] [varchar](50) NULL,
	[prior_state] [varchar](50) NULL,
	[prior_country] [varchar](50) NULL,
	[disaster_affected_student] [varchar](50) NULL,
	[student_offender_transfer] [varchar](50) NULL,
	[calendar] [varchar](100) NULL,
	[am_route_id] [varchar](max) NULL,
	[am_run_id] [varchar](max) NULL,
	[am_stop_id] [varchar](max) NULL,
	[am_time] [varchar](max) NULL,
	[am_desc] [varchar](max) NULL,
	[am_dist_stop] [varchar](max) NULL,
	[am_dist_school] [varchar](max) NULL,
	[am_bus_num] [varchar](max) NULL,
	[am_bus_driver] [varchar](max) NULL,
	[pm_route_id] [varchar](max) NULL,
	[pm_run_id] [varchar](max) NULL,
	[pm_stop_id] [varchar](max) NULL,
	[pm_time] [varchar](max) NULL,
	[pm_desc] [varchar](max) NULL,
	[pm_dist_stop] [varchar](max) NULL,
	[pm_dist_school] [varchar](max) NULL,
	[pm_bus_num] [varchar](max) NULL,
	[pm_bus_driver] [varchar](max) NULL,
	[address] [varchar](255) NULL,
	[address_2] [varchar](255) NULL,
	[city] [varchar](60) NULL,
	[state] [varchar](50) NULL,
	[zip] [varchar](10) NULL,
	[home_phone] [varchar](30) NULL,
	[mail_address] [varchar](255) NULL,
	[mail_address_2] [varchar](255) NULL,
	[mail_city] [varchar](60) NULL,
	[mail_state] [varchar](50) NULL,
	[mail_zip] [varchar](10) NULL,
	[city_state] [varchar](72) NULL,
	[mail_city_state] [varchar](72) NULL,
	[cont1_type] [varchar](100) NULL,
	[cont1_cstdy] [varchar](1) NULL,
	[cont1_emer] [varchar](1) NULL,
	[cont1_last] [varchar](100) NULL,
	[cont1_first] [varchar](100) NULL,
	[cont1_email] [varchar](255) NULL,
	[cont1_address] [varchar](255) NULL,
	[cont1_address2] [varchar](255) NULL,
	[cont1_city] [varchar](60) NULL,
	[cont1_state] [varchar](10) NULL,
	[cont1_zip] [varchar](10) NULL,
	[cont1_home_phone] [varchar](30) NULL,
	[cont1_cell] [varchar](255) NULL,
	[cont1_work] [varchar](255) NULL,
	[cont2_type] [varchar](100) NULL,
	[cont2_cstdy] [varchar](1) NULL,
	[cont2_emer] [varchar](1) NULL,
	[cont2_last] [varchar](100) NULL,
	[cont2_first] [varchar](100) NULL,
	[cont2_email] [varchar](255) NULL,
	[cont2_address] [varchar](255) NULL,
	[cont2_address2] [varchar](255) NULL,
	[cont2_city] [varchar](60) NULL,
	[cont2_state] [varchar](10) NULL,
	[cont2_zip] [varchar](10) NULL,
	[cont2_home_phone] [varchar](30) NULL,
	[cont2_cell] [varchar](255) NULL,
	[cont2_work] [varchar](255) NULL,
	[cont3_type] [varchar](100) NULL,
	[cont3_cstdy] [varchar](1) NULL,
	[cont3_emer] [varchar](1) NULL,
	[cont3_last] [varchar](100) NULL,
	[cont3_first] [varchar](100) NULL,
	[cont3_email] [varchar](255) NULL,
	[cont3_address] [varchar](255) NULL,
	[cont3_address2] [varchar](255) NULL,
	[cont3_city] [varchar](60) NULL,
	[cont3_state] [varchar](10) NULL,
	[cont3_zip] [varchar](10) NULL,
	[cont3_home_phone] [varchar](30) NULL,
	[cont3_cell] [varchar](255) NULL,
	[cont3_work] [varchar](255) NULL,
	[resident_status] [varchar](255) NULL,
	[MyPCSOnline] [varchar](1) NULL,
 CONSTRAINT [PK_Work_DS_Students] PRIMARY KEY CLUSTERED 
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_DS_Users]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_DS_Users](
	[type] [nvarchar](50) NULL,
	[SSN] [nvarchar](50) NULL,
	[emp_id] [int] NOT NULL,
	[emp_local_id] [int] NULL,
	[emp_state_id] [nvarchar](50) NULL,
	[emp_username] [nvarchar](100) NOT NULL,
	[samAccountName] [nvarchar](100) NULL,
	[Account] [nvarchar](50) NULL,
	[last_name] [nvarchar](100) NULL,
	[first_name] [nvarchar](100) NULL,
	[middle_name] [nvarchar](100) NULL,
	[LAST] [nvarchar](100) NULL,
	[FIRST] [nvarchar](100) NULL,
	[email] [nvarchar](100) NULL,
	[email_AD] [nvarchar](100) NULL,
	[birthdate] [date] NULL,
	[age] [int] NULL,
	[gender] [nvarchar](10) NULL,
	[race] [nvarchar](10) NULL,
	[veteran_status] [nvarchar](10) NULL,
	[veteran] [nvarchar](10) NULL,
	[access_token] [nvarchar](4000) NULL,
	[job] [nvarchar](10) NULL,
	[fund] [nvarchar](10) NULL,
	[func] [nvarchar](10) NULL,
	[obj] [nvarchar](10) NULL,
	[proj] [nvarchar](10) NULL,
	[subproj] [nvarchar](10) NULL,
	[prog] [nvarchar](10) NULL,
	[pld] [nvarchar](10) NULL,
	[job_pos_num] [nvarchar](10) NULL,
	[location] [nvarchar](10) NULL,
	[location_name] [nvarchar](100) NULL,
	[costcenter] [nvarchar](10) NULL,
	[costcenter_name] [nvarchar](100) NULL,
	[statejobcode] [nvarchar](10) NULL,
	[pcsbjobcode] [nvarchar](10) NULL,
	[jobtitle] [nvarchar](100) NULL,
	[slot] [nvarchar](10) NULL,
	[fingerprinted] [date] NULL,
	[hiredate] [date] NULL,
	[contg_hiredate] [date] NULL,
	[contracttype] [nvarchar](10) NULL,
	[contracthours] [numeric](8, 2) NULL,
	[contractmonths] [numeric](8, 1) NULL,
	[pay_days] [int] NULL,
	[pay_type] [nvarchar](10) NULL,
	[pay_cycle] [nvarchar](10) NULL,
	[persstat] [nvarchar](10) NULL,
	[status] [nvarchar](10) NULL,
	[leave] [nvarchar](10) NULL,
	[EmpStatus] [nvarchar](50) NULL,
	[EmpStatusType] [nvarchar](50) NULL,
	[DROPend] [date] NULL,
	[bargaining_unit] [nvarchar](50) NULL,
	[sickbank_code] [nvarchar](1) NULL,
	[schools] [nvarchar](800) NULL,
	[instructional] [nvarchar](10) NULL,
	[students] [int] NULL,
	[probation] [nvarchar](10) NULL,
	[exp_pinellas] [tinyint] NULL,
	[exp_other] [tinyint] NULL,
	[exp_total] [tinyint] NULL,
	[reading_certification] [nvarchar](10) NULL,
	[grades] [nvarchar](50) NULL,
	[grades_list] [nvarchar](50) NULL,
	[address1] [nvarchar](100) NULL,
	[address2] [nvarchar](50) NULL,
	[city] [nvarchar](50) NULL,
	[state] [nvarchar](10) NULL,
	[zip] [nvarchar](20) NULL,
	[phone] [nvarchar](20) NULL,
	[User_SearchByName_calc] [nvarchar](255) NULL,
	[temp_pk] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_iReady_logs_21_22]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_iReady_logs_21_22](
	[Last_Name] [varchar](100) NULL,
	[First_Name] [varchar](100) NULL,
	[Student_ID] [varchar](100) NULL,
	[Student_Grade] [varchar](100) NULL,
	[Academic_Year] [varchar](100) NULL,
	[School] [varchar](100) NULL,
	[Start_Date] [varchar](100) NULL,
	[Completion_Date] [varchar](100) NULL,
	[Diagnostic_used_to_establish_Growth_Measures_Y/N] [varchar](100) NULL,
	[Most_Recent_Diagnostic_Y/N] [varchar](100) NULL,
	[Duration_min] [varchar](100) NULL,
	[Rush_Flag] [varchar](100) NULL,
	[Overall_Scale_Score] [varchar](100) NULL,
	[Overall_Placement] [varchar](100) NULL,
	[Overall_Relative_Placement] [varchar](100) NULL,
	[Percentile] [varchar](100) NULL,
	[Grouping] [varchar](100) NULL,
	[Lexile_Measure] [varchar](100) NULL,
	[Lexile_Range] [varchar](100) NULL,
	[Phonological_Awareness_Scale_Score] [varchar](100) NULL,
	[Phonological_Awareness_Placement] [varchar](100) NULL,
	[Phonological_Awareness_Relative_Placement] [varchar](100) NULL,
	[Phonics_Scale_Score] [varchar](100) NULL,
	[Phonics_Placement] [varchar](100) NULL,
	[Phonics_Relative_Placement] [varchar](100) NULL,
	[Words_Scale_Score] [varchar](100) NULL,
	[Words_Placement] [varchar](100) NULL,
	[Words_Relative_Placement] [varchar](100) NULL,
	[Vocabulary_Scale_Score] [varchar](100) NULL,
	[Vocabulary_Placement] [varchar](100) NULL,
	[Vocabulary_Relative_Placement] [varchar](100) NULL,
	[Literature_Scale_Score] [varchar](100) NULL,
	[Literature_Placement] [varchar](100) NULL,
	[Literature_Relative_Placement] [varchar](100) NULL,
	[Informational_Text_Scale_Score] [varchar](100) NULL,
	[Informational_Text_Placement] [varchar](100) NULL,
	[Informational_Text_Relative_Placement] [varchar](100) NULL,
	[Annual_Typical_Growth_Measure] [varchar](100) NULL,
	[Annual_Stretch_Growth_Measure] [varchar](100) NULL,
	[Mid_On_Grade_Level_Scale_Score] [varchar](100) NULL,
	[Reading_Difficulty_Indicator_Y/N] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_iReadyMath_logs_21_22]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_iReadyMath_logs_21_22](
	[Last_Name] [varchar](100) NULL,
	[First_Name] [varchar](100) NULL,
	[Student_ID] [varchar](100) NULL,
	[Student_Grade] [varchar](100) NULL,
	[Academic_Year] [varchar](100) NULL,
	[School] [varchar](100) NULL,
	[Start_Date] [varchar](100) NULL,
	[Completion_Date] [varchar](100) NULL,
	[Diagnostic_used_to_establish_Growth_Measures_(Y/N)] [varchar](100) NULL,
	[Most_Recent_Diagnostic_(Y/N)] [varchar](100) NULL,
	[Duration_min] [varchar](100) NULL,
	[Rush_Flag] [varchar](100) NULL,
	[Overall_Scale_Score] [varchar](100) NULL,
	[Overall_Placement] [varchar](100) NULL,
	[Overall_Relative_Placement] [varchar](100) NULL,
	[Percentile] [varchar](100) NULL,
	[Grouping] [varchar](100) NULL,
	[Quantile_Measure] [varchar](100) NULL,
	[Quantile_Range] [varchar](100) NULL,
	[Number_and_Operations_Scale_Score] [varchar](100) NULL,
	[Number_and_Operations_Placement] [varchar](100) NULL,
	[Number_and_Operations_Relative_Placement] [varchar](100) NULL,
	[Algebra_and_Algebraic_Thinking_Scale_Score] [varchar](100) NULL,
	[Algebra_and_Algebraic_Thinking_Placement] [varchar](100) NULL,
	[Algebra_and_Algebraic_Thinking_Relative_Placement] [varchar](100) NULL,
	[Measurement_and_Data_Scale_Score] [varchar](100) NULL,
	[Measurement_and_Data_Placement] [varchar](100) NULL,
	[Measurement_and_Data_Relative_Placement] [varchar](100) NULL,
	[Geometry_Scale_Score] [varchar](100) NULL,
	[Geometry_Placement] [varchar](100) NULL,
	[Geometry_Relative_Placement] [varchar](100) NULL,
	[Annual_Typical_Growth_Measure] [varchar](100) NULL,
	[Annual_Stretch_Growth_Measure] [varchar](100) NULL,
	[Mid_On_Grade_Level_Scale_Score] [varchar](100) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_IXL_logs_21_22]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_IXL_logs_21_22](
	[pk] [int] NULL,
	[stu_id] [varchar](50) NULL,
	[Lastname] [varchar](50) NULL,
	[Firstname] [varchar](50) NULL,
	[School] [varchar](50) NULL,
	[Grade] [varchar](50) NULL,
	[Overall_math] [varchar](50) NULL,
	[Num_oper_lvl] [varchar](50) NULL,
	[Alg_think_lvl] [varchar](50) NULL,
	[Frac_lvl] [varchar](50) NULL,
	[Geo_lvl] [varchar](50) NULL,
	[Meas_lvl] [varchar](50) NULL,
	[Data_stat_prob_lvl] [varchar](50) NULL,
	[Overall_ELA] [varchar](50) NULL,
	[Overall_reading_lvl] [varchar](50) NULL,
	[Reading_strat_lvl] [varchar](50) NULL,
	[Vocab_lvl] [varchar](50) NULL,
	[Writing_strat_lvl] [varchar](50) NULL,
	[Gram_mech_lvl] [varchar](50) NULL,
	[month] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[work_JWB_import]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[work_JWB_import](
	[ParticipantBusinessKey] [nvarchar](500) NULL,
	[FirstName] [nvarchar](500) NULL,
	[MiddleInitial] [nvarchar](500) NULL,
	[LastName] [nvarchar](500) NULL,
	[Gender_Standard] [nvarchar](500) NULL,
	[Race_Standard] [nvarchar](500) NULL,
	[Ethnicity_Standard] [nvarchar](500) NULL,
	[DateOfBirth] [nvarchar](500) NULL,
	[StudentID] [nvarchar](500) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[work_mind_research_students]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[work_mind_research_students](
	[iid] [varchar](50) NULL,
	[district_school_id] [varchar](50) NULL,
	[school] [varchar](50) NULL,
	[district_teacher_id] [varchar](50) NULL,
	[teacher_email] [varchar](50) NULL,
	[teacher_last_name] [varchar](50) NULL,
	[teacher_first_name] [varchar](50) NULL,
	[grade] [varchar](50) NULL,
	[period] [varchar](50) NULL,
	[curriculum] [varchar](50) NULL,
	[student_id] [varchar](50) NULL,
	[new_student_id] [varchar](50) NULL,
	[student_last_name] [varchar](50) NULL,
	[student_first_name] [varchar](50) NULL,
	[student_username] [varchar](50) NULL,
	[student_password] [varchar](50) NULL,
	[permanent_login] [varchar](50) NULL,
	[birth_date] [varchar](50) NULL,
	[action] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[work_mind_research_teachers]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[work_mind_research_teachers](
	[iid] [varchar](50) NULL,
	[district_school_id] [varchar](50) NULL,
	[school] [varchar](50) NULL,
	[district_teacher_id] [varchar](50) NULL,
	[email] [varchar](50) NULL,
	[last_name] [varchar](50) NULL,
	[first_name] [varchar](50) NULL,
	[position] [varchar](50) NULL,
	[access_level] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_PLP_Form_logs_19_20]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_PLP_Form_logs_19_20](
	[pk] [numeric](18, 0) NULL,
	[CreationDate] [nvarchar](max) NULL,
	[username] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_PLP_Form_logs_20_21]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_PLP_Form_logs_20_21](
	[pk] [numeric](18, 0) NULL,
	[CreationDate] [nvarchar](max) NULL,
	[username] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_PLP_logs_19_20]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_PLP_logs_19_20](
	[pk] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[CreationDate] [nvarchar](max) NULL,
	[username] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_PLP_logs_20_21]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_PLP_logs_20_21](
	[pk] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[CreationDate] [nvarchar](max) NULL,
	[username] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_PLP_userLogs]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_PLP_userLogs](
	[pk] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[CreationDate] [nvarchar](50) NULL,
	[username] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_Profile_Student_Enrollment]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_Profile_Student_Enrollment](
	[syear] [int] NULL,
	[region] [int] NULL,
	[sch_id] [int] NULL,
	[stu_id] [int] NULL,
	[grade] [varchar](2) NULL,
	[timeframe] [varchar](20) NULL,
	[timeframe_id] [varchar](20) NULL,
	[timeframe_days] [int] NULL,
	[start_date] [date] NULL,
	[end_date] [date] NULL,
	[stu_days] [int] NULL,
	[stu_start_date] [date] NULL,
	[stu_end_date] [date] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Work_vw_students_auto]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Work_vw_students_auto](
	[student_id] [numeric](18, 0) NOT NULL,
	[last_name] [varchar](255) NOT NULL,
	[first_name] [varchar](255) NOT NULL,
	[middle_name] [varchar](255) NULL,
	[custom_270] [varchar](1) NULL,
	[custom_159] [varchar](256) NULL,
	[name_suffix] [varchar](3) NULL,
	[username] [varchar](100) NULL,
	[password] [varchar](255) NULL,
	[custom_621] [varchar](1) NULL,
	[custom_271] [varchar](1) NULL,
	[custom_272] [varchar](1) NULL,
	[custom_916] [varchar](max) NULL,
	[custom_20009017] [varchar](100) NULL,
	[custom_417] [varchar](100) NULL,
	[custom_418] [varchar](10) NULL,
	[AdultGoal2] [varchar](max) NULL,
	[AdultGoal3] [varchar](max) NULL,
	[ImmunExemptStartDate] [datetime2](7) NULL,
	[ImmunExemptEndDate] [datetime2](7) NULL,
	[ImmunExemptCode] [varchar](max) NULL,
	[LocalStudentID] [varchar](255) NULL,
	[OtherName] [varchar](255) NULL,
	[Birthplace] [varchar](255) NULL,
	[Parent/guardian] [varchar](255) NULL,
	[GridCode] [varchar](255) NULL,
	[EnglishProficiency] [varchar](max) NULL,
	[StudentLanguage] [varchar](max) NULL,
	[FosterHome] [char](1) NULL,
	[Free/ReducedMealsProgram] [varchar](max) NULL,
	[CounselorNumber] [varchar](255) NULL,
	[AdvisorNumber] [varchar](255) NULL,
	[NextSchoolofAttendance] [varchar](255) NULL,
	[NextGradeLevel] [varchar](255) NULL,
	[RetentionIndicator] [char](1) NULL,
	[Totalcreditsattempted] [varchar](255) NULL,
	[Totalcreditsearned] [varchar](255) NULL,
	[SchoolUnweightedcummGPA] [varchar](255) NULL,
	[SchoolWeightedCummGPA] [varchar](255) NULL,
	[CurrentReportPeriodGPA1] [varchar](255) NULL,
	[CurrentReportPeriodGPA2] [varchar](255) NULL,
	[SchoolUnweightedClassRank] [numeric](18, 0) NULL,
	[SchoolWeightedClassRank] [numeric](18, 0) NULL,
	[SchoolClassSize] [numeric](18, 0) NULL,
	[InstructionalSetting] [varchar](max) NULL,
	[LastSchoolofAttendance] [varchar](255) NULL,
	[Locker] [varchar](255) NULL,
	[DiplomaType] [varchar](max) NULL,
	[ConcurrentSchool] [varchar](255) NULL,
	[ConcurrentIsHomeSchool] [varchar](255) NULL,
	[UnlistedTelephoneNumber] [char](1) NULL,
	[ForbidAutoDialing] [char](1) NULL,
	[HomeRoomNumber] [varchar](255) NULL,
	[GradeLevelWhenFirstEntered] [varchar](255) NULL,
	[OriginalEnterCode] [varchar](max) NULL,
	[OriginalEnterDate] [datetime2](7) NULL,
	[ResidenceStatus] [varchar](max) NULL,
	[AMBusRoute] [varchar](255) NULL,
	[Est.YearofGraduation] [varchar](max) NULL,
	[HearingScreeningStatus] [varchar](max) NULL,
	[SpecialDiploma(ValuesareInvalid)] [varchar](max) NULL,
	[SpecialCode] [varchar](max) NULL,
	[AssignmentCode] [varchar](max) NULL,
	[CollegeDualEnrollment] [varchar](max) NULL,
	[InternetPermission(YorN)] [char](1) NULL,
	[College/MilitaryInfoOption] [varchar](max) NULL,
	[EmploymentIndicator] [varchar](max) NULL,
	[NextYearAssignCode] [varchar](max) NULL,
	[TeamFlag1] [varchar](max) NULL,
	[MultipleEnrollmentFlag] [varchar](255) NULL,
	[EndOfYearStatus] [varchar](max) NULL,
	[ZoneSchoolElem] [varchar](255) NULL,
	[GraduationDate] [datetime2](7) NULL,
	[AlgebraRequirementMet] [char](1) NULL,
	[PMBusRoute] [varchar](255) NULL,
	[FTECEEB] [varchar](255) NULL,
	[SummerSchool] [varchar](max) NULL,
	[HSComp-Communications] [varchar](255) NULL,
	[HSComp-Math] [varchar](255) NULL,
	[DiplomaDate] [datetime2](7) NULL,
	[CertificationType] [varchar](max) NULL,
	[CertificationCompletionDate] [datetime2](7) NULL,
	[CommunityServiceReqMet] [varchar](max) NULL,
	[CareerPathways(formerlyTechPrepParticipant)] [varchar](max) NULL,
	[MedicAlertSeeMedicalScreen] [char](1) NULL,
	[NoContact-SeeAddress&ContactsScreen] [char](1) NULL,
	[SmallLearningCommunity] [varchar](max) NULL,
	[VocSingleParent/Pregnant] [varchar](max) NULL,
	[MinimumCreditsFlag] [varchar](max) NULL,
	[MinimumCreditsNeeded] [numeric](18, 0) NULL,
	[EarlySuccessProgram] [varchar](max) NULL,
	[CaseManager] [varchar](255) NULL,
	[NationalMeritScholar] [varchar](max) NULL,
	[NationalAchievementScholar] [varchar](max) NULL,
	[VisionScreeningStatus] [varchar](max) NULL,
	[CommunityServiceHours] [numeric](18, 0) NULL,
	[HearingScreeningDate] [datetime2](7) NULL,
	[VisionScreeningDate] [datetime2](7) NULL,
	[SpeechScreeningStatus] [varchar](max) NULL,
	[SpeechScreeningDate] [datetime2](7) NULL,
	[PhysicalExamDate] [datetime2](7) NULL,
	[ZoneSchoolMiddle] [varchar](255) NULL,
	[FCATLow35%inReading] [varchar](max) NULL,
	[TeenParentStudentID] [varchar](255) NULL,
	[FCATLow35%inMath] [varchar](max) NULL,
	[NationalHispanicScholar] [varchar](max) NULL,
	[ExceptionalStuExtSchYrSvc] [varchar](max) NULL,
	[Semester7GPAforClassRank] [varchar](255) NULL,
	[Semester7ClassRank] [varchar](255) NULL,
	[Semester7ClassSize] [varchar](255) NULL,
	[Semester7FreezeDate] [datetime2](7) NULL,
	[LanguageScreeningStatus] [varchar](max) NULL,
	[AdvinternationalCertProg(AICEDiploma)] [varchar](max) NULL,
	[GEDExitOptionTestResult] [varchar](max) NULL,
	[InternationalBacalaureateDip(IBDiploma)] [varchar](max) NULL,
	[CollegeReadyDiploma] [varchar](max) NULL,
	[DifferentiatedDiploma] [varchar](max) NULL,
	[FTEdaysinterm] [varchar](255) NULL,
	[TransportationMembershipCategory] [varchar](max) NULL,
	[VehicleCategory] [varchar](max) NULL,
	[Course#(mustbe7characters)] [varchar](255) NULL,
	[Semester] [varchar](max) NULL,
	[Program#(mustbe7characters)] [varchar](255) NULL,
	[Certification#(mustbe8characters)] [varchar](255) NULL,
	[CertificationOutcome(mustbeselectedifCertification#hasavalue)] [varchar](max) NULL,
	[Voc.CPoints1] [varchar](max) NULL,
	[Voc.CPoints2] [varchar](max) NULL,
	[Voc.CPoints3] [varchar](max) NULL,
	[Voc.CPoints4] [varchar](max) NULL,
	[Voc.CPoints5] [varchar](max) NULL,
	[Voc.CPoints6] [varchar](max) NULL,
	[SpanishImmersionStartDate] [datetime2](7) NULL,
	[SpanishImmersionEndDate] [datetime2](7) NULL,
	[ShieldedStudent] [char](1) NULL,
	[Occupational/PhysicalTherapyLetterSent] [datetime2](7) NULL,
	[SpeechLetterSent] [datetime2](7) NULL,
	[PsychologicalServicesLetterSent] [datetime2](7) NULL,
	[NursingLetterSent] [datetime2](7) NULL,
	[SocialWorkLetterSent] [datetime2](7) NULL,
	[ELA/ReadingWaiver] [char](1) NULL,
	[St.PetersburgCollegeStudentID] [varchar](255) NULL,
	[ZonedSchool] [varchar](255) NULL,
	[CareerAssessmentCenterReferredDate] [datetime2](7) NULL,
	[CareerAssessmentCenterReportCompleteDate] [datetime2](7) NULL,
	[AdultEdHiGrade] [varchar](max) NULL,
	[AdultEdHiGradeUS] [varchar](max) NULL,
	[1.HaschildattendedVoluntaryPrekindergarten(VPK)inFlorida?*IfNo,Skipto#4] [varchar](255) NULL,
	[SelectnameofSchool/Center/Home] [varchar](255) NULL,
	[2.Whattypeofprogram?] [varchar](255) NULL,
	[VPKDataSource] [varchar](255) NULL,
	[3.DidchildcompletetheVPKprogram?] [varchar](max) NULL,
	[DoeschildhaveIEP?] [varchar](max) NULL,
	[ConcurrentGradeLevel] [varchar](255) NULL,
	[DirectoryInfoOpt-Out] [char](1) NULL,
	[TeacherSecondaryReadingRecommendation] [varchar](max) NULL,
	[ParentLanguage] [varchar](max) NULL,
	[TakeStockInChildren] [varchar](max) NULL,
	[TakeStockInChildrenTargetDate] [varchar](max) NULL,
	[LearnfareFlag] [varchar](max) NULL,
	[SanctionCode] [varchar](max) NULL,
	[ImpactLocation] [varchar](max) NULL,
	[ImpactStudent] [varchar](max) NULL,
	[EquipmentCode(DOEReporting)] [varchar](max) NULL,
	[BusService] [varchar](max) NULL,
	[IEPStopLocation] [varchar](max) NULL,
	[PickupStreetAddress] [varchar](255) NULL,
	[PickupBldg/AptNum] [varchar](255) NULL,
	[DropoffStreetAddress] [varchar](255) NULL,
	[DropoffBldg/AptNum] [varchar](255) NULL,
	[EligibilityDetermination(PurposeofMeeting)] [varchar](max) NULL,
	[OldQualificationCode] [varchar](max) NULL,
	[Impairment1] [varchar](max) NULL,
	[Impairment2] [varchar](max) NULL,
	[Impairment3] [varchar](max) NULL,
	[ImpairmentCode] [nvarchar](max) NULL,
	[ImpairedLifeActivity1] [varchar](max) NULL,
	[ImpairedLifeActivity2] [varchar](max) NULL,
	[ImpairedLifeActivity3] [varchar](max) NULL,
	[ImpairedLifeActivity4] [varchar](max) NULL,
	[ImpairedLifeActivity5] [varchar](max) NULL,
	[ImpairedLifeActivity6] [varchar](max) NULL,
	[ImpairedLifeActivity7] [varchar](max) NULL,
	[ImpairedLifeActivity8] [varchar](max) NULL,
	[ImpairedLifeActivity9] [varchar](max) NULL,
	[ImpairedMajorLifeActivity] [nvarchar](max) NULL,
	[InitialDeterminationDate] [datetime2](7) NULL,
	[ReevaluationDatefor504] [datetime2](7) NULL,
	[NextReevaluationDate] [datetime2](7) NULL,
	[CurrentAccommodationPlanDate] [datetime2](7) NULL,
	[DiscontinuedAccommodationPlanDate] [datetime2](7) NULL,
	[Comment] [varchar](255) NULL,
	[TemporaryDisabilityExpirationDate] [datetime2](7) NULL,
	[MigrantContinuationofServices] [varchar](max) NULL,
	[MigrantReferredServices] [varchar](255) NULL,
	[ELLStatus(LimitedEnglishProficiency)] [varchar](max) NULL,
	[StudentCharacteristicAgencyPrograms] [varchar](max) NULL,
	[HomeLanguageSurveyDate] [datetime2](7) NULL,
	[QADMigrantProgramEligibility] [varchar](255) NULL,
	[ImmunizationStatus] [varchar](max) NULL,
	[Title1Basic] [varchar](max) NULL,
	[Title1Migrant] [varchar](max) NULL,
	[Title1Delinquent] [varchar](max) NULL,
	[MigrantPriorityforServices] [varchar](max) NULL,
	[Chapter2Fed/StateProjInd] [varchar](max) NULL,
	[PriortoKindergarten] [varchar](max) NULL,
	[Pre-KindergartenPartic] [varchar](max) NULL,
	[EntryDate] [datetime2](7) NULL,
	[StudentPlanDate] [datetime2](7) NULL,
	[ClassificationDate] [datetime2](7) NULL,
	[ExitDate] [datetime2](7) NULL,
	[ELLReevaluationDate] [datetime2](7) NULL,
	[ExtensionofInstruction] [varchar](max) NULL,
	[ReclassificationEntryDate] [datetime2](7) NULL,
	[ReclassificationExitDate] [datetime2](7) NULL,
	[LEPBasisofEntry] [varchar](max) NULL,
	[LEPBasisofExit] [varchar](max) NULL,
	[FTEIntBacDiploma] [varchar](255) NULL,
	[FTEIntBacScore] [varchar](255) NULL,
	[FTECEEBAPTest] [varchar](255) NULL,
	[ScholarshipAward] [varchar](max) NULL,
	[MigrantResidencyDate] [datetime2](7) NULL,
	[ExtraCurricularEligibility] [varchar](max) NULL,
	[HealthExamSchoolEntry] [varchar](max) NULL,
	[GoldSealVocEndorsement] [varchar](max) NULL,
	[WDIS_Posttest] [varchar](255) NULL,
	[ESEFEFPCode] [varchar](max) NULL,
	[AdditionalSchoolYear] [varchar](max) NULL,
	[CareerAcademyParticipant] [varchar](max) NULL,
	[VocEconDisadvantageType1] [varchar](max) NULL,
	[VocEconDisadvantageType2] [varchar](max) NULL,
	[VocAcademicDisadvantage] [varchar](max) NULL,
	[MonitorDate1] [datetime2](7) NULL,
	[Status1] [varchar](max) NULL,
	[PermissiontoPlaceDate] [varchar](255) NULL,
	[EnrollmentSchoolNumber] [varchar](255) NULL,
	[CountryofBirthCode] [varchar](max) NULL,
	[MonitorDate2] [datetime2](7) NULL,
	[Status2] [varchar](max) NULL,
	[MonitorDate3] [datetime2](7) NULL,
	[Status3] [varchar](max) NULL,
	[MonitorDate4] [datetime2](7) NULL,
	[Status4] [varchar](max) NULL,
	[FirstTimeStudent] [varchar](max) NULL,
	[VocationalDisplacedHomemaker] [varchar](max) NULL,
	[DisabilityStudent] [varchar](max) NULL,
	[BasicSkillExam] [varchar](max) NULL,
	[AdultFeeStatus] [varchar](max) NULL,
	[FinancialAssistance1] [varchar](max) NULL,
	[FinancialAssistance2] [varchar](max) NULL,
	[FinancialAssistance3] [varchar](max) NULL,
	[FinancialAssistance4] [varchar](max) NULL,
	[FinancialAssistance5] [varchar](max) NULL,
	[Credential] [varchar](max) NULL,
	[EntranceProfile1] [varchar](255) NULL,
	[EntranceProfile2] [varchar](255) NULL,
	[EntranceProfile3] [varchar](255) NULL,
	[EntranceProfile4] [varchar](255) NULL,
	[EntranceProfile5] [varchar](255) NULL,
	[EmploymentStatus(unused)] [varchar](255) NULL,
	[GraduationOption] [varchar](max) NULL,
	[PostSecondaryEdPlan] [varchar](max) NULL,
	[ImmigrantStudent] [varchar](max) NULL,
	[ImmigrantServices] [varchar](255) NULL,
	[LEPAdult] [varchar](max) NULL,
	[OtherInstitutionalizedAdult] [varchar](max) NULL,
	[VeteranStudentIndicator] [varchar](max) NULL,
	[AdultRuralResident] [varchar](max) NULL,
	[MigrantStatusTerm] [varchar](max) NULL,
	[AlternateAssessmentAdminist] [varchar](max) NULL,
	[Talented20student] [varchar](max) NULL,
	[FTEEligibility1] [varchar](max) NULL,
	[FTEEligibility2] [varchar](max) NULL,
	[FTEEligibility3] [varchar](max) NULL,
	[FTEEligibility4] [varchar](max) NULL,
	[GrdpromoSt:GoodCauseExemp] [varchar](max) NULL,
	[CitizenshipStatus] [varchar](max) NULL,
	[InstNoNegDelS51] [varchar](255) NULL,
	[InstNoNegDelS52] [varchar](255) NULL,
	[AnnualHours] [varchar](255) NULL,
	[DaysinTerm] [varchar](255) NULL,
	[TransMembershipCategory] [varchar](max) NULL,
	[EOCCoursesEnrolledforCreditRecovery] [nvarchar](max) NULL,
	[BusNumber] [varchar](255) NULL,
	[BusRouteNumber] [varchar](255) NULL,
	[HomelessUnaccomYouth] [varchar](max) NULL,
	[AdultStudentGoal] [varchar](max) NULL,
	[HomelessStudentPK-12] [varchar](max) NULL,
	[DistrictNumber,ZonedSchool] [varchar](max) NULL,
	[SchoolNumber,ZonedSchool] [varchar](max) NULL,
	[DateEntered,USIndicator] [varchar](max) NULL,
	[DateEntered,UnitedStates] [datetime2](7) NULL,
	[Drop/DJJPrograms] [varchar](max) NULL,
	[FundSource] [varchar](max) NULL,
	[ELLProgramParticipant] [varchar](max) NULL,
	[TestAccommodations] [varchar](max) NULL,
	[NCLBChoiceTransportation] [varchar](max) NULL,
	[NCLBSupplementalEdServices] [varchar](max) NULL,
	[HazardousWalking] [varchar](255) NULL,
	[ResidenceCounty] [varchar](max) NULL,
	[InstNoNegDelS91] [varchar](255) NULL,
	[InstNoNegDelS92] [varchar](255) NULL,
	[MajorAreaofInterest] [varchar](max) NULL,
	[MealApprovalDate] [datetime2](7) NULL,
	[CareerParticipationComplFTE] [varchar](255) NULL,
	[MilitaryFamilyStudent] [varchar](max) NULL,
	[ReadingFluency] [varchar](255) NULL,
	[LEPBasisofExit(second)] [varchar](max) NULL,
	[ZoneSchoolHigh] [varchar](255) NULL,
	[AliasStudentID] [varchar](255) NULL,
	[GradPgmofStudy] [varchar](max) NULL,
	[IDEAEducationalEnvironments] [varchar](max) NULL,
	[IEP/MDCDate] [datetime2](7) NULL,
	[IEPLocation] [datetime2](7) NULL,
	[Setting] [varchar](255) NULL,
	[WeeklyTime] [numeric](18, 0) NULL,
	[NonESETime] [numeric](18, 0) NULL,
	[IEPDate] [datetime2](7) NULL,
	[ReEvalDate] [datetime2](7) NULL,
	[Setting(F/P/R)-SEMBND] [varchar](255) NULL,
	[SPE_Comments] [varchar](max) NULL,
	[Setting(F/P/R)-RESSCH] [varchar](255) NULL,
	[Time,TotalStudentWeek] [numeric](18, 0) NULL,
	[Time,WithNon-Disabled] [numeric](18, 0) NULL,
	[IfStuisrecvearlyInt] [varchar](255) NULL,
	[MathRemediation] [varchar](max) NULL,
	[DPPossibleInfluencesA] [varchar](max) NULL,
	[DPPossibleInfluencesB] [varchar](max) NULL,
	[DPPossibleInfluencesC] [varchar](max) NULL,
	[Groups] [nvarchar](max) NULL,
	[HazardousWalking(unused)] [numeric](18, 0) NULL,
	[MigrantMSIXIDNumber] [varchar](255) NULL,
	[MigrantBirthState] [varchar](max) NULL,
	[DPPossibleInfluencesD] [varchar](max) NULL,
	[DPPossibleInfluencesE] [varchar](max) NULL,
	[DPPossibleInfluencesF] [varchar](max) NULL,
	[DPPossibleInfluencesG] [varchar](max) NULL,
	[DPPossibleInfluencesH] [varchar](max) NULL,
	[DPPossibleInfluencesI] [varchar](max) NULL,
	[DPPossibleInfluencesJ] [varchar](max) NULL,
	[InfoMP1] [nvarchar](max) NULL,
	[InfoMP2] [nvarchar](max) NULL,
	[InfoMP3] [nvarchar](max) NULL,
	[PEWaiver] [char](1) NULL,
	[HomelessCause] [varchar](max) NULL,
	[EarlyAdmissionStudent] [varchar](max) NULL,
	[GiftedEligibility] [varchar](max) NULL,
	[DPPrimaryReason] [varchar](max) NULL,
	[DPSecondaryReason] [varchar](max) NULL,
	[DPActionTakenA] [varchar](max) NULL,
	[DPActionTakenB] [varchar](max) NULL,
	[DPActionTakenC] [varchar](max) NULL,
	[DPActionTakenD] [varchar](max) NULL,
	[DPActionTakenE] [varchar](max) NULL,
	[DPActionTakenF] [varchar](max) NULL,
	[DPActionTakenG] [varchar](max) NULL,
	[DPActionTakenH] [varchar](max) NULL,
	[DPActionTakenI] [varchar](max) NULL,
	[DPActionTakenJ] [varchar](max) NULL,
	[DPActionTakenK] [varchar](max) NULL,
	[DPActionTakenL] [varchar](max) NULL,
	[DPActionTakenM] [varchar](max) NULL,
	[DPActionTakenN] [varchar](max) NULL,
	[DPActionTakenO] [varchar](max) NULL,
	[MultipleBirthStudent] [varchar](max) NULL,
	[EvenStartPgm] [varchar](max) NULL,
	[FloridaFirstStartParticipant] [varchar](max) NULL,
	[OtherAlerts/Comments] [varchar](max) NULL,
	[YearEnteredHS] [varchar](max) NULL,
	[GraduationPlanYear] [varchar](max) NULL,
	[MediaRelease] [char](1) NULL,
	[CTAEStudentID] [varchar](255) NULL,
	[FosterServiceCareType] [varchar](max) NULL,
	[McKayProgram] [varchar](max) NULL,
	[DriverLicenseFlag] [varchar](max) NULL,
	[DriverLicenseDate] [datetime2](7) NULL,
	[DriversLicenseAbsences] [varchar](255) NULL,
	[LanguageScreeningDate] [datetime2](7) NULL,
	[IACDismissalSchool] [varchar](max) NULL,
	[IACDismissalDate] [datetime2](7) NULL,
	[FTServiceDeliveryCode] [varchar](max) NULL,
	[PTServiceDelivery1] [varchar](max) NULL,
	[PTServiceDelivery2] [varchar](max) NULL,
	[PTServiceDelivery3] [varchar](max) NULL,
	[NextYrFTServiceDelivery] [varchar](max) NULL,
	[NextYrPTServiceDelivery1] [varchar](max) NULL,
	[NextYrPTServiceDelivery2] [varchar](max) NULL,
	[NextYrPTServiceDelivery3] [varchar](max) NULL,
	[QualificationCode] [varchar](max) NULL,
	[RecommendedReadingPlacement] [varchar](255) NULL,
	[RecommendedMathPlacement] [varchar](255) NULL,
	[RecommendedLanguageArtsPlacement] [varchar](255) NULL,
	[RecommendedSciencePlacement] [varchar](255) NULL,
	[RecommendedSocialStudiesPlacement] [varchar](255) NULL,
	[EligiblePuertoRicoDiploma] [char](1) NULL,
	[NextYearStatus] [varchar](max) NULL,
	[InstNoNegDelS93] [varchar](255) NULL,
	[BehaviorMP1] [nvarchar](max) NULL,
	[BehaviorMP2] [nvarchar](max) NULL,
	[BehaviorMP3] [nvarchar](max) NULL,
	[WorkHabitsMP1] [varchar](max) NULL,
	[WHBehaviorMP1] [nvarchar](max) NULL,
	[WorkHabitsMP2] [varchar](max) NULL,
	[WHBehaviorMP2] [nvarchar](max) NULL,
	[WorkHabitsMP3] [varchar](max) NULL,
	[WHBehaviorMP3] [nvarchar](max) NULL,
	[ConductMP1] [varchar](max) NULL,
	[ConductMP2] [varchar](max) NULL,
	[ConductMP3] [varchar](max) NULL,
	[FDLEAlert] [char](1) NULL,
	[Val/SalExclusions] [varchar](255) NULL,
	[TeamFlag2] [varchar](max) NULL,
	[PMRN] [char](1) NULL,
	[Chooseoneofthefollowing] [varchar](max) NULL,
	[Career/ProfAcademyIdentifier] [varchar](max) NULL,
	[Career/ProfAcademyIdsecond] [varchar](max) NULL,
	[CAPE1] [varchar](max) NULL,
	[CAPE2] [varchar](max) NULL,
	[AllEvaluationsCompleted] [char](1) NULL,
	[DateofInitialConsent] [datetime2](7) NULL,
	[TeamDetermination:SufficientDataExists] [datetime2](7) NULL,
	[60DayDueDate] [datetime2](7) NULL,
	[Other:] [datetime2](7) NULL,
	[DateofLastEvaluation] [datetime2](7) NULL,
	[TeacherofVisuallyImpaired:] [datetime2](7) NULL,
	[ExclusionReasons] [varchar](max) NULL,
	[RemainingSchoolDays] [varchar](255) NULL,
	[SuspectedEligibilities(perconsent)] [nvarchar](max) NULL,
	[Completed_Days_Count] [varchar](255) NULL,
	[Psychologist:] [datetime2](7) NULL,
	[SocialWorker:] [datetime2](7) NULL,
	[SpeechLang.Pathologist:] [datetime2](7) NULL,
	[Medical] [datetime2](7) NULL,
	[FoodServicesPIN] [numeric](18, 0) NULL,
	[PathwaystoGraduation] [varchar](max) NULL,
	[GroupUnweightedCummGPA] [varchar](255) NULL,
	[GroupUnweightedRank] [numeric](18, 0) NULL,
	[GroupWeightedCummGPA] [varchar](255) NULL,
	[GroupWeightedRank] [numeric](18, 0) NULL,
	[GroupClassSize] [numeric](18, 0) NULL,
	[DOESelectedAliasID] [varchar](255) NULL,
	[DOESelectedFLID] [varchar](255) NULL,
	[EducationalDiagnostician] [datetime2](7) NULL,
	[RelatedServices] [nvarchar](max) NULL,
	[ALGEOCWaiver] [char](1) NULL,
	[PhysicalTherapist] [datetime2](7) NULL,
	[OccupationalTherapist] [datetime2](7) NULL,
	[PlannedEarlyGrad] [varchar](max) NULL,
	[InfoMP4] [nvarchar](max) NULL,
	[Teacher/Counselor] [varchar](255) NULL,
	[NumberofSchoolsAttended] [numeric](18, 0) NULL,
	[GradesRepeated] [numeric](18, 0) NULL,
	[ServicesRequested] [nvarchar](max) NULL,
	[Evaluation] [char](1) NULL,
	[EvaluationOptions] [varchar](max) NULL,
	[Reevaluation] [char](1) NULL,
	[ReevaluationOptions] [varchar](max) NULL,
	[Support] [char](1) NULL,
	[SupportOptions] [nvarchar](max) NULL,
	[NameofPersonMakingRequest] [varchar](255) NULL,
	[TitleofPersonMakingRequest] [varchar](255) NULL,
	[PhoneNumberofPersonMakingRequest] [varchar](255) NULL,
	[EmailofPersonMakingRequest] [varchar](255) NULL,
	[NameofPersontoReceiveRequest] [varchar](255) NULL,
	[TitleofPersontoReceiveRequest] [varchar](255) NULL,
	[PhoneNumberofPersontoReceiveRequest] [varchar](255) NULL,
	[EmailofPersontoReceiveRequest] [varchar](255) NULL,
	[OtherInformation] [varchar](max) NULL,
	[4.Didchildattendanypreschool,familydaycare,orearlychildhoodsetting?] [varchar](max) NULL,
	[5.IfchilddidnotparticipateinVoluntaryPrekindergarten,why?] [varchar](max) NULL,
	[FloridaFirstStartparticipant-NEW] [char](1) NULL,
	[CodeofConductAcknowledgement] [char](1) NULL,
	[HasSafetyPlan] [char](1) NULL,
	[MatrixDateFEFP254and255Only] [datetime2](7) NULL,
	[AdditionalEquipment] [nvarchar](max) NULL,
	[DirectoryInfoNOOpt-Outs] [char](1) NULL,
	[AmericanIndianorAlaskaNative] [varchar](max) NULL,
	[Asian] [varchar](max) NULL,
	[BlackorAfricanAmerican] [varchar](max) NULL,
	[NativeHawaiianorOtherPacificIslander] [varchar](max) NULL,
	[White] [varchar](max) NULL,
	[1.IsthestudentHispanic/Latino?] [varchar](max) NULL,
	[InstNoNegDelS53] [varchar](255) NULL,
	[FundSourceIDEA] [varchar](max) NULL,
	[FTEEarned,IBDiploma] [numeric](18, 0) NULL,
	[FTEEarned,IBScore] [numeric](18, 0) NULL,
	[FTEEarned,AICEDiploma] [numeric](18, 0) NULL,
	[FTEEarned,AICEScore] [numeric](18, 0) NULL,
	[Gender] [varchar](max) NULL,
	[EthnicCode] [varchar](max) NULL,
	[NickName] [varchar](255) NULL,
	[SocialSecurityNumber] [varchar](255) NULL,
	[Birthdate] [datetime2](7) NULL,
	[SecondaryLanguage] [varchar](max) NULL,
	[Physician] [varchar](255) NULL,
	[PhysicianPhone] [varchar](255) NULL,
	[PreferredHospital] [varchar](255) NULL,
	[MedicalComments] [varchar](max) NULL,
	[HasDoctor'sNote] [char](1) NULL,
	[Doctor'sNoteComments] [varchar](max) NULL,
	[E-mailAddress] [varchar](255) NULL,
	[Cohort_Gpa_Flag] [varchar](255) NULL,
	[OnlineReportCards] [char](1) NULL,
	[School-RelatedArrests] [varchar](max) NULL,
	[ExceptionalStudent,60-DayException] [varchar](max) NULL,
	[BulliedorHarassed-Disability] [varchar](max) NULL,
	[BulliedorHarassed-Race] [varchar](max) NULL,
	[BulliedorHarassed-Sex] [varchar](max) NULL,
	[McKayAttendingSchool] [varchar](255) NULL,
	[DiplomaDesignation] [varchar](max) NULL,
	[MEPEnrollmentDate] [datetime2](7) NULL,
	[AlgebraIAssessmentPassed] [varchar](max) NULL,
	[GeometryAssessmentPassed] [varchar](max) NULL,
	[BiologyAssessmentPassed] [varchar](max) NULL,
	[U.S.HistoryAssessmentPassed] [varchar](max) NULL,
	[VACCINE_CERT_EXPIRY_DATE] [datetime2](7) NULL,
	[BirthVerificationDocument] [varchar](max) NULL,
	[CivicsEOCPassDate] [datetime2](7) NULL,
	[EmploymentStatus] [varchar](max) NULL,
	[BulliedorHarassed-Religion] [varchar](max) NULL,
	[BulliedorHarassed-SexualOrientation] [varchar](max) NULL,
	[AlgebraIIAssessmentPassed] [varchar](max) NULL,
	[FloridaEducationIdentifier] [varchar](255) NULL,
	[FLEIDVerified] [char](1) NULL,
	[FormerorMaidenName] [varchar](255) NULL,
	[FederallyConnectedStudentIndicator] [varchar](max) NULL,
	[HabitualTruant] [char](1) NULL,
	[HighestSchoolGradeCompleted] [varchar](max) NULL,
	[MilitaryStatus] [varchar](max) NULL,
	[DiplomaBiliteracySealDesignation] [varchar](max) NULL,
	[MedicalComplexityExemption] [varchar](max) NULL,
	[EnglishLanguageLearners:TierPlacement] [varchar](max) NULL,
	[English/LanguageArtsAssessmentMet] [varchar](max) NULL,
	[GraduationRequirementBasis] [varchar](max) NULL,
	[TestAccommodations,FCATReading] [nvarchar](max) NULL,
	[TestAccommodations,EOCAlgebra] [nvarchar](max) NULL,
	[TestAccommodations,EOCBiology] [nvarchar](max) NULL,
	[TestAccommodations,EOCUSHistory] [nvarchar](max) NULL,
	[AlgebraRequirement] [datetime2](7) NULL,
	[BiologyRequirement] [datetime2](7) NULL,
	[GeometryRequirement] [datetime2](7) NULL,
	[HistoryRequirement] [datetime2](7) NULL,
	[FASTERComment] [varchar](max) NULL,
	[DateEnteredUSSchool] [datetime2](7) NULL,
	[OnlineCourseExempt] [varchar](max) NULL,
	[ResidencyforTuition] [varchar](max) NULL,
	[CredentialLevel] [varchar](max) NULL,
	[ProgramAttendanceStatusDuringAwardYear] [varchar](max) NULL,
	[Student'sEnrollmentStatusasofthe1stDayofEnrollmentinProgram] [varchar](max) NULL,
	[PrivateLoanAmounts] [numeric](18, 0) NULL,
	[MedicalorDentalInternshiporResidency] [char](1) NULL,
	[LCPContinuingStudent] [char](1) NULL,
	[CASASTrack] [varchar](max) NULL,
	[SignLanguageProficiencyInterview:AmericanSignLanguage(SLPI:ASL)] [bigint] NULL,
	[ACTFLAssessmentofPerformanceTowardProficiencyinLanguage(AAPPL)] [bigint] NULL,
	[ACTFLOralProficiencyInterview(OPI)] [bigint] NULL,
	[Standards-basedMeasurementofProficiencyforGrade7-Adult(STAMP4S)] [bigint] NULL,
	[ACTFLLatinInterpretiveReadingAssessment(LIRA)] [bigint] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[z_OneRoster_classes]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[z_OneRoster_classes](
	[sourcedId] [nvarchar](max) NULL,
	[status] [nvarchar](max) NULL,
	[dateLastModified] [nvarchar](max) NULL,
	[title] [nvarchar](max) NULL,
	[grades] [nvarchar](max) NULL,
	[courseSourcedId] [nvarchar](max) NULL,
	[classCode] [nvarchar](max) NULL,
	[classType] [nvarchar](max) NULL,
	[location] [nvarchar](max) NULL,
	[schoolSourcedId] [nvarchar](max) NULL,
	[termSourcedIds] [nvarchar](max) NULL,
	[subjects] [nvarchar](max) NULL,
	[subjectCodes] [nvarchar](max) NULL,
	[periods] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[z_OneRoster_courses]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[z_OneRoster_courses](
	[sourcedId] [nvarchar](max) NULL,
	[status] [nvarchar](max) NULL,
	[dateLastModified] [nvarchar](max) NULL,
	[schoolYearSourcedId] [nvarchar](max) NULL,
	[title] [nvarchar](max) NULL,
	[courseCode] [nvarchar](max) NULL,
	[grades] [nvarchar](max) NULL,
	[orgSourcedId] [nvarchar](max) NULL,
	[subjects] [nvarchar](max) NULL,
	[subjectCodes] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[z_OneRoster_enrollments]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[z_OneRoster_enrollments](
	[sourcedId] [nvarchar](max) NULL,
	[status] [nvarchar](max) NULL,
	[dateLastModified] [nvarchar](max) NULL,
	[classSourcedId] [nvarchar](max) NULL,
	[schoolSourcedId] [nvarchar](max) NULL,
	[userSourcedId] [nvarchar](max) NULL,
	[role] [nvarchar](max) NULL,
	[primary] [nvarchar](max) NULL,
	[beginDate] [nvarchar](max) NULL,
	[endDate] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[z_OneRoster_users]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[z_OneRoster_users](
	[sourcedId] [nvarchar](max) NULL,
	[status] [nvarchar](max) NULL,
	[dateLastModified] [nvarchar](max) NULL,
	[enabledUser] [nvarchar](max) NULL,
	[orgSourcedIds] [nvarchar](max) NULL,
	[role] [nvarchar](max) NULL,
	[username] [nvarchar](max) NULL,
	[userIds] [nvarchar](max) NULL,
	[givenName] [nvarchar](max) NULL,
	[familyName] [nvarchar](max) NULL,
	[middleName] [nvarchar](max) NULL,
	[identifier] [nvarchar](max) NULL,
	[email] [nvarchar](max) NULL,
	[sms] [nvarchar](max) NULL,
	[phone] [nvarchar](max) NULL,
	[agentSourcedIds] [nvarchar](max) NULL,
	[grades] [nvarchar](max) NULL,
	[password] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  View [dbo].[StudentTracker_Schools]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE view [dbo].[StudentTracker_Schools]
as
          select  15 as sch_id, '0431' as sch_state_id, 'HIGH SCHOOL' as Type, 'BOCA CIEGA HIGH SCHOOL ' as Name, 'Gulfport ' as City, 'FL' as State,                   '101505' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  22 as sch_id, '0711' as sch_state_id, 'HIGH SCHOOL' as Type, 'CLEARWATER HIGH SCHOOL ' as Name, 'Clearwater ' as City, 'FL' as State,                 '100265' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  25 as sch_id, '0751' as sch_state_id, 'HIGH SCHOOL' as Type, 'COUNTRYSIDE HIGH SCHOOL ' as Name, 'Clearwater ' as City, 'FL' as State,                '100264' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  30 as sch_id, '1031' as sch_state_id, 'HIGH SCHOOL' as Type, 'DIXIE M. HOLLINS HIGH SCHOOL ' as Name, 'Saint Petersburg ' as City, 'FL' as State,     '101507' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  33 as sch_id, '1081' as sch_state_id, 'HIGH SCHOOL' as Type, 'DUNEDIN HIGH SCHOOL ' as Name, 'Dunedin ' as City, 'FL' as State,                       '100428' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select 139 as sch_id, '6181' as sch_state_id, 'HIGH SCHOOL' as Type, 'EAST LAKE HIGH SCHOOL ' as Name, 'Tarpon Springs ' as City, 'FL' as State,              '101739' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  45 as sch_id, '1531' as sch_state_id, 'HIGH SCHOOL' as Type, 'GIBBS HIGH SCHOOL ' as Name, 'Saint Petersburg ' as City, 'FL' as State,                '101510' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  56 as sch_id, '2031' as sch_state_id, 'HIGH SCHOOL' as Type, 'LAKEWOOD HIGH SCHOOL ' as Name, 'Saint Petersburg ' as City, 'FL' as State,             '101516' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  59 as sch_id, '2081' as sch_state_id, 'HIGH SCHOOL' as Type, 'LARGO HIGH SCHOOL ' as Name, 'Largo ' as City, 'FL' as State,                           '100925' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  73 as sch_id, '2641' as sch_state_id, 'HIGH SCHOOL' as Type, 'NORTHEAST HIGH SCHOOL ' as Name, 'Saint Petersburg ' as City, 'FL' as State,            '101520' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  84 as sch_id, '3031' as sch_state_id, 'HIGH SCHOOL' as Type, 'OSCEOLA FUNDAMENTAL HIGH SCHOOL ' as Name, 'Seminole ' as City, 'FL' as State,          '101597' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select 134 as sch_id, '4681' as sch_state_id, 'HIGH SCHOOL' as Type, 'PALM HARBOR UNIVERSITY HIGH SCHOOL ' as Name, 'Palm Harbor ' as City, 'FL' as State,    '100254' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  97 as sch_id, '3421' as sch_state_id, 'HIGH SCHOOL' as Type, 'PINELLAS PARK HIGH SCHOOL ' as Name, 'Largo ' as City, 'FL' as State,                   '100927' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select 107 as sch_id, '3781' as sch_state_id, 'HIGH SCHOOL' as Type, 'SAINT PETERSBURG HIGH SCHOOL ' as Name, 'Saint Petersburg ' as City, 'FL' as State,     '101530' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select 113 as sch_id, '3921' as sch_state_id, 'HIGH SCHOOL' as Type, 'SEMINOLE HIGH SCHOOL ' as Name, 'Seminole ' as City, 'FL' as State,                     '100928' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
UNION ALL select  12 as sch_id, '4521' as sch_state_id, 'HIGH SCHOOL' as Type, 'TARPON SPRINGS HIGH SCHOOL ' as Name, 'Tarpon Springs ' as City, 'FL' as State,         '101735' as ACT_Code, 'PINELLAS COUNTY SCHOOL DISTRICT' as District, 'OPEN' as Status 
GO
/****** Object:  View [dbo].[vTally]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[vTally]
AS
WITH
  L0   AS(SELECT 1 AS c UNION ALL SELECT 1),
  L1   AS(SELECT 1 AS c FROM L0 AS A CROSS JOIN L0 AS B),
  L2   AS(SELECT 1 AS c FROM L1 AS A CROSS JOIN L1 AS B),
  L3   AS(SELECT 1 AS c FROM L2 AS A CROSS JOIN L2 AS B),
  L4   AS(SELECT 1 AS c FROM L3 AS A CROSS JOIN L3 AS B),
  L5   AS(SELECT 1 AS c FROM L4 AS A CROSS JOIN L4 AS B),
  Tally AS(SELECT ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS n FROM L5)
  SELECT TOP (100000000) N FROM Tally ORDER BY N 
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_CA_scores]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE UNIQUE NONCLUSTERED INDEX [IX_CA_scores] ON [dbo].[CA_scores]
(
	[student_id] ASC,
	[testid] ASC,
	[syear] ASC,
	[seq_testid] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_CA_scores_school]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE UNIQUE NONCLUSTERED INDEX [IX_CA_scores_school] ON [dbo].[CA_scores_school]
(
	[syear] ASC,
	[school_id] ASC,
	[testid] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_AppID_Type_i01]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_AppID_Type_i01] ON [dbo].[DS_Apps_Options]
(
	[app_id] ASC,
	[type] ASC,
	[i01] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_V01]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_V01] ON [dbo].[DS_Apps_Options]
(
	[v01] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_DS_Behavior_date]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_DS_Behavior_date] ON [dbo].[DS_Behavior]
(
	[incident_date] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_DS_Behavior_sch_id]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_DS_Behavior_sch_id] ON [dbo].[DS_Behavior]
(
	[sch_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_DS_Behavior_stu_id]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_DS_Behavior_stu_id] ON [dbo].[DS_Behavior]
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_DS_Behavior_syear]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_DS_Behavior_syear] ON [dbo].[DS_Behavior]
(
	[syear] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_DS_Classes_class_id]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_DS_Classes_class_id] ON [dbo].[DS_Classes]
(
	[class_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_DS_Classes_stu_id]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_DS_Classes_stu_id] ON [dbo].[DS_Classes]
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_empID]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_empID] ON [dbo].[DS_Classes]
(
	[emp_id] ASC
)
INCLUDE([sch_id],[school]) WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_DS_Enrollment_Stu]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_DS_Enrollment_Stu] ON [dbo].[DS_Enrollment]
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_Type]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_Type] ON [dbo].[DS_Users]
(
	[type] ASC
)
INCLUDE([pcsbjobcode]) WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_eds_assessments09_advisor]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_eds_assessments09_advisor] ON [dbo].[eds_assessments09]
(
	[advisor] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_eds_assessments09_schoolnum]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_eds_assessments09_schoolnum] ON [dbo].[eds_assessments09]
(
	[schoolnum] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_log_fmservers_time]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_log_fmservers_time] ON [dbo].[log_fmservers]
(
	[time] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_accountname]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_accountname] ON [dbo].[logins]
(
	[accountname] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_solutions]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_solutions] ON [dbo].[logins]
(
	[filename] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_time]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_time] ON [dbo].[logins]
(
	[time] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_MAP_Data_Summary_stu_id]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_MAP_Data_Summary_stu_id] ON [dbo].[MAP_Data_Summary]
(
	[focus_stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_SchID]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_SchID] ON [dbo].[P_Subgroups]
(
	[sch_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_StuID]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_StuID] ON [dbo].[P_Subgroups]
(
	[stu_id] ASC
)
INCLUDE([group],[subgroup],[color],[series]) WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [IX_PIAP10_1]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_PIAP10_1] ON [dbo].[PIAP10]
(
	[permnum] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_SchId]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_SchId] ON [dbo].[Profile_Student_Enrollment]
(
	[sch_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_Star_Assessments_stu]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_Star_Assessments_stu] ON [dbo].[Star_Assessments]
(
	[stu_id] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [IX_stuID_SchIDEvent_SchDate]    Script Date: 3/27/2023 10:28:49 AM ******/
CREATE NONCLUSTERED INDEX [IX_stuID_SchIDEvent_SchDate] ON [dbo].[Work_attendance_day]
(
	[student_id] ASC,
	[school_id_event] ASC,
	[school_date] ASC
)
INCLUDE([present],[code]) WITH (STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
ALTER TABLE [dbo].[Covid_charter] ADD  CONSTRAINT [DF_Covid_charter_created_timestamp]  DEFAULT (getdate()) FOR [created_timestamp]
GO
ALTER TABLE [dbo].[CTAE_Referral_Requests] ADD  CONSTRAINT [DF_CTAE_Referral_Requests_date_created]  DEFAULT (getdate()) FOR [date_created]
GO
ALTER TABLE [dbo].[PinellasLeaveOfAbsence] ADD  CONSTRAINT [DF_PinellasLeaveOfAbsence_LoadDate]  DEFAULT (getdate()) FOR [LoadDate]
GO
/****** Object:  StoredProcedure [dbo].[insert_assigned_schools]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		Heath Glandon
-- Create date: June 2010
-- Modified:    Oct 2011
-- Description:	Takes comma separated list of schools from users table and inserts a row for each school
--              into the assigned_schools table. The assigned_schools table is used
--              by EDS to determine which schools the user has access to.
-- =============================================

CREATE PROCEDURE [dbo].[insert_assigned_schools]
(
		@username        varchar(50),
		@staff_id        int,
		@school_list     varchar(800)
)
AS
BEGIN
	declare
		@pos             int,
		@school_id       int

    -- Make sure there is a final comma so we can get the last school_id in the list
	if right(rtrim(@school_list),1) <> ','
		set @school_list = @school_list  + ','

    -- Make sure there is no leading comma so the position of the first comma follows the first school_id
	if left(ltrim(@school_list),1) = ','
		set @school_list = right(@school_list,len(@school_list)-1)

    -- Get first comma position
	set @pos = patindex('%,%' , @school_list)

    -- Loop until out of commas
	while @pos <> 0
		BEGIN
			set @school_id = left(@school_list, @pos-1)  -- get school_id
			insert into focus_assigned_schools (username,staff_id,school_id) values (@username,@staff_id,@school_id) -- insert into table
			set @school_list = stuff(@school_list, 1, @pos, '') -- remove school_id and comma from beginning of @school_list
			set @pos = patindex('%,%' , @school_list) -- get the new first comma position
		END

END
GO
/****** Object:  StoredProcedure [dbo].[sp_update_demographics]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE procedure [dbo].[sp_update_demographics]
as
BEGIN


declare @job_start  datetime,
        @step_start datetime,
        @rows       int,
        @syear      int
set @job_start = getdate()
set @rows = 0
set @syear = (select syear from constants where relative_year=0)

-- log start
set @step_start = getdate()
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', '-------------------------', 'Start', '', '', ''


-------------------------------------------------
-- datawh_demographics_stu (from Focus)
-------------------------------------------------

-- step start
set @step_start = getdate()
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'datawh_demographics_stu', 'Start', '', '', ''

delete from datawh_demographics_stu where syear=(select syear from constants where relative_year=0)
-- log delete
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'datawh_demographics_stu', '', cast(@@rowcount as varchar(50))+' rows deleted',
       convert(varchar(50), getdate()-@step_start,108), convert(varchar(50), getdate()-@job_start,108)


insert into datawh_demographics_stu (
       syear,stu_rec_id,permnum,schoolnum,school_id,
       gPK,gKG,g01,g02,g03,g04,g05,g06,g07,g08,g09,g10,g11,g12,
       male,female,white,black,hispanic,multi,asian,native,other,nonblack,
       econdis,swd,gifted,retained,--homeless,
       l35read,l35math,lep,sec504,
       --startdate,enddate,
       status
       )

select c.syear, cast(c.syear as varchar(4)) + sch.schoolnum + stu.permnum as stu_rec_id,
       stu.permnum, stu.schoolnum, stu.school_id,
       case when stu.grade = 'PK' then 1 else 0 end as gPK,
       case when stu.grade = 'KG' then 1 else 0 end as gKG,
       case when stu.grade = '01' then 1 else 0 end as g01,
       case when stu.grade = '02' then 1 else 0 end as g02,
       case when stu.grade = '03' then 1 else 0 end as g03,
       case when stu.grade = '04' then 1 else 0 end as g04,
       case when stu.grade = '05' then 1 else 0 end as g05,
       case when stu.grade = '06' then 1 else 0 end as g06,
       case when stu.grade = '07' then 1 else 0 end as g07,
       case when stu.grade = '08' then 1 else 0 end as g08,
       case when stu.grade = '09' then 1 else 0 end as g09,
       case when stu.grade = '10' then 1 else 0 end as g10,
       case when stu.grade = '11' then 1 else 0 end as g11,
       case when stu.grade = '12' then 1 else 0 end as g12,
       case when left(stu.gender, 1) = 'M' then 1 else 0 end as male,
       case when left(stu.gender, 1) = 'F' then 1 else 0 end as female,
       case when left(stu.ethniccode, 1) = 'W' then 1 else 0 end as white,
       case when left(stu.ethniccode, 1) = 'B' then 1 else 0 end as black,
       case when left(stu.ethniccode, 1) = 'H' then 1 else 0 end as hispanic,
       case when left(stu.ethniccode, 1) = 'M' then 1 else 0 end as multi,
       case when left(stu.ethniccode, 1) = 'A' then 1 else 0 end as asian,
       case when left(stu.ethniccode, 1) = 'I' then 1 else 0 end as native,
       case when left(stu.ethniccode, 1) not in ('W','B','H') then 1 else 0 end as other,
       case when left(stu.ethniccode, 1) <> 'B' then 1 else 0 end as nonblack,
       case when left(stu.freemeals,1) in ('2','3','9') then 1 else 0 end as econdis,
       case when left(stu.priexc,1) not in (' ','L') then 1 else 0 end as swd,
       case when left(stu.priexc,1) = 'L' then 1 else 0 end as gifted,
       case when left(stu.endyrst,1) = 'R' then 1 else 0 end as retained,
       --case when left(stu.homeless,1) = 'X' then 1 else 0 end as homeless,
       case when stu.l35read = 'L35R' then 1 else 0 end as l35read,
       case when stu.l35math = 'L35M' then 1 else 0 end as l35math,
       case when left(stu.lep,2) in ('LY','LF') then 1 else 0 end as lep,
       case when stu.sec504elig = 'Y' then 1 else 0 end as sec504,
       --stu.startdate,  stu.enddate,
       stu.status

from focus_students as stu
join focus_schools as sch on stu.school_id=sch.school_id
join constants as c on c.relative_year=0
where
      stu.grade in ('PK','KG','01','02','03','04','05','06','07','08','09','10','11','12')
  and stu.status = ''

-- step end
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'datawh_demographics_stu', 'End', cast(@@rowcount as varchar(50))+' rows inserted',
       convert(varchar(50), getdate()-@step_start,108), convert(varchar(50), getdate()-@job_start,108)
-------------------------------------------------
-- datawh_demographics_sch
-------------------------------------------------
-- step start
set @step_start = getdate()
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'datawh_demographics_sch', 'Start', '', '', ''

truncate table datawh_demographics_sch
-- log
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'datawh_demographics_sch', '', cast(@@rowcount as varchar(50))+' rows [truncated]',
       convert(varchar(50), getdate()-@step_start,108), convert(varchar(50), getdate()-@job_start,108)

-- school_id
insert into datawh_demographics_sch (
       syear,district,region,eds_group,school_id,active,male,female,
       gPK,gKG,g01,g02,g03,g04,g05,g06,g07,g08,g09,g10,g11,g12,
       white,black,hispanic,multi,asian,native,other,nonblack,
       econdis,swd,gifted,retained,homeless,
       l35read,l35math,lep,sec504
       )

select d.syear, null as district, null as region, null as eds_group, d.school_id, count(*) as active,
       sum(male) as male,  sum(female) as female, 
       sum(gPK) as gPK, sum(gKG) as gKG, sum(g01) as g01, sum(g02) as g02, sum(g03) as g03, sum(g04) as g04, sum(g05) as g05, sum(g06) as g06, sum(g07) as g07, sum(g08) as g08, sum(g09) as g09, sum(g10) as g10, sum(g11) as g11,  sum(g12) as g12,
       sum(white) as white, sum(black) as black, sum(hispanic) as hispanic, sum(multi) as multi, sum(asian) as asian, sum(native) as native, sum(other) as other, sum(nonblack) as nonblack,
       sum(econdis) as econdis, sum(swd) as swd, sum(gifted) as gifted, sum(retained) as retained, sum(homeless) as homeless,
       sum(l35read) as l35read, sum(l35math) as l35math, sum(lep) as lep, sum(sec504) as sec504

from datawh_demographics_stu as d
join focus_schools as sch on d.school_id=sch.school_id
where status <> 'I'
group by d.syear, d.school_id
set @rows=@rows+@@rowcount

-- region
insert into datawh_demographics_sch (
       syear,district,region,eds_group,school_id,active,male,female,
       gPK,gKG,g01,g02,g03,g04,g05,g06,g07,g08,g09,g10,g11,g12,
       white,black,hispanic,multi,asian,native,other,nonblack,
       econdis,swd,gifted,retained,homeless,
       l35read,l35math,lep,sec504
       )

select d.syear, null as district, sch.region, null as eds_group, null as school_id, count(*) as active,
       sum(male) as male,  sum(female) as female, 
       sum(gPK) as gPK, sum(gKG) as gKG, sum(g01) as g01, sum(g02) as g02, sum(g03) as g03, sum(g04) as g04, sum(g05) as g05, sum(g06) as g06, sum(g07) as g07, sum(g08) as g08, sum(g09) as g09, sum(g10) as g10, sum(g11) as g11,  sum(g12) as g12,
       sum(white) as white, sum(black) as black, sum(hispanic) as hispanic, sum(multi) as multi, sum(asian) as asian, sum(native) as native, sum(other) as other, sum(nonblack) as nonblack,
       sum(econdis) as econdis, sum(swd) as swd, sum(gifted) as gifted, sum(retained) as retained, sum(homeless) as homeless,
       sum(l35read) as l35read, sum(l35math) as l35math, sum(lep) as lep, sum(sec504) as sec504

from datawh_demographics_stu as d
join focus_schools as sch on d.school_id=sch.school_id
where d.status <> 'I' and region is not null
group by d.syear, region
set @rows=@rows+@@rowcount

-- eds_group
insert into datawh_demographics_sch (
       syear,district,region,eds_group,school_id,active,male,female,
       gPK,gKG,g01,g02,g03,g04,g05,g06,g07,g08,g09,g10,g11,g12,
       white,black,hispanic,multi,asian,native,other,nonblack,
       econdis,swd,gifted,retained,homeless,
       l35read,l35math,lep,sec504
       )

select d.syear, null as district, null as region, eds_group, null as school_id, count(*) as active,
       sum(male) as male,  sum(female) as female, 
       sum(gPK) as gPK, sum(gKG) as gKG, sum(g01) as g01, sum(g02) as g02, sum(g03) as g03, sum(g04) as g04, sum(g05) as g05, sum(g06) as g06, sum(g07) as g07, sum(g08) as g08, sum(g09) as g09, sum(g10) as g10, sum(g11) as g11,  sum(g12) as g12,
       sum(white) as white, sum(black) as black, sum(hispanic) as hispanic, sum(multi) as multi, sum(asian) as asian, sum(native) as native, sum(other) as other, sum(nonblack) as nonblack,
       sum(econdis) as econdis, sum(swd) as swd, sum(gifted) as gifted, sum(retained) as retained, sum(homeless) as homeless,
       sum(l35read) as l35read, sum(l35math) as l35math, sum(lep) as lep, sum(sec504) as sec504

from datawh_demographics_stu as d
join focus_schools as sch on d.school_id=sch.school_id
where d.status <> 'I' and eds_group is not null
group by d.syear, eds_group
set @rows=@rows+@@rowcount

-- district
insert into datawh_demographics_sch (
       syear,district,region,eds_group,school_id,active,male,female,
       gPK,gKG,g01,g02,g03,g04,g05,g06,g07,g08,g09,g10,g11,g12,
       white,black,hispanic,multi,asian,native,other,nonblack,
       econdis,swd,gifted,retained,homeless,
       l35read,l35math,lep,sec504
       )

select d.syear, 1 as district, null as region, null as eds_group, null as school_id, count(*) as active,
       sum(male) as male,  sum(female) as female, 
       sum(gPK) as gPK, sum(gKG) as gKG, sum(g01) as g01, sum(g02) as g02, sum(g03) as g03, sum(g04) as g04, sum(g05) as g05, sum(g06) as g06, sum(g07) as g07, sum(g08) as g08, sum(g09) as g09, sum(g10) as g10, sum(g11) as g11,  sum(g12) as g12,
       sum(white) as white, sum(black) as black, sum(hispanic) as hispanic, sum(multi) as multi, sum(asian) as asian, sum(native) as native, sum(other) as other, sum(nonblack) as nonblack,
       sum(econdis) as econdis, sum(swd) as swd, sum(gifted) as gifted, sum(retained) as retained, sum(homeless) as homeless,
       sum(l35read) as l35read, sum(l35math) as l35math, sum(lep) as lep, sum(sec504) as sec504

from datawh_demographics_stu as d
join focus_schools as sch on d.school_id=sch.school_id
where d.status <> 'I'
group by d.syear
set @rows=@rows+@@rowcount

-- step end
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'datawh_demographics_sch', 'End', cast(@rows as varchar(50))+' rows inserted',
       convert(varchar(50), getdate()-@step_start,108), convert(varchar(50), getdate()-@job_start,108)


-------------------------------------------------
-- focus_demographics
-------------------------------------------------
-- step start
set @step_start = getdate()
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'focus_demographics', 'Start', '', '', ''

truncate table focus_demographics
-- log
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'focus_demographics', '', cast(@@rowcount as varchar(50))+' rows [truncated]',
       convert(varchar(50), getdate()-@step_start,108), convert(varchar(50), getdate()-@job_start,108)

insert into focus_demographics

select
       syear, school_id, schoolnum, title, democode, demo,
       sum(grade_count) as total_count,
       sum(demo_grade_count) as demo_count,
       cast(sum(demo_grade_count) as real)/cast(sum(grade_count) as real) as demo_per,
       max(case when seq=1  then grade else '' end)           as c01_grade,
       max(case when seq=1  then demo_grade_count else 0 end) as c01_count,
       max(case when seq=2  then grade else '' end)           as c02_grade,
       max(case when seq=2  then demo_grade_count else 0 end) as c02_count,
       max(case when seq=3  then grade else '' end)           as c03_grade,
       max(case when seq=3  then demo_grade_count else 0 end) as c03_count,
       max(case when seq=4  then grade else '' end)           as c04_grade,
       max(case when seq=4  then demo_grade_count else 0 end) as c04_count,
       max(case when seq=5  then grade else '' end)           as c05_grade,
       max(case when seq=5  then demo_grade_count else 0 end) as c05_count,
       max(case when seq=6  then grade else '' end)           as c06_grade,
       max(case when seq=6  then demo_grade_count else 0 end) as c06_count,
       max(case when seq=7  then grade else '' end)           as c07_grade,
       max(case when seq=7  then demo_grade_count else 0 end) as c07_count,
       max(case when seq=8  then grade else '' end)           as c08_grade,
       max(case when seq=8  then demo_grade_count else 0 end) as c08_count,
       max(case when seq=9  then grade else '' end)           as c09_grade,
       max(case when seq=9  then demo_grade_count else 0 end) as c09_count,
       max(case when seq=10 then grade else '' end)           as c10_grade,
       max(case when seq=10 then demo_grade_count else 0 end) as c10_count,
       max(case when seq=11 then grade else '' end)           as c11_grade,
       max(case when seq=11 then demo_grade_count else 0 end) as c11_count,
       max(case when seq=12 then grade else '' end)           as c12_grade,
       max(case when seq=12 then demo_grade_count else 0 end) as c12_count,
       max(case when seq=13 then grade else '' end)           as c13_grade,
       max(case when seq=13 then demo_grade_count else 0 end) as c13_count,
       max(case when seq=14 then grade else '' end)           as c14_grade,
       max(case when seq=14 then demo_grade_count else 0 end) as c14_count


from (
				select row_number() over ( partition by d.syear, sch.school_id, d.democode
                                    order by case when d.grade = 'PK' then '0'
                                                  when d.grade = 'KG' then '00'
                                                  else d.grade
                                             end ) as seq,
                       d.syear, sch.school_id, sch.schoolnum, sch.title,
                       d.democode, d.demo,
                       d.grade, d.demo_grade_count, d.grade_count
                from (
						select @syear as syear, stu.school_id, stu.grade, 'Total' as democode, 'Total'                            as demo, count(*) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'B'   as democode, 'B - Black, non-Hispanic'            as demo, count(case when ethniccode='B' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'W'   as democode, 'W - White, non-Hispanic'            as demo, count(case when ethniccode='W' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'A'   as democode, 'A - Asian/Pacific Islander'         as demo, count(case when ethniccode='A' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'H'   as democode, 'H - Hispanic'                       as demo, count(case when ethniccode='H' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'I'   as democode, 'I - American Indian/Alaskan Native' as demo, count(case when ethniccode='I' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'M'   as democode, 'M - Multiracial'                    as demo, count(case when ethniccode='M' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'ED'  as democode, 'Economically Disadvantaged'         as demo, count(case when freemeals in ('2','3','9') then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'SWD' as democode, 'Students with Disabilities'         as demo, count(case when priexc is not null and priexc not in ('','L') then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'Gift' as democode, 'Gifted'                            as demo, count(case when priexc = 'L' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'ELL' as democode, 'English Learning Language'          as demo, count(case when lep in ('LY','LF') then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'N/A' as democode, 'Unknown Race'                       as demo, count(case when ethniccode is null then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'Male'   as democode, 'Male'                               as demo, count(case when gender = 'M' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade union all
						select @syear as syear, stu.school_id, stu.grade, 'Female' as democode, 'Female'                             as demo, count(case when gender = 'F' then 1 end) as demo_grade_count, count(*) as grade_count from focus_students as stu join focus_schools as sch on stu.school_id=sch.school_id where stu.status = '' group by stu.school_id, stu.grade
                ) as d
                left join focus_schools as sch on d.school_id=sch.school_id
                where sch.school_id is not null
                  and d.grade <> ''
                  and d.syear >=2008



) as t
group by syear, school_id, schoolnum, title, democode, demo
order by syear, school_id, schoolnum, title, democode, demo

-- step end
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'focus_demographics', 'End', cast(@@rowcount as varchar(50))+' rows inserted',
       convert(varchar(50), getdate()-@step_start,108), convert(varchar(50), getdate()-@job_start,108)

-------------------------------------------------
-- focus_demo_chart
-------------------------------------------------
-- step start
set @step_start = getdate()
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'focus_demo_chart', 'Start', '', '', ''

truncate table focus_demo_chart
-- log
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'focus_demo_chart', '', cast(@@rowcount as varchar(50))+' rows [truncated]',
       convert(varchar(50), getdate()-@step_start,108), convert(varchar(50), getdate()-@job_start,108)

insert focus_demo_chart

select t.syear, t.school_id, sch.title as schoolname, sch.region, sch.eds_visible, sch.eds_group,
       max(case when democode = 'A' then demo_count else null end) as asian_num,
       max(case when democode = 'A' then demo_display else null end) as asian_dis,
       max(case when democode = 'A' then demo_per else null end) as asian_per,
       max(case when democode = 'B' then demo_count else null end) as black_num,
       max(case when democode = 'B' then demo_display else null end) as black_dis,
       max(case when democode = 'B' then demo_per else null end) as black_per,
       max(case when democode = 'ED' then demo_count else null end) as econ_dis_num,
       max(case when democode = 'ED' then demo_display else null end) as econ_dis_dis,
       max(case when democode = 'ED' then demo_per else null end) as econ_dis_per,
       max(case when democode = 'ELL' then demo_count else null end) as ell_num,
       max(case when democode = 'ELL' then demo_display else null end) as ell_dis,
       max(case when democode = 'ELL' then demo_per else null end) as ell_per,
       max(case when democode = 'FCATM1' then demo_count else null end) as fcatm1_num,
       max(case when democode = 'FCATM1' then demo_display else null end) as fcatm1_dis,
       max(case when democode = 'FCATM1' then demo_per else null end) as fcatm1_per,
       max(case when democode = 'FCATM2' then demo_count else null end) as fcatm2_num,
       max(case when democode = 'FCATM2' then demo_display else null end) as fcatm2_dis,
       max(case when democode = 'FCATM2' then demo_per else null end) as fcatm2_per,
       max(case when democode = 'FCATM3' then demo_count else null end) as fcatm3_num,
       max(case when democode = 'FCATM3' then demo_display else null end) as fcatm3_dis,
       max(case when democode = 'FCATM3' then demo_per else null end) as fcatm3_per,
       max(case when democode = 'FCATM4' then demo_count else null end) as fcatm4_num,
       max(case when democode = 'FCATM4' then demo_display else null end) as fcatm4_dis,
       max(case when democode = 'FCATM4' then demo_per else null end) as fcatm4_per,
       max(case when democode = 'FCATM5' then demo_count else null end) as fcatm5_num,
       max(case when democode = 'FCATM5' then demo_display else null end) as fcatm5_dis,
       max(case when democode = 'FCATM5' then demo_per else null end) as fcatm5_per,
       max(case when democode = 'FCATR1' then demo_count else null end) as fcatr1_num,
       max(case when democode = 'FCATR1' then demo_display else null end) as fcatr1_dis,
       max(case when democode = 'FCATR1' then demo_per else null end) as fcatr1_per,
       max(case when democode = 'FCATR2' then demo_count else null end) as fcatr2_num,
       max(case when democode = 'FCATR2' then demo_display else null end) as fcatr2_dis,
       max(case when democode = 'FCATR2' then demo_per else null end) as fcatr2_per,
       max(case when democode = 'FCATR3' then demo_count else null end) as fcatr3_num,
       max(case when democode = 'FCATR3' then demo_display else null end) as fcatr3_dis,
       max(case when democode = 'FCATR3' then demo_per else null end) as fcatr3_per,
       max(case when democode = 'FCATR4' then demo_count else null end) as fcatr4_num,
       max(case when democode = 'FCATR4' then demo_display else null end) as fcatr4_dis,
       max(case when democode = 'FCATR4' then demo_per else null end) as fcatr4_per,
       max(case when democode = 'FCATR5' then demo_count else null end) as fcatr5_num,
       max(case when democode = 'FCATR5' then demo_display else null end) as fcatr5_dis,
       max(case when democode = 'FCATR5' then demo_per else null end) as fcatr5_per,
       max(case when democode = 'Gift' then demo_count else null end) as gifted_num,
       max(case when democode = 'Gift' then demo_display else null end) as gifted_dis,
       max(case when democode = 'Gift' then demo_per else null end) as gifted_per,
       max(case when democode = 'H' then demo_count else null end) as hispanic_num,
       max(case when democode = 'H' then demo_display else null end) as hispanic_dis,
       max(case when democode = 'H' then demo_per else null end) as hispanic_per,
       max(case when democode = 'I' then demo_count else null end) as indian_num,
       max(case when democode = 'I' then demo_display else null end) as indian_dis,
       max(case when democode = 'I' then demo_per else null end) as indian_per,
       max(case when democode = 'M' then demo_count else null end) as multi_num,
       max(case when democode = 'M' then demo_display else null end) as multi_dis,
       max(case when democode = 'M' then demo_per else null end) as multi_per,
       max(case when democode = 'SWD' then demo_count else null end) as swd_num,
       max(case when democode = 'SWD' then demo_display else null end) as swd_dis,
       max(case when democode = 'SWD' then demo_per else null end) as swd_per,
       max(case when democode = 'Total' then demo_count else null end) as total_num,
       max(case when democode = 'Total' then demo_display else null end) as total_dis,
       max(case when democode = 'Total' then demo_per else null end) as total_per,
       max(case when democode = 'N/A' then demo_count else null end) as unknown_num,
       max(case when democode = 'N/A' then demo_display else null end) as unknown_dis,
       max(case when democode = 'N/A' then demo_per else null end) as unknown_per,
       max(case when democode = 'W' then demo_count else null end) as white_num,
       max(case when democode = 'W' then demo_display else null end) as white_dis,
       max(case when democode = 'W' then demo_per else null end) as white_per

from(
		select syear,school_id,democode,demo_count,demo_per,
               cast(round(demo_per*100,0) as varchar(4)) +'% ('+ cast(demo_count as varchar(8)) +')' as demo_display
		from focus_demographics
    ) as t
join focus_schools as sch on t.school_id=sch.school_id
group by t.syear, t.school_id, sch.title, sch.region, sch.eds_visible, sch.eds_group

-- step end
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', 'focus_demo_chart', 'End', cast(@@rowcount as varchar(50))+' rows inserted',
       convert(varchar(50), getdate()-@step_start,108), convert(varchar(50), getdate()-@job_start,108)

-------------------------------
-- End of job
-------------------------------
-- job end
insert into log_jobs (log_time,job,step,result,detail,step_duration,job_duration)
select getdate(), 'sp_update_demographics', '-------------------------', 'End', '',
       '', convert(varchar(50), getdate()-@job_start,108)

END
GO
/****** Object:  StoredProcedure [dbo].[ss_FCAT_LEVEL_Update]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


--EXECUTE ss_FCAT_LEVEL_Update

create PROCEDURE [dbo].[ss_FCAT_LEVEL_Update] 
as 
truncate table ss_FCAT_Levels
Insert into ss_FCAT_Levels
(
schoolnum 
,schoolname
,students
,rdglv1
,rdglv2
,rdglv3
,rdglv4
,rdglv5
,mthlv1
,mthlv2
,mthlv3
,mthlv4
,mthlv5 
,perRdglv1
,perRdglv2
,perRdglv3
,perRdglv4
,perRdglv5
,perMthlv1
,perMthlv2
,perMthlv3
,perMthlv4
,perMthlv5
)
Select
schoolnum 
,schoolname
,students
,rdglv1
,rdglv2
,rdglv3
,rdglv4
,rdglv5
,mthlv1
,mthlv2
,mthlv3
,mthlv4
,mthlv5 
,perRdglv1
,perRdglv2
,perRdglv3
,perRdglv4
,perRdglv5
,perMthlv1
,perMthlv2
,perMthlv3
,perMthlv4
,perMthlv5


FROM 
(

/* Group by school*/ SELECT schoolnum, schoolname, students, rdglv1, rdglv2, rdglv3, rdglv4, rdglv5, mthlv1, mthlv2, mthlv3, mthlv4, mthlv5, 
                      Cast(RdgLv1 AS real) / Cast(students AS real) AS perRdglv1, Cast(RdgLv2 AS real) / Cast(students AS real) AS perRdglv2, Cast(RdgLv3 AS real) 
                      / Cast(students AS real) AS perRdglv3, Cast(RdgLv4 AS real) / Cast(students AS real) AS perRdglv4, Cast(RdgLv5 AS real) / Cast(students AS real) 
                      AS perRdglv5, Cast(MthLv1 AS real) / Cast(students AS real) AS perMthlv1, Cast(MthLv2 AS real) / Cast(students AS real) AS perMthlv2, 
                      Cast(MthLv3 AS real) / Cast(students AS real) AS perMthlv3, Cast(MthLv4 AS real) / Cast(students AS real) AS perMthlv4, Cast(MthLv5 AS real) 
                      / Cast(students AS real) AS perMthlv5
FROM         (SELECT     stu.schoolnum, sch.schoolname, count(*) AS students, count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '1' THEN 1 END) AS RdgLv1, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '2' THEN 1 END) AS RdgLv2, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '3' THEN 1 END) AS RdgLv3, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '4' THEN 1 END) AS RdgLv4, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '5' THEN 1 END) AS RdgLv5, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '1' THEN 1 END) AS MthLv1, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '2' THEN 1 END) AS MthLv2, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '3' THEN 1 END) AS MthLv3, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '4' THEN 1 END) AS MthLv4, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '5' THEN 1 END) AS MthLv5
                       FROM          astu8d21 AS stu JOIN
                                              dbo.FCAT_Scores AS f ON stu.permnum = f.permnum JOIN
                                              dbo.schools AS sch ON stu.schoolnum = sch.schoolnum AND district_totals = 'Y'
      where f.FCAT_09_Rdg_SSS_Level is not null   and f.FCAT_09_Mth_SSS_Level is not null  

                      GROUP BY stu.schoolnum, sch.schoolname/*order by stu.schoolnum*/ ) AS t
UNION
/* District*/ SELECT schoolnum, schoolname, students, rdglv1, rdglv2, rdglv3, rdglv4, rdglv5, mthlv1, mthlv2, mthlv3, mthlv4, mthlv5, Cast(RdgLv1 AS real) 
                      / Cast(students AS real) AS perRdglv1, Cast(RdgLv2 AS real) / Cast(students AS real) AS perRdglv2, Cast(RdgLv3 AS real) / Cast(students AS real) 
                      AS perRdglv3, Cast(RdgLv4 AS real) / Cast(students AS real) AS perRdglv4, Cast(RdgLv5 AS real) / Cast(students AS real) AS perRdglv5, 
                      Cast(MthLv1 AS real) / Cast(students AS real) AS perMthlv1, Cast(MthLv2 AS real) / Cast(students AS real) AS perMthlv2, Cast(MthLv3 AS real) 
                      / Cast(students AS real) AS perMthlv3, Cast(MthLv4 AS real) / Cast(students AS real) AS perMthlv4, Cast(MthLv5 AS real) / Cast(students AS real) 
                      AS perMthlv5
FROM         (SELECT     '10000' AS schoolnum, 'All District' AS schoolname, count(*) AS students, count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '1' THEN 1 END) 
                                              AS RdgLv1, count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '2' THEN 1 END) AS RdgLv2, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '3' THEN 1 END) AS RdgLv3, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '4' THEN 1 END) AS RdgLv4, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '5' THEN 1 END) AS RdgLv5, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '1' THEN 1 END) AS MthLv1, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '2' THEN 1 END) AS MthLv2, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '3' THEN 1 END) AS MthLv3, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '4' THEN 1 END) AS MthLv4, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '5' THEN 1 END) AS MthLv5
                       FROM          astu8d21 AS stu JOIN
                                              dbo.FCAT_Scores AS f ON stu.permnum = f.permnum JOIN
                                              dbo.schools AS sch ON stu.schoolnum = sch.schoolnum AND district_totals = 'Y'
      where f.FCAT_09_Rdg_SSS_Level is not null   and f.FCAT_09_Mth_SSS_Level is not null  

/*order by stu.schoolnum*/ ) AS t
UNION
/* Group by levels*/ SELECT schoolnum, schoolname, students, rdglv1, rdglv2, rdglv3, rdglv4, rdglv5, mthlv1, mthlv2, mthlv3, mthlv4, mthlv5, 
                      Cast(RdgLv1 AS real) / Cast(students AS real) AS perRdglv1, Cast(RdgLv2 AS real) / Cast(students AS real) AS perRdglv2, Cast(RdgLv3 AS real) 
                      / Cast(students AS real) AS perRdglv3, Cast(RdgLv4 AS real) / Cast(students AS real) AS perRdglv4, Cast(RdgLv5 AS real) / Cast(students AS real) 
                      AS perRdglv5, Cast(MthLv1 AS real) / Cast(students AS real) AS perMthlv1, Cast(MthLv2 AS real) / Cast(students AS real) AS perMthlv2, 
                      Cast(MthLv3 AS real) / Cast(students AS real) AS perMthlv3, Cast(MthLv4 AS real) / Cast(students AS real) AS perMthlv4, Cast(MthLv5 AS real) 
                      / Cast(students AS real) AS perMthlv5
FROM         (SELECT     CASE WHEN levelname = 'Elementary' THEN '10100' WHEN levelname = 'Middle' THEN '10200' WHEN levelname = 'High' THEN '10300' ELSE
                                               '10400' END AS schoolnum, 
                                              CASE WHEN levelname = 'Elementary' THEN 'All Elementary' WHEN levelname = 'Middle' THEN 'All Middle' WHEN levelname = 'High' THEN
                                               'All High' ELSE 'All Others' END AS schoolname, count(*) AS students, count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '1' THEN 1 END) 
                                              AS RdgLv1, count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '2' THEN 1 END) AS RdgLv2, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '3' THEN 1 END) AS RdgLv3, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '4' THEN 1 END) AS RdgLv4, 
                                              count(CASE WHEN f.FCAT_09_Rdg_SSS_Level = '5' THEN 1 END) AS RdgLv5, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '1' THEN 1 END) AS MthLv1, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '2' THEN 1 END) AS MthLv2, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '3' THEN 1 END) AS MthLv3, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '4' THEN 1 END) AS MthLv4, 
                                              count(CASE WHEN f.FCAT_09_Mth_SSS_Level = '5' THEN 1 END) AS MthLv5
                       FROM          astu8d21 AS stu JOIN
                                              dbo.FCAT_Scores AS f ON stu.permnum = f.permnum JOIN
                                              dbo.schools AS sch ON stu.schoolnum = sch.schoolnum AND district_totals = 'Y'
      where f.FCAT_09_Rdg_SSS_Level is not null   and f.FCAT_09_Mth_SSS_Level is not null  

                       GROUP BY sch.levelname/*order by stu.schoolnum*/ ) AS t
)as u
GO
/****** Object:  StoredProcedure [dbo].[Update_Assessment_Query09]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE procedure

[dbo].[Update_Assessment_Query09]
as

truncate table C1_Assmt_Query09

insert into  C1_Assmt_Query09

(permnum,schoolnum,lastname, firstname, teacher,grade, gender, ethniccode,
 Gifted, lep, SWD, EcoDis, endyrst, YTD_ABS, RdgPerc,RdgStatus,MathScore1, 
 MathPerc1, MthStatus, WriteScore, WritStatus,SciScore1,SciPerc1,SciStatus, fcatread,readgain,fcatmath,mathgain,r1MazePercentile,r1WAPercentile,
 fcatwri, fcatsci)

select
permnum,schoolnum,lastname, firstname, teacher,grade, gender, ethniccode,
 Gifted, lep, SWD, EcoDis, endyrst, YTD_ABS, RdgPerc,RdgStatus,MathScore1, 
 MathPerc1, MthStatus, WriteScore, WritStatus,SciScore1,SciPerc1,SciStatus, fcatread,readgain,fcatmath,mathgain,r1MazePercentile,r1WAPercentile,
 fcatwri, fcatsci

from
(
select
stu.permnum,stu.schoolnum,stu.lastname, stu.firstname,tch.lastname +', '+ left(tch.firstname,1) as teacher, stu.grade, stu.gender, stu.ethniccode,
 l.lep, stu.endyrst, stu.YTD_ABS, (p.r1PRS*.01) as RdgPerc,a.r1status as RdgStatus, ms.MathScore1, 
 ms.MathPerc1, a.m1status as MthStatus, a.w1stgscr as WriteScore, w1status as WritStatus, ms.SciScore1,ms.SciPerc1, a.s1status as SciStatus,f.fcatread,f.readgain,f.fcatmath,f.mathgain,
 f.fcatwri, f.fcatsci,p.r1MazePercentile , p.r1WAPercentile ,
case when stu.priexc = 'L' then 'G' end as Gifted,
case when stu.freemeals in ('2','3') then 'Q' end as EcoDis,
case when stu.priexc = 'C' THEN 'OI'
	when stu.priexc = 'D' THEN 'OT'  
	when stu.priexc = 'E' THEN 'PT'  
	when stu.priexc = 'F' THEN 'SI'  
	when stu.priexc = 'G' THEN 'LI'  
	when stu.priexc = 'H' THEN 'DDH'  
	when stu.priexc = 'I' THEN 'VI'  
	when stu.priexc = 'J' THEN 'EBD'  
	when stu.priexc = 'K' THEN 'SLD'  
	when stu.priexc = 'M' THEN 'HH'  
	when stu.priexc = 'T' THEN 'DD'  
	when stu.priexc = 'V' THEN 'OHI' 
   END AS SWD


from astu9d21 as stu
left join piap09 as p on stu.permnum = p.permnum
left join fcat9 as f on stu.permnum = f.permnum
left join Mth_Sci_Scores09 as ms on stu.permnum = ms.permnum


left join sfla9d21 as l on stu.stulink = l.stulink and stu.schoolnum = l.schoolnum
left join atch9d21 as tch on stu.schoolnum = tch.schoolnum and stu.advisor = tch.tchnum
left join EDS_Assessments as a on stu.permnum = a.studentid
where stu.status = ''
)as r


GO
/****** Object:  StoredProcedure [dbo].[Update_ATTENDANCE_QUERY_COUNT]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure
[dbo].[Update_ATTENDANCE_QUERY_COUNT]
as
truncate table ATTENDANCE_QUERY_COUNT

insert into  ATTENDANCE_QUERY_COUNT

(
[PERMNUM]
      ,[SCHOOLNUM]
      ,[ENTERDATE]
      ,[LASTNAME]
      ,[FIRSTNAME]
      ,[GRADE]
      ,[GENDER]
      ,[ETHNICCODE]
      ,[PRIEXC]
      ,[FREEMEALS]
      ,[tarytd]
      ,[absytd]
      ,[tar8]
      ,[abs8]
      ,[tar9]
      ,[abs9]
      ,[tar10]
      ,[abs10]
      ,[tar11]
      ,[abs11]
      ,[tar12]
      ,[abs12]
      ,[tar1]
      ,[abs1]
      ,[tar2]
      ,[abs2]
      ,[tar3]
      ,[abs3]
      ,[tar4]
      ,[abs4]
      ,[tar5]
      ,[abs5]
      ,[tar6]
      ,[abs6]
      ,[tar7]
      ,[abs7]
      ,[tarsem1]
      ,[abssem1]
      ,[tarsem2]
      ,[abssem2]
      ,[targrp1]
      ,[absgrp1]
      ,[targrp2]
      ,[absgrp2]
      ,[targrp3]
      ,[absgrp3]
)

SELECT [PERMNUM]
      ,[SCHOOLNUM]
      ,[ENTERDATE]
      ,[LASTNAME]
      ,[FIRSTNAME]
      ,[GRADE]
      ,[GENDER]
      ,[ETHNICCODE]
      ,[PRIEXC]
      ,[FREEMEALS]
      ,[tarytd]
      ,[absytd]
      ,[tar8]
      ,[abs8]
      ,[tar9]
      ,[abs9]
      ,[tar10]
      ,[abs10]
      ,[tar11]
      ,[abs11]
      ,[tar12]
      ,[abs12]
      ,[tar1]
      ,[abs1]
      ,[tar2]
      ,[abs2]
      ,[tar3]
      ,[abs3]
      ,[tar4]
      ,[abs4]
      ,[tar5]
      ,[abs5]
      ,[tar6]
      ,[abs6]
      ,[tar7]
      ,[abs7]
      ,[tarsem1]
      ,[abssem1]
      ,[tarsem2]
      ,[abssem2]
      ,[targrp1]
      ,[absgrp1]
      ,[targrp2]
      ,[absgrp2]
      ,[targrp3]
      ,[absgrp3]


from
(select
 PERMNUM, SCHOOLNUM, ENTERDATE, LASTNAME, FIRSTNAME, 
--case
-- when GRADE = 'PK' then '00' 
--cast(when GRADE = 'Kg' then '0' as int)
-- when GRADE = '01' then '01' 
--when GRADE = '02' then '02' 
--when GRADE = '03' then '03' 
--when GRADE = '04' then '04'
-- when GRADE = '05' then '05' 
--when GRADE = '06' then '06' 
--when GRADE = '07' then '07' 
--when GRADE = '08' then '08'
-- when GRADE = '09' then '09' 
--when GRADE = '10' then '10' 
--when GRADE = '11' then '11' 
--when GRADE = '12' then '12'
--end as Grade,
Grade,

 GENDER, ETHNICCODE, PRIEXC,
case when FREEMEALS IN('2','3') then 'Q' end as FREEMEALS, 
                      COUNT(CASE WHEN type = 'T' THEN 1 END) AS tarytd, COUNT(CASE WHEN type = 'A' THEN 1 END) AS absytd, COUNT(CASE WHEN datepart(month, 
                      absdate) = 8 AND type = 'T' THEN 1 END) AS tar8, COUNT(CASE WHEN datepart(month, absdate) = 8 AND type = 'A' THEN 1 END) AS abs8, 
                      COUNT(CASE WHEN datepart(month, absdate) = 9 AND type = 'T' THEN 1 END) AS tar9, COUNT(CASE WHEN datepart(month, absdate) = 9 AND 
                      type = 'A' THEN 1 END) AS abs9, COUNT(CASE WHEN datepart(month, absdate) = 10 AND type = 'T' THEN 1 END) AS tar10, 
                      COUNT(CASE WHEN datepart(month, absdate) = 10 AND type = 'A' THEN 1 END) AS abs10, COUNT(CASE WHEN datepart(month, absdate) = 11 AND 
                      type = 'T' THEN 1 END) AS tar11, COUNT(CASE WHEN datepart(month, absdate) = 11 AND type = 'A' THEN 1 END) AS abs11, 
                      COUNT(CASE WHEN datepart(month, absdate) = 12 AND type = 'T' THEN 1 END) AS tar12, COUNT(CASE WHEN datepart(month, absdate) = 12 AND 
                      type = 'A' THEN 1 END) AS abs12, COUNT(CASE WHEN datepart(month, absdate) = 1 AND type = 'T' THEN 1 END) AS tar1, 
                      COUNT(CASE WHEN datepart(month, absdate) = 1 AND type = 'A' THEN 1 END) AS abs1, COUNT(CASE WHEN datepart(month, absdate) = 2 AND 
                      type = 'T' THEN 1 END) AS tar2, COUNT(CASE WHEN datepart(month, absdate) = 2 AND type = 'A' THEN 1 END) AS abs2, 
                      COUNT(CASE WHEN datepart(month, absdate) = 3 AND type = 'T' THEN 1 END) AS tar3, COUNT(CASE WHEN datepart(month, absdate) = 3 AND 
                      type = 'A' THEN 1 END) AS abs3, COUNT(CASE WHEN datepart(month, absdate) = 4 AND type = 'T' THEN 1 END) AS tar4, 
                      COUNT(CASE WHEN datepart(month, absdate) = 4 AND type = 'A' THEN 1 END) AS abs4, COUNT(CASE WHEN datepart(month, absdate) = 5 AND 
                      type = 'T' THEN 1 END) AS tar5, COUNT(CASE WHEN datepart(month, absdate) = 5 AND type = 'A' THEN 1 END) AS abs5, 
                      COUNT(CASE WHEN datepart(month, absdate) = 6 AND type = 'T' THEN 1 END) AS tar6, COUNT(CASE WHEN datepart(month, absdate) = 6 AND 
                      type = 'A' THEN 1 END) AS abs6, COUNT(CASE WHEN datepart(month, absdate) = 7 AND type = 'T' THEN 1 END) AS tar7, 
                      COUNT(CASE WHEN datepart(month, absdate) = 7 AND type = 'A' THEN 1 END) AS abs7, COUNT(CASE WHEN absdate BETWEEN '2009-08-25' AND 
                      '2010-01-24' AND type = 'T' THEN 1 END) AS tarsem1, COUNT(CASE WHEN absdate BETWEEN '2009-08-25' AND '2010-01-24' AND 
                      type = 'A' THEN 1 END) AS abssem1, COUNT(CASE WHEN absdate BETWEEN '2010-01-25' AND '2010-06-09' AND type = 'T' THEN 1 END) AS tarsem2, 
                      COUNT(CASE WHEN absdate BETWEEN '2010-01-25' AND '2010-06-09' AND type = 'A' THEN 1 END) AS abssem2, 
                      COUNT(CASE WHEN absdate BETWEEN '2009-08-25' AND '2009-10-30' AND type = 'T' THEN 1 END) AS targrp1, 
                      COUNT(CASE WHEN absdate BETWEEN '2009-08-25' AND '2009-10-30' AND type = 'A' THEN 1 END) AS absgrp1, 
                      COUNT(CASE WHEN absdate BETWEEN '2009-11-02' AND '2010-02-12' AND type = 'T' THEN 1 END) AS targrp2, 
                      COUNT(CASE WHEN absdate BETWEEN '2009-11-02' AND '2010-02-12' AND type = 'A' THEN 1 END) AS absgrp2, 
                      COUNT(CASE WHEN absdate BETWEEN '2010-02-15' AND '2010-06-09' AND type = 'T' THEN 1 END) AS targrp3, 
                      COUNT(CASE WHEN absdate BETWEEN '2010-02-15' AND '2010-06-09' AND type = 'A' THEN 1 END) AS absgrp3
FROM         dbo.attendance_query AS q

GROUP BY PERMNUM, SCHOOLNUM, ENTERDATE, LASTNAME, FIRSTNAME, GRADE, GENDER, ETHNICCODE, PRIEXC, FREEMEALS


) as t
GO
/****** Object:  StoredProcedure [dbo].[Update_AYP_SubGrps]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[Update_AYP_SubGrps] 
as

truncate table dbo.AYP_SubGrps10

insert into dbo.AYP_SubGrps10


( schoolnum, StdsTotal, wh, WhWrite, bL, BlWrite, his, hisWrite,  ind, indWrite,asi, asiWrite, fr, frWrite,
        lep, lepWrite, swdWrite, allWrite
)

select

schoolnum, StdsTotal, wh, WhWrite, bL, BlWrite, his, hisWrite, ind, indWrite, asi, asiWrite, fr, frWrite,
        lep, lepWrite, swdWrite, allWrite

 
from
(
select stu.schoolnum,
 
       count(*) as 'stdsTotal',
       count(case when stu.ethniccode = 'W' then 1 end) as wh,
       count(case when stu.ethniccode = 'W' and stu.grade = '04'then 1 end) as whWrite,

       count(case when stu.ethniccode = 'B' then 1 end) as bl,
       count(case when stu.ethniccode = 'B' and stu.grade in('04','08','10')  then 1 end) as blWrite,


       count(case when stu.ethniccode = 'H' then 1 end) as his,
       count(case when stu.ethniccode = 'H' and stu.grade in('04','08','10') then 1 end) as hisWrite,

       count(case when stu.ethniccode = 'i'then 1 end) as ind,       
       count(case when stu.ethniccode = 'i' and stu.grade in('04','08','10') then 1 end) as indWrite,

       count(case when stu.ethniccode = 'a' then 1 end) as asi,
       count(case when stu.ethniccode = 'a' and stu.grade in('04','08','10')  then 1 end) as asiWrite,

       count(case when stu.freemeals in ('2','3') then 1 end) as fr,
       count(case when stu.freemeals in ('2','3') and stu.grade in('04','08','10') then 1 end) as frWrite,

       count(case when ayp.lep in ('LF','LY')then 1 end) as lep,
       count(case when ayp.lep in ('LF','LY') and stu.grade in('04','08','10') then 1 end) as lepWrite,

       count(case when stu.priexc not in ('L','') then 1 end) as swd,
       count(case when stu.priexc not in ('L','')and stu.grade in('04','08','10') then 1 end) as swdWrite,


       count(case when stu.grade in('04','08','10') then 1 end) as allWrite




from astu9d21 as stu

join ayp09 as ayp on stu.permnum = ayp.permnum and ayp.schoolnum = stu.schoolnum
where stu.grade in ('03','04','05','06','07','08','09','10')
group by stu.schoolnum
) as t


GO
/****** Object:  StoredProcedure [dbo].[update_MS_HS_Discipline_Chart]    Script Date: 3/27/2023 10:28:49 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



Create procedure 
[dbo].[update_MS_HS_Discipline_Chart]
as

truncate table dbo.Discipline_HS_report9

insert into dbo.Discipline_HS_report9 
 

(
     disschnum, 
			AugBat, AugBlkBat, AugNonBlkBat, SepBat, SepBlkBat, SepNonBlkBat, OctBat,
			OctBlkBat, OctNonBlkBat,NovBat, NovBlkBat, NovNonBlkBat, DecBat, DecBlkBat, 
			DecNonBlkBat, JanBat, JanBlkBat, JanNonBlkBat,FebBat, FebBlkBat, FebNonBlkBat,
			MarBat, MarBlkBat, MarNonBlkBat, AprBat, AprBlkBat, AprNonBlkBat, 
			MayBat, MayBlkBat, MayNonBlkBat,JunBat, JunBlkBat, JunNonBlkBat, 
			Tot_NonBlkBat,
			Tot_BlkBat,


			AugIns, AugBlkIns, AugNonBlkIns, SepIns, SepBlkIns, SepNonBlkIns, OctIns, 
			OctBlkIns, OctNonBlkIns, NovIns, NovBlkIns, NovNonBlkIns, DecIns, DecBlkIns, 
			DecNonBlkIns, JanIns, JanBlkIns, JanNonBlkIns, FebIns, FebBlkIns, FebNonBlkIns,
			MarIns, MarBlkIns, MarNonBlkIns, AprIns, AprBlkIns, AprNonBlkIns, 
			MayIns, MayBlkIns, MayNonBlkIns,JunIns, JunBlkIns, JunNonBlkIns, 
			Tot_NonBlkIns,
			Tot_BlkIns,

			AugDisr, AugBlkDisr, AugNonBlkDisr, SepDisr, SepBlkDisr, SepNonBlkDisr, OctDisr, 
			OctBlkDisr, OctNonBlkDisr,NovDisr, NovBlkDisr, NovNonBlkDisr, DecDisr, DecBlkDisr, 
			DecNonBlkDisr, JanDisr, JanBlkDisr, JanNonBlkDisr,FebDisr, FebBlkDisr, FebNonBlkDisr,
			MarDisr, MarBlkDisr, MarNonBlkDisr, AprDisr, AprBlkDisr, AprNonBlkDisr, 
			MayDisr, MayBlkDisr, MayNonBlkDisr,JunDisr, JunBlkDisr, JunNonBlkDisr,
			Tot_NonBlkDisr,
			Tot_BlkDisr,

			AugFig, AugBlkFig, AugNonBlkFig, SepFig, SepBlkFig, SepNonBlkFig, OctFig, 
			OctBlkFig, OctNonBlkFig,NovFig, NovBlkFig, NovNonBlkFig, DecFig, DecBlkFig, 
			DecNonBlkFig, JanFig, JanBlkFig, JanNonBlkFig,FebFig, FebBlkFig, FebNonBlkFig,
			MarFig, MarBlkFig, MarNonBlkFig,AprFig, AprBlkFig, AprNonBlkFig,
			MayFig, MayBlkFig, MayNonBlkFig,JunFig, JunBlkFig, JunNonBlkFig, 
			Tot_NonBlkFig,
			Tot_BlkFig,

			AugObs, AugBlkObs, AugNonBlkObs, SepObs, SepBlkObs, SepNonBlkObs, OctObs, 
			OctBlkObs, OctNonBlkObs,NovObs, NovBlkObs, NovNonBlkObs, DecObs, DecBlkObs, 
			DecNonBlkObs, JanObs, JanBlkObs, JanNonBlkObs, FebObs, FebBlkObs, FebNonBlkObs,
			MarObs, MarBlkObs, MarNonBlkObs,AprObs, AprBlkObs, AprNonBlkObs, 
			MayObs, MayBlkObs, MayNonBlkObs,JunObs, JunBlkObs, JunNonBlkObs, 
			Tot_NonBlkObs,
			Tot_BlkObs,

			AugRep, AugBlkRep, AugNonBlkRep, SepRep, SepBlkRep, SepNonBlkRep, OctRep, 
			OctBlkRep, OctNonBlkRep,NovRep, NovBlkRep, NovNonBlkRep, DecRep, DecBlkRep, 
			DecNonBlkRep, JanRep, JanBlkRep, JanNonBlkRep, FebRep, FebBlkRep, FebNonBlkRep,
			MarRep, MarBlkRep, MarNonBlkRep,AprRep, AprBlkRep, AprNonBlkRep,
			MayRep, MayBlkRep, MayNonBlkRep,JunRep, JunBlkRep, JunNonBlkRep, 
			Tot_NonBlkRep,
			Tot_BlkRep,

			AugTar, AugBlkTar, AugNonBlkTar, SepTar, SepBlkTar, SepNonBlkTar, OctTar, 
			OctBlkTar, OctNonBlkTar,NovTar, NovBlkTar, NovNonBlkTar, DecTar, DecBlkTar, 
			DecNonBlkTar, JanTar, JanBlkTar, JanNonBlkTar, FebNonBlkTar, FebTar, FebBlkTar, 
			MarTar, MarBlkTar, MarNonBlkTar,AprTar, AprBlkTar, AprNonBlkTar, 
			MayTar, MayBlkTar, MayNonBlkTar,JunTar, JunBlkTar, JunNonBlkTar,
			Tot_NonBlkTar,
			Tot_BlkTar,

			AugISS, AugBlkISS, AugNonBlkISS, SepISS, SepBlkISS, SepNonBlkISS, OctISS, 
			OctBlkISS, OctNonBlkISS,NovISS, NovBlkISS, NovNonBlkISS, DecISS, DecBlkISS, 
			DecNonBlkISS, JanISS, JanBlkISS, JanNonBlkISS,FebISS, FebBlkISS, FebNonBlkISS,
			MarISS, MarBlkISS, MarNonBlkISS,AprISS, AprBlkISS, AprNonBlkISS, 
			MayISS, MayBlkISS, MayNonBlkISS,JunISS, JunBlkISS, JunNonBlkISS,
 			Tot_NonBlkISS,
			Tot_BlkISS,

			AugOSS, AugBlkOSS, AugNonBlkOSS, SepOSS, SepBlkOSS, SepNonBlkOSS, OctOSS, 
			OctBlkOSS, OctNonBlkOSS,NovOSS, NovBlkOSS, NovNonBlkOSS, DecOSS, DecBlkOSS, 
			DecNonBlkOSS, JanOSS, JanBlkOSS, JanNonBlkOSS,FebOSS, FebBlkOSS, FebNonBlkOSS,
			MarOSS, MarBlkOSS, MarNonBlkOSS,AprOSS, AprBlkOSS, AprNonBlkOSS, 
			MayOSS, MayBlkOSS, MayNonBlkOSS,JunOSS, JunBlkOSS, JunNonBlkOSS,
			Tot_NonBlkOSS,
			Tot_BlkOSS,

			AugReAssign, AugBlkReAssign, AugNonBlkReAssign, SepReAssign, SepBlkReAssign, SepNonBlkReAssign, OctReAssign, 
			OctBlkReAssign, OctNonBlkReAssign,NovReAssign, NovBlkReAssign, NovNonBlkReAssign, DecReAssign, DecBlkReAssign, 
			DecNonBlkReAssign, JanReAssign, JanBlkReAssign, JanNonBlkReAssign,FebReAssign, FebBlkReAssign, FebNonBlkReAssign,
			MarReAssign, MarBlkReAssign, MarNonBlkReAssign,	AprReAssign, AprBlkReAssign, AprNonBlkReAssign, 
			MayReAssign, MayBlkReAssign, MayNonBlkReAssign,JunReAssign, JunBlkReAssign, JunNonBlkReAssign,
			Tot_NonBlkReAssign,
			Tot_BlkReAssign,

			AugBus, AugBlkBus, AugNonBlkBus, SepBus, SepBlkBus, SepNonBlkBus, OctBus, 
			OctBlkBus, OctNonBlkBus,NovBus, NovBlkBus, NovNonBlkBus, DecBus, DecBlkBus, 
			DecNonBlkBus, JanBus, JanBlkBus, JanNonBlkBus,FebBus, FebBlkBus, FebNonBlkBus,
			MarBus, MarBlkBus, MarNonBlkBus,AprBus, AprBlkBus, AprNonBlkBus, 
			MayBus, MayBlkBus, MayNonBlkBus,JunBus, JunBlkBus, JunNonBlkBus,
			Tot_NonBlkBus,
			Tot_BlkBus

)



 select dis.disschnum,
	-- Battery on Students Referrals
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkBat, 
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkBat,
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkBat, 
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkBat,
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkBat, 
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkBat,
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkBat, 
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkBat,
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkBat,
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkBat, 
          count(case when  dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBat,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkBat, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkBat,
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='02'then 1 end) as Tot_NonBlkBat,
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='02'then 1 end) as Tot_BlkBat,

	-- Defiance/Insubordination Referrals
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkIns,
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkIns,
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkIns, 
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkIns,
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkIns, 
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkIns,
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkIns, 
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkIns,
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkIns,
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkIns, 
          count(case when  dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunIns,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkIns, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkIns,
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='07'then 1 end) as Tot_NonBlkIns,
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='07'then 1 end) as Tot_BlkIns,

	-- Class Disruption Referrals
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkDisr, 
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkDisr,
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkDisr, 
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkDisr,
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkDisr, 
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkDisr,
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkDisr, 
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkDisr,
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkDisr,
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkDisr, 
          count(case when  dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunDisr,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkDisr, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkDisr,
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='16'then 1 end) as Tot_NonBlkDisr,
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='16'then 1 end) as Tot_BlkDisr,
	-- Fighting Referrals
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkFig, 
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkFig,
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkFig, 
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkFig,
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkFig, 
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkFig,
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkFig, 
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkFig,
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkFig,
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkFig, 
          count(case when  dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunFig,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkFig, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkFig,
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='05'then 1 end) as Tot_NonBlkFig,
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='05'then 1 end) as Tot_BlkFig,

	-- Profanity/Obscene Language Referrals
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkObs, 
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkObs,
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkObs, 
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkObs,
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkObs, 
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkObs,
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkObs, 
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkObs,
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkObs,
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkObs, 
          count(case when  dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunObs,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkObs, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkObs,
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='08'then 1 end) as Tot_NonBlkObs,
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='08'then 1 end) as Tot_BlkObs,

	-- Repeated Misconduct Referrals
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkRep, 
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkRep,
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkRep, 
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkRep,
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkRep, 
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkRep,
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkRep, 
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkRep,
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkRep,
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkRep, 
          count(case when  dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunRep,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkRep, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkRep,
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='09'then 1 end) as Tot_NonBlkRep,
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='09'then 1 end) as Tot_BlkRep,

	-- Tardy Referrals
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkTar, 
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkTar,
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkTar, 
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkTar,
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkTar, 
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkTar,
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkTar, 
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkTar,
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkTar,
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkTar, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkTar, 
          count(case when  dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunTar,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkTar,
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkTar, 

          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='21'then 1 end) as Tot_NonBlkTar,
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='21'then 1 end) as Tot_BlkTar,

          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkISS, 
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkISS,
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkISS, 
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkISS,
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkISS, 
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkISS,
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkISS, 
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkISS,
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkISS,
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkISS, 
          count(case when  dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunISS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkISS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkISS,
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='I'then 1 end) as Tot_NonBlkISS,
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='I'then 1 end) as Tot_BlkISS,

          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkOSS, 
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkOSS,
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkOSS, 
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkOSS,
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkOSS, 
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkOSS,
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkOSS, 
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkOSS,
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkOSS,
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkOSS, 
          count(case when  dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunOSS,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkOSS, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkOSS,
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='O'then 1 end) as Tot_NonBlkOSS,
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='O'then 1 end) as Tot_BlkOSS,

	-- Reassigment Referrals
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkReAssign, 
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkReAssign,
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkReAssign, 
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkReAssign,
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkReAssign, 
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkReAssign,
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkReAssign, 
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkReAssign,
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkReAssign,
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkReAssign, 
          count(case when  dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunReAssign,     
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkReAssign, 
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkReAssign,
          count(case when stu.ethniccode <> 'B' and dis.DISPCODE ='X'then 1 end) as Tot_NonBlkReAssign,
          count(case when stu.ethniccode = 'B' and dis.DISPCODE ='X'then 1 end) as Tot_BlkReAssign,

	-- Arrest 
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '8'then 1 end) as AugNonBlkBus, 
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '9'then 1 end) as SepNonBlkBus,
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '10'then 1 end) as OctNonBlkBus, 
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '11'then 1 end) as NovNonBlkBus,
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '12'then 1 end) as DecNonBlkBus, 
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '1'then 1 end) as JanNonBlkBus,
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '2'then 1 end) as FebNonBlkBus, 
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '3'then 1 end) as MarNonBlkBus,
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkBus,
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as MayBlkBus, 
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '4'then 1 end) as MayNonBlkBus, 
          count(case when  dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBus,     
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunBlkBus,
          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'AND MONTH(DIS.REFERDATE)= '5'then 1 end) as JunNonBlkBus, 

          count(case when stu.ethniccode <> 'B' and dis.DESCCODE ='14'then 1 end) as Tot_NonBlkBus,
          count(case when stu.ethniccode = 'B' and dis.DESCCODE ='14'then 1 end) as Tot_BlkBus

FROM dbo.ASTU9D21 AS stu 
join dbo.ADIS9D22 AS dis ON stu.SCHOOLNUM = dis.schoolnum AND stu.stulink = dis.stulink
where dis.REFERDATE BETWEEN '8/1/09' AND '6/30/10' and stu.grade in ('06','07','08','09','10','11','12')
group by dis.disschnum
--) as Referrals




GO
ALTER DATABASE [EDS] SET  READ_WRITE 
GO
